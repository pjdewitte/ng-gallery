//This file is the first one when creating minified build
//and is used to set certain flags that are needed
//for the concatenated build.
// Define the most often used ones
// fix IE events
// IE does not implement ArrayBuffer slice. Handy!
//The BlobBuilder object
// Launch full screen on the given element with the available method
// Exit full screen with the available method
// Determines if the browser is in full screen
// Get the version of the android device through user agent.
// Return the version string of android device, e.g. 4.4, 5.0...
// Determine if this is a touch or notouch device.
// Convert touchstart event to click to remove the delay between the touch and
// the click event which is sent after touchstart with about 300ms deley.
// Should be used in UI elements on touch devices.
//Safari doesn't have the Performance object
//We only need the now() function, so that's easy to emulate.
//# sourceMappingURL=hammer.min.map
// -------------------------------------------------------------------------Node
// ---------------------------------------------------------------AdvancingFront
// ----------------------------------------------------------------------Exports
// ------------------------------------------------------------------------Point
// -----------------------------------------------------Point ("static" methods)
// -----------------------------------------------------------------"Point-Like"
// ---------------------------------------------------------Exports (public API)
// (this feature is not automatically provided by browserify).
// Backward compatibility
// ------------------------------------------------------------------------utils
// ------------------------------------------------------------------------Sweep
// ----------------------------------------------------------------------Exports
// ------------------------------------------------------------------------utils
// -------------------------------------------------------------------------Edge
// ------------------------------------------------------------------------Basin
// --------------------------------------------------------------------EdgeEvent
// ----------------------------------------------------SweepContext (public API)
// Method added in the JavaScript version (was not present in the c++ version)
// Method added in the JavaScript version (was not present in the c++ version)
// Shortcut method for sweep.triangulate(SweepContext).
// Method added in the JavaScript version (was not present in the c++ version)
// Method added in the JavaScript version (was not present in the c++ version)
// ---------------------------------------------------SweepContext (private API)
// ----------------------------------------------------------------------Exports
// ---------------------------------------------------------------------Triangle
// Method added in the JavaScript version (was not present in the c++ version)
// Additional check from Java version (see issue #88)
// ---------------------------------------------------------Exports (public API)
//========================================================
// Utility functions used by page->model conversions below
// A default Xhr error handler that will pass errors to raiseError
/// Returns true if the operation belongs to a chain of combined operations; otherwise returns false.
//
// This object handles the default click behaviour, some of which is controlled
// via the "setClickBehavior" configuration.
//
// /** @constructor */
//
// TODO: Pass in the api instead of the impl, don't use the impl object.
//
// /** @constructor */
//
// TODO: Pass in the api instead of the impl, don't use the impl object.
//
// /** @constructor */
//
// TODO: Pass in the api instead of the impl, don't use the impl object.
//
// /** @constructor */
//
// TODO: Pass in the api instead of the impl, don't use the impl object.
//
//Makes the children of a given node visible and
//everything else not visible
//Makes the children of a given node visible and
//everything else not visible
//Makes the children of a given node visible and
//everything else not visible
//Those are globals -- set by the build system.
// A cache of entire worker script as data URL.
// Create a web worker.
//Maps a relative resource path (like a pack file or texture)
//to an absolute URL (possibly signed).
//Creates a non-indexed triangle geometry vertex (triangle vertex coords stored in single vertex structure)
//====================================================================================================
//====================================================================================================
// Indexed triangle code path can only be used when hardware instancing is not in use.
// Otherwise, the addTriangleGeom operation should be used to add simple triangles to the buffer.
//====================================================================================================
//====================================================================================================
//====================================================================================================
//====================================================================================================
// End indexed triangle code path.
//====================================================================================================
//====================================================================================================
//Creates a non-indexed triangle geometry (triangle vertex coords stored in single vertex structure)
//Scratch variables used by bvh_bin_axis
//TODO: can be replaced by a flat ArrayBuffer
//TODO: can be replaced by a flat ArrayBuffer
//Given a list of LMV fragments, builds a spatial index for view-dependent traversal and hit testing
//Constants duplicated from src/lmvtk/VertexBufferBuilder.js
//Encapsulates frustum-box intersection logic
//Finds a precanned BufferAttribute corresponding to the given
//attribute data, so that we don't have to allocate the same exact
//one over and over and over.
//Converts a mesh description passed back from worker threads into a renderable three.js
//compatible LmvBufferGeometry.
//Sets various extra flags we need.
//this.disableStreaming = true;
//Given a leaf node, find the correct parent
//node to select according to the given selection mode
//        this.setFlagGlobal(MESH_HIDE, hide);
// This function should probably not be called outside VisibityManager
// in order to maintain node visibility state.
//Use only for incremental adding to linearly ordered (non-BVH) scenes!
//Use the complex implementation of forEach only when paging is enabled.
//TODO: This might be better done using inheritance from RenderBatch
//Use the complex implementation only when paging is enabled.
//TODO: This might be better done using inheritance from RenderBatch
//TODO: better heuristic for group size might be needed
//But it should be based on polygon count as well as
//fragment count. But polygon count is not known
//until we get the meshes later on.
//TODO: This file is in the process of being refactored into three parts: RenderModel, ModelIteratorBVH and ModelIteratorLinear
//Please keep this in mind when making changes here
//TODO: This should be removed, because the functionality that uses it
//in the SvfLoader does not seem needed
// requires vWorldPosition
//          vViewPosition, if CUTPLANES_LINE
//See http://aras-p.info/texts/CompactNormalStorage.html
//Currently using the slow and simple approach of mapping 3d normal to two spherical coords.
//TODO try other, cheaper ways to encode the normal.
//Gaussian falloff function
// Precomputed sin/cos of the environment rotation
//Trivial copy pass
//Shader that composes a final frame from the color target, SSAO target and overlays target.
//Tone mapping is currently done by the main forward pass, in order to fit the
//output into an RGBA8 render target. It's mathematically wrong to apply the
//ambient obscurance in gamma space, but the performance savings of not using RGBA32 target
//are significant.
//Bilateral separable blur pass for SAO shader.
//Shader used to convert the normals+depth texture into a smaller texture containing only depth
//Since it packs depth into RGBA8 target it also maps it to the range 0-1 then packs that float
//into an RGBA using magic.
//            "depth = texture2D(tDiffuse, vUv).z;",
//Shader used to generate mip levels for the depth texture (used by the SAO shader)
//            "gl_FragColor = texture2D(tDiffuse, vUv);",
//TODO: vFragDepth and depth varyings are basically the same ( vFragDepth = 1.0 - depth ) so they can be combined into one
//TODO: vFragDepth and depth varyings are basically the same ( vFragDepth = 1.0 - depth ) so they can be combined into one
//============================================================================
// Iterative distance to ellipse from Geometric Tools by Eberly
// See Page 11 of the document:
// http://www.geometrictools.com/Documentation/DistancePointEllipseEllipsoid.pdf
//============================================================================
//Our ID target is RGB, but it still seems to work if we call readPixels with RGBA, so the check is commented out
//Line types from acad.lin below. Definitions are kept the same
//as the original except the format is JSON-ified to avoid parsing .LIN
//
//  AutoCAD Linetype Definition file
//  Version 2.0
//  Copyright 1991, 1992, 1993, 1994, 1996 by Autodesk, Inc.
//
//List of line type definitions from ACAD.lin.
//[TS] The units for these items seem to be inches or drawing units with dot
// being represented by 0, i.e. pen width = 0. (see note about ISO patterns below)
//
//  ISO 128 (ISO/DIS 12011) linetypes
//
//  The size of the line segments for each defined ISO line, is
//  defined for an usage with a pen width of 1 mm. To use them with
//  the other ISO predefined pen widths, the line has to be scaled
//  with the appropriate value (e.g. pen width 0,5 mm -> ltscale 0.5).
//
//[TS] Added pen_width and unit properties to make this explicit
//  Complex linetypes
//
//  Complex linetypes have been added to this file.
//  These linetypes were defined in LTYPESHP.LIN in
//  Release 13, and are incorporated in ACAD.LIN in
//  Release 14.
//  
//  These linetype definitions use LTYPESHP.SHX.
//
//[TS] These do not work, we can only render linear types.
// Helper functions to parse ugly Protein JSON
// Catmull-Rom spline
//            stderr("click");
// Copyright (c)2014 Jan Mühlemann (jamuhl).
// Distributed under MIT license
// http://i18next.com
//        // Change -0.0 to 0.0
//        if (x === 0.0) {
//            x = 0.0;
//        }
//==========================================================================================================
//==========================================================================================================
//==========================================================================================================
//==========================================================================================================
//==========================================================================================================
//==========================================================================================================
// static
// static
// static
// static
// Alias Tree/TreeDelegate from Private namespace into UI namespace.
// This is temporary and should be removed eventually.
//
//Constant FOV used to make math right for Ortho cameras.
//TODO: This is used in several places, but should not be global, move it into some namepsace
//==============================================================================
// Builds on the basic Viewer3D by adding various common GUI elements.
//==============================================================================
// this is to hide the specific child node
//TODO: Is it really necessary to expose it other than to ExtensionManager?
//Shader that implements Oculus VR headset image warping.
//See three.js OculusRiftEffect
//            stderr("click");
//        var line = user.name + ": " + e.data.msg;
// /** @constructor */
//
// TODO: Pass in the api instead of the impl, don't use the impl object.
//
//
// /** @constructor */
//
//
//
// /** @constructor */
//
//
//
// /** @constructor */
//
//
//
// First Person
//
// VR
//
//Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.isSimResultGroupNode = function (node) {
//    if (!this.simGalleryPanel || !this.simGalleryPanel.simDef || !this.simGalleryPanel.simDef.resultGroups || this.simGalleryPanel.simDef.resultGroups.length == 0)
//        return false;
//    var groupKeys = Object.keys(this.simGalleryPanel.simDef.resultGroups);
//    for (var i = 0; i < groupKeys.length; i++) {
//        var id = Number(groupKeys[i]);
//        if(id == node)
//            return true;
//    }
//    return false;
//};
// Callback function provided by client to get a new access token.
// Viewer uses this to refresh token in a fixed interval.
// GUID of the current active document item.
// Returns the query parameter value from window url
// return value of parameter from a url
// Return a default document URN for demo purpose.
// TODO:  This is here for now, until we find a better place for it.
//
function launchFullscreen(e,t){e.requestFullscreen?e.requestFullscreen(t):e.mozRequestFullScreen?e.mozRequestFullScreen(t):e.webkitRequestFullscreen?e.webkitRequestFullscreen(t):e.msRequestFullscreen&&e.msRequestFullscreen(t)}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(e){return e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen||e.msRequestFullscreen}function getAndroidVersion(e){var e=e||navigator.userAgent,t=e.match(/Android\s([0-9\.]*)/)
return t?t[1]:!1}function isTouchDevice(){return"ontouchstart"in window}function isIOSDevice(){return/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())}function isAndroidDevice(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")}function isMobileDevice(){return isIOSDevice()||isAndroidDevice()}function detectWebGL(){if(window.WebGLRenderingContext){for(var e=document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],i=!1,n=0;4>n;n++)try{if(i=e.getContext(t[n]),i&&"function"==typeof i.getParameter)return 1}catch(o){}return 0}return-1}function touchStartToClick(e){e.preventDefault(),e.stopPropagation(),e.target.click()}function init_three_dds_loader(){THREE.DDSLoader=function(){this._parser=THREE.DDSLoader.parse},THREE.DDSLoader.prototype=Object.create(THREE.CompressedTextureLoader.prototype),THREE.DDSLoader.prototype.constructor=THREE.DDSLoader,THREE.DDSLoader.parse=function(e,t){function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function n(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}function o(e,t,i,n){for(var o=i*n*4,r=new Uint8Array(e,t,o),a=new Uint8Array(o),s=0,l=0,c=0;n>c;c++)for(var u=0;i>u;u++){var d=r[l]
l++
var h=r[l]
l++
var p=r[l]
l++
var f=r[l]
l++,a[s]=p,s++,a[s]=h,s++,a[s]=d,s++,a[s]=f,s++}return a}var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},a=542327876,s=131072,l=512,c=4,u=i("DXT1"),d=i("DXT3"),h=i("DXT5"),p=31,f=0,m=1,v=2,g=3,E=4,y=7,A=20,T=21,b=22,w=23,_=24,x=25,C=26,S=28,R=new Int32Array(e,0,p)
if(R[f]!==a)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),r
if(!R[A]&c)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),r
var M,P=R[T],L=!1
switch(P){case u:M=8,r.format=THREE.RGB_S3TC_DXT1_Format
break
case d:M=16,r.format=THREE.RGBA_S3TC_DXT3_Format
break
case h:M=16,r.format=THREE.RGBA_S3TC_DXT5_Format
break
default:if(!(32==R[b]&&16711680&R[w]&&65280&R[_]&&255&R[x]&&4278190080&R[C]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",n(P)),r
L=!0,M=64,r.format=THREE.RGBAFormat}r.mipmapCount=1,R[v]&s&&t!==!1&&(r.mipmapCount=Math.max(1,R[y])),r.isCubemap=R[S]&l?!0:!1,r.width=R[E],r.height=R[g]
for(var I=R[m]+4,k=r.width,V=r.height,N=r.isCubemap?6:1,D=0;N>D;D++){for(var H=0;H<r.mipmapCount;H++){if(L)var O=o(e,I,k,V),B=O.length
else var B=Math.max(4,k)/4*Math.max(4,V)/4*M,O=new Uint8Array(e,I,B)
var F={data:O,width:k,height:V}
r.mipmaps.push(F),I+=B,k=Math.max(.5*k,1),V=Math.max(.5*V,1)}k=r.width,V=r.height}return r}}function trace(e){"\n"==e[e.length-1]&&(e=e.substring(0,e.length-1)),console.log((performance.now()/1e3).toFixed(3)+": "+e)}function init_three_triangulator(){"use strict"
Autodesk.Viewing.Private.Triangulator||(Autodesk.Viewing.Private.Triangulator=function(){function e(e,t,i){var n=t>e?e+":"+t:t+":"+e
return i+":"+n}function t(t,i,n,o,r,a,s){this.pt1=t,this.pt2=i,this.p1=-1,this.p2=-1,this.eid1=e(n,o,s),this.eid2=e(r,a,s)}function i(){this.bbox=new THREE.Box2,this.left=null,this.right=null,this.node_edges=[]}function n(e,t,i){this.pts=e,this.edges=t,this.bbox=i,this.pipResult=!1}function o(e,t){this.edges=e,this.bbox=t,this.pts=[],this.idmap={},this.xymap={},this.contours=[],this.scale=1e6/this.bbox.size().length()}function r(e){this.indices=[],this.cset=e
var t=this.pts=e.pts
this.intervalTree=new n(e.pts,e.edges,e.bbox),this.intervalTree.build()
for(var i=0;i<t.length;i++)t[i].id=i
var o=new lmv_poly2tri.SweepContext([])
if(o.points_=t.slice(),e.contours)for(var r=this.cset.contours,a=0;a<r.length;a++){for(var s=r[a],l=s[0]!==s[s.length-1],c=[],u=0;u<s.length-1;u++)c.push(t[s[u]])
o.initEdges(c,l)}else for(var d=this.cset.edges,i=0;i<d.length;i++){var h=d[i]
if(h.p1!=h.p2){var p=[t[h.p1],t[h.p2]]
o.initEdges(p,!0)}}this.triangulate(o),this.processResult(o)}return n.prototype.splitNode=function(e){if(!(e.bbox.min.y>=e.bbox.max.y||e.node_edges.length<3)){var t=.5*(e.bbox.min.y+e.bbox.max.y)
e.left=new i,e.right=new i
for(var n=this.pts,o=e.node_edges,r=[],a=new THREE.Vector2,s=0;s<o.length;s++){var l=this.edges[o[s]],c=n[l.p1].y,u=n[l.p2].y
if(c>u){var d=c
c=u,u=d}var h=null
t>u?(e.left.node_edges.push(o[s]),h=e.left.bbox):c>t?(e.right.node_edges.push(o[s]),h=e.right.bbox):r.push(o[s]),h&&(a.set(n[l.p1].x,n[l.p1].y),h.expandByPoint(a),a.set(n[l.p2].x,n[l.p2].y),h.expandByPoint(a))}e.node_edges=r,e.left.node_edges.length&&this.splitNode(e.left),e.right.node_edges.length&&this.splitNode(e.right)}},n.prototype.build=function(){this.root=new i
for(var e=this.root.node_edges,t=0;t<this.edges.length;t++)e.push(t)
this.root.bbox.copy(this.bbox),this.splitNode(this.root)},n.prototype.pointInPolygonRec=function(e,t,i){if(e.bbox.min.y<=i&&e.bbox.max.y>=i)for(var n=this.pts,o=e.node_edges,r=0,a=o.length;a>r;r++){var s=this.edges[o[r]],l=n[s.p1],c=l.x,u=l.y,d=u>=i,h=n[s.p2],p=h.x,f=h.y,m=f>=i
d!=m&&(f-i)*(c-p)>=(p-t)*(u-f)==m&&(this.pipResult=!this.pipResult)}var v=e.left
v&&v.bbox.min.y<=i&&v.bbox.max.y>=i&&this.pointInPolygonRec(v,t,i)
var g=e.right
g&&g.bbox.min.y<=i&&g.bbox.max.y>=i&&this.pointInPolygonRec(g,t,i)},n.prototype.pointInPolygon=function(e,t){return this.pipResult=!1,this.pointInPolygonRec(this.root,e,t),this.pipResult},o.prototype.getPointIndex=function(e,t,i){var n=this.idmap[i]
if(void 0!==n)return n
var o,r=0|e*this.scale,a=0|t*this.scale,s=this.xymap[r]
return void 0===s?(this.xymap[r]=s={},o=void 0):o=s[a],void 0===o&&(s[a]=o=this.pts.length,this.idmap[i]=o,this.pts.push({x:e,y:t})),o},o.prototype.snapEdges=function(){for(var e=0;e<this.edges.length;e++){var t=this.edges[e]
t.p1=this.getPointIndex(t.pt1.x,t.pt1.y,t.eid1),t.p2=this.getPointIndex(t.pt2.x,t.pt2.y,t.eid2)}},o.prototype.sanitizeEdges=function(){for(var e={},t=[],i=0,n=this.edges.length;n>i;i++){var o=this.edges[i]
if(o.p1!==o.p2){var r=Math.min(o.p1,o.p2)+":"+Math.max(o.p1,o.p2)
e[r]!==!0&&(e[r]=!0,t.push(o))}}this.edges=t},o.prototype.stitchContours=function(){for(var e={},t=0;t<this.edges.length;t++){var i=this.edges[t]
i.p1!==i.p2&&(void 0!==e[i.p1]?e[i.p1].push(i.p2):e[i.p1]=[i.p2],void 0!==e[i.p2]?e[i.p2].push(i.p1):e[i.p2]=[i.p1])}var n=[]
for(var o in e)if(2!==e[o].length){stderr("Incomplete edge table")
break}for(;;){var r=void 0
for(var o in e)if(e[o].length>1){r=o
break}if(!r)for(var o in e)if(e[o].length>0){r=o
break}if(!r)break
var a=-1,s=parseInt(r),l=e[r]
for(n.push(s);l&&l.length;){var c=l.shift()
if(c===a&&(c=l.shift()),void 0===c){delete e[s]
break}n.push(c),0==l.length?delete e[s]:l[0]===a&&delete e[s],a=s,s=c,l=e[c]}n.length&&(this.contours.push(n),n=[])}for(var u=[],t=0;t<this.contours.length;t++){var d=this.contours[t]
d[0]!==d[d.length-1]&&u.push(d)}if(u.length)for(var h=!0;h;){h=!1
for(var p={},f=this.contours,t=0;t<f.length;t++){var d=f[t],m=d[0],v=d[d.length-1]
m!==v&&(p[m]?p[m].push(-t-1):p[m]=[-t-1],p[v]?p[v].push(t):p[v]=[t])}for(var o in p){var g=p[o]
if(2==g.length){var E=void 0
if(g[0]<0&&g[1]<0){var y=-g[0]-1,A=-g[1]-1
f[A].shift(),Array.prototype.push.apply(f[y].reverse(),f[A]),E=A}if(g[0]<0&&g[1]>0){var y=-g[0]-1,A=g[1]
f[A].pop(),Array.prototype.push.apply(f[A],f[y]),E=y}if(g[0]>0&&g[1]<0){var y=g[0],A=-g[1]-1
f[y].pop(),Array.prototype.push.apply(f[y],f[A]),E=A}if(g[0]>0&&g[1]>0){var y=g[0],A=g[1]
f[y].pop(),Array.prototype.push.apply(f[y],f[A].reverse()),E=A}void 0!==E&&(f.splice(E,1),h=!0)
break}}}},r.prototype.triangulate=function(e){try{e.triangulate()}catch(t){}},r.prototype.processResult=function(e){for(var t=0;t<e.map_.length;t++){var i=e.map_[t],n=i.points_[0],o=i.points_[1],r=i.points_[2]
void 0!==n.id&&void 0!==o.id&&void 0!==r.id&&this.filterFace(n.id,o.id,r.id)}},r.prototype.pointInEdgeList=function(e,t){for(var i,n,o,r,a,s,l=this.cset.pts,c=this.cset.edges,u=!1,d=0,h=c.length;h>d;++d){var p=c[d]
o=l[p.p1].x,r=l[p.p1].y,i=r>=t,a=l[p.p2].x,s=l[p.p2].y,n=s>=t,i!=n&&(s-t)*(o-a)>=(a-e)*(r-s)==n&&(u=!u)}return u},r.prototype.pointInContour=function(e,t,i){var n,o,r,a,s,l,c=!1,u=this.cset.pts
r=u[i[i.length-1]].x,a=u[i[i.length-1]].y,n=a>=t
for(var d=0,h=i.length;h>d;++d)s=u[i[d]].x,l=u[i[d]].y,o=l>=t,n!=o&&(l-t)*(r-s)>=(s-e)*(a-l)==o&&(c=!c),n=o,r=s,a=l
return c},r.prototype.pointInPolygon=function(e,t){for(var i=!1,n=0;n<this.cset.contours.length;n++)this.pointInContour(e,t,this.cset.contours[n])&&(i=!i)
return i},r.prototype.filterFace=function(e,t,i){var n=this.pts[e],o=this.pts[t],r=this.pts[i],a=(n.x+o.x+r.x)/3,s=(n.y+o.y+r.y)/3
if(this.intervalTree.pointInPolygon(a,s)){var l=o.x-n.x,c=o.y-n.y,u=r.x-n.x,d=r.y-n.y,h=l*d-u*c
h>0?this.indices.push(e,t,i):this.indices.push(e,i,t)}},{TriangulatedSurface:r,ContourSet:o,Edge:t}}())}function init_three_intersector(){"use strict"
Autodesk.Viewing.Private.Intersector||(Autodesk.Viewing.Private.Intersector=function(){function e(e){return Math.abs(e)<l}function t(t,i,n,o,r){var a=u.subVectors(n,i),s=t.normal.dot(a)
if(e(s))return o.copy(i),r.copy(n),2
s=1/s
var c=-(i.dot(t.normal)*s+t.constant*s)
if(-l>c||c>1+l)return 0
var d=a.multiplyScalar(c).add(i)
return o.copy(d),1}function i(e,i,n,o,r,a,s,u,p){var f=e.distanceToPoint(i),m=e.distanceToPoint(n),v=e.distanceToPoint(o)
if(-l>f&&-l>m&&-l>v)return null
if(f>l&&m>l&&v>l)return null
var g=Math.sign(f),E=Math.sign(m),y=Math.sign(v)
if(0===g&&0===E&&0===y)return null
var A,T,b,w,_,x
if(g!==E){var C=t(e,i,n,d,h)
if(2==C)return void u.push(new c(i.clone(),n.clone(),r,r,a,a,p))
1==C?(b=r,w=a,A=d.clone()):console.warn("Unexpected zero intersections where at least one was expected")}if(E!==y){var C=t(e,n,o,d,h)
if(2==C)return void u.push(new c(n.clone(),o.clone(),a,a,s,s,p))
1==C?A?d.distanceTo(A)>l&&(_=a,x=s,T=d.clone()):(b=a,w=s,A=d.clone()):console.warn("Unexpected zero intersections where at least one was expected")}if(y!==g){var C=t(e,o,i,d,h)
if(2==C)return void u.push(new c(o.clone(),i.clone(),s,s,r,r,p))
1==C?A?d.distanceTo(A)>l&&(_=s,x=r,T=d.clone()):console.warn("Unexpected single intersection point"):console.warn("Unexpected zero intersections where at least one was expected")}A&&T?u.push(new c(A,T,b,w,_,x,p)):console.warn("Unexpected one intersection where two were expected")}function n(e,t){p.set(t.min.x,t.min.y,t.min.z)
var i=e.distanceToPoint(p),n=Math.sign(i)
p.set(t.min.x,t.min.y,t.max.z)
var o=e.distanceToPoint(p)
return Math.sign(o)!==n?!0:(p.set(t.min.x,t.max.y,t.min.z),o=e.distanceToPoint(p),Math.sign(o)!==n?!0:(p.set(t.min.x,t.max.y,t.max.z),o=e.distanceToPoint(p),Math.sign(o)!==n?!0:(p.set(t.max.x,t.min.y,t.min.z),o=e.distanceToPoint(p),Math.sign(o)!==n?!0:(p.set(t.max.x,t.min.y,t.max.z),o=e.distanceToPoint(p),Math.sign(o)!==n?!0:(p.set(t.max.x,t.max.y,t.min.z),o=e.distanceToPoint(p),Math.sign(o)!==n?!0:(p.set(t.max.x,t.max.y,t.max.z),o=e.distanceToPoint(p),Math.sign(o)!==n?!0:!1))))))}function o(e,t,n){var o=t.geometry,r=n.length,a=o.attributes,s=t.matrixWorld
g.getInverse(s),E.copy(e).applyMatrix4(g)
var l,c,u
if(void 0!==a.index){var d=a.index.array||o.ib,h=o.vb?o.vb:a.position.array,p=o.vb?o.vbstride:3,y=o.offsets
y&&0!==y.length||(y=[{start:0,count:d.length,index:0}])
for(var A=0,T=y.length;T>A;++A)for(var b=y[A].start,w=y[A].count,_=y[A].index,x=b,C=b+w;C>x;x+=3)l=_+d[x],c=_+d[x+1],u=_+d[x+2],f.x=h[l*p],f.y=h[l*p+1],f.z=h[l*p+2],m.x=h[c*p],m.y=h[c*p+1],m.z=h[c*p+2],v.x=h[u*p],v.y=h[u*p+1],v.z=h[u*p+2],i(E,f,m,v,l,c,u,n,t.fragId)}else for(var h=o.vb?o.vb:a.position.array,p=o.vb?o.vbstride:3,x=0,S=0,C=h.length;C>x;x+=3,S+=9)l=x,c=x+1,u=x+2,f.x=h[l*p],f.y=h[l*p+1],f.z=h[l*p+2],m.x=h[c*p],m.y=h[c*p+1],m.z=h[c*p+2],v.x=h[u*p],v.y=h[u*p+1],v.z=h[u*p+2],i(E,f,m,v,l,c,u,n,t.fragId)
for(var x=r;x<n.length;x++)n[x].pt1.applyMatrix4(s),n[x].pt2.applyMatrix4(s)}function r(e,t,i){var n=t,o=Math.sqrt(1-n*n),r=1-n,a=e.x,s=e.y,l=e.z,c=r*a,u=r*s
i.set(c*a+n,c*s-o*l,c*l+o*s,0,c*s+o*l,u*s+n,u*l-o*a,0,c*l-o*s,u*l+o*a,r*l*l+n,0,0,0,0,1)}function a(t){var i=new THREE.Vector3(0,0,1),n=t.normal.clone().cross(i)
n=n.normalize()
var o=i.dot(t.normal),a=new THREE.Matrix4
return e(n.x)&&e(n.y)&&e(n.z)?a.elements[14]=o*t.constant:(r(n,o,a),a.elements[14]=t.constant),a}function s(e,t,i){for(var n=0;n<t.length;n++){var o=t[n]
o.pt1.applyMatrix4(e),o.pt2.applyMatrix4(e),i.expandByPoint(o.pt1),i.expandByPoint(o.pt2)}}var l=1e-10,c=Autodesk.Viewing.Private.Triangulator.Edge,u=new THREE.Vector3,d=new THREE.Vector3,h=new THREE.Vector3,p=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector3,v=new THREE.Vector3,g=new THREE.Matrix4,E=new THREE.Plane
return{makePlaneBasis:a,convertToPlaneCoords:s,intersectTrianglePlane:i,intersectMeshPlane:o,intersectBoxPlane:n}}())}function NodeArray(e,t){t?this.bytes_per_node=32:this.bytes_per_node=36
var i,n
e instanceof ArrayBuffer?(i=e.byteLength/this.bytes_per_node,n=e,this.nodeCount=i):(i=0|e,n=new ArrayBuffer(this.bytes_per_node*i),this.nodeCount=0),this.nodeCapacity=i,this.nodesRaw=n,this.is_lean_node=t,this.node_stride=this.bytes_per_node/4,this.node_stride_short=this.bytes_per_node/2,this.nodesF=new Float32Array(this.nodesRaw),this.nodesI=new Int32Array(this.nodesRaw),this.nodesS=new Uint16Array(this.nodesRaw)}function BVHBuilder(e,t){this.boxes=e.boxes,this.polygonCounts=e.polygonCounts,this.materials=e.materials,this.materialDefs=t,this.prim_count=e.length,this.frags_per_leaf_node=-1,this.frags_per_inner_node=-1,this.nodes=null,this.work_buf=new ArrayBuffer(4*this.prim_count),this.sort_prims=new Int32Array(this.work_buf),this.primitives=new Int32Array(this.prim_count),this.centroids=new Float32Array(POINT_STRIDE*this.prim_count),this.boxv_o=new Float32Array(6),this.boxc_o=new Float32Array(6),this.boxv_t=new Float32Array(6),this.boxc_t=new Float32Array(6),this.recursion_stack=[]}function RenderContext(){function e(){function e(e){e.material.blending=THREE.NoBlending,e.material.depthWrite=!1,e.material.depthTest=!1}var t=W.NormalsShader
n=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:THREE.UniformsUtils.clone(t.uniforms)}),n.blending=THREE.NoBlending,n.packedNormals=!0,c=new W.LmvShaderPass(W.SAOShader),e(c),l=new W.LmvShaderPass(W.SAOBlurShader),e(l),d=new W.LmvShaderPass(W.SAOMinifyFirstShader),e(d),u=new W.LmvShaderPass(W.SAOMinifyShader),e(u),h=new W.LmvShaderPass(W.FXAAShader),e(h),p=new W.LmvShaderPass(W.CelShader),e(p),f=new W.LmvShaderPass(W.BlendShader),e(f),s=new W.LmvShaderPass(W.BackgroundShader),e(s),m=new W.LmvShaderPass(W.CopyShader),e(m)}function t(e,t){var i=3*e[1],n=3*(e[3]-e[1])-i,o=1-i-n
return((o*t+n)*t+i)*t}var i,n,o,r,a,s,l,c,u,d,h,p,f,m,v,g,E,y=!1,A=null,T=null,b=null,w=null,_=null,x=null,C=0,S=0,R=1,M=!1,P=new Uint8Array(4),L=(new THREE.Color).setRGB(1,1,1),I=(new THREE.Color).setRGB(0,0,0),k=null,V=!1,N=!1,D=!1,H=!1,O=0,B=0,F=[.42,0,1,1],U=.004,z={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,idbuffer:!0,customPresentPass:!1,toonShaded:!1,envMapBg:!1},G={},W=Autodesk.Viewing.Shaders
this.settings=z,this.init=function(t,n,o){return init_FireflyPhongShader(W),init_FireflyPrismShader(W),init_BackgroundShader(W),init_BlendShader(W),init_CelShader(W),init_CopyShader(W),init_FXAAShader(W),init_LineShader(W),init_NormalsShader(W),init_SAOBlurShader(W),init_SAOMinifyShader(W),init_SAOShader(W),init_FireflyBasicShader(W),t?(V=-1!=window.navigator.userAgent.indexOf("Firefox")&&-1!=window.navigator.userAgent.indexOf("Mac OS"),N=isAndroidDevice()||isIOSDevice(),z.idbuffer=!N,g=n,E=o,i=t,e(),void this.initPostPipeline(z.sao,z.antialias,!1)):void console.error("You need a gl context to make a renderer. Things will go downhill from here.")},this.overlayUpdate=function(e){if(0===O||-1===O)return!1
var i=f.uniforms.highlightIntensity.value,n=(performance.now()-B)*U
n=Math.min(n,1)
var o=t(F,n)
return i!=o?(f.uniforms.highlightIntensity.value=o,!0):!1},this.beginScene=function(e,t,n,o){if(r=t,a=n,y=!1,!T)return void(g||M||(console.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance."),M=!0))
if(o&&(k&&!z.envMapBg?(i.setClearColor(k,1),i.clearTarget(T,!0,!0,!1)):(s.uniforms.uCamDir.value=r.getWorldDirection(),s.uniforms.uCamUp.value=r.up,s.uniforms.uResolution.value.set(g,E),i.clearTarget(T,!1,!0,!1),s.render(i,T,null))),x&&(i.setClearColor(L,1),i.clearTarget(x,!0,!1,!1)),z.sao||z.toonShaded){o&&(i.setClearColor(I,0),i.clearTarget(v,!0,!1,!1))
var l=t.near,u=t.far
c.uniforms.cameraNear.value=l,c.uniforms.cameraFar.value=u,p.uniforms.cameraNear.value=l,p.uniforms.cameraFar.value=u,d.uniforms.cameraNear.value=l,d.uniforms.cameraInvNearFar.value=1/(l-u)
var h=t.projectionMatrix.elements
t.isPerspective?(c.uniforms.projInfo.value.set(-2/(T.width*h[0]),-2/(T.height*h[5]),(1-h[8])/h[0],(1+h[9])/h[5]),p.uniforms.projInfo.value.copy(c.uniforms.projInfo.value),c.uniforms.isOrtho.value=0,p.uniforms.isOrtho.value=0):(c.uniforms.projInfo.value.set(-2/(T.width*h[0]),-2/(T.height*h[5]),(1-h[12])/h[0],(1-h[13])/h[5]),p.uniforms.projInfo.value.copy(c.uniforms.projInfo.value),c.uniforms.isOrtho.value=1,p.uniforms.isOrtho.value=1)
var f=.25
c.uniforms.projScale.value=.5*f*(T.height*h[5])}this.renderScenePart(e,!0,!0,!1,!0)},this.renderScenePart=function(e,t,s,l,c){y=!1
var u=c?a:void 0
if(D&&H)z.idbuffer&&l&&(z.sao||z.toonShaded)?i.render(e,r,[T,v,x],!1,u):z.sao||z.toonShaded?i.render(e,r,[T,v],!1,u):z.idbuffer&&l?i.render(e,r,[T,x]):i.render(e,r,T,!1,u)
else if(H){if(z.idbuffer&&l?i.render(e,r,[T,x],!1,u):i.render(e,r,T,!1,u),(z.sao||z.toonShaded)&&s){var d=e.overrideMaterial
e.overrideMaterial=n,i.render(e,r,v,!1,void 0),e.overrideMaterial=d}}else{if(t&&i.render(e,r,T,!1,u),z.idbuffer&&l&&o){var d=e.overrideMaterial
e.overrideMaterial=o,i.render(e,r,x,!1,void 0),e.overrideMaterial=d}if((z.sao||z.toonShaded)&&s){var d=e.overrideMaterial
e.overrideMaterial=n,i.render(e,r,v,!1,void 0),e.overrideMaterial=d}}},this.clearAllOverlays=function(){i.clearTarget(b,!0,!1,!1)},this.renderOverlays=function(e,t){var n=0
for(var o in e){var a=e[o],s=a.scene,l=a.camera?a.camera:r
s.children.length&&(n||(n=1,i.setClearColor(I,0),i.clearTarget(b,!0,!1,!1)),a.materialPre&&(s.overrideMaterial=a.materialPre),i.render(s,l,b,!1,t),a.materialPost&&(s.overrideMaterial=a.materialPost,i.context.depthFunc(i.context.GREATER),i.render(s,l,b,!1,t),i.context.depthFunc(i.context.LEQUAL)),s.overrideMaterial=null)}f.uniforms.useOverlay.value=n},this.computeSSAO=function(e){if(e||!z.sao||z.toonShaded)f.uniforms.useAO.value=0
else{if(!y){if(A){var t=A[0]
d.uniforms.resolution.value.set(1/t.width,1/t.height),d.render(i,t,v)
for(var n=1;n<A.length;n++){var o=A[n]
u.uniforms.resolution.value.set(1/o.width,1/o.height),u.render(i,o,t),t=o}}c.render(i,_,T),l.uniforms.axis.value.set(1,0),l.render(i,w,_),l.uniforms.axis.value.set(0,1),l.render(i,_,w),y=!0}f.uniforms.useAO.value=1}},this.presentBuffer=function(e){var t=!z.sao&&!f.uniforms.useOverlay.value&&!f.uniforms.objID.value
t?z.antialias?e?(h.render(i,w,T),e.render(i,null,w)):z.toonShaded?(p.render(i,w,T),h.render(i,null,w)):h.render(i,null,T):e?e.render(i,null,T):z.toonShaded?(p.render(i,w,T),m.render(i,null,w)):m.render(i,null,T):z.antialias?(f.render(i,w,T),e?(h.render(i,_,w),e.render(i,null,_)):z.toonShaded?(p.render(i,_,w),h.render(i,null,_)):h.render(i,null,w)):e?(f.render(i,w,T),e.render(i,null,w)):z.toonShaded?(f.render(i,w,T),p.render(i,_,w),m.render(i,null,_)):f.render(i,null,T)},this.composeFinalFrame=function(e,t,i){z.sao&&!z.toonShaded&&this.computeSSAO(e),i||this.presentBuffer()},this.cleanup=function(){if(T&&(T.dispose(),T=null),v&&(v.dispose(),v=null),b&&(b.dispose(),b=null),w&&(w.dispose(),w=null),_&&(_.dispose(),_=null),A){for(var e=0;e<A.length;e++)A[e].dispose()
A=[]}},this.setSize=function(e,t,n){g=e,E=t
var o=0|e*i.getPixelRatio(),r=0|t*i.getPixelRatio()
if(z.logicalWidth=e,z.logicalHeight=t,z.deviceWidth=o,z.deviceHeight=r,0==e&&0==t)return void this.cleanup()
i.setSize(e,t),stderr("width: "+o+" height: "+r)
var a=1/o,s=1/r
if((z.useSSAA||z.toonShaded&&i.getPixelRatio()<=1)&&(o*=2,r*=2,n=!0),(n||!T||T.width!=o||T.height!=r)&&(stderr("Reallocating render targets."),this.cleanup(),T=new THREE.WebGLRenderTarget(o,r,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,type:z.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:!1}),b=new THREE.WebGLRenderTarget(o,r,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,stencilBuffer:!1,generateMipmaps:!1}),b.shareDepthFrom=T,v=null,w=null,_=null,A=[]),(z.antialias||z.sao||z.customPresentPass||z.toonShaded)&&(n||!w||w.width!=o||w.height!=r)&&(w=new THREE.WebGLRenderTarget(o,r,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1})),z.sao||z.toonShaded){if(n||!v||v.width!=o||v.height!=r){var u=THREE.FloatType
isMobileDevice()&&(u=THREE.HalfFloatType),v=new THREE.WebGLRenderTarget(o,r,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:u,stencilBuffer:!1}),v.shareDepthFrom=T,A=[]
for(var d=0;5>d;d++){var m=new THREE.WebGLRenderTarget(0|o/(2<<d),0|r/(2<<d),{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1})
m.generateMipmaps=!1,A.push(m),c.uniforms["tDepth_mip"+(d+1)].value=m}D=!V&&i.verifyMRTWorks([T,v]),_=w.clone()}!_&&z.antialias&&z.customPresentPass&&(_=w.clone()),c.uniforms.size.value.set(o,r),c.uniforms.resolution.value.set(a,s),c.uniforms.tDepth.value=v,l.uniforms.size.value.set(o,r),l.uniforms.resolution.value.set(a,s),p.uniforms.tDepth.value=v}z.idbuffer?((n||!x||x.width!=o||x.height!=r)&&(x=new THREE.WebGLRenderTarget(o,r,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:!1}),x.shareDepthFrom=T,H=!V&&i.verifyMRTWorks([T,x]),H||console.warn("ID buffer requested, but MRT is not supported. Some features will not work.")),p.uniforms.tID.value=x):x&&(x.dispose(),x=null),h.uniforms.uResolution.value.set(a,s),p.uniforms.resolution.value.set(a,s),f.uniforms.tOverlay.value=b,f.uniforms.tAO.value=_,f.uniforms.useAO.value=z.sao?1:0,f.uniforms.resolution.value.set(a,s),f.uniforms.tID.value=x},this.getMaxAnisotropy=function(){return i.getMaxAnisotropy()},this.hasMRT=function(){return!V&&i.supportsMRT()},this.applyMRTFlags=function(e){var t=e.mrtNormals,i=e.mrtIdBuffer
e.mrtNormals=this.hasMRT()&&D&&(z.sao||z.toonShaded),e.mrtIdBuffer=this.hasMRT()&&H&&z.idbuffer,(e.mrtNormals!==t||e.mrtIdBuffer!==i)&&(e.needsUpdate=!0)},this.initPostPipeline=function(e,t){z.sao=e&&!_isIE11,z.antialias=t&&!_isIE11,z.sao&&(z.toonShaded=!1),z.haveTwoSided&&(n.side=THREE.DoubleSide),n.needsUpdate=!0,c.material.needsUpdate=!0,l.material.needsUpdate=!0,d.material.needsUpdate=!0,u.material.needsUpdate=!0,h.material.needsUpdate=!0,p.material.needsUpdate=!0,f.material.needsUpdate=!0,s.material.needsUpdate=!0,m.material.needsUpdate=!0,this.setSize(g,E)},this.setClearColors=function(e,t){k=t?e.equals(t)||N?new THREE.Color(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)):void 0:e.clone(),k||(s.uniforms.color1.value.copy(e),s.uniforms.color2.value.copy(t))},this.setAOOptions=function(e,t){void 0!==e&&(c.uniforms.radius.value=e),void 0!==t&&(c.uniforms.intensity.value=t),y=!1},this.getAORadius=function(){return c.uniforms.radius.value},this.getAOIntensity=function(){return c.uniforms.intensity.value},this.setCubeMap=function(e){s.material.envMap=e},this.setEnvRotation=function(e){s.material.envRotationSin=Math.sin(e),s.material.envRotationCos=Math.cos(e)},this.setTonemapExposureBias=function(e){C=e},this.getExposureBias=function(){return C},this.setTonemapMethod=function(e){S=e,0===e?i.gammaInput=!1:i.gammaInput=!0},this.getToneMapMethod=function(){return S},this.toggleTwoSided=function(e){z.haveTwoSided!=e&&n&&(n.side=e?THREE.DoubleSide:THREE.FrontSide,n.needsUpdate=!0),z.haveTwoSided=e},this.toggleCelShading=function(e){z.sao=!e,z.toonShaded=e,z.idbuffer=e,this.initPostPipeline(z.sao,z.antialias)},this.toggleEnvMapBackground=function(e){z.envMapBg=e,s.uniforms.envMapBackground.value=e},this.enter2DMode=function(e){o=e,G.sao=z.sao,G.antialias=z.antialias,G.idbuffer=z.idbuffer,z.idbuffer=!0,f.material.defines.IS_2D="",this.initPostPipeline(!1,!1)},this.exit2DMode=function(){o=null,z.idbuffer=G.idbuffer,delete f.material.defines.IS_2D,this.initPostPipeline(G.sao,G.antialias)},this.idAtPixel=function(e,t){if(!x)return 0
var n=.5*(e+1)*x.width,o=.5*(t+1)*x.height
i.readRenderTargetPixels(x,n,o,1,1,P)
var r=P[2]<<16|P[1]<<8|P[0]
return r=r<<8>>8},this.idAtPixels=function(e,t,n){if(!x)return 0
var o=.5*(e+1)*x.width-.5*(n-1),r=.5*(t+1)*x.height-.5*(n-1),a=new Uint8Array(4*n*n)
i.readRenderTargetPixels(x,o,r,n,n,a)
for(var s,l=0;n*n>l&&(s=a[4*l+2]<<16|a[4*l+1]<<8|a[4*l],s=s<<8>>8,!(s>=0));l++);return s},this.rolloverObjectViewport=function(e,t){var i=this.idAtPixel(e,t)
return i==O?!1:(f.uniforms.highlightIntensity.value=0,B=performance.now(),O=i,0>=i&&(i=0,P[0]=P[1]=P[2]=P[3]=0),f.uniforms.objID.value=i,f.uniforms.objIDv3.value.set(P[0]/255,P[1]/255,P[2]/255),!0)},this.setUnitScale=function(e){R=e},this.getUnitScale=function(){return R},this.getBlendPass=function(){return f},this.getColorTarget=function(){return T},this.getDepthMaterial=function(){return n}}function init_FXAAShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.FXAAShader&&(e.FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},uResolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 uResolution;","varying vec2 vPos;","varying vec4 vPosPos;","void main() {","vPos = uv;","vPosPos.xy = uv + vec2(-0.5, -0.5) * uResolution;","vPosPos.zw = uv + vec2( 0.5,  0.5) * uResolution;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define FXAA_EDGE_SHARPNESS (8.0)","#define FXAA_EDGE_THRESHOLD (0.125)","#define FXAA_EDGE_THRESHOLD_MIN (0.05)","#define FXAA_RCP_FRAME_OPT (0.50)","#define FXAA_RCP_FRAME_OPT2 (2.0)","uniform sampler2D tDiffuse;","uniform highp vec2 uResolution;","varying vec2 vPos;","varying vec4 vPosPos;","float FxaaLuma(vec3 rgb) {","return dot(rgb, vec3(0.299, 0.587, 0.114));","}","void main() {","float lumaNw = FxaaLuma(texture2D(tDiffuse, vPosPos.xy).rgb);","float lumaSw = FxaaLuma(texture2D(tDiffuse, vPosPos.xw).rgb);","float lumaNe = FxaaLuma(texture2D(tDiffuse, vPosPos.zy).rgb) + 1.0/384.0;","float lumaSe = FxaaLuma(texture2D(tDiffuse, vPosPos.zw).rgb);","vec3 rgbM = texture2D(tDiffuse, vPos.xy).rgb;","float lumaM = FxaaLuma(rgbM.rgb);","float lumaMax = max(max(lumaNe, lumaSe), max(lumaNw, lumaSw));","float lumaMin = min(min(lumaNe, lumaSe), min(lumaNw, lumaSw));","float lumaMaxSubMinM = max(lumaMax, lumaM) - min(lumaMin, lumaM);","float lumaMaxScaledClamped = max(FXAA_EDGE_THRESHOLD_MIN, lumaMax * FXAA_EDGE_THRESHOLD);","if (lumaMaxSubMinM < lumaMaxScaledClamped) {","gl_FragColor = vec4(rgbM, 1.0);","return;","}","float dirSwMinusNe = lumaSw - lumaNe;","float dirSeMinusNw = lumaSe - lumaNw;","vec2 dir1 = normalize(vec2(dirSwMinusNe + dirSeMinusNw, dirSwMinusNe - dirSeMinusNw));","vec3 rgbN1 = texture2D(tDiffuse, vPos.xy - dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;","vec3 rgbP1 = texture2D(tDiffuse, vPos.xy + dir1 * FXAA_RCP_FRAME_OPT*uResolution).rgb;","float dirAbsMinTimesC = min(abs(dir1.x), abs(dir1.y)) * FXAA_EDGE_SHARPNESS;","vec2 dir2 = clamp(dir1.xy / dirAbsMinTimesC, -2.0, 2.0);","vec3 rgbN2 = texture2D(tDiffuse, vPos.xy - dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;","vec3 rgbP2 = texture2D(tDiffuse, vPos.xy + dir2 * FXAA_RCP_FRAME_OPT2*uResolution).rgb;","vec3 rgbA = rgbN1 + rgbP1;","vec3 rgbB = ((rgbN2 + rgbP2) * 0.25) + (rgbA * 0.25);","float lumaB = FxaaLuma(rgbB);","if ((lumaB < lumaMin) || (lumaB > lumaMax))","gl_FragColor = vec4(rgbA * 0.5, 1.0);","else","gl_FragColor = vec4(rgbB, 1.0);","}"].join("\n")})}function init_CopyShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.CopyShader&&(e.CopyShader={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(tDiffuse, vUv);","}"].join("\n")})}function init_CelShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.CelShader&&(e.CelShader={uniforms:{tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},tID:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},isOrtho:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#extension GL_OES_standard_derivatives : enable","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform sampler2D tID;","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform float isOrtho;","uniform vec4 projInfo;","varying vec2 vUv;","vec4 recoverNZ(vec4 nrmz) {","float z = sqrt(1.0 - dot(nrmz.xy, nrmz.xy));","nrmz.w = -(nrmz.z +cameraNear) / (cameraFar - cameraNear);","nrmz.z = z;","return nrmz;","}",TonemapShaderChunk,"vec4 quantize(vec4 c) {","c *= c;","float L = max(c.x, max(c.y, c.z));","c.xyz *= floor(L * 8.0 + 0.5) / (8.0 * L);","c.w = 1.0;","return sqrt(c);","}","vec4 quantizeRGB(vec4 c) {","c *= c;","c.xyz *= floor(c.xyz * 8.0 + 0.5) / 8.0;","c.w = 1.0;","return sqrt(c);","}","vec3 reconstructCSPosition(vec2 S, float z) {","return vec3((S.xy * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);","}","vec3 reconstructCSFaceNormal(vec3 C) {","return normalize(cross(dFdy(C), dFdx(C)));","}","vec3 getPosition(ivec2 ssP, float depth) {","vec3 P;","P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);","return P;","}","int isObjectEdge() {","vec4 MM = texture2D(tID, vUv + vec2( 0.0,  0.0));","vec4 LL = texture2D(tID, vUv + vec2(-1.0, -1.0) * resolution);","if (MM != LL) return 1;","vec4 LM = texture2D(tID, vUv + vec2( 0.0, -1.0) * resolution);","if (MM != LM) return 1;","vec4 LR = texture2D(tID, vUv + vec2( 1.0, -1.0) * resolution);","if (MM != LR) return 1;","vec4 ML = texture2D(tID, vUv + vec2(-1.0,  0.0) * resolution);","if (MM != ML) return 1;","vec4 MR = texture2D(tID, vUv + vec2( 1.0,  0.0) * resolution);","if (MM != MR) return 1;","vec4 UL = texture2D(tID, vUv + vec2(-1.0,  1.0) * resolution);","if (MM != UL) return 1;","vec4 UM = texture2D(tID, vUv + vec2( 0.0,  1.0) * resolution);","if (MM != UM) return 1;","vec4 UR = texture2D(tID, vUv + vec2( 1.0,  1.0) * resolution);","if (MM != UR) return 1;","return 0;","}","float normalDiff(vec3 n1, vec3 n2) {","float d = dot(n1.xyz, n2.xyz);","return acos(clamp(d, -1.0, 1.0));","}","const float r = 1.0;","void main() {","vec4 color = texture2D(tDiffuse, vUv);","ivec2 ssC = ivec2(gl_FragCoord.xy);","if (isObjectEdge() == 1) {","gl_FragColor = vec4(0,0,0,1);","return;","}","vec4 MM = texture2D(tDepth, vUv + vec2( 0.0,  0.0));","if (MM.z == 0.0) {","gl_FragColor = quantize(color);","return;","}","vec4 LL = texture2D(tDepth, vUv + vec2(-r, -r) * resolution);","vec4 LM = texture2D(tDepth, vUv + vec2( 0.0, -r) * resolution);","vec4 LR = texture2D(tDepth, vUv + vec2( r, -r) * resolution);","vec4 ML = texture2D(tDepth, vUv + vec2(-r,  0.0) * resolution);","vec4 MR = texture2D(tDepth, vUv + vec2( r,  0.0) * resolution);","vec4 UL = texture2D(tDepth, vUv + vec2(-r, r) * resolution);","vec4 UM = texture2D(tDepth, vUv + vec2( 0.0,  r) * resolution);","vec4 UR = texture2D(tDepth, vUv + vec2( r,  r) * resolution);","vec3 C = getPosition(ssC + ivec2(-1, -1), LL.z);","vec3 LLz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2( 0, -1), LM.z);","vec3 LMz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2( 1, -1), LR.z);","vec3 LRz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2(-1, 0), ML.z);","vec3 MLz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2( 0, 0), MM.z);","vec3 MMz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2( 1, 0), MR.z);","vec3 MRz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2(-1, 1), UL.z);","vec3 ULz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2(0, 1), UM.z);","vec3 UMz = reconstructCSFaceNormal(C);","C = getPosition(ssC + ivec2(1, 1), UR.z);","vec3 URz = reconstructCSFaceNormal(C);","LL = recoverNZ(LL);","LM = recoverNZ(LM);","LR = recoverNZ(LR);","ML = recoverNZ(ML);","MM = recoverNZ(MM);","MR = recoverNZ(MR);","UL = recoverNZ(UL);","UM = recoverNZ(UM);","UR = recoverNZ(UR);","float pLL = normalDiff(LL.xyz, MM.xyz);","float pLM = normalDiff(LM.xyz, MM.xyz);","float pLR = normalDiff(LR.xyz, MM.xyz);","float pML = normalDiff(ML.xyz, MM.xyz);","float pMM = normalDiff(MM.xyz, MM.xyz);","float pMR = normalDiff(MR.xyz, MM.xyz);","float pUL = normalDiff(UL.xyz, MM.xyz);","float pUM = normalDiff(UM.xyz, MM.xyz);","float pUR = normalDiff(UR.xyz, MM.xyz);","float pLLz = normalDiff(LLz.xyz, MMz.xyz);","float pLMz = normalDiff(LMz.xyz, MMz.xyz);","float pLRz = normalDiff(LRz.xyz, MMz.xyz);","float pMLz = normalDiff(MLz.xyz, MMz.xyz);","float pMMz = normalDiff(MMz.xyz, MMz.xyz);","float pMRz = normalDiff(MRz.xyz, MMz.xyz);","float pULz = normalDiff(ULz.xyz, MMz.xyz);","float pUMz = normalDiff(UMz.xyz, MMz.xyz);","float pURz = normalDiff(URz.xyz, MMz.xyz);","float dGx = (dFdx(UL.w) + 2.0 * dFdx(UM.w) + dFdx(UR.w)) - (dFdx(LL.w) + 2.0 * dFdx(LM.w) + dFdx(LR.w)) + (dFdx(UR.w) + 2.0 * dFdx(MR.w) - dFdx(LR.w)) - (dFdx(UL.w) + 2.0 * dFdx(ML.w) - dFdx(LL.w));","float dGy = (dFdy(UL.w) + 2.0 * dFdy(UM.w) + dFdy(UR.w)) - (dFdy(LL.w) + 2.0 * dFdy(LM.w) + dFdy(LR.w)) + (dFdy(UR.w) + 2.0 * dFdy(MR.w) - dFdy(LR.w)) - (dFdy(UL.w) + 2.0 * dFdy(ML.w) - dFdy(LL.w));","float Gn = (abs(pUL - pMM) + 2.0 * abs(pUM - pMM) + abs(pUR - pMM) + 2.0 * abs(pML - pMM) + 2.0 * abs(pMR - pMM) + abs(pLL - pMM) + 2.0 * abs(pLM - pMM) + abs(pLR - pMM));","float Gnz = (abs(pULz - pMMz) + 2.0 * abs(pUMz - pMMz) + abs(pURz - pMMz) + 2.0 * abs(pMLz - pMMz) + 2.0 * abs(pMRz - pMMz) + abs(pLLz - pMMz) + 2.0 * abs(pLMz - pMMz) + abs(pLRz - pMMz));","float G = (abs(UL.w - MM.w) + 2.0 * abs(UM.w - MM.w) + abs(UR.w - MM.w) + 2.0 * abs(ML.w - MM.w) + 2.0 * abs(MR.w - MM.w) + abs(LL.w - MM.w) + 2.0 * abs(LM.w - MM.w) + abs(LR.w - MM.w));","float dd = abs(dFdx(G)) + abs(dFdy(G));","if (dd > 0.004 || abs(Gnz) > 2.2 || abs(Gn) > 2.0)","gl_FragColor = vec4(0.0,0.0,0.0,1.0);","else","gl_FragColor = /*vec4(1.0,1.0,1.0,1.0);*/quantize(color);","}"].join("\n")})}function init_BlendShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.BlendShader&&(e.BlendShader={uniforms:{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},tID:{type:"t",value:null},objID:{type:"i",value:0},objIDv3:{type:"v3",value:new THREE.Vector3(0,0,0)},highlightIntensity:{type:"f",value:1},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},defines:{},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tAO;","uniform int useAO;","uniform sampler2D tOverlay;","uniform int useOverlay;","uniform vec2 resolution;","uniform int objID;","uniform vec3 objIDv3;","uniform sampler2D tID;","uniform float highlightIntensity;","varying vec2 vUv;",TonemapShaderChunk,"vec4 overlayEdgeDetect(vec2 vUv) {","#define IS_SELECTION(C) ( (C).b > (C).r && (C).b > (C).g )","#define CHECK_EDGE_ALPHA(I, J)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); maxAlpha = max(maxAlpha, c.a); if (c.a > 0.0 && IS_SELECTION(c)) { hasEdge++; selectionPixel = c; } }","#define CHECK_EDGE_SELECTION(I, J) { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); maxAlpha = max(maxAlpha, c.a); if (c.a <= 0.0) hasEdge++; }","int hasEdge = 0;","vec4 center = texture2D(tOverlay, vUv);","vec4 selectionPixel = vec4(0.0);","float maxAlpha = 0.0;","bool paintOutline = false;","if (center.a <= 0.0) {","CHECK_EDGE_ALPHA(-1.0,-1.0);","CHECK_EDGE_ALPHA( 0.0,-1.0);","CHECK_EDGE_ALPHA( 1.0,-1.0);","CHECK_EDGE_ALPHA(-1.0, 0.0);","CHECK_EDGE_ALPHA( 1.0, 0.0);","CHECK_EDGE_ALPHA(-1.0, 1.0);","CHECK_EDGE_ALPHA( 0.0, 1.0);","CHECK_EDGE_ALPHA( 1.0, 1.0);","if (hasEdge != 0) {","center = selectionPixel;","paintOutline = true;","}","}","else if (center.a > 0.0 && IS_SELECTION(center)) {","CHECK_EDGE_SELECTION(-1.0,-1.0);","CHECK_EDGE_SELECTION( 0.0,-1.0);","CHECK_EDGE_SELECTION( 1.0,-1.0);","CHECK_EDGE_SELECTION(-1.0, 0.0);","CHECK_EDGE_SELECTION( 1.0, 0.0);","CHECK_EDGE_SELECTION(-1.0, 1.0);","CHECK_EDGE_SELECTION( 0.0, 1.0);","CHECK_EDGE_SELECTION( 1.0, 1.0);","if (hasEdge != 0)","paintOutline = true;","else","center.a = -center.a;","}","if (paintOutline) {","float maxComponent = max(center.r, max(center.g, center.b));","center.rgb /= maxComponent;","center.rgb = sqrt(center.rgb);","center.a = 0.5 + 0.5 * maxAlpha * 0.125 * float(hasEdge);","}","return center;","}","vec4 sampleColor() {","return texture2D( tDiffuse, vUv );","}","float sampleAO() {","return (useAO != 0) ? texture2D(tAO, vUv).r : 1.0;","}","void main() {","vec4 texel = sampleColor();","texel.rgb *= sampleAO();","if (useOverlay != 0) {","vec4 overlay = overlayEdgeDetect(vUv);","if (overlay.a < 0.0) {","overlay.a = -overlay.a;","if (overlay.a >= 0.99) {","overlay.a = 0.75;","texel.rgb = vec3(luminance_post(texel.rgb));","}","}","texel.rgb = mix(texel.rgb, sqrt(overlay.rgb)/*sqrt=gamma*/, overlay.a);","}","if (objID != 0) {","vec4 idAtPixel = texture2D(tID, vUv);","vec3 idDelta = abs(idAtPixel.rgb - objIDv3.rgb);","if (max(max(idDelta.r, idDelta.g), idDelta.b) < 1e-3) {","#ifdef IS_2D","texel.rgb = mix(texel.rgb, vec3(1.0,1.0,0.0), highlightIntensity * 0.25);","#else","texel.rgb += highlightIntensity * 0.2;","#endif","}","}","gl_FragColor = texel;","}"].join("\n")})}function init_SAOShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.SAOShader&&(e.SAOShader={uniforms:{tDepth:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:10},bias:{type:"f",value:.01},projScale:{type:"f",value:500},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},intensity:{type:"f",value:.5},isOrtho:{type:"f",value:1},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define USE_MIPMAP 1","uniform float cameraNear;","uniform float cameraFar;","uniform vec2 size;","uniform vec2 resolution;","uniform float lumInfluence;","varying vec2 vUv;","#define NUM_SAMPLES (17)","#define LOG_MAX_OFFSET (3)","#define MAX_MIP_LEVEL (5)","#define NUM_SPIRAL_TURNS (7)","uniform float           projScale;","uniform sampler2D tDepth;","#ifdef USE_MIPMAP","uniform sampler2D tDepth_mip1;","uniform sampler2D tDepth_mip2;","uniform sampler2D tDepth_mip3;","uniform sampler2D tDepth_mip4;","uniform sampler2D tDepth_mip5;","#endif","uniform float radius;","uniform float bias;","uniform float intensity;","uniform float isOrtho;","vec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){","float alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));","float angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;","ssR = alpha;","return vec2(cos(angle), sin(angle));","}","float CSZToKey(float z) {","return clamp(z * (1.0 / -cameraFar), 0.0, 1.0);","}","void packKey(float key, out vec2 p) {","float temp = floor(key * 256.0);","p.x = temp * (1.0 / 256.0);","p.y = key * 256.0 - temp;","}",PackDepthShaderChunk,"float unpackDepthNearFar( const in vec4 rgba_depth ) {","float depth = unpackDepth( rgba_depth );","if (depth == 0.0)","return -cameraFar * 1.0e10;","return depth * (cameraNear - cameraFar) - cameraNear;","}","uniform vec4 projInfo;","vec3 reconstructCSPosition(vec2 S, float z) {","return vec3((S.xy * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);","}","vec3 reconstructCSFaceNormal(vec3 C) {","return normalize(cross(dFdy(C), dFdx(C)));","}","vec3 reconstructNonUnitCSFaceNormal(vec3 C) {","return cross(dFdy(C), dFdx(C));","}","vec3 getPosition(ivec2 ssP, float depth) {","vec3 P;","P = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);","return P;","}","vec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {","ivec2 ssP = ivec2(ssR * unitOffset) + ssC;","vec3 P;","vec2 screenUV = (vec2(ssP) + vec2(0.5)) * resolution;","#ifdef USE_MIPMAP","int mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));","if (mipLevel == 0) {","P.z = texture2D(tDepth, screenUV).z;","if (P.z == 0.0) P.z = -cameraFar * 1.0e10;","}","else if (mipLevel == 1)","P.z = unpackDepthNearFar(texture2D(tDepth_mip1, screenUV));","else if (mipLevel == 2)","P.z = unpackDepthNearFar(texture2D(tDepth_mip2, screenUV));","else if (mipLevel == 3)","P.z = unpackDepthNearFar(texture2D(tDepth_mip3, screenUV));","else if (mipLevel == 4)","P.z = unpackDepthNearFar(texture2D(tDepth_mip4, screenUV));","else if (mipLevel == 5)","P.z = unpackDepthNearFar(texture2D(tDepth_mip5, screenUV));","#else","P.z = texture2D(tDepth, screenUV).z;","if (P.z == 0.0) P.z = -cameraFar * 1.0e10;","#endif","P = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);","return P;","}","float sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {","float ssR;","vec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);","ssR *= ssDiskRadius;","vec3 Q = getOffsetPosition(ssC, unitOffset, ssR);","vec3 v = Q - C;","float vv = dot(v, v);","float vn = dot(v, n_C);","const float epsilon = 0.01;","float f = max(radius * radius - vv, 0.0); return f * f * f * max((vn - bias) / (epsilon + vv), 0.0);","}","const bool useNoise = true;","vec2 rand( const vec2 coord ) {","vec2 noise;","if ( useNoise ) {","float nx = dot ( coord, vec2( 12.9898, 78.233 ) );","float ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );","noise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );","} else {","float ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );","float gg = fract( coord.t * ( size.y / 2.0 ) );","noise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;","}","return ( noise * 2.0  - 1.0 );","}","float getRandomAngle(vec2 pos) {","vec2 rnd = rand(pos);","return atan(rnd.y, rnd.x);","}","void main() {","ivec2 ssC = ivec2(gl_FragCoord.xy);","vec4 nrmz = texture2D(tDepth, vUv);","if (nrmz.z == 0.0) {","gl_FragColor.r = 1.0;","gl_FragColor.a = 0.0;","packKey(1.0, gl_FragColor.gb);","return;","}","vec3 C = getPosition(ssC, nrmz.z);","packKey(CSZToKey(C.z), gl_FragColor.gb);","float randomPatternRotationAngle = getRandomAngle(vUv);","vec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));","float ssDiskRadius = -projScale * radius / mix(C.z, -1.0, isOrtho);","float sum = 0.0;","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 0, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 1, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 2, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 3, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 4, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 5, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 6, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 7, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 8, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 9, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 10, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 11, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 12, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 13, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 14, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 15, randomPatternRotationAngle);","sum += sampleAO(ssC, C, n_C, ssDiskRadius, 16, randomPatternRotationAngle);","float intensityDivR6 = intensity / pow(radius, 6.0);","float A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));","if (abs(dFdx(C.z)) < 0.02) {","A -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);","}","if (abs(dFdy(C.z)) < 0.02) {","A -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);","}","gl_FragColor.r = A;","gl_FragColor.a = 1.0;","}"].join("\n")})}function init_SAOBlurShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.SAOBlurShader&&(e.SAOBlurShader={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)},axis:{type:"v2",value:new THREE.Vector2(1,0)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define EDGE_SHARPNESS     (1.0)","#define SCALE               (2)","#define R                   (4)","#define VALUE_TYPE        float","#define VALUE_COMPONENTS   r","#define VALUE_IS_KEY       0","#define KEY_COMPONENTS     gb","#if __VERSION__ >= 330","const float gaussian[R + 1] =","float[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);  // stddev = 2.0","#endif","uniform sampler2D   tDiffuse;","uniform vec2 size;","uniform vec2 resolution;","uniform vec2       axis;","#define  result         gl_FragColor.VALUE_COMPONENTS","#define  keyPassThrough gl_FragColor.KEY_COMPONENTS","float unpackKey(vec2 p) {","return p.x * (256.0 / 257.0) + p.y * (1.0 / 257.0);","}","varying vec2 vUv;","void main() {","#   if __VERSION__ < 330","float gaussian[R + 1];","#       if R == 3","gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;  // stddev = 2.0","#       elif R == 4","gaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;  // stddev = 2.0","#       elif R == 6","gaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;","#       endif","#   endif","ivec2 axisi = ivec2(axis);","ivec2 ssC = ivec2(gl_FragCoord.xy);","vec4 temp = texture2D(tDiffuse, vUv);","gl_FragColor.gb = temp.KEY_COMPONENTS;","gl_FragColor.a = temp.a;","VALUE_TYPE sum = temp.VALUE_COMPONENTS;","if (temp.a == 0.0) {","result = sum;","return;","}","float key = unpackKey(keyPassThrough);","float BASE = gaussian[0];","float totalWeight = BASE;","sum *= totalWeight;","int r = -4; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[4];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r = -3; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[3];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r = -2; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[2];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r=-1; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[1];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r = 1; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[1];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r = 2; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[2];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r = 3; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[3];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","r = 4; {","vec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;","temp = texture2D(tDiffuse, ssUV);","float      tapKey = unpackKey(temp.KEY_COMPONENTS);","VALUE_TYPE value  = temp.VALUE_COMPONENTS;","float weight = 0.3 + gaussian[4];","float dz = tapKey - key;","weight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));","sum += value * weight;","totalWeight += weight;","}","const float epsilon = 0.0001;","result = sum / (totalWeight + epsilon);","}"].join("\n")})}function init_SAOMinifyShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.SAOMinifyFirstShader&&(e.SAOMinifyFirstShader={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraInvNearFar;",PackDepthShaderChunk,"void main() {","vec2 ssP = vec2(gl_FragCoord.xy);","ssP = ssP * 2.0 + mod(ssP, 2.0);","ssP = (ssP + 0.5) * resolution * 0.5;","float depth = texture2D(tDiffuse, ssP).z;","if (depth != 0.0)","depth = (depth + cameraNear) * cameraInvNearFar;","gl_FragColor = packDepth(depth);","}"].join("\n")},e.SAOMinifyShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","void main() {","vec2 ssP = vec2(gl_FragCoord.xy);","ssP = ssP * 2.0 + mod(ssP, 2.0);","ssP = (ssP + 0.5) * resolution * 0.5;","gl_FragColor = texture2D(tDiffuse, ssP);","}"].join("\n")})}function init_FireflyPhongShader(){var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.FireflyPhongShader&&(e.FireflyPhongShader={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.lights,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},reflMipIndex:{type:"f",value:0},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)},texMatrix:{type:"m3",value:new THREE.Matrix3},texMatrixBump:{type:"m3",value:new THREE.Matrix3},texMatrixAlpha:{type:"m3",value:new THREE.Matrix3},irradianceMap:{type:"t",value:null},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1},cutplanes:{type:"v4v",value:[]},cutplanesOutlineColor:{type:"v3",value:new THREE.Vector3(0,1,0)},hatchParams:{type:"v2",value:new THREE.Vector2(1,10)},cutplanesOutlineThickness:{type:"f",value:.001},hatchTintColor:{type:"c",value:new THREE.Color(16777215)},hatchTintIntensity:{type:"f",value:1},dbId:{type:"v4",value:new THREE.Vector4(0,0,0,0)}}]),vertexShader:["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","varying vec3 vNormal;","#endif","#if defined( USE_MAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform mat3 texMatrix;","#endif","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","varying vec2 vUvBump;","uniform mat3 texMatrixBump;","#endif","#if defined( USE_ALPHAMAP )","varying vec2 vUvAlpha;","uniform mat3 texMatrixAlpha;","#endif","#if defined( USE_ENVMAP )","#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","uniform float refractionRatio;","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif","#ifdef USE_COLOR","varying vec3 vColor;","#endif","#ifdef USE_LOGDEPTHBUF","#ifdef USE_LOGDEPTHBUF_EXT","varying float vFragDepth;","#endif","uniform float logDepthBufFC;","#endif","#ifdef MRT_NORMALS","varying float depth;","#endif",PackNormalsShaderChunk,"void main() {","#if defined( USE_MAP ) || defined( USE_SPECULARMAP )","vUv = (texMatrix * vec3(uv, 1.0)).xy;","#endif","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vUvBump = (texMatrixBump * vec3(uv, 1.0)).xy;","#endif","#if defined( USE_ALPHAMAP )","vUvAlpha = (texMatrixAlpha * vec3(uv, 1.0)).xy;","#endif","#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif","#ifdef UNPACK_NORMALS","vec3 objectNormal = decodeNormal(normal);","#else","vec3 objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;","#ifndef FLAT_SHADED","vNormal = normalize( transformedNormal );","#endif","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vViewPosition = -mvPosition.xyz;","#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","#endif","#ifdef USE_LOGDEPTHBUF","if (projectionMatrix[3][3] == 0.0) {","gl_Position.z = log2(max(1.0e-6, gl_Position.w + 1.0)) * logDepthBufFC;","#ifdef USE_LOGDEPTHBUF_EXT","vFragDepth = 1.0 + gl_Position.w;","#else","gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;","#endif","} else {","#ifdef USE_LOGDEPTHBUF_EXT","vFragDepth = 1.0 + vViewPosition.z;","#else","#endif","}","#endif","#ifdef MRT_NORMALS","depth = mvPosition.z;","#endif","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",EnvSamplingShaderChunk,"#ifdef USE_COLOR","varying vec3 vColor;","#endif","#ifdef GAMMA_INPUT","vec3 InputToLinear(vec3 c) {","return c * c;","}","float InputToLinear(float c) {","return c * c;","}","#else","vec3 InputToLinear(vec3 c) {","return c;","}","float InputToLinear(float c) {","return c;","}","#endif","#if defined( USE_MAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","varying vec2 vUvBump;","#endif","#if defined( USE_ALPHAMAP )","varying vec2 vUvAlpha;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif","#if TONEMAP_OUTPUT > 0","uniform float exposureBias;",TonemapShaderChunk,"#endif","#if defined(IRR_RGBM) || defined(ENV_RGBM) || defined(ENV_GAMMA) || defined(IRR_GAMMA)","uniform float envMapExposure;","#endif","#if defined(MRT_ID_BUFFER) || defined(ID_COLOR)","uniform vec4 dbId;","#endif","vec3 RGBMDecode(in vec4 vRGBM, in float exposure) {","vec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);","ret *= ret;","ret *= exposure;","return ret;","}","vec3 GammaDecode(in vec4 vRGBA, in float exposure) {","return vRGBA.xyz * vRGBA.xyz * exposure;","}","#ifdef USE_ENVMAP","uniform float reflMipIndex;","uniform float reflectivity;","uniform samplerCube envMap;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform float refractionRatio;","#endif","vec3 sampleReflection(vec3 dir, float mipIndex) {","vec3 adjDir = adjustLookupVector(dir);","#ifdef ENV_GAMMA","#ifdef HAVE_TEXTURE_LOD","vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );","#else","vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );","#endif","return GammaDecode(envTexColor, envMapExposure);","#elif defined(ENV_RGBM)","#ifdef HAVE_TEXTURE_LOD","vec4 envTexColor = textureCubeLodEXT( envMap, adjDir, mipIndex );","#else","vec4 envTexColor = textureCube( envMap, adjDir, mipIndex );","#endif","return RGBMDecode(envTexColor, envMapExposure);","#else","vec4 envTexColor = textureCube( envMap, adjDir );","vec3 cubeColor = envTexColor.xyz;","#ifdef GAMMA_INPUT","cubeColor *= cubeColor;","#endif","return cubeColor;","#endif","}","#endif","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef USE_IRRADIANCEMAP","uniform samplerCube irradianceMap;","#endif","#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0","varying highp vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying highp vec3 vViewPosition;","#ifndef FLAT_SHADED","varying highp vec3 vNormal;","#endif","#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUvBump );","vec2 dSTdy = dFdy( vUvBump );","float Hll = bumpScale * GET_BUMPMAP(vUvBump).x;","float dBx = bumpScale * GET_BUMPMAP(vUvBump + dSTdx).x - Hll;","float dBy = bumpScale * GET_BUMPMAP(vUvBump + dSTdy).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif","#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUvBump.st );","vec2 st1 = dFdy( vUvBump.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = GET_NORMALMAP(vUvBump).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif","#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif","#ifdef USE_ALPHAMAP","uniform sampler2D alphaMap;","#endif",HatchPatternShaderChunk,"#if defined(MRT_NORMALS) || defined(MRT_ID_BUFFER)","varying highp float depth;","#define gl_FragColor gl_FragData[0]","#endif","#ifdef USE_LOGDEPTHBUF","uniform float logDepthBufFC;","#ifdef USE_LOGDEPTHBUF_EXT","#extension GL_EXT_frag_depth : enable","varying highp float vFragDepth;","#endif","#endif","vec3 Schlick_v3(vec3 v, float cosHV) {","float facing = max(1.0 - cosHV, 0.0);","float facing2 = facing * facing;","return v + (1.0 - v) * facing * facing2 * facing2;","}","float Schlick_f(float v, float cosHV) {","float facing = max(1.0 - cosHV, 0.0);","float facing2 = facing * facing;","return v + ( 1.0 - v ) * facing2 * facing2 * facing;","}",CutPlanesShaderChunk,"void main() {","#if NUM_CUTPLANES > 0","if (checkCutPlanes(vWorldPosition)) return;","#endif","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );","#ifdef USE_MAP","vec4 texelColor = GET_MAP(vUv);","#ifdef MAP_INVERT","texelColor.xyz = 1.0-texelColor.xyz;","#endif","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif","#ifdef USE_ALPHAMAP","vec4 texelAlpha = GET_ALPHAMAP(vUvAlpha);","gl_FragColor.a *= texelAlpha.r;","#endif","#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif","float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = GET_SPECULARMAP(vUv);","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif","#ifndef FLAT_SHADED","vec3 normal = normalize( vNormal );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#else","vec3 fdx = dFdx( vViewPosition );","vec3 fdy = dFdy( vViewPosition );","vec3 normal = normalize( cross( fdx, fdy ) );","#endif","vec3 geomNormal = normal;","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","vec3 viewDirection;","if (projectionMatrix[3][3] == 0.0) {","viewDirection = normalize( vViewPosition );","} else {","viewDirection = vec3(0.0, 0.0, 1.0);","}","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","float shininessB = shininess * 4.0;","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += InputToLinear(diffuse) * InputToLinear(pointLightColor[ i ]) * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewDirection );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininessB ), 0.0 );","float specularNormalization = shininessB * 0.125 + 0.25;","vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, pointHalfVector ) );","pointSpecular += schlick * InputToLinear(pointLightColor[ i ]) * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;","}","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += InputToLinear(diffuse) * InputToLinear(spotLightColor[ i ]) * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewDirection );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininessB ), 0.0 );","float specularNormalization = shininessB * 0.125 + 0.25;","vec3 schlick = Schlick_v3(InputToLinear(specular), dot( lVector, spotHalfVector ) );","spotSpecular += schlick * InputToLinear(spotLightColor[ i ]) * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","}","}","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += InputToLinear(diffuse) * InputToLinear(directionalLightColor[ i ]) * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewDirection );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininessB ), 0.0 );","float specularNormalization = shininessB * 0.125 + 0.25;","vec3 schlick = Schlick_v3(InputToLinear(specular), dot( dirVector, dirHalfVector ));","dirSpecular += schlick * InputToLinear(directionalLightColor[ i ]) * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","}","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#ifdef USE_IRRADIANCEMAP","vec3 worldNormal = mat3(viewMatrixInverse) * normal;","vec4 cubeColor4 = textureCube(irradianceMap, adjustLookupVector(worldNormal));","#ifdef IRR_GAMMA","vec3 indirectDiffuse = GammaDecode(cubeColor4, envMapExposure);","#elif defined(IRR_RGBM)","vec3 indirectDiffuse = RGBMDecode(cubeColor4, envMapExposure);","#else","vec3 indirectDiffuse = cubeColor4.xyz;","#ifdef GAMMA_INPUT","indirectDiffuse.xyz *= indirectDiffuse.xyz;","#endif","#endif","totalDiffuse += InputToLinear(diffuse) * indirectDiffuse;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( InputToLinear(emissive) + totalDiffuse + ambientLightColor * InputToLinear(diffuse) ) + totalSpecular;","#endif","#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );","#endif","#if defined(USE_ENVMAP)","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","#ifdef ENVMAP_MODE_REFLECTION","reflectVec = reflect( -viewDirection, normal );","#else ","reflectVec = refract( -viewDirection, normal, refractionRatio );","#endif","#else","reflectVec = reflect( -viewDirection, normal );","#endif","reflectVec = mat3(viewMatrixInverse) * reflectVec;","float reflectScale = 1.0;","vec3 cubeColor = sampleReflection(reflectVec, reflMipIndex);","cubeColor *= reflectScale;","float facing = dot( viewDirection, geomNormal );","if (facing < -1e-2)","facing = 1.0;","else","facing = max(1e-6, facing);","vec3 schlickRefl;","#ifdef METAL","schlickRefl = InputToLinear(specular);","#else","schlickRefl = Schlick_v3(InputToLinear(specular), facing);","gl_FragColor.a = mix(gl_FragColor.a, Schlick_f(gl_FragColor.a, facing), reflectivity);","float invSchlick = (1.0 - facing * 0.5);","float invSchlick2 = invSchlick * invSchlick;","float norm_factor = 1.0 - invSchlick * invSchlick2 * invSchlick2;","norm_factor = (28.0 / 23.0) * norm_factor;","gl_FragColor.xyz *= norm_factor * (1.0 - InputToLinear(specular));","#endif","gl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;","#ifdef CLEARCOAT","vec3 reflectVecClearcoat = reflect( -viewDirection, geomNormal );","reflectVecClearcoat = mat3(viewMatrixInverse) * reflectVecClearcoat;","vec3 cubeColorClearcoat = sampleReflection(reflectVecClearcoat, 0.0);","float schlickClearcoat = Schlick_f(InputToLinear(reflectivity), facing);","gl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickClearcoat, 0.5);","#endif","#endif","#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif","#if TONEMAP_OUTPUT == 1","gl_FragColor.xyz = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * gl_FragColor.xyz);","#elif TONEMAP_OUTPUT == 2","gl_FragColor.xyz = toneMapCanonFilmic_WithGamma( exposureBias * gl_FragColor.xyz );","#endif","#ifdef HATCH_PATTERN","gl_FragColor = calculateHatchPattern(hatchParams, gl_FragCoord.xy, gl_FragColor, hatchTintColor, hatchTintIntensity);","#endif","#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)","gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;","#endif","#ifdef MRT_NORMALS","gl_FragData[1] = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);","#endif","#ifdef MRT_ID_BUFFER","#ifdef MRT_NORMALS","const int index = 2;","#else","const int index = 1;","#endif","gl_FragData[index] = vec4(dbId.rgb, 1.0);","#elif defined(ID_COLOR)","gl_FragColor = dbId;","#endif","}"].join("\n")},THREE.ShaderLib.firefly_phong=e.FireflyPhongShader)}function init_FireflyPrismShader(){function e(e){var t=e+"_texMatrix",i=e+"_invert",n={}
return n[e]={type:"t",value:null},n[t]={type:"m3",value:new THREE.Matrix3},n[i]={type:"i",value:0},n}function t(e){var t=e+"_texMatrix",i=e+"_bumpScale",n=e+"_bumpmapType",o={}
return o[e]={type:"t",value:null},o[t]={type:"m3",value:new THREE.Matrix3},o[i]={type:"v2",value:new THREE.Vector2(1,1)},o[n]={type:"i",value:0},o}function i(e){var t=["#if defined( USE_SURFACE_ALBEDO_MAP ) || defined( USE_SURFACE_ROUGHNESS_MAP ) || defined( USE_SURFACE_CUTOUT_MAP ) || defined( USE_SURFACE_ANISOTROPY_MAP ) || defined( USE_SURFACE_ROTATION_MAP ) || defined( USE_OPAQUE_ALBEDO_MAP ) || defined( USE_OPAQUE_F0_MAP ) || defined( USE_OPAQUE_LUMINANCE_MODIFIER_MAP ) || defined( USE_LAYERED_BOTTOM_F0_MAP ) || defined( USE_LAYERED_F0_MAP ) || defined( USE_LAYERED_DIFFUSE_MAP ) || defined( USE_LAYERED_FRACTION_MAP ) || defined( USE_LAYERED_ROUGHNESS_MAP ) || defined( USE_LAYERED_ANISOTROPY_MAP ) || defined( USE_LAYERED_ROTATION_MAP ) || defined( USE_METAL_F0_MAP ) || defined( USE_SURFACE_NORMAL_MAP ) || defined( USE_LAYERED_NORMAL_MAP )",e,"#endif"].join("\n")
return t}function n(e,t,i,n){var o=i?"_v3":"",r=i?"vec3 ":"",a=i?t+" = averageOfFloat3("+t+o+");":"",s=n?t+o+" = SRGBToLinear("+t+o+");":"",l=["#if defined( USE_"+e.toUpperCase()+"_MAP )","vec2 uv_"+e+"_map = ("+e+"_map_texMatrix * vec3(vUv, 1.0)).xy;",r+t+o+" = texture2D("+e+"_map, uv_"+e+"_map).xyz;",s,"if("+e+"_map_invert) "+t+o+" = vec3(1.0) - "+t+o+";",a,"#else",t+" = "+e+";","#endif"].join("\n")
return l}function o(e){var t=e+"_texMatrix",i=e+"_invert",n="USE_"+e,o=["#if defined( "+n.toUpperCase()+" )","uniform sampler2D "+e+";","uniform mat3 "+t+";","uniform bool "+i+";","#endif"].join("\n")
return o}function r(e){var t=e+"_texMatrix",i=e+"_bumpScale",n=e+"_bumpmapType",o="USE_"+e,r=["#if defined( "+o.toUpperCase()+" )","uniform sampler2D "+e+";","uniform mat3 "+t+";","uniform vec2 "+i+";","uniform int "+n+";","#endif"].join("\n")
return r}var a=Autodesk.Viewing.Shaders,s=Autodesk.Viewing.Private
"undefined"==typeof a.PrismShader&&(a.PrismShader={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.lights,e("surface_albedo_map"),e("surface_roughness_map"),e("surface_cutout_map"),e("surface_anisotropy_map"),e("surface_rotation_map"),e("opaque_albedo_map"),e("opaque_f0_map"),e("opaque_luminance_modifier_map"),e("layered_bottom_f0_map"),e("layered_f0_map"),e("layered_diffuse_map"),e("layered_fraction_map"),e("layered_roughness_map"),e("layered_anisotropy_map"),e("layered_rotation_map"),e("metal_f0_map"),t("surface_normal_map"),t("layered_normal_map"),{surface_albedo:{type:"c",value:new THREE.Color(1118481)},surface_roughness:{type:"f",value:1},surface_anisotropy:{type:"f",value:1},surface_rotation:{type:"f",value:1},opaque_albedo:{type:"c",value:new THREE.Color(1118481)},opaque_f0:{type:"f",value:1},opaque_luminance_modifier:{type:"c",value:new THREE.Color(1118481)},opaque_luminance:{type:"f",value:1},metal_f0:{type:"c",value:new THREE.Color(1118481)},layered_f0:{type:"f",value:1},layered_diffuse:{type:"c",value:new THREE.Color(0)},layered_fraction:{type:"f",value:1},layered_bottom_f0:{type:"c",value:new THREE.Color(1118481)},layered_roughness:{type:"f",value:1},layered_anisotropy:{type:"f",value:1},layered_rotation:{type:"f",value:1},transparent_ior:{type:"f",value:2},transparent_color:{type:"c",value:new THREE.Color(1118481)},transparent_distance:{type:"f",value:1},irradianceMap:{type:"t",value:null},envMap:{type:"t",value:null},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1},envExponentMin:{type:"f",value:1},envExponentMax:{type:"f",value:512},envExponentCount:{type:"f",value:10},cutplanes:{type:"v4v",value:[]},cutplanesOutlineColor:{type:"v3",value:new THREE.Vector3(0,1,0)},hatchParams:{type:"v2",value:new THREE.Vector2(1,10)},cutplanesOutlineThickness:{type:"f",value:.001},hatchTintColor:{type:"c",value:new THREE.Color(16777215)},hatchTintIntensity:{type:"f",value:1},dbId:{type:"v4",value:new THREE.Vector4(0,0,0,0)}}]),vertexShader:["varying vec3 vViewPosition;","varying vec3 vNormal;","#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif",i("#define USE_MAP"),"#ifdef USE_MAP","varying vec2 vUv;","#endif","#ifdef USE_LOGDEPTHBUF","#ifdef USE_LOGDEPTHBUF_EXT","varying float vFragDepth;","#endif","uniform float logDepthBufFC;","#endif","#ifdef MRT_NORMALS","varying float depth;","#endif",PackNormalsShaderChunk,"#if !defined(USE_MAP) && (MAX_DIR_LIGHTS > 0 || MAX_POINT_LIGHTS > 0 || MAX_SPOT_LIGHTS > 0)","varying vec3 vTangent;","varying vec3 vBitangent;","void ComputeTangents(vec3 normal, out vec3 u, out vec3 v)","{","    float scale = normal.z < 0.0 ? -1.0 : 1.0;","    vec3 temp = scale * normal;","    float e    = temp.z;","    float h    = 1.0/(1.0 + e);","    float hvx  = h   *  temp.y;","    float hvxy = hvx * -temp.x;","    u = vec3(e + hvx * temp.y, hvxy,                -temp.x);","    v = vec3(hvxy,             e + h * temp.x * temp.x, -temp.y);","    u *= scale;","    v *= scale;","}","#endif","void main() {","#ifdef USE_MAP","vUv = uv;","#endif","#ifdef UNPACK_NORMALS","vec3 objectNormal = decodeNormal(normal);","#else","vec3 objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;","vNormal = normalize( transformedNormal );","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vViewPosition = -mvPosition.xyz;","#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","#endif","#if !defined(USE_MAP) && (MAX_DIR_LIGHTS > 0 || MAX_POINT_LIGHTS > 0 || MAX_SPOT_LIGHTS > 0)","vec3 Tu, Tv;","ComputeTangents(vNormal, Tu, Tv);","vTangent = Tu;","vBitangent = Tv;","#endif","#ifdef USE_LOGDEPTHBUF","if (projectionMatrix[3][3] == 0.0) {","gl_Position.z = log2(max(1.0e-6, gl_Position.w + 1.0)) * logDepthBufFC;","#ifdef USE_LOGDEPTHBUF_EXT","vFragDepth = 1.0 + gl_Position.w;","#else","gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;","#endif","} else {","#ifdef USE_LOGDEPTHBUF_EXT","vFragDepth = 1.0 + vViewPosition.z;","#else","#endif","}","#endif","#ifdef MRT_NORMALS","depth = mvPosition.z;","#endif","}"].join("\n"),fragmentShader:["#define PI 3.141592654","uniform vec3 surface_albedo;","uniform float surface_roughness;","uniform float surface_anisotropy;","uniform float surface_rotation;","#if defined( PRISMOPAQUE )","uniform vec3 opaque_albedo;","uniform float opaque_f0;","uniform vec3 opaque_luminance_modifier;","uniform float opaque_luminance;","#elif defined( PRISMMETAL )","uniform vec3 metal_f0;","#elif defined( PRISMLAYERED )","uniform float layered_f0;","uniform vec3 layered_diffuse;","uniform float layered_fraction;","uniform vec3 layered_bottom_f0;","uniform float layered_roughness;","uniform float layered_anisotropy;","uniform float layered_rotation;","#elif defined( PRISMTRANSPARENT )","uniform float transparent_ior;","uniform vec3 transparent_color;","uniform float transparent_distance;","#endif","uniform float envExponentMin;","uniform float envExponentMax;","uniform float envExponentCount;",EnvSamplingShaderChunk,"#if TONEMAP_OUTPUT > 0","uniform float exposureBias;",TonemapShaderChunk,"#endif","#if defined(MRT_NORMALS) || defined(MRT_ID_BUFFER)","varying highp float depth;","#define gl_FragColor gl_FragData[0]","#endif","#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif","#ifdef USE_LOGDEPTHBUF","uniform float logDepthBufFC;","#ifdef USE_LOGDEPTHBUF_EXT","#extension GL_EXT_frag_depth : enable","varying highp float vFragDepth;","#endif","#endif","#if defined(MRT_ID_BUFFER) || defined(ID_COLOR)","uniform vec4 dbId;","#endif",i("#define USE_MAP"),"#ifdef USE_MAP","varying vec2 vUv;","#endif",o("surface_albedo_map"),o("surface_roughness_map"),o("surface_cutout_map"),o("surface_anisotropy_map"),o("surface_rotation_map"),o("opaque_albedo_map"),o("opaque_f0_map"),o("opaque_luminance_modifier_map"),o("layered_bottom_f0_map"),o("layered_f0_map"),o("layered_diffuse_map"),o("layered_fraction_map"),o("layered_roughness_map"),o("layered_anisotropy_map"),o("layered_rotation_map"),o("metal_f0_map"),r("surface_normal_map"),r("layered_normal_map"),"vec3 RGBMDecode(in vec4 vRGBM, in float exposure) {","vec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);","ret *= ret;","ret *= exposure;","return ret;","}","vec3 GammaDecode(in vec4 vRGBA, in float exposure) {","return vRGBA.xyz * vRGBA.xyz * exposure;","}","float SRGBToLinearComponent(float color) {","float result = color;","if (result<=0.04045)","result /= 12.92;","else","result = pow(abs((result+0.055)/1.055), 2.4);","return result;","}","vec3 SRGBToLinear(vec3 color) {","vec3 result = color;","result.x = SRGBToLinearComponent(result.x);","result.y = SRGBToLinearComponent(result.y);","result.z = SRGBToLinearComponent(result.z);","return result;","}","#if defined( USE_ENVMAP )","uniform float envMapExposure;","uniform samplerCube envMap;","#endif","float averageOfFloat3(in vec3 value)","{ ","    const float oneThird = 1.0 / 3.0; ","    return dot(value, vec3(oneThird, oneThird, oneThird)); ","} ","#if defined( USE_SURFACE_NORMAL_MAP ) || defined( USE_LAYERED_NORMAL_MAP )","vec3 heightMapTransform(sampler2D bumpTexture, vec2 uv, mat3 transform, vec2 bumpScale, vec3 T, vec3 B, vec3 N) {","vec2 st = (transform * vec3(uv, 1.0)).xy;","mat3 mtxTangent = mat3(T, B, N);","T = normalize(mtxTangent * (transform * vec3(1.0, 0.0, 0.0)));","B = normalize(mtxTangent * (transform * vec3(0.0, 1.0, 0.0)));","const float oneThird = 1.0 / 3.0;","vec3 avg = vec3(oneThird, oneThird, oneThird);","vec2 offset = fwidth(st);","float h0 = dot(texture2D(bumpTexture, st).xyz, avg);","float hx = dot(texture2D(bumpTexture, st + vec2(offset.x, 0.0)).xyz, avg);","float hy = dot(texture2D(bumpTexture, st + vec2(0.0, offset.y)).xyz, avg);","vec2 diff = vec2(h0 - hx, h0 - hy) / offset;","return normalize(N + (diff.x * T * bumpScale.x + diff.y * B * bumpScale.y));","}","vec3 normalMapTransform(sampler2D bumpTexture, vec2 uv, mat3 transform, vec2 bumpScale, vec3 T, vec3 B, vec3 N) {","vec2 st = (transform * vec3(uv, 1.0)).xy;","vec3 NMap =  2.0 * texture2D( bumpTexture, st ).xyz - 1.0; ","return normalize(bumpScale.x * (NMap.x * T + NMap.y * B) + NMap.z * N);","}","#endif","#if !defined(USE_MAP)&& (MAX_DIR_LIGHTS > 0 || MAX_POINT_LIGHTS > 0 || MAX_SPOT_LIGHTS > 0)","varying vec3 vTangent;","varying vec3 vBitangent;","#endif","#if defined( USE_ENVMAP )","vec3 sampleReflection(vec3 N, vec3 V, float mipIndex) {","vec3 dir = (2.0 * dot(V, N)) * N - V;","dir = adjustLookupVector(mat3(viewMatrixInverse) * dir);","#ifdef ENV_GAMMA","#ifdef HAVE_TEXTURE_LOD","vec4 envTexColor = textureCubeLodEXT( envMap, dir, mipIndex );","#else","vec4 envTexColor = textureCube( envMap, dir, mipIndex );","#endif","return GammaDecode(envTexColor, envMapExposure);","#elif defined(ENV_RGBM)","#ifdef HAVE_TEXTURE_LOD","vec4 envTexColor = textureCubeLodEXT( envMap, dir, mipIndex );","#else","vec4 envTexColor = textureCube( envMap, dir, mipIndex );","#endif","return RGBMDecode(envTexColor, envMapExposure);","#else","vec4 envTexColor = textureCube( envMap, dir );","vec3 cubeColor = envTexColor.xyz;","#ifdef GAMMA_INPUT","cubeColor *= cubeColor;","#endif","return cubeColor;","#endif","}","#endif",HatchPatternShaderChunk,"#if defined( USE_ENVMAP ) && defined( USE_IRRADIANCEMAP )","uniform samplerCube irradianceMap;","vec3 sampleNormal(vec3 normal) {","vec3 worldNormal = mat3(viewMatrixInverse) * normal;","vec4 cubeColor4 = textureCube(irradianceMap, adjustLookupVector(worldNormal));","#ifdef IRR_GAMMA","vec3 indirectDiffuse = GammaDecode(cubeColor4, envMapExposure);","#elif defined(IRR_RGBM)","vec3 indirectDiffuse = RGBMDecode(cubeColor4, envMapExposure);","#else","vec3 indirectDiffuse = cubeColor4.xyz;","#ifdef GAMMA_INPUT","indirectDiffuse.xyz *= indirectDiffuse.xyz;","#endif","#endif","return indirectDiffuse;}","#endif","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","float sqr(float x) {return x*x;}","float aSqrd(float maxAlphaSqr, float cosTheta)","{","   float tan2 = 1.0/sqr(cosTheta) - 1.0;","   return maxAlphaSqr * tan2;","}","vec3 Fresnel_Schlick(vec3 f0, float cosAngle)","{","    float x = 1.0 - cosAngle;","    float x2 = x * x;","    float x5 = x * x2 * x2;","    return f0 + (1.0 - f0) * x5;","}","vec3 Fresnel_Rough(vec3 f0, float cosAngle, float alpha)","{","    float x = 1.0 - cosAngle;","    float x2 = x * x;","    float x5 = x * x2 * x2;","    vec3 maxReflectance = mix(vec3(1.0), f0, vec3(min(0.7, alpha)) / 0.7);","    return f0 + (maxReflectance - f0) * x5;","}","float IORToReflectance(float ior)","{","    return sqr((1.0 - ior)/(1.0 + ior));","}","vec2 RoughnessToAlpha(float roughness, float anisotropy)","{","    vec2 alpha = roughness * vec2(1.0, 1.0 - anisotropy);","    alpha = alpha * alpha;","    alpha = clamp(alpha, 0.001, 1.0);","    return alpha;","}","float AlphaToPhong(float alpha)","{","    return max(0.0, 2.56/alpha - 7.0);","}","float ExponentToReflMipIndex(float exponent)","{","    float targetLog = log2(exponent);","    float minLog = log2(envExponentMin); ","    float maxLog = log2(envExponentMax); ","    float deltaLog = clamp(targetLog - minLog, 0.0, maxLog - minLog);  ","    float level = clamp((1.0-(deltaLog + 0.5) / envExponentCount), 0.0, 1.0) * 6.0; ","    return level; ","}","#if MAX_DIR_LIGHTS > 0 || MAX_POINT_LIGHTS > 0 || MAX_SPOT_LIGHTS > 0","vec3 DiffuseLobe(vec3 diffuseColor)","{","return diffuseColor / PI;","}","vec3 Rotate(vec3 vec, float angle)","{","float s = sin(angle);","float c = cos(angle);","return vec3(vec.x * c - vec.y * s, vec.x * s + vec.y * c, vec.z);","}","float NDF_GGX(float alphaU, float alphaV, vec3 normal)","{","float nx2 = sqr(normal.x);","float ny2 = sqr(normal.y);","float nz2 = sqr(normal.z);","float scale = 1.0/(alphaU * alphaV * PI);","return scale/sqr(nx2/sqr(alphaU) + ny2/sqr(alphaV) + nz2);","}","float G1_GGX(float aSqrd)","{","    return 2.0 / (1.0 + sqrt(1.0 + aSqrd));","}","vec3 MicrofacetLobe(","vec3 Hlocal, float NdotL, float NdotH, float NdotV, float VdotH,","float roughness, float anisotropy, float rotation, vec3 reflectance)","{","vec2 alpha = RoughnessToAlpha(roughness, anisotropy);","Hlocal = Rotate(Hlocal, rotation);","vec3 F = Fresnel_Schlick(reflectance, VdotH);","float D = NDF_GGX(alpha.x, alpha.y, Hlocal);","float alpha2 = max(sqr(alpha.x), sqr(alpha.y));","float alpha2NL = aSqrd(alpha2, NdotL);","float alpha2NV = aSqrd(alpha2, NdotV);","float G = G1_GGX(alpha2NL) * G1_GGX(alpha2NV);","return max(F * D * G / (4.0 * NdotL * NdotV), vec3(0.0));","}","#if defined( PRISMOPAQUE )","vec3 BRDF_Opaque(vec3 Hlocal, float NdotL, float NdotH, float NdotV, float VdotH, ","                 vec3 surfaceAlbedo, float surfaceRoughness, float surfaceAnisotropy, float surfaceRotation, ","                 float opaqueF0, vec3 opaqueAlbedo)","{","    vec3 diffuse = DiffuseLobe(opaqueAlbedo);","    vec3 specular = surfaceAlbedo * MicrofacetLobe(","        Hlocal, NdotL, NdotH, NdotV, VdotH,","        surfaceRoughness, surfaceAnisotropy, surfaceRotation, vec3(opaqueF0));","    return (specular+diffuse)*NdotL;","}","#elif defined( PRISMMETAL )","vec3 BRDF_Metal(vec3 Hlocal, float NdotL, float NdotH, float NdotV, float VdotH, ","                vec3 surfaceAlbedo, float surfaceRoughness, float surfaceAnisotropy, float surfaceRotation, ","                vec3 metalF0)","{","    vec3 specular = surfaceAlbedo * MicrofacetLobe(","        Hlocal, NdotL, NdotH, NdotV, VdotH,","        surfaceRoughness, surfaceAnisotropy, surfaceRotation, metalF0);","    return specular*NdotL;","}","#elif defined( PRISMLAYERED )","vec3 BRDF_Layered(vec3 Hlocal, float NdotL, float NdotH, float NdotV, float VdotH, ","                  vec3 Hlocal2, float N2dotL, float N2dotH, float N2dotV, ","                  vec3 surfaceAlbedo, float surfaceRoughness, float surfaceAnisotropy, float surfaceRotation,","                  float layeredF0, vec3 layeredDiffuse, float layeredRoughness, float layeredAnisotropy,","                  float layeredRotation, vec3 bottom_f0, float layeredFraction)","{","    vec3 Fl = Fresnel_Schlick(vec3(layeredF0), NdotL);","    vec3 Fv = Fresnel_Schlick(vec3(layeredF0), NdotV);","    vec3 amount = (1.0 - Fl) * (1.0 - Fv);","    vec3 topSpecular = surfaceAlbedo * MicrofacetLobe(","        Hlocal, NdotL, NdotH, NdotV, VdotH,","        surfaceRoughness, surfaceAnisotropy, surfaceRotation,","        vec3(layeredF0));","    vec3 topDiffuse = DiffuseLobe(layeredDiffuse);","    vec3 botSpecular = MicrofacetLobe(","        Hlocal2, N2dotL, N2dotH, N2dotV, VdotH,","        layeredRoughness, layeredAnisotropy, layeredRotation,","        bottom_f0);","    return topSpecular*NdotL + amount * mix(topDiffuse*NdotL, botSpecular*N2dotL, layeredFraction);","}","#elif defined( PRISMTRANSPARENT )","vec3 BRDF_Transparent(vec3 Hlocal, float NdotL, float NdotH, float NdotV, float VdotH, ","                vec3 surfaceAlbedo, float surfaceRoughness, float surfaceAnisotropy, float surfaceRotation)","{","    vec3 reflectance = vec3(IORToReflectance(transparent_ior));","    vec3 specular = surfaceAlbedo * MicrofacetLobe(","        Hlocal, NdotL, NdotH, NdotV, VdotH,","        surfaceRoughness, surfaceAnisotropy, surfaceRotation, reflectance);","    return specular*NdotL;","}","#endif","#endif","#if defined( USE_ENVMAP )","#if defined( PRISMOPAQUE )","vec3 Environment_Opaque(vec3 N, vec3 V, float NdotV, vec3 surfaceAlbedo, float surfaceRoughness,","                        float opaqueF0, vec3 opaqueAlbedo)","{","    float alpha = RoughnessToAlpha(surfaceRoughness, 0.0).x;","    float exponent = AlphaToPhong(alpha);","    float reflMipIndex = ExponentToReflMipIndex(exponent);","    vec3 F = Fresnel_Rough(vec3(opaqueF0), NdotV, alpha);","#if defined( USE_IRRADIANCEMAP )","    vec3 envIrradiance = sampleNormal(N);","#else","    vec3 envIrradiance = vec3(1.0);","#endif","    vec3 diffuse = (1.0 - F) * opaqueAlbedo * envIrradiance;","     vec3 luminanceModifier;",n("opaque_luminance_modifier","luminanceModifier",!1,!0),"    vec3 emission = luminanceModifier * opaque_luminance;","    vec3 envSpecular = sampleReflection(N, V, reflMipIndex);","    vec3 specular = F* surfaceAlbedo * envSpecular;","    return diffuse + specular + emission;","}","#elif defined( PRISMMETAL )","vec3 Environment_Metal(vec3 N, vec3 V, float NdotV, vec3 surfaceAlbedo, float surfaceRoughness, vec3 metalF0)","{","    float alpha = RoughnessToAlpha(surfaceRoughness, 0.0).x;","    float exponent = AlphaToPhong(alpha);","    float reflMipIndex = ExponentToReflMipIndex(exponent);","    vec3 F = Fresnel_Rough(metalF0, NdotV, alpha);","    vec3 envSpecular = sampleReflection(N, V, reflMipIndex);","    vec3 specular = F * surfaceAlbedo * envSpecular;","    return specular;","}","#elif defined( PRISMLAYERED )","vec3 Environment_Layered(vec3 N, vec3 V, float NdotV, vec3 N2, float N2dotV, vec3 surfaceAlbedo, float surfaceRoughness,","                         float layeredF0, vec3 layeredDiffuse, float layeredRoughness, float layeredAnisotropy,","                         float layeredRotation, vec3 bottom_f0, float layeredFraction)","{","    float alpha = RoughnessToAlpha(surfaceRoughness, 0.0).x;","    float exponent = AlphaToPhong(alpha);","    float reflMipIndex = ExponentToReflMipIndex(exponent);","    vec3 envSpecular = sampleReflection(N, V, reflMipIndex);","    vec3 F = Fresnel_Schlick(vec3(layeredF0), NdotV);","    vec3 topSpecular = F * surfaceAlbedo * envSpecular;","    vec3 amount = (1.0 - F);","#if defined( USE_IRRADIANCEMAP )","    vec3 envIrradiance = sampleNormal(N);","#else","    vec3 envIrradiance = vec3(1.0);","#endif","    vec3 topDiffuse = layeredDiffuse * envIrradiance;","    alpha = RoughnessToAlpha(layeredRoughness, 0.0).x;","    exponent = AlphaToPhong(alpha);","    reflMipIndex = ExponentToReflMipIndex(exponent);","    envSpecular = sampleReflection(N2, V, reflMipIndex);","    F = Fresnel_Rough(bottom_f0, N2dotV, alpha);","    vec3 botSpecular = F * envSpecular;","    return topSpecular + amount * mix(topDiffuse, botSpecular, layeredFraction);","}","#elif defined( PRISMTRANSPARENT )","vec3 Environment_Transparent(vec3 N, vec3 V, float NdotV, vec3 surfaceAlbedo, float surfaceRoughness)","{","    float alpha = RoughnessToAlpha(surfaceRoughness, 0.0).x;","    float exponent = AlphaToPhong(alpha);","    float reflMipIndex = ExponentToReflMipIndex(exponent);","    vec3 reflectance = vec3(IORToReflectance(transparent_ior));","    vec3 F = Fresnel_Rough(reflectance, NdotV, alpha);","    vec3 envSpecular = sampleReflection(N, V, reflMipIndex);","    vec3 specular = F * surfaceAlbedo * envSpecular;","#if defined( USE_IRRADIANCEMAP )","    vec3 envIrradiance = sampleNormal(N);","#else","    vec3 envIrradiance = vec3(1.0);","#endif","    vec3 color = 0.5 * (1.0 - F) * transparent_color * envIrradiance;","    return specular + color;","}","#endif","#endif","varying vec3 vNormal;","varying vec3 vViewPosition;",CutPlanesShaderChunk,"void main() {","#if NUM_CUTPLANES > 0","if (checkCutPlanes(vWorldPosition)) return;","#endif","vec3 N = normalize(vNormal);","#if defined( USE_SURFACE_NORMAL_MAP ) || defined( USE_LAYERED_NORMAL_MAP ) || MAX_DIR_LIGHTS > 0 || MAX_POINT_LIGHTS > 0 || MAX_SPOT_LIGHTS > 0","#ifndef USE_MAP","vec3 Tu = normalize(vTangent);","vec3 Tv = normalize(vBitangent);","#else","vec3 q0 = dFdx( -vViewPosition );","vec3 q1 = dFdy( -vViewPosition );","vec2 st0 = dFdx( vUv );","vec2 st1 = dFdy( vUv );","vec3 Tu = normalize(  q0 * st1.t - q1 * st0.t );","vec3 Tv = normalize( -q0 * st1.s + q1 * st0.s );","#endif","#endif","vec3 V;","if (projectionMatrix[3][3] == 0.0) {","V = normalize( vViewPosition );","} else {","V = vec3(0.0, 0.0, 1.0);","}","N = faceforward(N, -V, N);","#if defined(PRISMLAYERED)","vec3 N2 = N;","#endif","#ifndef FLAT_SHADED","vec3 normal = normalize( vNormal );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","#endif","#else","vec3 fdx = dFdx( vViewPosition );","vec3 fdy = dFdy( vViewPosition );","vec3 normal = normalize( cross( fdx, fdy ) );","#endif","vec3 geomNormal = normal;","#if defined( USE_SURFACE_NORMAL_MAP )","if (surface_normal_map_bumpmapType == 0)","     N = heightMapTransform(surface_normal_map, vUv, surface_normal_map_texMatrix, surface_normal_map_bumpScale, Tu, Tv, N);","else","     N = normalMapTransform(surface_normal_map, vUv, surface_normal_map_texMatrix, surface_normal_map_bumpScale, Tu, Tv, N);","#endif","#if defined( USE_LAYERED_NORMAL_MAP )","if (layered_normal_map_bumpmapType == 0)","     N2 = heightMapTransform(layered_normal_map, vUv, layered_normal_map_texMatrix, layered_normal_map_bumpScale, Tu, Tv, N2);","else","     N2 = normalMapTransform(layered_normal_map, vUv, layered_normal_map_texMatrix, layered_normal_map_bumpScale, Tu, Tv, N2);","#endif","float NdotV = dot(N, V);","#if defined(PRISMLAYERED)","float N2dotV = dot(N2, V);","#endif","vec3 surfaceAlbedo;",n("surface_albedo","surfaceAlbedo",!1,!0),"float surfaceRoughness;",n("surface_roughness","surfaceRoughness",!0,!1),"float surfaceAnisotropy;",n("surface_anisotropy","surfaceAnisotropy",!0,!1),"float surfaceRotation;",n("surface_rotation","surfaceRotation",!0,!1),"#if defined(PRISMOPAQUE)","float opaqueF0;",n("opaque_f0","opaqueF0",!0,!1),"vec3 opaqueAlbedo;",n("opaque_albedo","opaqueAlbedo",!1,!0),"#elif defined(PRISMMETAL)","vec3 metalF0;",n("metal_f0","metalF0",!1,!0),"#elif defined(PRISMLAYERED)","float layeredF0;",n("layered_f0","layeredF0",!0,!1),"vec3 layeredDiffuse;",n("layered_diffuse","layeredDiffuse",!1,!0),"float layeredRoughness;",n("layered_roughness","layeredRoughness",!0,!1),"float layeredAnisotropy;",n("layered_anisotropy","layeredAnisotropy",!0,!1),"float layeredRotation;",n("layered_rotation","layeredRotation",!0,!1),"vec3 bottom_f0;",n("layered_bottom_f0","bottom_f0",!1,!0),"float layeredFraction;",n("layered_fraction","layeredFraction",!0,!1),"#endif","vec3 outRadianceLight = vec3(0.0);","#if MAX_DIR_LIGHTS > 0 || MAX_POINT_LIGHTS > 0 || MAX_SPOT_LIGHTS > 0","vec3 lightDirection[ MAX_DIR_LIGHTS + MAX_POINT_LIGHTS + MAX_SPOT_LIGHTS ];","vec3 lightColor[ MAX_DIR_LIGHTS + MAX_POINT_LIGHTS + MAX_SPOT_LIGHTS ];","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","lightDirection[i] = normalize( lDirection.xyz );","lightColor[i] = SRGBToLinear(directionalLightColor[ i ]);","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","lightDirection[MAX_DIR_LIGHTS + i] = normalize( lVector );","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lightColor[MAX_DIR_LIGHTS + i] = SRGBToLinear(pointLightColor[ i ]) * lDistance;","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","lightDirection[MAX_DIR_LIGHTS + MAX_POINT_LIGHTS + i] = normalize( lVector );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] )","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","lightColor[MAX_DIR_LIGHTS + MAX_POINT_LIGHTS + i] = SRGBToLinear(spotLightColor[ i ]) * lDistance * spotEffect;","}","#endif","for( int i = 0; i < MAX_DIR_LIGHTS + MAX_POINT_LIGHTS + MAX_SPOT_LIGHTS; i ++ ) {","vec3 L = lightDirection[i];","float NdotL = dot(N, L);","vec3 H = normalize(L + V);","float NdotH = dot(N, H);","float VdotH = dot(V, H);","float Hu = dot(H, Tu);","float Hv = dot(H, Tv);","vec3 Hlocal = vec3(Hu, Hv, NdotH);","#if defined(PRISMLAYERED)","float N2dotL = dot(N2, L);","float N2dotH = dot(N2, H);","vec3 Hlocal2 = vec3(Hu, Hv, N2dotH);","#endif","vec3 brdf = lightColor[i] * ","#if defined(PRISMOPAQUE)","    BRDF_Opaque(Hlocal, NdotL, NdotH, NdotV, VdotH,","                surfaceAlbedo, surfaceRoughness, surfaceAnisotropy, surfaceRotation,","                opaqueF0, opaqueAlbedo);","#elif defined(PRISMMETAL)","    BRDF_Metal(Hlocal, NdotL, NdotH, NdotV, VdotH, ","               surfaceAlbedo, surfaceRoughness, surfaceAnisotropy, surfaceRotation, ","               metalF0);","#elif defined(PRISMLAYERED)","    BRDF_Layered(Hlocal, NdotL, NdotH, NdotV, VdotH, Hlocal2, N2dotL, N2dotH, N2dotV,","                 surfaceAlbedo, surfaceRoughness, surfaceAnisotropy, surfaceRotation,","                 layeredF0, layeredDiffuse, layeredRoughness, layeredAnisotropy,","                 layeredRotation, bottom_f0, layeredFraction);","#elif defined(PRISMTRANSPARENT)","    BRDF_Transparent(Hlocal, NdotL, NdotH, NdotV, VdotH, surfaceAlbedo, surfaceRoughness, surfaceAnisotropy, surfaceRotation);","#endif","outRadianceLight += max(vec3(0.0), brdf);","}","#endif","vec3 outRadianceEnv = vec3(0.0);","#if defined( USE_ENVMAP )","outRadianceEnv =","#if defined(PRISMOPAQUE)","    Environment_Opaque(N, V, clamp(NdotV, 0.0, 1.0), surfaceAlbedo, surfaceRoughness,","                        opaqueF0, opaqueAlbedo);","#elif defined(PRISMMETAL)","    Environment_Metal(N, V, clamp(NdotV, 0.0, 1.0), surfaceAlbedo, surfaceRoughness, metalF0);","#elif defined(PRISMLAYERED)","    Environment_Layered(N, V, clamp(NdotV, 0.0, 1.0), N2, clamp(N2dotV, 0.0, 1.0), surfaceAlbedo, surfaceRoughness,","                layeredF0, layeredDiffuse, layeredRoughness, layeredAnisotropy,","                layeredRotation, bottom_f0, layeredFraction);","#elif defined(PRISMTRANSPARENT)","    Environment_Transparent(N, V, clamp(NdotV, 0.0, 1.0), surfaceAlbedo, surfaceRoughness);","#endif","#endif","float opacity = 1.0;","float surface_cutout = 1.0;",n("surface_cutout","surface_cutout",!0,!1),"#if defined( USE_SURFACE_CUTOUT_MAP )","if(surface_cutout < 0.01) discard;","#endif","#if defined(PRISMTRANSPARENT)","if (transparent_ior == 1.0 && transparent_color == vec3(1.0,1.0,1.0))","opacity = 0.0;","else","opacity = max(0.5, mix(1.0, surfaceRoughness, NdotV));","#endif","gl_FragColor = vec4( outRadianceLight + outRadianceEnv, opacity*surface_cutout );","#if TONEMAP_OUTPUT == 1","gl_FragColor.xyz = toneMapCanonOGS_WithGamma_WithColorPerserving(exposureBias * gl_FragColor.xyz);","#elif TONEMAP_OUTPUT == 2","gl_FragColor.xyz = toneMapCanonFilmic_WithGamma(exposureBias * gl_FragColor.xyz);","#endif","#ifdef HATCH_PATTERN","gl_FragColor = calculateHatchPattern(hatchParams, gl_FragCoord.xy, gl_FragColor, hatchTintColor, hatchTintIntensity);","#endif","#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)","gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;","#endif","#ifdef MRT_NORMALS","gl_FragData[1] = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);","#endif","#ifdef MRT_ID_BUFFER","#ifdef MRT_NORMALS","const int index = 2;","#else","const int index = 1;","#endif","gl_FragData[index] = vec4(dbId.rgb, 1.0);","#elif defined(ID_COLOR)","gl_FragColor = dbId;","#endif","}"].join("\n")},THREE.ShaderLib.prism=a.PrismShader,s.createPrismMaterial=function(){var e=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(a.PrismShader.uniforms),vertexShader:a.PrismShader.vertexShader,fragmentShader:a.PrismShader.fragmentShader})
return e.mapList={},e.isPrismMaterial=!0,e},s.clonePrismMaterial=function(e){var t=s.createPrismMaterial()
switch(t.mapList=e.mapList,t.prismType=e.prismType,t.surface_albedo=e.surface_albedo,t.surface_albedo_map=e.surface_albedo_map,t.surface_roughness=e.surface_roughness,t.surface_roughness_map=e.surface_roughness_map,t.surface_anisotropy=e.surface_anisotropy,t.surface_anisotropy_map=e.surface_anisotropy_map,t.surface_rotation=e.surface_rotation,t.surface_rotation_map=e.surface_rotation_map,t.surface_cutout_map=e.surface_cutout_map,t.surface_normal_map=e.surface_normal_map,t.prismType){case"PrismOpaque":t.opaque_albedo=(new THREE.Color).copy(e.opaque_albedo),t.opaque_luminance_modifier=(new THREE.Color).copy(e.opaque_luminance_modifier),t.opaque_f0=e.opaque_f0,t.opaque_luminance=e.opaque_luminance,t.opaque_albedo_map=e.opaque_albedo_map,t.opaque_luminance_modifier_map=e.opaque_luminance_modifier_map,t.opaque_f0_map=e.opaque_f0_map
break
case"PrismMetal":t.metal_f0=(new THREE.Color).copy(e.metal_f0),t.metal_f0_map=e.metal_f0_map
break
case"PrismLayered":t.layered_f0=e.layered_f0,t.layered_diffuse=(new THREE.Color).copy(e.layered_diffuse),t.layered_fraction=e.layered_fraction,t.layered_bottom_f0=(new THREE.Color).copy(e.layered_bottom_f0),t.layered_roughness=e.layered_roughness,t.layered_anisotropy=e.layered_anisotropy,t.layered_rotation=e.layered_rotation,t.layered_bottom_f0_map=e.layered_bottom_f0_map,t.layered_f0_map=e.layered_f0_map,t.layered_diffuse_map=e.layered_diffuse_map,t.layered_fraction_map=e.layered_fraction_map,t.layered_rotationlayered_roughness_map=e.layered_rotationlayered_roughness_map,t.layered_anisotropy_map=e.layered_anisotropy_map,t.layered_rotation_map=e.layered_rotation_map,t.layered_normal_map=e.layered_normal_map
break
case"PrismTransparent":t.transparent_color=(new THREE.Color).copy(e.transparent_color),t.transparent_distance=e.transparent_distance,t.transparent_ior=e.transparent_ior
break
default:console.warn("Unknown prism type: "+e.prismType)}return t.envExponentMin=e.envExponentMin,t.envExponentMax=e.envExponentMax,t.envExponentCount=e.envExponentCount,t.envMap=e.envMap,t.defines=e.defines,t})}function init_NormalsShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.NormalsShader&&(e.NormalsShader={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:["varying vec3 vNormal;","varying float depth;","#if NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif",PackNormalsShaderChunk,"void main() {","#ifdef UNPACK_NORMALS","vec3 objectNormal = decodeNormal(normal);","#else","vec3 objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;","vNormal = normalize( transformedNormal );","#if NUM_CUTPLANES > 0","    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","    vWorldPosition = worldPosition.xyz;","#endif","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","depth = mvPosition.z;","vec4 p_Position = projectionMatrix * mvPosition;","gl_Position = p_Position;","}"].join("\n"),fragmentShader:["varying highp vec3 vNormal;","varying highp float depth;","#if NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif",CutPlanesShaderChunk,"void main() {","#if NUM_CUTPLANES > 0","if (checkCutPlanes(vWorldPosition)) return;","#endif","vec3 n = vNormal;","n = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );","n = normalize( n );","gl_FragColor = vec4(n.x, n.y, depth, 1.0);","}"].join("\n")})}function init_BackgroundShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.BackgroundShader&&(e.BackgroundShader={uniforms:{color1:{type:"v3",value:new THREE.Vector3(41/255,76/255,120/255)},color2:{type:"v3",value:new THREE.Vector3(1/255,2/255,3/255)},envMap:{type:"t",value:null},envRotationSin:{type:"f",value:0},envRotationCos:{type:"f",value:1},exposure:{type:"f",value:1},uCamDir:{type:"v3",value:new THREE.Vector3},uCamUp:{type:"v3",value:new THREE.Vector3},uResolution:{type:"v2",value:new THREE.Vector2(600,400)},envMapBackground:{type:"i",value:0}},vertexShader:["uniform vec3 color1;","uniform vec3 color2;","varying vec2 vUv;","varying vec3 vColor;","void main() {","if (uv.y == 0.0)","vColor = color2;","else","vColor = color1;","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec3 vColor;","varying vec2 vUv;","uniform samplerCube envMap;","uniform float exposure;","uniform vec3 uCamDir;","uniform vec3 uCamUp;","uniform vec2 uResolution;","uniform bool envMapBackground;",EnvSamplingShaderChunk,"const int bloomRange = 4;",OrderedDitheringShaderChunk,"vec3 RGBMDecode(in vec4 vRGBM, in float exposure) {","vec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);","ret *= ret;","ret *= exposure;","return ret;","}","vec3 rayDir(in vec2 vUv) {","vec3 A = (uResolution.x/uResolution.y)*normalize(cross(uCamDir,uCamUp));","vec3 B = normalize(uCamUp);","vec3 C = normalize(uCamDir);","vec3 ray = normalize( C + (2.0*vUv.x-1.0)*A + (2.0*vUv.y-1.0)*B );","return ray;","}","vec4 getColor(in vec3 rd) {","return vec4(RGBMDecode(textureCube(envMap, adjustLookupVector(rd)), exposure), 1.0);","}","void main() {","vec3 rd = rayDir(vUv);","if (envMapBackground) {","gl_FragColor = getColor(rd);","}","else {","gl_FragColor = vec4(orderedDithering(vColor), 1.0);","}","}"].join("\n")})}function init_FireflyBasicShader(e){THREE.ShaderLib.firefly_basic={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap,{cutplanes:{type:"v4v",value:[]},cutplanesOutlineColor:{type:"v3",value:new THREE.Vector3(0,1,0)}}]),vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"#if NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif","void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"	#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"	#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,"#if NUM_CUTPLANES > 0","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","#endif",THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"#if NUM_CUTPLANES > 0","varying highp vec3 vWorldPosition;","#endif",CutPlanesShaderChunk,"void main() {","#if NUM_CUTPLANES > 0","if (checkCutPlanes(vWorldPosition)) return;","#endif","	vec3 outgoingLight = vec3( 0.0 );","	vec4 diffuseColor = vec4( diffuse, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"	outgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"	gl_FragColor = vec4( outgoingLight, diffuseColor.a );","}"].join("\n")}}function init_LineShader(e){"use strict"
"undefined"==typeof e.LineShader&&(e.LineShader={uniforms:{pixelsPerUnit:{type:"f",value:1},aaRange:{type:"f",value:.5},tLayerMask:{type:"t",value:null},tLineStyle:{type:"t",value:null},vLineStyleTexSize:{type:"v2",value:new THREE.Vector2(13,70)},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new THREE.Vector2(4096,1)},displayPixelRatio:{type:"f",value:1}},attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,extraParams:0,instFlags4b:0,linetype4b:0},defines:{},vertexShader:["#define TAU 6.28318530718","#define PI 3.14159265358979","#define HALF_PI 1.57079632679","#define VBB_LINE_SEGMENT     16.0","#define VBB_ARC_CIRCULAR     32.0","#define VBB_ARC_ELLIPTICAL   48.0","#define VBB_TEX_QUAD         64.0","#define VBB_ONE_TRIANGLE     80.0","#define VBB_INSTANCED_FLAG   0.0","#define VBB_SEG_START_RIGHT  1.0","#define VBB_SEG_START_LEFT   2.0","#define VBB_SEG_END_RIGHT    3.0","#define VBB_SEG_END_LEFT     4.0","attribute vec3 fields1;","attribute vec3 fields2;","attribute vec4 color4b;","attribute vec4 dbId4b;","attribute vec4 linetype4b;","attribute vec4 flags4b;","#ifdef HAS_ELLIPTICALS","attribute vec3 extraParams;","#endif","#ifdef USE_INSTANCING","attribute vec4 instFlags4b;","#endif","uniform mat4 mvpMatrix;","uniform float pixelsPerUnit;","uniform float aaRange;","#ifdef HAS_LAYERS","uniform sampler2D tLayerMask;","#endif","#ifdef SELECTION_RENDERER","uniform sampler2D tSelectionTexture;","uniform vec2 vSelTexSize;","#endif","varying vec4 outColor;","varying vec4 dbId;","vec2 centralVertex;","vec2 offsetPosition;","varying vec2 offsetDirection;","varying vec4 multipurpose;","varying float halfWidth;","void strokeLineSegment(float vertexId) {","float distanceAlong = fields2.x;","float totalDistance = fields2.z;","float isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;","float isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;","float angleTransverse = fields1.z + isLeftSide * HALF_PI;","float st = sin(angleTransverse);","float ct = cos(angleTransverse);","float lwAdjustment = halfWidth + aaRange;","vec2 transverseOffset = vec2(ct, st) * lwAdjustment;","offsetPosition.xy += transverseOffset;","float distanceFromStart = max(isStartCapVertex, 0.0) * distanceAlong;","vec2 along = distanceFromStart * vec2(cos(fields1.z), sin(fields1.z));","offsetPosition.xy += along;","centralVertex.xy += along;","vec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);","offsetPosition.xy -= moveOffset;","centralVertex.xy -= moveOffset;","multipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;","multipurpose.y = distanceAlong;","multipurpose.z = linetype4b.x;","multipurpose.w = totalDistance;","if (fields2.y < 0.0)","halfWidth = -halfWidth;","}","#ifdef HAS_TRIANGLE_GEOMS","void strokeOneTriangle(float vertexId) {","halfWidth = 0.0;","if (vertexId == VBB_SEG_END_RIGHT)","offsetPosition.xy = vec2(fields1.z, fields2.x);","else if (vertexId == VBB_SEG_END_LEFT)","offsetPosition.xy = fields2.yz;","}","#endif","#ifdef HAS_RASTER_QUADS","void strokeTexQuad(float vertexId) {","float distanceAlong = fields2.x;","bool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);","float isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;","float angleTransverse = fields1.z + isLeftSide * HALF_PI;","multipurpose.y = distanceAlong;","float st = sin(angleTransverse);","float ct = cos(angleTransverse);","float moveDist = halfWidth;","vec2 offset = vec2(ct, st) * moveDist;","offsetPosition.xy += offset;","multipurpose.z = 1.0;","halfWidth = 0.0;","if (isStartCapVertex) {","offsetPosition.xy += isLeftSide * vec2(0.0, offset.x);","multipurpose.x = 0.0;","multipurpose.y = max(0.0, isLeftSide);","}","else {","vec2 along = vec2(cos(fields1.z), sin(fields1.z));","offsetPosition.xy += distanceAlong * along;","centralVertex.xy += distanceAlong * along;","offsetPosition.xy += isLeftSide * vec2(0.0, -offset.x);","multipurpose.x = 1.0;","multipurpose.y = max(0.0, isLeftSide);","}","}","#endif","#ifdef HAS_CIRCLES","void strokeCircularArc(float vertexId) {","vec2 angles = vec2(fields1.z, fields2.x);","float r = fields2.z;","if (r * pixelsPerUnit < 0.125)","r = 0.25 * aaRange;","float isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;","float isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;","vec2 minPt;","vec2 maxPt;","vec2 endsX = vec2(fields1.x) + r * cos(angles);","vec2 endsY = vec2(fields1.y) + r * sin(angles);","minPt = maxPt = vec2(endsX.x, endsY.x);","minPt = min(minPt, vec2(endsX.y, endsY.y));","maxPt = max(maxPt, vec2(endsX.y, endsY.y));","float start = angles.x;","float end = angles.y;","if (end > start) {","if (start < (0.5 * PI) && end > (0.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y + r));","maxPt = max(maxPt, vec2(fields1.x, fields1.y + r));","}","if (start < PI && end > PI) {","minPt = min(minPt, vec2(fields1.x - r, fields1.y));","maxPt = max(maxPt, vec2(fields1.x - r, fields1.y));","}","if (start < (1.5 * PI) && end > (1.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y - r));","maxPt = max(maxPt, vec2(fields1.x, fields1.y - r));","}","}","else {","minPt = min(minPt, vec2(fields1.x + r, fields1.y));","maxPt = max(maxPt, vec2(fields1.x + r, fields1.y));","if (start < (0.5 * PI) || end > (0.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y + r));","maxPt = max(maxPt, vec2(fields1.x, fields1.y + r));","}","if (start < PI || end > PI) {","minPt = min(minPt, vec2(fields1.x - r, fields1.y));","maxPt = max(maxPt, vec2(fields1.x - r, fields1.y));","}","if (start < (1.5 * PI) || end > (1.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y - r));","maxPt = max(maxPt, vec2(fields1.x, fields1.y - r));","}","}","minPt -= halfWidth + aaRange;","maxPt += halfWidth + aaRange;","if (isStart<0.0)","offsetPosition.x = minPt.x;","else","offsetPosition.x = maxPt.x;","if (isLeft<0.0)","offsetPosition.y = minPt.y;","else","offsetPosition.y = maxPt.y;","multipurpose.x = angles.x;","multipurpose.y = -r;","multipurpose.z = angles.y;","multipurpose.w = -r;","}","#endif","#ifdef HAS_ELLIPTICALS","void strokeEllipticalArc(float vertexId) {","vec2 angles = vec2(fields1.z, fields2.x);","float isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;","float isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;","float major = fields2.z;","float minor = extraParams.x;","vec2 minPt;","vec2 maxPt;","vec2 endsX = vec2(fields1.x) + major * cos(angles);","vec2 endsY = vec2(fields1.y) + minor * sin(angles);","minPt = maxPt = vec2(endsX.x, endsY.x);","minPt = min(minPt, vec2(endsX.y, endsY.y));","maxPt = max(maxPt, vec2(endsX.y, endsY.y));","float start = angles.x;","float end = angles.y;","if (end > start) {","if (start < (0.5 * PI) && end > (0.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y + minor));","maxPt = max(maxPt, vec2(fields1.x, fields1.y + minor));","}","if (start < PI && end > PI) {","minPt = min(minPt, vec2(fields1.x - major, fields1.y));","maxPt = max(maxPt, vec2(fields1.x - major, fields1.y));","}","if (start < (1.5 * PI) && end > (1.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y - minor));","maxPt = max(maxPt, vec2(fields1.x, fields1.y - minor));","}","}","else {","minPt = min(minPt, vec2(fields1.x + major, fields1.y));","maxPt = max(maxPt, vec2(fields1.x + major, fields1.y));","if (start < (0.5 * PI) || end > (0.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y + minor));","maxPt = max(maxPt, vec2(fields1.x, fields1.y + minor));","}","if (start < PI || end > PI) {","minPt = min(minPt, vec2(fields1.x - major, fields1.y));","maxPt = max(maxPt, vec2(fields1.x - major, fields1.y));","}","if (start < (1.5 * PI) || end > (1.5 * PI)) {","minPt = min(minPt, vec2(fields1.x, fields1.y - minor));","maxPt = max(maxPt, vec2(fields1.x, fields1.y - minor));","}","}","minPt -= halfWidth + aaRange;","maxPt += halfWidth + aaRange;","if (isStart < 0.0)","offsetPosition.x = minPt.x;","else","offsetPosition.x = maxPt.x;","if (isLeft < 0.0)","offsetPosition.y = minPt.y;","else","offsetPosition.y = maxPt.y;","multipurpose.x = angles.x;","multipurpose.y = -major;","multipurpose.z = angles.y;","multipurpose.w = minor;","}","#endif","#ifdef SELECTION_RENDERER","bool isSelected() {","vec3 oid = dbId4b.rgb * 255.0;","float id01 = oid.r + oid.g * 256.0;","float t = (id01 + 0.5) * (1.0 / 4096.0);","float flrt = floor(t);","float texU = t - flrt;","float id23 = oid.b * (65536.0 / 4096.0) + flrt;","t = (id23 + 0.5) / vSelTexSize.y;","float texV = fract(t);","vec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));","return selBit.r == 1.0;","}","#endif","bool isLayerOff() {","#ifdef HAS_LAYERS","vec4 layerBit = texture2D(tLayerMask, flags4b.ba / 255.0);","return layerBit.r == 0.0;","#else","return false;","#endif","}","void main() {","centralVertex = offsetPosition = fields1.xy;","if (isLayerOff()) {","outColor = vec4(0.0);","}","else {","float vertexId = mod(flags4b.x, 16.0);","float geomType = flags4b.x - vertexId;","#ifdef USE_INSTANCING","vertexId = instFlags4b.x;","#endif","float lineWeight = fields2.y;","if (lineWeight > 0.0) {","if (lineWeight * pixelsPerUnit < 0.5)","lineWeight = 0.5 / pixelsPerUnit;","}","else {","lineWeight = abs(lineWeight) / pixelsPerUnit;","}","#ifdef SELECTION_RENDERER","if (isSelected())","outColor = vec4(0.0,0.0,1.0,1.0);","else","outColor = vec4(0.0);","#else","outColor = color4b;","#endif","halfWidth = lineWeight;","dbId = dbId4b;","if (geomType == VBB_LINE_SEGMENT)","strokeLineSegment(vertexId);","#ifdef HAS_CIRCLES","else if (geomType == VBB_ARC_CIRCULAR)","strokeCircularArc(vertexId);","#endif","#ifdef HAS_ELLIPTICALS","else if (geomType == VBB_ARC_ELLIPTICAL)","strokeEllipticalArc(vertexId);","#endif","#ifdef HAS_RASTER_QUADS","else if (geomType == VBB_TEX_QUAD)","strokeTexQuad(vertexId);","#endif","#ifdef HAS_TRIANGLE_GEOMS","else if (geomType == VBB_ONE_TRIANGLE)","strokeOneTriangle(vertexId);","#endif","else {","halfWidth = 0.0;","multipurpose.z = 0.0;","}","}","offsetDirection = offsetPosition - centralVertex;","gl_Position = mvpMatrix * modelMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );","}"].join("\n"),fragmentShader:["#define TAU 6.28318530717958","#define PI  3.14159265358979","uniform highp float pixelsPerUnit;","uniform highp float aaRange;","#ifdef HAS_RASTER_QUADS","uniform sampler2D tRaster;","#endif","#ifdef HAS_LINESTYLES","uniform sampler2D tLineStyle;","uniform vec2 vLineStyleTexSize;","#endif","varying vec4 outColor;","varying vec4 dbId;","varying vec2 offsetDirection;","varying vec4 multipurpose;","varying float halfWidth;","float curveGaussian(float r, float invWidth) {","float amt = clamp(r * invWidth, 0.0, 1.0);","float exponent = amt * 2.0;","return exp(-exponent*exponent);","}","#ifdef HAS_LINESTYLES","float getLinePatternPixel(int i, int j) {","return texture2D(tLineStyle, (vec2(i, j) + 0.5) / vLineStyleTexSize).x * 255.0;","}","float getPatternLength(int whichPattern) {","float p1 = getLinePatternPixel(0, whichPattern);","float p2 = getLinePatternPixel(1, whichPattern);","return (p2 * 256.0 + p1);","}","#endif","void fillLineSegment() {","float radius = abs(halfWidth);","float parametricDistance = multipurpose.x;","float segmentLength = multipurpose.y;","float totalDistance = multipurpose.w;","#ifdef HAS_LINESTYLES","int whichPattern = int(multipurpose.z);","if (whichPattern > 0) {","const float TEX_TO_UNIT = 1.0 / 96.0;","float LTSCALE = 1.0;","float patternScale;","if (halfWidth < 0.0) {","patternScale = LTSCALE;","} else {","patternScale = LTSCALE * TEX_TO_UNIT * pixelsPerUnit;","}","float patLen = patternScale * getPatternLength(whichPattern);","float phase = mod((totalDistance + parametricDistance) * pixelsPerUnit, patLen);","bool onPixel = true;","float radiusPixels = radius * pixelsPerUnit;","for (int i=2; i<MAX_LINESTYLE_LENGTH; i+=2) {","float on = getLinePatternPixel(i, whichPattern);","if (on == 1.0) on = 0.0;","on *= patternScale;","onPixel = true;","phase -= on;","if (phase < 0.0) {","break;","}","else if (phase <= radiusPixels) {","onPixel = false;","break;","}","float off = getLinePatternPixel(i+1, whichPattern);","if (off <= 1.0) off = 0.0;","off *= patternScale;","onPixel = false;","phase -= off;","if (phase < -radiusPixels)","discard;","if (phase <= 0.0)","break;","}","if (!onPixel && (abs(phase) <= radiusPixels)) {","segmentLength = 0.0;","parametricDistance = phase / pixelsPerUnit;","}","}","#endif","float dist;","float offsetLength2 = dot(offsetDirection, offsetDirection);","float ltz = max(0.0, sign(-parametricDistance));","float gtsl = max(0.0, sign(parametricDistance - segmentLength));","float d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);","dist = sqrt(max(0.0, offsetLength2 + d*d));","float range =  dist - radius;","if (range > aaRange) {","discard;","}","gl_FragColor = outColor;","gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);","}","#ifdef HAS_CIRCLES","void fillCircularArc() {","float dist = length(offsetDirection);","float radius = abs(multipurpose.y);","float range =  abs(dist - radius);","range -= halfWidth;","if (range > aaRange) {","discard;","}","vec2 angles = multipurpose.xz;","vec2 direction = offsetDirection;","float angle = atan(direction.y, direction.x);","if (angles.x > angles.y)","angles.x -= TAU;","else if (angle < 0.0)","angle += TAU;","if (angle > angles.x && angle < angles.y) {","gl_FragColor = outColor;","gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);","}","else {","discard;","}","}","#endif","#ifdef HAS_ELLIPTICALS","float DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {","float dist;","vec2 esqr = e * e;","vec2 ey = e * y;","float t0 = -esqr[1] + ey[1];","float t1 = -esqr[1] + length(ey);","float t;","vec2 r;","for (int i = 0; i < 6; ++i) {","t = mix(t0, t1, 0.5);//0.5*(t0 + t1);","r = ey / (vec2(t) + esqr);","vec2 rsq = r * r;","float f = rsq[0] + rsq[1] - 1.0;","float fsign = sign(f);","t0 = mix(t0, t, max(0.0, fsign));","t1 = mix(t1, t, max(0.0, -fsign));","}","x = e * r;","dist = distance(x, y);","if (dist > max(2.0 * (width + aaRange), e[0] * 0.05))","return dist;","for (int i = 0; i < 6; ++i) {","t = mix(t0, t1, 0.5);//0.5*(t0 + t1);","r = ey / (vec2(t) + esqr);","vec2 rsq = r * r;","float f = rsq[0] + rsq[1] - 1.0;","float fsign = sign(f);","t0 = mix(t0, t, max(0.0, fsign));","t1 = mix(t1, t, max(0.0, -fsign));","}","x = e * r;","dist = distance(x, y);","float ecc = 1.0 +  0.1 * e[0] / e[1];","if (dist > max(ecc * (width + aaRange), e[0] * 0.001))","return dist;","if (dist < (width - aaRange) / ecc)","return dist;","for (int i = 0; i < 10; ++i) {","t = mix(t0, t1, 0.5);//0.5*(t0 + t1);","r = ey / (vec2(t) + esqr);","vec2 rsq = r * r;","float f = rsq[0] + rsq[1] - 1.0;","float fsign = sign(f);","t0 = mix(t0, t, max(0.0, fsign));","t1 = mix(t1, t, max(0.0, -fsign));","}","x = e * r;","dist = distance(x, y);","return dist;","}","float DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {","vec2 locE, locY;","float diff = sign(e[0] - e[1]);","vec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));","locE.x = dot(e, swizzle.xy);","locE.y = dot(e, swizzle.yx);","locY.x = dot(y, swizzle.xy);","locY.y = dot(y, swizzle.yx);","vec2 refl = sign(locY);","locY *= refl;","vec2 x;","float distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);","x *= refl;","locX.x = dot(x, swizzle.xy);","locX.y = dot(x, swizzle.yx);","return distance;","}","void fillEllipticalArc() {","vec2 radii = abs(multipurpose.yw);","vec2 dir = offsetDirection;","vec2 pos;","float range = DistancePointEllipse(radii, dir, pos, halfWidth, aaRange);","range -= halfWidth;","if (range > aaRange)","discard;","float ar = radii[0] / radii[1];","vec2 angles = multipurpose.xz;","float angle = atan(ar * pos.y, pos.x);","if (angles.x > angles.y)","angles.x -= TAU;","else if (angle < 0.0)","angle += TAU;","if (angle > angles.x && angle < angles.y) {","gl_FragColor = outColor;","gl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);","}","else {","discard;","}","}","#endif","void main() {","if (outColor.a == 0.0) {","discard;","}","if (halfWidth == 0.0) {","#ifdef HAS_RASTER_QUADS","if (multipurpose.z != 0.0)","gl_FragColor = texture2D(tRaster, multipurpose.xy);","else","#endif","gl_FragColor = outColor;","}","else if (multipurpose.y < 0.0) {","#ifdef HAS_CIRCLES","#ifdef HAS_ELLIPTICALS","if (multipurpose.y == multipurpose.w)","#endif","fillCircularArc();","#endif","#ifdef HAS_ELLIPTICALS","#ifdef HAS_CIRCLES","else","#endif","fillEllipticalArc();","#endif","}","else","fillLineSegment();","#ifdef MRT_NORMALS","gl_FragData[1] = vec4(0, 0, 0, 0.0);","#endif","#ifdef MRT_ID_BUFFER","#ifdef MRT_NORMALS","const int index = 2;","#else","const int index = 1;","#endif","gl_FragData[index] = vec4(dbId.rgb, 1.0);","#elif defined(ID_COLOR)","gl_FragColor = dbId;","#endif","}"].join("\n")})}function init_GroundShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.GroundDepthShader&&(e.GroundDepthShader={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:["#ifdef USE_LOGDEPTHBUF","    #ifdef USE_LOGDEPTHBUF_EXT","        varying float vFragDepth;","    #endif","    uniform float logDepthBufFC;","#endif","#if NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif","void main() {","    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;","#if NUM_CUTPLANES > 0","    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","    vWorldPosition = worldPosition.xyz;","#endif","#ifdef USE_LOGDEPTHBUF","    gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;","    #ifdef USE_LOGDEPTHBUF_EXT","        vFragDepth = 1.0 + gl_Position.w;","    #else","        gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;","    #endif","#endif","}"].join("\n"),fragmentShader:["#ifdef USE_LOGDEPTHBUF","    uniform float logDepthBufFC;","    #ifdef USE_LOGDEPTHBUF_EXT","        #extension GL_EXT_frag_depth : enable","        varying float vFragDepth;","    #endif","#endif",PackDepthShaderChunk,"#if NUM_CUTPLANES > 0","varying vec3 vWorldPosition;","#endif",CutPlanesShaderChunk,"void main() {","#if NUM_CUTPLANES > 0","if (checkCutPlanes(vWorldPosition)) return;","#endif","#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)","gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;","#endif","#ifdef USE_LOGDEPTHBUF_EXT","float depth = gl_FragDepthEXT / gl_FragCoord.w;","#else","float depth = gl_FragCoord.z / gl_FragCoord.w;","#endif","depth = 1.0 - depth;","gl_FragColor = packDepth(depth);","}"].join("\n")},e.GroundShadowAOShader={uniforms:{tDepth:{type:"t",value:null},worldSize:{type:"v3",value:new THREE.Vector3(1,1,1)}},defines:{},vertexShader:["varying vec2 vUv;","void main() {","vUv = vec2(uv.x, uv.y);","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define NUM_SAMPLES 29.0","#define NUM_SPIRAL_TURNS 7.0","uniform sampler2D tDepth;","uniform vec3 worldSize;","varying vec2 vUv;","#ifdef PRESET_2","#define SAMPLE_RADIUS 0.3","#define AO_GAMMA 1.0","#define AO_INTENSITY 1.0","#else","#define SAMPLE_RADIUS 0.2","#define AO_GAMMA 3.0","#define AO_INTENSITY 0.8","#endif",PackDepthShaderChunk,"#define PI 3.14159265358979","float rand(vec2 co) {","return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);","}","float getRandomAngle(vec2 pos) {","return rand(pos) * (2.0 * PI);","}","vec2 tapLocation(float sampleNumber, float spinAngle, out float ssR){","float alpha = float(sampleNumber + 0.5) * (1.0 / NUM_SAMPLES);","float angle = alpha * (NUM_SPIRAL_TURNS * PI * 2.0) + spinAngle;","ssR = alpha;","return vec2(cos(angle), sin(angle));","}","vec2 sampleAO(vec2 unitDirection, float radius) {","vec2 sampleOffset = unitDirection * radius;","float idepth = unpackDepth(texture2D(tDepth, vUv + sampleOffset));","float depth = 1.0 - idepth;","if (depth < 1e-6) {","if (radius == 0.0)","return vec2(1.0, 1.0);","else","return vec2(0.0, 1.0);","}","vec3 dir = vec3(sampleOffset.x, depth, sampleOffset.y) * worldSize;","float distance2 = dot(dir,dir);","float idistance = 1.0 / sqrt(distance2);","vec3 ndir = dir * idistance;","#ifdef PRESET_2","float importance = ndir.y * idistance;","#else","float importance = ndir.y / distance2;","#endif","vec2 ret;","ret.x = (idepth == 0.0) ? 0.0 : importance;","ret.y = importance;","return ret;","}","void main() {","vec2 sum = vec2(0.0);","float angle = getRandomAngle(vUv);","for (float i = 0.0; i<NUM_SAMPLES; i+= 1.0) {","float ssR;","vec2 uv = tapLocation(i, angle, ssR);","sum += sampleAO(uv, ssR * SAMPLE_RADIUS);","}","float ao = sum.x / sum.y;","gl_FragColor = packDepth(AO_INTENSITY * clamp(pow(ao, AO_GAMMA), 0.0, 0.9999));","}"].join("\n")},e.GroundShadowBlurShader={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:["varying vec2 vUv;","void main() {","vUv = vec2(uv.x, uv.y);","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D tDepth;","varying vec2 vUv;","#ifdef HORIZONTAL","#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE*(X), vUv.y)","#else","#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE*(Y))","#endif",PackDepthShaderChunk,"#define PI 3.14159265358979","#define SIGMA ((2.0 * KERNEL_RADIUS+1.0) / 6.0)","#define SIGMASQ2 (2.0 * SIGMA * SIGMA)","#ifdef BOX","#define KERNEL_VAL(X) 1.0","#else","#define KERNEL_VAL(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )","#endif","void main() {","float depthVal = 0.0;","float sum = 0.0;","for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {","depthVal += unpackDepth(texture2D(tDepth, GET_UV(x))) * KERNEL_VAL(x);","sum += KERNEL_VAL(x);","}","gl_FragColor = packDepth(depthVal/sum);","}"].join("\n")},e.GroundShadowColorShader={uniforms:{tDepth:{type:"t",value:null},uShadowColor:{type:"v4",value:new THREE.Vector4(0,0,0,1)}},vertexShader:["varying vec2 vUv;","void main() {","    vUv = vec2(uv.x, uv.y);","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D tDepth;","uniform vec4 uShadowColor;","varying vec2 vUv;",PackDepthShaderChunk,"void main() {","float depthVal = unpackDepth(texture2D(tDepth, vUv));","gl_FragColor = vec4(uShadowColor.rgb, uShadowColor.a * depthVal);","}"].join("\n")})}function init_GroundReflectionShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.GroundReflectionCompShader&&(e.GroundReflectionCompShader={uniforms:{tDiffuse:{type:"t",value:null},tBackground:{type:"t",value:null},uColor:{type:"v4",value:new THREE.Vector4(1,1,1,1)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tBackground;","uniform vec4 uColor;","varying vec2 vUv;","void main() {","vec4 bgCol = texture2D( tBackground, vUv );","vec4 diffCol = uColor * texture2D( tDiffuse, vUv );","gl_FragColor = mix(bgCol, diffCol, diffCol.a);","}"].join("\n")},e.GroundReflectionDrawShader={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = texel;","}"].join("\n")})}function init_GaussianShader(){"use strict"
var e=Autodesk.Viewing.Shaders
"undefined"==typeof e.GaussianShader&&(e.GaussianShader={uniforms:{tDiffuse:{type:"t",value:null},uColor:{type:"v4",value:new THREE.Vector4(1,1,1,1)}},vertexShader:["varying vec2 vUv;","void main() {","#if defined(HORIZONTAL) && defined(FLIP_UV)","    vUv = vec2(uv.x, 1.0-uv.y);","#else","    vUv = vec2(uv.x, uv.y);","#endif","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec4 uColor;","varying vec2 vUv;","#ifdef HORIZONTAL","    #define GET_UV(X) vec2(vUv.x + KERNEL_SCALE_H*(X), vUv.y)","#else","    #define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE_V*(Y))","#endif","#define PI 3.14159265358979","#define SIGMA ((KERNEL_RADIUS+KERNEL_RADIUS+1.0) / 6.0)","#define SIGMASQ2 (2.0 * SIGMA * SIGMA)","#define GAUSSIAN(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )","void main() {","    vec4 texColSum = vec4(0.0);","    float gaussSum = 0.0;","    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {","        float gauss = GAUSSIAN(x);","        vec4 texCol = texture2D(tDiffuse, GET_UV(x));","        #ifdef HAS_ALPHA","            texCol.rgb *= texCol.a;","        #endif","        texColSum += texCol * gauss;","        gaussSum += gauss;","    }","    #ifdef HAS_ALPHA","        texColSum.rgb /= texColSum.a;","    #endif","#ifdef HORIZONTAL","    gl_FragColor = texColSum/gaussSum;","#else","    gl_FragColor = texColSum/gaussSum * uColor;","#endif","}"].join("\n")})}function init_UnifiedCamera(){if("undefined"==typeof Autodesk.Viewing.UnifiedCamera){var e=function(e,t){THREE.Camera.call(this),this.fov=45,this.near=.1,this.far=1e5,this.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.clientWidth=e,this.clientHeight=t,this.target=new THREE.Vector3(0,0,-1),this.worldup=new THREE.Vector3(0,1,0),this.orthographicCamera=new THREE.OrthographicCamera(this.left,this.right,this.top,this.bottom,this.near,this.far),this.perspectiveCamera=new THREE.PerspectiveCamera(this.fov,this.aspect,this.near,this.far),this.zoom=1,this.toPerspective()}
e.ORTHO_FOV=2*Math.atan(.5)*180/Math.PI,e.prototype=Object.create(THREE.Camera.prototype),e.prototype.clone=function(){var t=new e(2*this.right,2*this.top)
return THREE.Camera.prototype.clone.call(this,t),t.position.copy(this.position),t.up.copy(this.up),this.target&&(t.target=this.target.clone()),this.worldup&&(t.worldup=this.worldup.clone()),this.worldUpTransform&&(t.worldUpTransform=this.worldUpTransform.clone()),t.left=this.left,t.right=this.right,t.top=this.top,t.bottom=this.bottom,t.near=this.near,t.far=this.far,t.fov=this.fov,t.aspect=this.aspect,t.zoom=this.zoom,t.isPerspective=this.isPerspective,this.updateProjectionMatrix(),t},e.prototype.__computeFovPosition=function(e){if(Math.abs(this.fov-e)<=1e-4)return this.position.clone()
var t=this.target.clone().sub(this.position),i=THREE.Math.degToRad(this.fov),n=THREE.Math.degToRad(e),o=t.length()*Math.tan(.5*i)/Math.tan(.5*n),r=t.normalize().multiplyScalar(-o)
return this.target.clone().add(r)},e.prototype.toPerspective=function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov),this.perspectiveCamera.aspect=this.aspect,this.perspectiveCamera.near=this.near,this.perspectiveCamera.far=this.far,this.perspectiveCamera.fov=this.fov/this.zoom,this.perspectiveCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspectiveCamera.projectionMatrix,this.isPerspective=!0},e.prototype.toOrthographic=function(){if(this.isPerspective){this.saveFov=this.fov
var t=e.ORTHO_FOV
this.position.copy(this.__computeFovPosition(t)),this.fov=t}this.orthoScale=this.target.clone().sub(this.position).length()
var i=.5*this.orthoScale,n=i*this.aspect
this.left=this.orthographicCamera.left=-n,this.right=this.orthographicCamera.right=n,this.top=this.orthographicCamera.top=i,this.bottom=this.orthographicCamera.bottom=-i,this.orthographicCamera.near=this.near,this.orthographicCamera.far=this.far,this.orthographicCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthographicCamera.projectionMatrix,this.isPerspective=!1},e.prototype.updateProjectionMatrix=function(){this.isPerspective?this.toPerspective():this.toOrthographic()},e.prototype.setSize=function(e,t){this.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},e.prototype.setFov=function(e){this.fov=e,this.updateProjectionMatrix()},e.prototype.setLens=function(e,t){void 0===t&&(t=24)
var i=2*THREE.Math.radToDeg(Math.atan(t/(2*e)))
return this.setFov(i),i},e.prototype.getCameraChangedEvent=function(){return{type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:this}},Autodesk.Viewing.UnifiedCamera=e}}function stringToDOM(e){var t=document.createElement("div")
return t.innerHTML=e,t.firstChild}function MobileCallbacks(){this.ios=window.webkit,this.android=window.JSINTERFACE,this.iosSend=function(e,t){window.webkit.messageHandlers.callbackHandler.postMessage({command:e,data:t})},this.androidSend=window.JSINTERFACE}function init_WarpShader(){"undefined"==typeof window.WarpShader&&(WarpShader={uniforms:{tDiffuse:{type:"t",value:null},scale:{type:"v2",value:new THREE.Vector2(1,1)},scaleIn:{type:"v2",value:new THREE.Vector2(1,1)},lensCenter:{type:"v2",value:new THREE.Vector2(0,0)},hmdWarpParam:{type:"v4",value:new THREE.Vector4(1,.22,.24,0)},chromAbParam:{type:"v4",value:new THREE.Vector4(.996,-.004,1.014,0)}},defines:{},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 scale;","uniform vec2 scaleIn;","uniform vec2 lensCenter;","uniform vec4 hmdWarpParam;","uniform vec4 chromAbParam;","varying vec2 vUv;","vec4 sampleColor() {","vec2 uv = (vUv*2.0)-1.0;","vec2 theta = (uv-lensCenter)*scaleIn;","float rSq = theta.x*theta.x + theta.y*theta.y;","vec2 rvector = theta*(hmdWarpParam.x + hmdWarpParam.y*rSq + hmdWarpParam.z*rSq*rSq + hmdWarpParam.w*rSq*rSq*rSq);","  vec2 rBlue = rvector * (chromAbParam.z + chromAbParam.w * rSq);","  vec2 tcBlue = (lensCenter + scale * rBlue);","  tcBlue = (tcBlue+1.0)/2.0;","  if (any(bvec2(clamp(tcBlue, vec2(0.0,0.0), vec2(1.0,1.0))-tcBlue)))","    return vec4(0.0, 0.0, 0.0, 1.0);","  vec2 tcGreen = lensCenter + scale * rvector;","  tcGreen = (tcGreen+1.0)/2.0;","  vec2 rRed = rvector * (chromAbParam.x + chromAbParam.y * rSq);","  vec2 tcRed = lensCenter + scale * rRed;","  tcRed = (tcRed+1.0)/2.0;","  return vec4(texture2D(tDiffuse, tcRed).r, texture2D(tDiffuse, tcGreen).g, texture2D(tDiffuse, tcBlue).b, 1);","}","void main() {","vec4 texel = sampleColor();","gl_FragColor = texel;","}"].join("\n")})}function init_SectionMesh(){Autodesk.Viewing.Extensions.Section.SectionMesh||(Autodesk.Viewing.Extensions.Section.SectionMesh=function(e,t,i){THREE.Mesh.call(this,e,t,!1),this.plane=i,this.planeVec=new THREE.Vector4(i.normal.x,i.normal.y,i.normal.z,i.constant),this.connectivity=[],this.outlines=[]},Autodesk.Viewing.Extensions.Section.SectionMesh.prototype=Object.create(THREE.Mesh.prototype),Autodesk.Viewing.Extensions.Section.SectionMesh.prototype.constructor=Autodesk.Viewing.Extensions.Section.SectionMesh,Autodesk.Viewing.Extensions.Section.SectionMesh.prototype.update=function(){this.plane.normal.set(0,0,1),this.plane.normal.applyQuaternion(this.quaternion)
var e=this.plane.normal,t=-1*this.getWorldPosition().dot(e)
this.planeVec.set(e.x,e.y,e.z,t),this.plane.constant=t})}function init_TransformGizmos(){"use strict"
var e=function(e){THREE.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=THREE.FrontSide,this.transparent=!0,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}}
e.prototype=Object.create(THREE.MeshBasicMaterial.prototype)
var t=function(e){THREE.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=1,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}}
t.prototype=Object.create(THREE.LineBasicMaterial.prototype),void 0===THREE.PolyhedronGeometry&&(THREE.PolyhedronGeometry=function(e,t,i,n){function o(e){var t=e.normalize().clone()
t.index=u.vertices.push(t)-1
var i=s(e)/2/Math.PI+.5,n=l(e)/Math.PI+.5
return t.uv=new THREE.Vector2(i,1-n),t}function r(e,t,i){var n=new THREE.Face3(e.index,t.index,i.index,[e.clone(),t.clone(),i.clone()])
u.faces.push(n),y.copy(e).add(t).add(i).divideScalar(3)
var o=s(y)
u.faceVertexUvs[0].push([c(e.uv,e,o),c(t.uv,t,o),c(i.uv,i,o)])}function a(e,t){for(var i=Math.pow(2,t),n=(Math.pow(4,t),o(u.vertices[e.a])),a=o(u.vertices[e.b]),s=o(u.vertices[e.c]),l=[],c=0;i>=c;c++){l[c]=[]
for(var d=o(n.clone().lerp(s,c/i)),h=o(a.clone().lerp(s,c/i)),p=i-c,f=0;p>=f;f++)0==f&&c==i?l[c][f]=d:l[c][f]=o(d.clone().lerp(h,f/p))}for(var c=0;i>c;c++)for(var f=0;2*(i-c)-1>f;f++){var m=Math.floor(f/2)
f%2==0?r(l[c][m+1],l[c+1][m],l[c][m]):r(l[c][m+1],l[c+1][m+1],l[c+1][m])}}function s(e){return Math.atan2(e.z,-e.x)}function l(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}function c(e,t,i){return 0>i&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(i/2/Math.PI+.5,e.y)),e.clone()}THREE.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},i=i||1,n=n||0
for(var u=this,d=0,h=e.length;h>d;d+=3)o(new THREE.Vector3(e[d],e[d+1],e[d+2]))
for(var p=this.vertices,f=[],d=0,m=0,h=t.length;h>d;d+=3,m++){var v=p[t[d]],g=p[t[d+1]],E=p[t[d+2]]
f[m]=new THREE.Face3(v.index,g.index,E.index,[v.clone(),g.clone(),E.clone()])}for(var y=new THREE.Vector3,d=0,h=f.length;h>d;d++)a(f[d],n)
for(var d=0,h=this.faceVertexUvs[0].length;h>d;d++){var A=this.faceVertexUvs[0][d],T=A[0].x,b=A[1].x,w=A[2].x,_=Math.max(T,Math.max(b,w)),x=Math.min(T,Math.min(b,w))
_>.9&&.1>x&&(.2>T&&(A[0].x+=1),.2>b&&(A[1].x+=1),.2>w&&(A[2].x+=1))}for(var d=0,h=this.vertices.length;h>d;d++)this.vertices[d].multiplyScalar(i)
this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,i)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype)),void 0===THREE.OctahedronGeometry&&(THREE.OctahedronGeometry=function(e,t){this.parameters={radius:e,detail:t}
var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2]
THREE.PolyhedronGeometry.call(this,i,n,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype)),void 0===THREE.TorusGeometry&&(THREE.TorusGeometry=function(e,t,i,n,o){THREE.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:o},e=e||100,t=t||40,i=i||8,n=n||6,o=o||2*Math.PI
for(var r=new THREE.Vector3,a=[],s=[],l=0;i>=l;l++)for(var c=0;n>=c;c++){var u=c/n*o,d=l/i*Math.PI*2
r.x=e*Math.cos(u),r.y=e*Math.sin(u)
var h=new THREE.Vector3
h.x=(e+t*Math.cos(d))*Math.cos(u),h.y=(e+t*Math.cos(d))*Math.sin(u),h.z=t*Math.sin(d),this.vertices.push(h),a.push(new THREE.Vector2(c/n,l/i)),s.push(h.clone().sub(r).normalize())}for(var l=1;i>=l;l++)for(var c=1;n>=c;c++){var p=(n+1)*l+c-1,f=(n+1)*(l-1)+c-1,m=(n+1)*(l-1)+c,v=(n+1)*l+c,g=new THREE.Face3(p,f,v,[s[p].clone(),s[f].clone(),s[v].clone()])
this.faces.push(g),this.faceVertexUvs[0].push([a[p].clone(),a[f].clone(),a[v].clone()]),g=new THREE.Face3(f,m,v,[s[f].clone(),s[m].clone(),s[v].clone()]),this.faces.push(g),this.faceVertexUvs[0].push([a[f].clone(),a[m].clone(),a[v].clone()])}this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype))
var i=function(e,t,i){var n=new THREE.Geometry
i=i?i:1
for(var o=0;64*i>=o;++o)"x"==t&&n.vertices.push(new THREE.Vector3(0,Math.cos(o/32*Math.PI),Math.sin(o/32*Math.PI)).multiplyScalar(e)),"y"==t&&n.vertices.push(new THREE.Vector3(Math.cos(o/32*Math.PI),0,Math.sin(o/32*Math.PI)).multiplyScalar(e)),"z"==t&&n.vertices.push(new THREE.Vector3(Math.sin(o/32*Math.PI),Math.cos(o/32*Math.PI),0).multiplyScalar(e))
return n},n=function(e,t,i,n,o,r){var a=new THREE.Geometry,s=new THREE.Mesh(new THREE.CylinderGeometry(e,t,i,n,o,r))
return s.position.y=.5,s.updateMatrix(),a.merge(s.geometry,s.matrix),a},o=function(e){var t=new THREE.Geometry
return"X"===e?t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0)):"Y"===e?t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0)):"Z"===e&&t.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),t}
THREE.TransformGizmo=function(){var e=this,t=!1,i=!1
this.init=function(){THREE.Object3D.call(this),this.handles=new THREE.Object3D,this.pickers=new THREE.Object3D,this.planes=new THREE.Object3D,this.highlights=new THREE.Object3D,this.hemiPicker=new THREE.Object3D,this.subPickers=new THREE.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes),this.add(this.highlights),this.add(this.hemiPicker),this.add(this.subPickers)
var e=new THREE.PlaneBufferGeometry(50,50,2,2),t=new THREE.MeshBasicMaterial({wireframe:!0})
t.side=THREE.DoubleSide
var i={XY:new THREE.Mesh(e,t),YZ:new THREE.Mesh(e,t),XZ:new THREE.Mesh(e,t),XYZE:new THREE.Mesh(e,t)}
this.activePlane=i.XYZE,i.YZ.rotation.set(0,Math.PI/2,0),i.XZ.rotation.set(-Math.PI/2,0,0)
for(var n in i)i[n].name=n,this.planes.add(i[n]),this.planes[n]=i[n],i[n].visible=!1
this.setupGizmos(),this.activeMode="",this.traverse(function(e){if(e instanceof THREE.Mesh){e.updateMatrix()
var t=new THREE.Geometry
e.geometry instanceof THREE.BufferGeometry&&(e.geometry=(new THREE.Geometry).fromBufferGeometry(e.geometry)),t.merge(e.geometry,e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}})},this.hide=function(){this.traverse(function(e){e.visible=!1})},this.show=function(){this.traverse(function(i){i.visible=!0,(i.parent==e.pickers||i.parent==e.hemiPicker)&&(i.visible=t),i.parent==e.planes&&(i.visible=!1)}),this.activePlane.visible=i},this.highlight=function(e){this.traverse(function(t){t.material&&t.material.highlight&&(t.name==e?t.material.highlight(!0):t.material.highlight(!1))})},this.setupGizmos=function(){var e=function(e,t){for(var i in e)for(var n=e[i].length;n--;){var o=e[i][n][0],r=e[i][n][1],a=e[i][n][2],s=e[i][n][3]
o.name=i,r&&o.position.set(r[0],r[1],r[2]),a&&o.rotation.set(a[0],a[1],a[2]),s&&(o.visble=s),t.add(o)}}
this.setHandlePickerGizmos(),e(this.handleGizmos,this.handles),e(this.pickerGizmos,this.pickers),e(this.highlightGizmos,this.highlights),e(this.hemiPickerGizmos,this.hemiPicker),e(this.subPickerGizmos,this.subPickers),this.hide(),this.show()}},THREE.TransformGizmo.prototype=Object.create(THREE.Object3D.prototype),THREE.TransformGizmo.prototype.update=function(e,t){var i=new THREE.Vector3(0,0,0),n=new THREE.Vector3(0,1,0),o=new THREE.Matrix4
this.traverse(function(r){r.name&&(-1!=r.name.search("E")?r.quaternion.setFromRotationMatrix(o.lookAt(t,i,n)):(-1!=r.name.search("X")||-1!=r.name.search("Y")||-1!=r.name.search("Z"))&&r.quaternion.setFromEuler(e))})},THREE.TransformGizmoTranslate=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){var i=n(0,.05,.2,12,1,!1),r=o("X"),a=o("Y"),s=o("Z")
this.handleGizmos={X:[[new THREE.Mesh(i,new e({color:15805484})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(r,new t({color:15805484}))]],Y:[[new THREE.Mesh(i,new e({color:768011})),[0,.5,0]],[new THREE.Line(a,new t({color:768011}))]],Z:[[new THREE.Mesh(i,new e({color:2895089})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(s,new t({color:2895089}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new e({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new e({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new e({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new e({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),new e({color:16777215,opacity:.25}))]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new e({color:16776960,opacity:.25})),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new e({color:65535,opacity:.25})),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new e({color:16711935,opacity:.25})),[.2,0,.2],[-Math.PI/2,0,0]]]},this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(1.2,1.2,1.2),new e({color:255})),[.5,.5,.5],null,!1]]}},this.setActivePlane=function(e,t){var i=new THREE.Matrix4
t.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"==e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"==e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"==e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==e&&(this.activePlane=this.planes.XYZE),"XY"==e&&(this.activePlane=this.planes.XY),"YZ"==e&&(this.activePlane=this.planes.YZ),"XZ"==e&&(this.activePlane=this.planes.XZ),this.hide(),this.show()},this.init()},THREE.TransformGizmoTranslate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoRotate=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){this.handleGizmos={RX:[[new THREE.Line(i(1,"x",.5),new t({color:16711680}))]],RY:[[new THREE.Line(i(1,"y",.5),new t({color:65280}))]],RZ:[[new THREE.Line(i(1,"z",.5),new t({color:255}))]],RE:[[new THREE.Line(i(1.25,"z",1),new t({color:65535}))]],RXYZE:[[new THREE.Line(i(1,"z",1),new t({color:16711935}))]]},this.pickerGizmos={RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new e({color:16711680,opacity:.25})),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new e({color:65280,opacity:.25})),[0,0,0],[Math.PI/2,0,0]]],RZ:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new e({color:255,opacity:.25})),[0,0,0],[0,0,-Math.PI/2]]],RE:[[new THREE.Mesh(new THREE.TorusGeometry(1.25,.12,2,24),new e({color:65535,opacity:.25}))]],RXYZE:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,2,24),new e({color:16711935,opacity:.25}))]]}},this.setActivePlane=function(e){"RE"==e&&(this.activePlane=this.planes.XYZE),"RX"==e&&(this.activePlane=this.planes.YZ),"RY"==e&&(this.activePlane=this.planes.XZ),"RZ"==e&&(this.activePlane=this.planes.XY),this.hide(),this.show()},this.update=function(e,t){THREE.TransformGizmo.prototype.update.apply(this,arguments)
var i=new THREE.Matrix4,n=new THREE.Euler(0,0,1),o=new THREE.Quaternion,r=new THREE.Vector3(1,0,0),a=new THREE.Vector3(0,1,0),s=new THREE.Vector3(0,0,1),l=new THREE.Quaternion,c=new THREE.Quaternion,u=new THREE.Quaternion,d=t.clone()
n.copy(this.planes.XY.rotation),o.setFromEuler(n),i.makeRotationFromQuaternion(o).getInverse(i),d.applyMatrix4(i),this.traverse(function(e){o.setFromEuler(n),"RX"==e.name&&(l.setFromAxisAngle(r,Math.atan2(-d.y,d.z)),o.multiplyQuaternions(o,l),e.quaternion.copy(o)),"RY"==e.name&&(c.setFromAxisAngle(a,Math.atan2(d.x,d.z)),o.multiplyQuaternions(o,c),e.quaternion.copy(o)),"RZ"==e.name&&(u.setFromAxisAngle(s,Math.atan2(d.y,d.x)),o.multiplyQuaternions(o,u),e.quaternion.copy(o))})},this.init()},THREE.TransformGizmoRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoTranslateRotate=function(){THREE.TransformGizmo.call(this)
var t=this
this.setHandlePickerGizmos=function(){var t=n(0,.05,.2,12,1,!1),i=new THREE.Geometry
i.vertices.push(new THREE.Vector3(0,0,-.1),new THREE.Vector3(0,0,.1),new THREE.Vector3(-.1,0,0),new THREE.Vector3(.1,0,0))
var o=.15
this.handleGizmos={Z:[[new THREE.Mesh(t,new e({color:16777215})),[0,0,.25],[Math.PI/2,0,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.015,.015,.6,4,1,!1),new e({color:16777215})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,2*o*Math.PI),new e({color:16711680})),[0,0,0],[o*Math.PI,-Math.PI/2,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.015,60,1,!1),new e({color:16711680})),[0,0,1],[Math.PI/2,0,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,2*o*Math.PI),new e({color:255})),[0,0,0],[Math.PI/2,0,(.5-o)*Math.PI]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.01,60,1,!1),new e({color:255})),[0,0,1]]]},this.pickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new e({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,2*o*Math.PI),new e({color:16711680,opacity:.25})),[0,0,0],[o*Math.PI,-Math.PI/2,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,2*o*Math.PI),new e({color:255,opacity:.25})),[0,0,0],[Math.PI/2,0,(.5-o)*Math.PI]]]},this.subPickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new e({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]]},this.highlightGizmos={Z:[],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new e({color:16711680,opacity:1})),[0,0,0],[0,-Math.PI/2,-Math.PI/2],!1]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new e({color:255,opacity:1})),[0,0,0],[Math.PI/2,0,0],!1]]},this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.SphereGeometry(1.2,8,8,0,Math.PI),new e({color:255})),null,null,!1]]}},this.setActivePlane=function(e,t){if("translate"==this.activeMode){var i=new THREE.Matrix4
t.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"==e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"==e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"==e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ))}else"rotate"==this.activeMode&&("RX"==e&&(this.activePlane=this.planes.YZ),"RY"==e&&(this.activePlane=this.planes.XZ),"RZ"==e&&(this.activePlane=this.planes.XY))
this.hide(),this.show()},this.update=function(e,t){if("translate"==this.activeMode)THREE.TransformGizmo.prototype.update.apply(this,arguments)
else if("rotate"==this.activeMode){THREE.TransformGizmo.prototype.update.apply(this,arguments)
var i=new THREE.Matrix4,n=new THREE.Euler(0,0,1),o=new THREE.Quaternion,r=new THREE.Vector3(1,0,0),a=new THREE.Vector3(0,1,0),s=new THREE.Vector3(0,0,1),l=new THREE.Quaternion,c=new THREE.Quaternion,u=new THREE.Quaternion,d=t.clone()
n.copy(this.planes.XY.rotation),o.setFromEuler(n),i.makeRotationFromQuaternion(o).getInverse(i),d.applyMatrix4(i),this.traverse(function(e){o.setFromEuler(n),"RX"==e.name&&(l.setFromAxisAngle(r,Math.atan2(-d.y,d.z)),o.multiplyQuaternions(o,l),e.quaternion.copy(o)),"RY"==e.name&&(c.setFromAxisAngle(a,Math.atan2(d.x,d.z)),o.multiplyQuaternions(o,c),e.quaternion.copy(o)),"RZ"==e.name&&(u.setFromAxisAngle(s,Math.atan2(d.y,d.x)),o.multiplyQuaternions(o,u),e.quaternion.copy(o))})}},this.show=function(){this.traverse(function(e){(null==t.parent||t.parent.useAllPickers||e.parent!=t.handles)&&(e.visible=!0),e.material&&(e.material.opacity=e.material.oldOpacity),(e.parent==t.pickers||e.parent==t.hemiPicker||e.parent==t.subPickers)&&(e.visible=!1),(e.parent==t.planes||e.parent==t.highlights)&&(e.visible=!1)}),this.activePlane.visible=!1},this.highlight=function(e){this.traverse(function(i){i.material&&i.material.highlight&&(i.name==e?((i.parent==t.highlights||i.parent==t.handles)&&(i.visible=!0),i.material.highlight(!0)):(i.material.highlight(!1),i.material.opacity=.1))})},this.init()},THREE.TransformGizmoTranslateRotate.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformGizmoScale=function(){THREE.TransformGizmo.call(this),this.setHandlePickerGizmos=function(){var i=n(.125,.125,.125),r=o("X"),a=o("Y"),s=o("Z")
this.handleGizmos={X:[[new THREE.Mesh(i,new e({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(r,new t({color:16711680}))]],Y:[[new THREE.Mesh(i,new e({color:65280})),[0,.5,0]],[new THREE.Line(a,new t({color:65280}))]],Z:[[new THREE.Mesh(i,new e({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(s,new t({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125),new e({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new e({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.4,.4,.4),new e({color:16777215,opacity:.25}))]]}},this.setActivePlane=function(e,t){var i=new THREE.Matrix4
t.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"==e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"==e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"==e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"==e&&(this.activePlane=this.planes.XYZE),this.hide(),this.show()},this.init()},THREE.TransformGizmoScale.prototype=Object.create(THREE.TransformGizmo.prototype),THREE.TransformControls=function(e,t,i){function n(i,n){var o=t.getBoundingClientRect(),r=(i.clientX-o.left)/o.width*2-1,a=2*-((i.clientY-o.top)/o.height)+1
e.isPerspective?(y.set(r,a,.5),y.unproject(e),E.set(e.position,y.sub(e.position).normalize())):(y.set(r,a,-1),y.unproject(e),A.set(0,0,-1),E.set(y,A.transformDirection(e.matrixWorld)))
var s=E.intersectObjects(n,!0)
return s[0]?s[0]:!1}switch(THREE.Object3D.call(this),t=void 0!==t?t:document,this.gizmo={},i){case"translate":this.gizmo[i]=new THREE.TransformGizmoTranslate
break
case"rotate":this.gizmo[i]=new THREE.TransformGizmoRotate
break
case"transrotate":this.gizmo[i]=new THREE.TransformGizmoTranslateRotate
break
case"scale":this.gizmo[i]=new THREE.TransformGizmoScale}if(this.add(this.gizmo[i]),this.gizmo[i].hide(),this.object=void 0,this.snap=null,this.snapDelta=0,this.space="world",this.size=1,this.axis=null,this.useAllPickers=!0,this.unitX=new THREE.Vector3(1,0,0),this.unitY=new THREE.Vector3(0,1,0),this.unitZ=new THREE.Vector3(0,0,1),this.normal=new THREE.Vector3(0,0,1),"transrotate"===i){var o=new THREE.Geometry
o.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1))
var r=new THREE.LineBasicMaterial({color:0,linewidth:2,depthTest:!1})
this.startLine=new THREE.Line(o,r)
var o=new THREE.Geometry,r=new THREE.LineBasicMaterial({color:16770563,linewidth:2,depthTest:!1})
o.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1)),this.endLine=new THREE.Line(o,r)
var o=new THREE.Geometry,r=new THREE.LineDashedMaterial({color:0,linewidth:1,depthTest:!1})
o.vertices.push(new THREE.Vector3(0,-1,0),new THREE.Vector3(0,1,0)),this.centerLine=new THREE.Line(o,r)
var a=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/centerMarker_X.png"))
a.magFilter=a.minFilter=THREE.NearestFilter
var o=new THREE.CircleGeometry(.1,32),r=new THREE.MeshBasicMaterial({opacity:1,side:THREE.DoubleSide,transparent:!0,map:a})
this.centerMark=new THREE.Mesh(o,r),this.centerMark.rotation.set(Math.PI/2,0,0),this.ticks={}
var a=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/cardinalPoint.png"))
a.magFilter=a.minFilter=THREE.NearestFilter
var r=new THREE.MeshBasicMaterial({depthTest:!1,opacity:1,transparent:!0,side:THREE.DoubleSide,map:a}),s=.12,l=.25,c=1.15
this.ticks.RX=new THREE.Object3D
var o=new THREE.PlaneBufferGeometry(s,l),u=new THREE.Mesh(o,r)
u.position.set(0,0,-c-l/2),u.rotation.set(Math.PI/2,Math.PI/2,0),this.ticks.RX.add(u),u=u.clone(),u.position.set(0,c+l/2,0),u.rotation.set(0,Math.PI/2,0),this.ticks.RX.add(u),u=u.clone(),u.position.set(0,0,c+l/2),u.rotation.set(0,Math.PI/2,Math.PI/2),this.ticks.RX.add(u),u=u.clone(),u.position.set(0,-c-l/2,0),u.rotation.set(0,Math.PI/2,0),this.ticks.RX.add(u),this.ticks.RY=new THREE.Object3D,u=u.clone(),u.position.set(0,0,-c-l/2),u.rotation.set(Math.PI/2,0,0),this.ticks.RY.add(u),u=u.clone(),u.position.set(-c-l/2,0,0),u.rotation.set(Math.PI/2,0,Math.PI/2),this.ticks.RY.add(u),u=u.clone(),u.position.set(0,0,c+l/2),u.rotation.set(Math.PI/2,0,0),this.ticks.RY.add(u),u=u.clone(),u.position.set(c+l/2,0,0),u.rotation.set(Math.PI/2,0,Math.PI/2),this.ticks.RY.add(u)}var d=this,h=!1,p=i,f={type:"change"},m={type:"mouseDown"},v={type:"mouseUp",mode:p},g={type:"objectChange"},E=new THREE.Raycaster,y=new THREE.Vector3,A=new THREE.Vector3,T=new THREE.Vector3,b=new THREE.Vector3,w=new THREE.Vector3,_=new THREE.Vector3,x=1,C=new THREE.Matrix4,S=new THREE.Vector3,R=new THREE.Matrix4,M=new THREE.Vector3,P=new THREE.Quaternion,L=new THREE.Vector3,I=new THREE.Vector3,k=new THREE.Vector3,V=new THREE.Quaternion,N=new THREE.Quaternion,D=new THREE.Quaternion,H=new THREE.Quaternion,O=new THREE.Quaternion,B=new THREE.Vector3,F=new THREE.Vector3,U=new THREE.Matrix4,z=new THREE.Matrix4,G=new THREE.Vector3,W=new THREE.Vector3,j=new THREE.Euler,X=new THREE.Matrix4,Y=new THREE.Vector3
new THREE.Euler
this.attach=function(e){d.object=e,this.gizmo[p].show(),d.update(),d.updateUnitVectors()},this.detach=function(e){d.object=void 0,this.axis=null,this.gizmo[p].hide()},this.setMode=function(e){p=e?e:p,"scale"==p&&(d.space="local"),this.gizmo[p].show(),this.update(),d.dispatchEvent(f)},this.getPicker=function(){return d.gizmo[p].hemiPicker.children},this.setPosition=function(e){this.object.position.copy(e),this.update()},this.setNormal=function(e){P.setFromUnitVectors(this.normal,e),this.unitX.applyQuaternion(P),this.unitY.applyQuaternion(P),this.unitZ.applyQuaternion(P),this.normal.copy(e),this.object&&this.object.quaternion.multiply(P),this.update()},this.setSnap=function(e,t){d.snap=e,d.snapDelta=t},this.setSize=function(e){d.size=e,this.update(),d.dispatchEvent(f)},this.setSpace=function(e){d.space=e,this.update(),d.dispatchEvent(f)},this.update=function(i){if(void 0!==d.object){d.object.updateMatrixWorld(),W.setFromMatrixPosition(d.object.matrixWorld),j.setFromRotationMatrix(R.extractRotation(d.object.matrixWorld)),e.updateMatrixWorld(),Y.setFromMatrixPosition(e.matrixWorld),this.position.copy(W),this.quaternion.setFromEuler(j),this.normal.set(0,0,1),this.normal.applyEuler(j)
var n=W.distanceTo(Y),o=e.isPerspective?2*Math.tan(e.fov*Math.PI/360)*n:n,r=t.getBoundingClientRect()
x=100*o/r.height,this.scale.set(x,x,x),i&&this.gizmo[p].highlight(d.axis)}},this.updateUnitVectors=function(){this.unitX.set(1,0,0),this.unitY.set(0,1,0),this.unitZ.set(0,0,1),this.unitX.applyEuler(j),this.unitY.applyEuler(j),this.unitZ.applyEuler(j)},this.showRotationGizmos=function(e){for(var t=this.gizmo[p].handles.children,i=0;i<t.length;i++){var n=t[i]
n.visible=!0,-1!==n.name.search("R")&&(n.visible=e)}this.useAllPickers=e},this.highlight=function(){this.gizmo[p].highlight(this.axis||"Z")},this.onPointerHover=function(e){if(void 0===d.object||h===!0)return!1
var t=e.pointers?e.pointers[0]:e,i=n(t,d.useAllPickers?d.gizmo[p].pickers.children:d.gizmo[p].subPickers.children),o=null,r=""
return i&&(o=i.object.name,r=-1!=o.search("R")?"rotate":"translate"),d.axis!==o&&(d.axis=o,d.gizmo[p].activeMode=r,d.update(!0),d.dispatchEvent(f)),null===d.axis&&d.gizmo[p].show(),i?!0:!1},this.onPointerDown=function(t){if(void 0===d.object||h===!0)return!1
var i=t.pointers?t.pointers[0]:t
if("touch"===t.pointerType){var o=n(i,d.useAllPickers?d.gizmo[p].pickers.children:d.gizmo[p].subPickers.children),r=null,a=""
o&&(r=o.object.name,a=-1!=r.search("R")?"rotate":"translate"),d.axis!==r&&(d.axis=r,d.gizmo[p].activeMode=a)}var o=null
if((0===i.button||void 0===i.button)&&(o=n(i,d.useAllPickers?d.gizmo[p].pickers.children:d.gizmo[p].subPickers.children))){d.dispatchEvent(m),d.axis=o.object.name,d.update(),S.copy(e.position).sub(W).normalize(),d.gizmo[p].setActivePlane(d.axis,S)
var s=n(i,[d.gizmo[p].activePlane])
if(s&&b.copy(s.point),B.copy(d.object.position),F.copy(d.object.scale),U.extractRotation(d.object.matrix),X.extractRotation(d.object.matrixWorld),d.object.parent?(z.extractRotation(d.object.parent.matrixWorld),G.setFromMatrixScale(R.getInverse(d.object.parent.matrixWorld))):(z.extractRotation(d.object.matrixWorld),G.setFromMatrixScale(R.getInverse(d.object.matrixWorld))),"transrotate"===p&&"rotate"===d.gizmo[p].activeMode){d.startLine.geometry.vertices[0].set(0,0,0).applyMatrix4(d.matrixWorld),d.startLine.geometry.vertices[1].set(0,0,1).applyMatrix4(d.matrixWorld),d.startLine.geometry.verticesNeedUpdate=!0,d.parent.add(d.startLine)
var l=d.object.geometry.getAttribute("position"),c=(new THREE.Vector3).fromAttribute(l,0).applyMatrix4(d.object.matrixWorld),u=(new THREE.Vector3).fromAttribute(l,1).applyMatrix4(d.object.matrixWorld),f=(new THREE.Vector3).fromAttribute(l,2).applyMatrix4(d.object.matrixWorld),v=(new THREE.Vector3).fromAttribute(l,3).applyMatrix4(d.object.matrixWorld)
if("RX"===d.axis){c.lerp(f,.5),u.lerp(v,.5)
var g=c.distanceTo(u)
d.centerLine.material.dashSize=g/15,d.centerLine.material.gapSize=g/30,d.centerLine.geometry.vertices[0].copy(c),d.centerLine.geometry.vertices[1].copy(u)}else{c.lerp(u,.5),f.lerp(v,.5)
var g=c.distanceTo(f)
d.centerLine.material.dashSize=g/15,d.centerLine.material.gapSize=g/30,d.centerLine.geometry.vertices[0].copy(c),d.centerLine.geometry.vertices[1].copy(f)}d.centerLine.geometry.computeLineDistances(),d.centerLine.geometry.verticesNeedUpdate=!0,d.parent.add(d.centerLine),d.ticks[d.axis].position.copy(d.position),d.ticks[d.axis].quaternion.copy(d.quaternion),d.ticks[d.axis].scale.copy(d.scale),d.parent.add(d.ticks[d.axis])}}return h=!0,o?!0:!1},this.onPointerMove=function(e){if(void 0===d.object||null===d.axis||h===!1)return!1
var t=e.pointers?e.pointers[0]:e,i=n(t,[d.gizmo[p].activePlane])
i&&T.copy(i.point)
var o=d.gizmo[p].activeMode
if("translate"==o)T.sub(b),T.multiply(G),"local"==d.space&&(T.applyMatrix4(R.getInverse(X)),L.copy(this.unitX),I.copy(this.unitY),k.copy(this.unitZ),M.set(0,0,0),-1!=d.axis.search("X")&&(L.multiplyScalar(T.dot(this.unitX)),M.add(L)),-1!=d.axis.search("Y")&&(I.multiplyScalar(T.dot(this.unitY)),M.add(I)),-1!=d.axis.search("Z")&&(k.multiplyScalar(T.dot(this.unitZ)),M.add(k)),T.copy(M),T.applyMatrix4(U),d.object.position.copy(B),d.object.position.add(T)),("world"==d.space||-1!=d.axis.search("XYZ"))&&(L.copy(this.unitX),I.copy(this.unitY),k.copy(this.unitZ),M.set(0,0,0),-1!=d.axis.search("X")&&(L.multiplyScalar(T.dot(this.unitX)),M.add(L)),-1!=d.axis.search("Y")&&(I.multiplyScalar(T.dot(this.unitY)),M.add(I)),-1!=d.axis.search("Z")&&(k.multiplyScalar(T.dot(this.unitZ)),M.add(k)),T.copy(M),T.applyMatrix4(R.getInverse(z)),d.object.position.copy(B),d.object.position.add(T))
else if("scale"==o)T.sub(b),T.multiply(G),"local"==d.space&&("XYZ"==d.axis?(x=1+T.y/50,d.object.scale.x=F.x*x,d.object.scale.y=F.y*x,d.object.scale.z=F.z*x):(T.applyMatrix4(R.getInverse(X)),"X"==d.axis&&(d.object.scale.x=F.x*(1+T.x/50)),"Y"==d.axis&&(d.object.scale.y=F.y*(1+T.y/50)),"Z"==d.axis&&(d.object.scale.z=F.z*(1+T.z/50))))
else if("rotate"==o){if(T.sub(W),T.multiply(G),M.copy(b).sub(W),M.multiply(G),"RE"==d.axis){T.applyMatrix4(R.getInverse(C)),M.applyMatrix4(R.getInverse(C)),w.set(Math.atan2(T.z,T.y),Math.atan2(T.x,T.z),Math.atan2(T.y,T.x)),_.set(Math.atan2(M.z,M.y),Math.atan2(M.x,M.z),Math.atan2(M.y,M.x)),P.setFromRotationMatrix(R.getInverse(z))
var r=w.z-_.z
if(null!==d.snap){var a=Math.round(r/d.snap)*d.snap
Math.abs(a-r)<d.snapDelta&&(r=a)}O.setFromAxisAngle(S,r),V.setFromRotationMatrix(X),P.multiplyQuaternions(P,O),P.multiplyQuaternions(P,V),d.object.quaternion.copy(P)}else if("RXYZE"==d.axis){var s=T.clone().cross(M).normalize()
P.setFromRotationMatrix(R.getInverse(z))
var l=-T.clone().angleTo(M)
if(null!==d.snap){var a=Math.round(l/d.snap)*d.snap
Math.abs(a-l)<d.snapDelta&&(l=a)}N.setFromAxisAngle(s,l),V.setFromRotationMatrix(X),P.multiplyQuaternions(P,N),P.multiplyQuaternions(P,V),d.object.quaternion.copy(P)}else if("local"==d.space){T.applyMatrix4(R.getInverse(X)),M.applyMatrix4(R.getInverse(X))
var c=T.dot(this.unitX),u=T.dot(this.unitY),m=T.dot(this.unitZ),v=M.dot(this.unitX),E=M.dot(this.unitY),y=M.dot(this.unitZ)
w.set(Math.atan2(m,u),Math.atan2(c,m),Math.atan2(u,c)),_.set(Math.atan2(y,E),Math.atan2(v,y),Math.atan2(E,v))
var A=w.x-_.x,j=w.y-_.y,r=w.z-_.z
if(null!==d.snap){if(-1!=d.axis.search("X")){var a=Math.round(A/d.snap)*d.snap
Math.abs(a-A)<d.snapDelta&&(A=a)}if(-1!=d.axis.search("Y")){var a=Math.round(j/d.snap)*d.snap
Math.abs(a-j)<d.snapDelta&&(j=a)}if(-1!=d.axis.search("Z")){var a=Math.round(r/d.snap)*d.snap
Math.abs(a-r)<d.snapDelta&&(r=a)}}N.setFromAxisAngle(this.unitX,A),D.setFromAxisAngle(this.unitY,j),H.setFromAxisAngle(this.unitZ,r),V.setFromRotationMatrix(U),"RX"==d.axis&&V.multiplyQuaternions(V,N),"RY"==d.axis&&V.multiplyQuaternions(V,D),"RZ"==d.axis&&V.multiplyQuaternions(V,H),d.object.quaternion.copy(V)}else if("world"==d.space){var c=T.dot(this.unitX),u=T.dot(this.unitY),m=T.dot(this.unitZ),v=M.dot(this.unitX),E=M.dot(this.unitY),y=M.dot(this.unitZ)
w.set(Math.atan2(m,u),Math.atan2(c,m),Math.atan2(u,c)),_.set(Math.atan2(y,E),Math.atan2(v,y),Math.atan2(E,v)),P.setFromRotationMatrix(R.getInverse(z))
var A=w.x-_.x,j=w.y-_.y,r=w.z-_.z
if(null!==d.snap){if(-1!=d.axis.search("X")){var a=Math.round(A/d.snap)*d.snap
Math.abs(a-A)<d.snapDelta&&(A=a)}if(-1!=d.axis.search("Y")){var a=Math.round(j/d.snap)*d.snap
Math.abs(a-j)<d.snapDelta&&(j=a)}if(-1!=d.axis.search("Z")){var a=Math.round(r/d.snap)*d.snap
Math.abs(a-r)<d.snapDelta&&(r=a)}}N.setFromAxisAngle(this.unitX,A),D.setFromAxisAngle(this.unitY,j),H.setFromAxisAngle(this.unitZ,r),V.setFromRotationMatrix(X),"RX"==d.axis&&P.multiplyQuaternions(P,N),"RY"==d.axis&&P.multiplyQuaternions(P,D),"RZ"==d.axis&&P.multiplyQuaternions(P,H),P.multiplyQuaternions(P,V),d.object.quaternion.copy(P)}"transrotate"===p&&(d.add(d.endLine),d.add(d.centerMark))}return d.object.matrixAutoUpdate=!0,d.update(!0),d.dispatchEvent(f),d.dispatchEvent(g),i?!0:!1},this.onPointerUp=function(e){return h&&null!==d.axis&&(v.mode=p,d.dispatchEvent(v)),h=!1,this.gizmo[p].show(),this.updateUnitVectors(),"transrotate"===p&&"rotate"===this.gizmo[p].activeMode&&(this.remove(this.endLine),this.remove(this.centerMark),this.parent.remove(this.centerLine),this.parent.remove(this.startLine),this.parent.remove(this.ticks[this.axis])),!1}},THREE.TransformControls.prototype=Object.create(THREE.Object3D.prototype)}function stderr(){ENABLE_TRACE&&console.log.apply(console,arguments)}var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="lmvworker.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0,AutodeskNamespace=function(e){for(var t="undefined"!=typeof window&&null!==window?window:self,i=e.split("."),n=0;n<i.length;++n)t[i[n]]=t[i[n]]||{},t=t[i[n]]
return t}
AutodeskNamespace("Autodesk.Viewing.Private"),AutodeskNamespace("Autodesk.Viewing.Extensions"),AutodeskNamespace("Autodesk.Viewing.Shaders"),AutodeskNamespace("Autodesk.Viewing.UI")
var _isIE11=!!navigator.userAgent.match(/Trident\/7\./)
"undefined"!=typeof window&&_isIE11&&!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0}
var i=document.createEvent("CustomEvent")
return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i}e.prototype=window.CustomEvent.prototype,window.CustomEvent=e}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(e,t){if(!t||t>this.byteLength?t=this.byteLength:0>t&&(t=this.byteLength+t,0>t&&(t=0)),0>e&&(e=this.byteLength+e,0>e&&(e=0)),e>=t)return new ArrayBuffer
for(var i=t-e,n=new Uint8Array(this,e,i),o=new Uint8Array(i),r=0;i>r;r++)o[r]=n[r]
return o.buffer}),"undefined"!=typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder),function(){var e="undefined"!=typeof window&&null!==window?window:self
e.performance||(e.performance=Date)}(),"undefined"!=typeof window&&!function(e,t,i,n){"use strict"
function o(e,t,i){return setTimeout(u(e,i),t)}function r(e,t,i){return Array.isArray(e)?(a(e,i[t],i),!0):!1}function a(e,t,i){var o
if(e)if(e.forEach)e.forEach(t,i)
else if(e.length!==n)for(o=0;o<e.length;)t.call(i,e[o],o,e),o++
else for(o in e)e.hasOwnProperty(o)&&t.call(i,e[o],o,e)}function s(e,t,i){for(var o=Object.keys(t),r=0;r<o.length;)(!i||i&&e[o[r]]===n)&&(e[o[r]]=t[o[r]]),r++
return e}function l(e,t){return s(e,t,!0)}function c(e,t,i){var n,o=t.prototype
n=e.prototype=Object.create(o),n.constructor=e,n._super=o,i&&s(n,i)}function u(e,t){return function(){return e.apply(t,arguments)}}function d(e,t){return typeof e==ue?e.apply(t?t[0]||n:n,t):e}function h(e,t){return e===n?t:e}function p(e,t,i){a(g(t),function(t){e.addEventListener(t,i,!1)})}function f(e,t,i){a(g(t),function(t){e.removeEventListener(t,i,!1)})}function m(e,t){for(;e;){if(e==t)return!0
e=e.parentNode}return!1}function v(e,t){return e.indexOf(t)>-1}function g(e){return e.trim().split(/\s+/g)}function E(e,t,i){if(e.indexOf&&!i)return e.indexOf(t)
for(var n=0;n<e.length;){if(i&&e[n][i]==t||!i&&e[n]===t)return n
n++}return-1}function y(e){return Array.prototype.slice.call(e,0)}function A(e,t,i){for(var n=[],o=[],r=0;r<e.length;){var a=t?e[r][t]:e[r]
E(o,a)<0&&n.push(e[r]),o[r]=a,r++}return i&&(n=t?n.sort(function(e,i){return e[t]>i[t]}):n.sort()),n}function T(e,t){for(var i,o,r=t[0].toUpperCase()+t.slice(1),a=0;a<le.length;){if(i=le[a],o=i?i+r:t,o in e)return o
a++}return n}function b(){return fe++}function w(e){var t=e.ownerDocument
return t.defaultView||t.parentWindow}function _(e,t){var i=this
this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){d(e.options.enable,[e])&&i.handler(t)},this.init()}function x(e){var t,i=e.options.inputClass
return new(t=i?i:ge?B:Ee?z:ve?W:O)(e,C)}function C(e,t,i){var n=i.pointers.length,o=i.changedPointers.length,r=t&_e&&n-o===0,a=t&(Ce|Se)&&n-o===0
i.isFirst=!!r,i.isFinal=!!a,r&&(e.session={}),i.eventType=t,S(e,i),e.emit("hammer.input",i),e.recognize(i),e.session.prevInput=i}function S(e,t){var i=e.session,n=t.pointers,o=n.length
i.firstInput||(i.firstInput=P(t)),o>1&&!i.firstMultiple?i.firstMultiple=P(t):1===o&&(i.firstMultiple=!1)
var r=i.firstInput,a=i.firstMultiple,s=a?a.center:r.center,l=t.center=L(n)
t.timeStamp=pe(),t.deltaTime=t.timeStamp-r.timeStamp,t.angle=N(s,l),t.distance=V(s,l),R(i,t),t.offsetDirection=k(t.deltaX,t.deltaY),t.scale=a?H(a.pointers,n):1,t.rotation=a?D(a.pointers,n):0,M(i,t)
var c=e.element
m(t.srcEvent.target,c)&&(c=t.srcEvent.target),t.target=c}function R(e,t){var i=t.center,n=e.offsetDelta||{},o=e.prevDelta||{},r=e.prevInput||{};(t.eventType===_e||r.eventType===Ce)&&(o=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=e.offsetDelta={x:i.x,y:i.y}),t.deltaX=o.x+(i.x-n.x),t.deltaY=o.y+(i.y-n.y)}function M(e,t){var i,o,r,a,s=e.lastInterval||t,l=t.timeStamp-s.timeStamp
if(t.eventType!=Se&&(l>we||s.velocity===n)){var c=s.deltaX-t.deltaX,u=s.deltaY-t.deltaY,d=I(l,c,u)
o=d.x,r=d.y,i=he(d.x)>he(d.y)?d.x:d.y,a=k(c,u),e.lastInterval=t}else i=s.velocity,o=s.velocityX,r=s.velocityY,a=s.direction
t.velocity=i,t.velocityX=o,t.velocityY=r,t.direction=a}function P(e){for(var t=[],i=0;i<e.pointers.length;)t[i]={clientX:de(e.pointers[i].clientX),clientY:de(e.pointers[i].clientY)},i++
return{timeStamp:pe(),pointers:t,center:L(t),deltaX:e.deltaX,deltaY:e.deltaY}}function L(e){var t=e.length
if(1===t)return{x:de(e[0].clientX),y:de(e[0].clientY)}
for(var i=0,n=0,o=0;t>o;)i+=e[o].clientX,n+=e[o].clientY,o++
return{x:de(i/t),y:de(n/t)}}function I(e,t,i){return{x:t/e||0,y:i/e||0}}function k(e,t){return e===t?Re:he(e)>=he(t)?e>0?Me:Pe:t>0?Le:Ie}function V(e,t,i){i||(i=De)
var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]]
return Math.sqrt(n*n+o*o)}function N(e,t,i){i||(i=De)
var n=t[i[0]]-e[i[0]],o=t[i[1]]-e[i[1]]
return 180*Math.atan2(o,n)/Math.PI}function D(e,t){return N(t[1],t[0],He)-N(e[1],e[0],He)}function H(e,t){return V(t[0],t[1],He)/V(e[0],e[1],He)}function O(){this.evEl=Be,this.evWin=Fe,this.allow=!0,this.pressed=!1,_.apply(this,arguments)}function B(){this.evEl=Ge,this.evWin=We,_.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function F(){this.evTarget=Xe,this.evWin=Ye,this.started=!1,_.apply(this,arguments)}function U(e,t){var i=y(e.touches),n=y(e.changedTouches)
return t&(Ce|Se)&&(i=A(i.concat(n),"identifier",!0)),[i,n]}function z(){this.evTarget=Ke,this.targetIds={},_.apply(this,arguments)}function G(e,t){var i=y(e.touches),n=this.targetIds
if(t&(_e|xe)&&1===i.length)return n[i[0].identifier]=!0,[i,i]
var o,r,a=y(e.changedTouches),s=[],l=this.target
if(r=i.filter(function(e){return m(e.target,l)}),t===_e)for(o=0;o<r.length;)n[r[o].identifier]=!0,o++
for(o=0;o<a.length;)n[a[o].identifier]&&s.push(a[o]),t&(Ce|Se)&&delete n[a[o].identifier],o++
return s.length?[A(r.concat(s),"identifier",!0),s]:void 0}function W(){_.apply(this,arguments)
var e=u(this.handler,this)
this.touch=new z(this.manager,e),this.mouse=new O(this.manager,e)}function j(e,t){this.manager=e,this.set(t)}function X(e){if(v(e,tt))return tt
var t=v(e,it),i=v(e,nt)
return t&&i?it+" "+nt:t||i?t?it:nt:v(e,et)?et:$e}function Y(e){this.id=b(),this.manager=null,this.options=l(e||{},this.defaults),this.options.enable=h(this.options.enable,!0),this.state=ot,this.simultaneous={},this.requireFail=[]}function q(e){return e&ct?"cancel":e&st?"end":e&at?"move":e&rt?"start":""}function K(e){return e==Ie?"down":e==Le?"up":e==Me?"left":e==Pe?"right":""}function Z(e,t){var i=t.manager
return i?i.get(e):e}function Q(){Y.apply(this,arguments)}function J(){Q.apply(this,arguments),this.pX=null,this.pY=null}function $(){Q.apply(this,arguments)}function ee(){Y.apply(this,arguments),this._timer=null,this._input=null}function te(){Q.apply(this,arguments)}function ie(){Q.apply(this,arguments)}function ne(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function oe(e,t){return t=t||{},t.recognizers=h(t.recognizers,oe.defaults.preset),new re(e,t)}function re(e,t){t=t||{},this.options=l(t,oe.defaults),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=x(this),this.touchAction=new j(this,this.options.touchAction),ae(this,!0),a(t.recognizers,function(e){var t=this.add(new e[0](e[1]))
e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function ae(e,t){var i=e.element
a(e.options.cssProps,function(e,n){i.style[T(i.style,n)]=t?e:""})}function se(e,i){var n=t.createEvent("Event")
n.initEvent(e,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var le=["","webkit","moz","MS","ms","o"],ce=t.createElement("div"),ue="function",de=Math.round,he=Math.abs,pe=Date.now,fe=1,me=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in e,ge=T(e,"PointerEvent")!==n,Ee=ve&&me.test(navigator.userAgent),ye="touch",Ae="pen",Te="mouse",be="kinect",we=25,_e=1,xe=2,Ce=4,Se=8,Re=1,Me=2,Pe=4,Le=8,Ie=16,ke=Me|Pe,Ve=Le|Ie,Ne=ke|Ve,De=["x","y"],He=["clientX","clientY"]
_.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(w(this.element),this.evWin,this.domHandler)}}
var Oe={mousedown:_e,mousemove:xe,mouseup:Ce},Be="mousedown",Fe="mousemove mouseup"
c(O,_,{handler:function(e){var t=Oe[e.type]
t&_e&&0===e.button&&(this.pressed=!0),t&xe&&1!==e.which&&(t=Ce),this.pressed&&this.allow&&(t&Ce&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:Te,srcEvent:e}))}})
var Ue={pointerdown:_e,pointermove:xe,pointerup:Ce,pointercancel:Se,pointerout:Se},ze={2:ye,3:Ae,4:Te,5:be},Ge="pointerdown",We="pointermove pointerup pointercancel"
e.MSPointerEvent&&(Ge="MSPointerDown",We="MSPointerMove MSPointerUp MSPointerCancel"),c(B,_,{handler:function(e){var t=this.store,i=!1,n=e.type.toLowerCase().replace("ms",""),o=Ue[n],r=ze[e.pointerType]||e.pointerType,a=r==ye,s=E(t,e.pointerId,"pointerId")
o&_e&&(0===e.button||a)?0>s&&(t.push(e),s=t.length-1):o&(Ce|Se)&&(i=!0),0>s||(t[s]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),i&&t.splice(s,1))}})
var je={touchstart:_e,touchmove:xe,touchend:Ce,touchcancel:Se},Xe="touchstart",Ye="touchstart touchmove touchend touchcancel"
c(F,_,{handler:function(e){var t=je[e.type]
if(t===_e&&(this.started=!0),this.started){var i=U.call(this,e,t)
t&(Ce|Se)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:ye,srcEvent:e})}}})
var qe={touchstart:_e,touchmove:xe,touchend:Ce,touchcancel:Se},Ke="touchstart touchmove touchend touchcancel"
c(z,_,{handler:function(e){var t=qe[e.type],i=G.call(this,e,t)
i&&this.callback(this.manager,t,{pointers:i[0],changedPointers:i[1],pointerType:ye,srcEvent:e})}}),c(W,_,{handler:function(e,t,i){var n=i.pointerType==ye,o=i.pointerType==Te
if(n)this.mouse.allow=!1
else if(o&&!this.mouse.allow)return
t&(Ce|Se)&&(this.mouse.allow=!0),this.callback(e,t,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}})
var Ze=T(ce.style,"touchAction"),Qe=Ze!==n,Je="compute",$e="auto",et="manipulation",tt="none",it="pan-x",nt="pan-y"
j.prototype={set:function(e){e==Je&&(e=this.compute()),Qe&&(this.manager.element.style[Ze]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[]
return a(this.manager.recognizers,function(t){d(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),X(e.join(" "))},preventDefaults:function(e){if(!Qe){var t=e.srcEvent,i=e.offsetDirection
if(this.manager.session.prevented)return void t.preventDefault()
var n=this.actions,o=v(n,tt),r=v(n,nt),a=v(n,it)
return o||r&&i&ke||a&&i&Ve?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}}
var ot=1,rt=2,at=4,st=8,lt=st,ct=16,ut=32
Y.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(r(e,"recognizeWith",this))return this
var t=this.simultaneous
return e=Z(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return r(e,"dropRecognizeWith",this)?this:(e=Z(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(r(e,"requireFailure",this))return this
var t=this.requireFail
return e=Z(e,this),-1===E(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(r(e,"dropRequireFailure",this))return this
e=Z(e,this)
var t=E(this.requireFail,e)
return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){i.manager.emit(i.options.event+(t?q(n):""),e)}var i=this,n=this.state
st>n&&t(!0),t(),n>=st&&t(!0)},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=ut)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(ut|ot)))return!1
e++}return!0},recognize:function(e){var t=s({},e)
return d(this.options.enable,[this,t])?(this.state&(lt|ct|ut)&&(this.state=ot),this.state=this.process(t),void(this.state&(rt|at|st|ct)&&this.tryEmit(t))):(this.reset(),void(this.state=ut))},process:function(){},getTouchAction:function(){},reset:function(){}},c(Q,Y,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers
return 0===t||e.pointers.length===t},process:function(e){var t=this.state,i=e.eventType,n=t&(rt|at),o=this.attrTest(e)
return n&&(i&Se||!o)?t|ct:n||o?i&Ce?t|st:t&rt?t|at:rt:ut}}),c(J,Q,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ne},getTouchAction:function(){var e=this.options.direction,t=[]
return e&ke&&t.push(nt),e&Ve&&t.push(it),t},directionTest:function(e){var t=this.options,i=!0,n=e.distance,o=e.direction,r=e.deltaX,a=e.deltaY
return o&t.direction||(t.direction&ke?(o=0===r?Re:0>r?Me:Pe,i=r!=this.pX,n=Math.abs(e.deltaX)):(o=0===a?Re:0>a?Le:Ie,i=a!=this.pY,n=Math.abs(e.deltaY))),e.direction=o,i&&n>t.threshold&&o&t.direction},attrTest:function(e){return Q.prototype.attrTest.call(this,e)&&(this.state&rt||!(this.state&rt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY
var t=K(e.direction)
t&&this.manager.emit(this.options.event+t,e),this._super.emit.call(this,e)}}),c($,Q,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&rt)},emit:function(e){if(this._super.emit.call(this,e),1!==e.scale){var t=e.scale<1?"in":"out"
this.manager.emit(this.options.event+t,e)}}}),c(ee,Y,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[$e]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime>t.time
if(this._input=e,!n||!i||e.eventType&(Ce|Se)&&!r)this.reset()
else if(e.eventType&_e)this.reset(),this._timer=o(function(){this.state=lt,this.tryEmit()},t.time,this)
else if(e.eventType&Ce)return lt
return ut},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===lt&&(e&&e.eventType&Ce?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=pe(),this.manager.emit(this.options.event,this._input)))}}),c(te,Q,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[tt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&rt)}}),c(ie,Q,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:ke|Ve,pointers:1},getTouchAction:function(){return J.prototype.getTouchAction.call(this)},attrTest:function(e){var t,i=this.options.direction
return i&(ke|Ve)?t=e.velocity:i&ke?t=e.velocityX:i&Ve&&(t=e.velocityY),this._super.attrTest.call(this,e)&&i&e.direction&&e.distance>this.options.threshold&&he(t)>this.options.velocity&&e.eventType&Ce},emit:function(e){var t=K(e.direction)
t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),c(ne,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[et]},process:function(e){var t=this.options,i=e.pointers.length===t.pointers,n=e.distance<t.threshold,r=e.deltaTime<t.time
if(this.reset(),e.eventType&_e&&0===this.count)return this.failTimeout()
if(n&&r&&i){if(e.eventType!=Ce)return this.failTimeout()
var a=this.pTime?e.timeStamp-this.pTime<t.interval:!0,s=!this.pCenter||V(this.pCenter,e.center)<t.posThreshold
this.pTime=e.timeStamp,this.pCenter=e.center,s&&a?this.count+=1:this.count=1,this._input=e
var l=this.count%t.taps
if(0===l)return this.hasRequireFailures()?(this._timer=o(function(){this.state=lt,this.tryEmit()},t.interval,this),rt):lt}return ut},failTimeout:function(){return this._timer=o(function(){this.state=ut},this.options.interval,this),ut},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==lt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),oe.VERSION="2.0.4",oe.defaults={domEvents:!1,touchAction:Je,enable:!0,inputTarget:null,inputClass:null,preset:[[te,{enable:!1}],[$,{enable:!1},["rotate"]],[ie,{direction:ke}],[J,{direction:ke},["swipe"]],[ne],[ne,{event:"doubletap",taps:2},["tap"]],[ee]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}}
var dt=1,ht=2
re.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?ht:dt},recognize:function(e){var t=this.session
if(!t.stopped){this.touchAction.preventDefaults(e)
var i,n=this.recognizers,o=t.curRecognizer;(!o||o&&o.state&lt)&&(o=t.curRecognizer=null)
for(var r=0;r<n.length;)i=n[r],t.stopped===ht||o&&i!=o&&!i.canRecognizeWith(o)?i.reset():i.recognize(e),!o&&i.state&(rt|at|st)&&(o=t.curRecognizer=i),r++}},get:function(e){if(e instanceof Y)return e
for(var t=this.recognizers,i=0;i<t.length;i++)if(t[i].options.event==e)return t[i]
return null},add:function(e){if(r(e,"add",this))return this
var t=this.get(e.options.event)
return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(r(e,"remove",this))return this
var t=this.recognizers
return e=this.get(e),t.splice(E(t,e),1),this.touchAction.update(),this},on:function(e,t){var i=this.handlers
return a(g(e),function(e){i[e]=i[e]||[],i[e].push(t)}),this},off:function(e,t){var i=this.handlers
return a(g(e),function(e){t?i[e].splice(E(i[e],t),1):delete i[e]}),this},emit:function(e,t){this.options.domEvents&&se(e,t)
var i=this.handlers[e]&&this.handlers[e].slice()
if(i&&i.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()}
for(var n=0;n<i.length;)i[n](t),n++}},destroy:function(){this.element&&ae(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(oe,{INPUT_START:_e,INPUT_MOVE:xe,INPUT_END:Ce,INPUT_CANCEL:Se,STATE_POSSIBLE:ot,STATE_BEGAN:rt,STATE_CHANGED:at,STATE_ENDED:st,STATE_RECOGNIZED:lt,STATE_CANCELLED:ct,STATE_FAILED:ut,DIRECTION_NONE:Re,DIRECTION_LEFT:Me,DIRECTION_RIGHT:Pe,DIRECTION_UP:Le,DIRECTION_DOWN:Ie,DIRECTION_HORIZONTAL:ke,DIRECTION_VERTICAL:Ve,DIRECTION_ALL:Ne,Manager:re,Input:_,TouchAction:j,TouchInput:z,MouseInput:O,PointerEventInput:B,TouchMouseInput:W,SingleTouchInput:F,Recognizer:Y,AttrRecognizer:Q,Tap:ne,Pan:J,Swipe:ie,Pinch:$,Rotate:te,Press:ee,on:p,off:f,each:a,merge:l,extend:s,inherit:c,bindFn:u,prefixed:T}),"undefined"!=typeof module&&module.exports,e[i]=oe}(window,document,"Hammer"),LmvMatrix4=function(e){e?this.elements=new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},LmvMatrix4.prototype={constructor:LmvMatrix4,set:function(e,t,i,n,o,r,a,s,l,c,u,d,h,p,f,m){var v=this.elements
return v[0]=e,v[4]=t,v[8]=i,v[12]=n,v[1]=o,v[5]=r,v[9]=a,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=d,v[3]=h,v[7]=p,v[11]=f,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return this.elements.set(e.elements),this},makeRotationFromQuaternion:function(e){var t=this.elements,i=e.x,n=e.y,o=e.z,r=e.w,a=i+i,s=n+n,l=o+o,c=i*a,u=i*s,d=i*l,h=n*s,p=n*l,f=o*l,m=r*a,v=r*s,g=r*l
return t[0]=1-(h+f),t[4]=u-g,t[8]=d+v,t[1]=u+g,t[5]=1-(c+f),t[9]=p-m,t[2]=d-v,t[6]=p+m,t[10]=1-(c+h),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},multiply:function(e){return this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,o=this.elements,r=i[0],a=i[4],s=i[8],l=i[12],c=i[1],u=i[5],d=i[9],h=i[13],p=i[2],f=i[6],m=i[10],v=i[14],g=i[3],E=i[7],y=i[11],A=i[15],T=n[0],b=n[4],w=n[8],_=n[12],x=n[1],C=n[5],S=n[9],R=n[13],M=n[2],P=n[6],L=n[10],I=n[14],k=n[3],V=n[7],N=n[11],D=n[15]
return o[0]=r*T+a*x+s*M+l*k,o[4]=r*b+a*C+s*P+l*V,o[8]=r*w+a*S+s*L+l*N,o[12]=r*_+a*R+s*I+l*D,o[1]=c*T+u*x+d*M+h*k,o[5]=c*b+u*C+d*P+h*V,o[9]=c*w+u*S+d*L+h*N,o[13]=c*_+u*R+d*I+h*D,o[2]=p*T+f*x+m*M+v*k,o[6]=p*b+f*C+m*P+v*V,o[10]=p*w+f*S+m*L+v*N,o[14]=p*_+f*R+m*I+v*D,o[3]=g*T+E*x+y*M+A*k,o[7]=g*b+E*C+y*P+A*V,o[11]=g*w+E*S+y*L+A*N,o[15]=g*_+E*R+y*I+A*D,this},multiplyToArray:function(e,t,i){var n=this.elements
return this.multiplyMatrices(e,t),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(e){var t=this.elements
return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],o=e[12],r=e[1],a=e[5],s=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],p=e[3],f=e[7],m=e[11],v=e[15]
return p*(+o*s*u-n*l*u-o*a*d+i*l*d+n*a*h-i*s*h)+f*(+t*s*h-t*l*d+o*r*d-n*r*h+n*l*c-o*s*c)+m*(+t*l*u-t*a*h-o*r*u+i*r*h+o*a*c-i*l*c)+v*(-n*a*c-t*s*u+t*a*d+n*r*u-i*r*d+i*s*c)},transpose:function(){var e,t=this.elements
return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},flattenToArrayOffset:function(e,t){var i=this.elements
return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e},setPosition:function(e){var t=this.elements
return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var i=this.elements,n=e.elements,o=n[0],r=n[4],a=n[8],s=n[12],l=n[1],c=n[5],u=n[9],d=n[13],h=n[2],p=n[6],f=n[10],m=n[14],v=n[3],g=n[7],E=n[11],y=n[15]
i[0]=u*m*g-d*f*g+d*p*E-c*m*E-u*p*y+c*f*y,i[4]=s*f*g-a*m*g-s*p*E+r*m*E+a*p*y-r*f*y,i[8]=a*d*g-s*u*g+s*c*E-r*d*E-a*c*y+r*u*y,i[12]=s*u*p-a*d*p-s*c*f+r*d*f+a*c*m-r*u*m,i[1]=d*f*v-u*m*v-d*h*E+l*m*E+u*h*y-l*f*y,i[5]=a*m*v-s*f*v+s*h*E-o*m*E-a*h*y+o*f*y,i[9]=s*u*v-a*d*v-s*l*E+o*d*E+a*l*y-o*u*y,i[13]=a*d*h-s*u*h+s*l*f-o*d*f-a*l*m+o*u*m,i[2]=c*m*v-d*p*v+d*h*g-l*m*g-c*h*y+l*p*y,i[6]=s*p*v-r*m*v-s*h*g+o*m*g+r*h*y-o*p*y,i[10]=r*d*v-s*c*v+s*l*g-o*d*g-r*l*y+o*c*y,i[14]=s*c*h-r*d*h-s*l*p+o*d*p+r*l*m-o*c*m,i[3]=u*p*v-c*f*v-u*h*g+l*f*g+c*h*E-l*p*E,i[7]=r*f*v-a*p*v+a*h*g-o*f*g-r*h*E+o*p*E,i[11]=a*c*v-r*u*v-a*l*g+o*u*g+r*l*E-o*c*E,i[15]=r*u*h-a*c*h+a*l*p-o*u*p-r*l*f+o*c*f
var A=o*i[0]+l*i[4]+h*i[8]+v*i[12]
if(0==A){var T="Matrix4.getInverse(): can't invert matrix, determinant is 0"
if(t)throw new Error(T)
return console.warn(T),this.identity(),this}return this.multiplyScalar(1/A),this},scale:function(e){var t=this.elements,i=e.x,n=e.y,o=e.z
return t[0]*=i,t[4]*=n,t[8]*=o,t[1]*=i,t[5]*=n,t[9]*=o,t[2]*=i,t[6]*=n,t[10]*=o,t[3]*=i,t[7]*=n,t[11]*=o,this},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e)
return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e)
return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e)
return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),o=1-i,r=e.x,a=e.y,s=e.z,l=o*r,c=o*a
return this.set(l*r+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*r,0,l*s-n*a,c*s+n*r,o*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},compose:function(e,t,i){return this.makeRotationFromQuaternion(t),this.scale(i),this.setPosition(e),this},transformPoint:function(e){var t=e.x,i=e.y,n=e.z,o=this.elements
return e.x=o[0]*t+o[4]*i+o[8]*n+o[12],e.y=o[1]*t+o[5]*i+o[9]*n+o[13],e.z=o[2]*t+o[6]*i+o[10]*n+o[14],e},transformDirection:function(e){var t=e.x,i=e.y,n=e.z,o=this.elements
e.x=o[0]*t+o[4]*i+o[8]*n,e.y=o[1]*t+o[5]*i+o[9]*n,e.z=o[2]*t+o[6]*i+o[10]*n
var r=Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)
if(r>0){var a=1/r
e.x*=a,e.y*=a,e.z*=a}return e},fromArray:function(e){return this.elements.set(e),this},toArray:function(){var e=this.elements
return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},clone:function(){return(new LmvMatrix4).fromArray(this.elements)}},!function(e){var t
"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.lmv_poly2tri=e()}(function(){return function e(t,i,n){function o(a,s){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require
if(!s&&l)return l(a,!0)
if(r)return r(a,!0)
throw new Error("Cannot find module '"+a+"'")}var c=i[a]={exports:{}}
t[a][0].call(c.exports,function(e){var i=t[a][1][e]
return o(i?i:e)},c,c.exports,e,t,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a])
return o}({1:[function(e,t,i){t.exports={version:"1.3.5"}},{}],2:[function(e,t,i){"use strict"
var n=function(e,t){this.point=e,this.triangle=t||null,this.next=null,this.prev=null,this.value=e.x},o=function(e,t){this.head_=e,this.tail_=t,this.search_node_=e}
o.prototype.head=function(){return this.head_},o.prototype.setHead=function(e){this.head_=e},o.prototype.tail=function(){return this.tail_},o.prototype.setTail=function(e){this.tail_=e},o.prototype.search=function(){return this.search_node_},o.prototype.setSearch=function(e){this.search_node_=e},o.prototype.findSearchNode=function(){return this.search_node_},o.prototype.locateNode=function(e){var t=this.search_node_
if(e<t.value){for(;t=t.prev;)if(e>=t.value)return this.search_node_=t,t}else for(;t=t.next;)if(e<t.value)return this.search_node_=t.prev,t.prev
return null},o.prototype.locatePoint=function(e){var t=e.x,i=this.findSearchNode(t),n=i.point.x
if(t===n){if(e!==i.point)if(e===i.prev.point)i=i.prev
else{if(e!==i.next.point)throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call")
i=i.next}}else if(n>t)for(;(i=i.prev)&&e!==i.point;);else for(;(i=i.next)&&e!==i.point;);return i&&(this.search_node_=i),i},t.exports=o,t.exports.Node=n},{}],3:[function(e,t,i){"use strict"
function n(e,t){if(!e)throw new Error(t||"Assert Failed")}t.exports=n},{}],4:[function(e,t,i){"use strict"
var n=e("./xy"),o=function(e,t){this.x=+e||0,this.y=+t||0,this._p2t_edge_list=null}
o.prototype.toString=function(){return n.toStringBase(this)},o.prototype.toJSON=function(){return{x:this.x,y:this.y}},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.set_zero=function(){return this.x=0,this.y=0,this},o.prototype.set=function(e,t){return this.x=+e||0,this.y=+t||0,this},o.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},o.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},o.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},o.prototype.mul=function(e){return this.x*=e,this.y*=e,this},o.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.normalize=function(){var e=this.length()
return this.x/=e,this.y/=e,e},o.prototype.equals=function(e){return this.x===e.x&&this.y===e.y},o.negate=function(e){return new o(-e.x,-e.y)},o.add=function(e,t){return new o(e.x+t.x,e.y+t.y)},o.sub=function(e,t){return new o(e.x-t.x,e.y-t.y)},o.mul=function(e,t){return new o(e*t.x,e*t.y)},o.cross=function(e,t){return"number"==typeof e?"number"==typeof t?e*t:new o(-e*t.y,e*t.x):"number"==typeof t?new o(t*e.y,-t*e.x):e.x*t.y-e.y*t.x},o.toString=n.toString,o.compare=n.compare,o.cmp=n.compare,o.equals=n.equals,o.dot=function(e,t){return e.x*t.x+e.y*t.y},t.exports=o},{"./xy":11}],5:[function(e,t,i){"use strict"
var n=e("./xy"),o=function(e,t){this.name="PointError",this.points=t=t||[],this.message=e||"Invalid Points!"
for(var i=0;i<t.length;i++)this.message+=" "+n.toString(t[i])}
o.prototype=new Error,o.prototype.constructor=o,t.exports=o},{"./xy":11}],6:[function(e,t,i){(function(t){"use strict"
var n=t.poly2tri
i.noConflict=function(){return t.poly2tri=n,i},i.VERSION=e("../dist/version.json").version,i.PointError=e("./pointerror"),i.Point=e("./point"),i.Triangle=e("./triangle"),i.SweepContext=e("./sweepcontext")
var o=e("./sweep")
i.triangulate=o.triangulate,i.sweep={Triangulate:o.triangulate}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(e,t,i){"use strict"
function n(e){e.initTriangulation(),e.createAdvancingFront(),o(e),r(e)}function o(e){var t,i=e.pointCount()
for(t=1;i>t;++t)for(var n=e.getPoint(t),o=a(e,n),r=n._p2t_edge_list,l=0;r&&l<r.length;++l)s(e,r[l],o)}function r(e){for(var t=e.front().head().next.triangle,i=e.front().head().next.point;!t.getConstrainedEdgeCW(i);)t=t.neighborCCW(i)
e.meshClean(t)}function a(e,t){var i=e.locateNode(t),n=u(e,t,i)
return t.x<=i.point.x+O&&d(e,i),h(e,n),n}function s(e,t,i){e.edge_event.constrained_edge=t,e.edge_event.right=t.p.x>t.q.x,c(i.triangle,t.p,t.q)||(A(e,t,i),l(e,t.p,t.q,i.triangle,t.q))}function l(e,t,i,n,o){if(!c(n,t,i)){var r=n.pointCCW(o),a=F(i,r,t)
if(a===B.COLLINEAR)throw new V("poly2tri EdgeEvent: Collinear not supported!",[i,r,t])
var s=n.pointCW(o),u=F(i,s,t)
if(u===B.COLLINEAR)throw new V("poly2tri EdgeEvent: Collinear not supported!",[i,s,t])
a===u?(n=a===B.CW?n.neighborCCW(o):n.neighborCW(o),l(e,t,i,n,o)):M(e,t,i,n,o)}}function c(e,t,i){var n=e.edgeIndex(t,i)
if(-1!==n){e.markConstrainedEdgeByIndex(n)
var o=e.getNeighbor(n)
return o&&o.markConstrainedEdgeByPoints(t,i),!0}return!1}function u(e,t,i){var n=new N(t,i.point,i.next.point)
n.markNeighbor(i.triangle),e.addToMap(n)
var o=new D(t)
return o.next=i.next,o.prev=i,i.next.prev=o,i.next=o,f(e,n)||e.mapTriangleToNodes(n),o}function d(e,t){var i=new N(t.prev.point,t.point,t.next.point)
i.markNeighbor(t.prev.triangle),i.markNeighbor(t.triangle),e.addToMap(i),t.prev.next=t.next,t.next.prev=t.prev,f(e,i)||e.mapTriangleToNodes(i)}function h(e,t){for(var i=t.next;i.next&&!z(i.point,i.next.point,i.prev.point);)d(e,i),i=i.next
for(i=t.prev;i.prev&&!z(i.point,i.next.point,i.prev.point);)d(e,i),i=i.prev
t.next&&t.next.next&&p(t)&&g(e,t)}function p(e){var t=e.point.x-e.next.next.point.x,i=e.point.y-e.next.next.point.y
return k(i>=0,"unordered y"),t>=0||Math.abs(t)<i}function f(e,t){for(var i=0;3>i;++i)if(!t.delaunay_edge[i]){var n=t.getNeighbor(i)
if(n){var o=t.getPoint(i),r=n.oppositePoint(t,o),a=n.index(r)
if(n.constrained_edge[a]||n.delaunay_edge[a]){t.constrained_edge[i]=n.constrained_edge[a]
continue}var s=m(o,t.pointCCW(o),t.pointCW(o),r)
if(s){t.delaunay_edge[i]=!0,n.delaunay_edge[a]=!0,v(t,o,n,r)
var l=!f(e,t)
return l&&e.mapTriangleToNodes(t),l=!f(e,n),l&&e.mapTriangleToNodes(n),t.delaunay_edge[i]=!1,n.delaunay_edge[a]=!1,!0}}}return!1}function m(e,t,i,n){var o=e.x-n.x,r=e.y-n.y,a=t.x-n.x,s=t.y-n.y,l=o*s,c=a*r,u=l-c
if(0>=u)return!1
var d=i.x-n.x,h=i.y-n.y,p=d*r,f=o*h,m=p-f
if(0>=m)return!1
var v=a*h,g=d*s,E=o*o+r*r,y=a*a+s*s,A=d*d+h*h,T=E*(v-g)+y*m+A*u
return T>0}function v(e,t,i,n){var o,r,a,s
o=e.neighborCCW(t),r=e.neighborCW(t),a=i.neighborCCW(n),s=i.neighborCW(n)
var l,c,u,d
l=e.getConstrainedEdgeCCW(t),c=e.getConstrainedEdgeCW(t),u=i.getConstrainedEdgeCCW(n),d=i.getConstrainedEdgeCW(n)
var h,p,f,m
h=e.getDelaunayEdgeCCW(t),p=e.getDelaunayEdgeCW(t),f=i.getDelaunayEdgeCCW(n),m=i.getDelaunayEdgeCW(n),e.legalize(t,n),i.legalize(n,t),i.setDelaunayEdgeCCW(t,h),e.setDelaunayEdgeCW(t,p),e.setDelaunayEdgeCCW(n,f),i.setDelaunayEdgeCW(n,m),i.setConstrainedEdgeCCW(t,l),e.setConstrainedEdgeCW(t,c),e.setConstrainedEdgeCCW(n,u),i.setConstrainedEdgeCW(n,d),e.clearNeighbors(),i.clearNeighbors(),o&&i.markNeighbor(o),r&&e.markNeighbor(r),a&&e.markNeighbor(a),s&&i.markNeighbor(s),e.markNeighbor(i)}function g(e,t){for(F(t.point,t.next.point,t.next.next.point)===B.CCW?e.basin.left_node=t.next.next:e.basin.left_node=t.next,e.basin.bottom_node=e.basin.left_node;e.basin.bottom_node.next&&e.basin.bottom_node.point.y>=e.basin.bottom_node.next.point.y;)e.basin.bottom_node=e.basin.bottom_node.next
if(e.basin.bottom_node!==e.basin.left_node){for(e.basin.right_node=e.basin.bottom_node;e.basin.right_node.next&&e.basin.right_node.point.y<e.basin.right_node.next.point.y;)e.basin.right_node=e.basin.right_node.next
e.basin.right_node!==e.basin.bottom_node&&(e.basin.width=e.basin.right_node.point.x-e.basin.left_node.point.x,e.basin.left_highest=e.basin.left_node.point.y>e.basin.right_node.point.y,E(e,e.basin.bottom_node))}}function E(e,t){if(!y(e,t)){d(e,t)
var i
if(t.prev!==e.basin.left_node||t.next!==e.basin.right_node){if(t.prev===e.basin.left_node){if(i=F(t.point,t.next.point,t.next.next.point),i===B.CW)return
t=t.next}else if(t.next===e.basin.right_node){if(i=F(t.point,t.prev.point,t.prev.prev.point),i===B.CCW)return
t=t.prev}else t=t.prev.point.y<t.next.point.y?t.prev:t.next
E(e,t)}}}function y(e,t){var i
return i=e.basin.left_highest?e.basin.left_node.point.y-t.point.y:e.basin.right_node.point.y-t.point.y,e.basin.width>i?!0:!1}function A(e,t,i){e.edge_event.right?T(e,t,i):x(e,t,i)}function T(e,t,i){for(;i.next.point.x<t.p.x;)F(t.q,i.next.point,t.p)===B.CCW?b(e,t,i):i=i.next}function b(e,t,i){i.point.x<t.p.x&&(F(i.point,i.next.point,i.next.next.point)===B.CCW?w(e,t,i):(_(e,t,i),b(e,t,i)))}function w(e,t,i){d(e,i.next),i.next.point!==t.p&&F(t.q,i.next.point,t.p)===B.CCW&&F(i.point,i.next.point,i.next.next.point)===B.CCW&&w(e,t,i)}function _(e,t,i){F(i.next.point,i.next.next.point,i.next.next.next.point)===B.CCW?w(e,t,i.next):F(t.q,i.next.next.point,t.p)===B.CCW&&_(e,t,i.next)}function x(e,t,i){for(;i.prev.point.x>t.p.x;)F(t.q,i.prev.point,t.p)===B.CW?C(e,t,i):i=i.prev}function C(e,t,i){i.point.x>t.p.x&&(F(i.point,i.prev.point,i.prev.prev.point)===B.CW?R(e,t,i):(S(e,t,i),C(e,t,i)))}function S(e,t,i){F(i.prev.point,i.prev.prev.point,i.prev.prev.prev.point)===B.CW?R(e,t,i.prev):F(t.q,i.prev.prev.point,t.p)===B.CW&&S(e,t,i.prev)}function R(e,t,i){d(e,i.prev),i.prev.point!==t.p&&F(t.q,i.prev.point,t.p)===B.CW&&F(i.point,i.prev.point,i.prev.prev.point)===B.CW&&R(e,t,i)}function M(e,t,i,n,o){var r=n.neighborAcross(o)
k(r,"FLIP failed due to missing triangle!")
var a=r.oppositePoint(n,o)
if(n.getConstrainedEdgeAcross(o)){var s=n.index(o)
throw new V("poly2tri Intersecting Constraints",[o,a,n.getPoint((s+1)%3),n.getPoint((s+2)%3)])}if(U(o,n.pointCCW(o),n.pointCW(o),a))if(v(n,o,r,a),e.mapTriangleToNodes(n),e.mapTriangleToNodes(r),o===i&&a===t)i===e.edge_event.constrained_edge.q&&t===e.edge_event.constrained_edge.p&&(n.markConstrainedEdgeByPoints(t,i),r.markConstrainedEdgeByPoints(t,i),f(e,n),f(e,r))
else{var c=F(i,a,t)
n=P(e,c,n,r,o,a),M(e,t,i,n,o)}else{var u=L(t,i,r,a)
I(e,t,i,n,r,u),l(e,t,i,n,o)}}function P(e,t,i,n,o,r){var a
return t===B.CCW?(a=n.edgeIndex(o,r),n.delaunay_edge[a]=!0,f(e,n),n.clearDelaunayEdges(),i):(a=i.edgeIndex(o,r),i.delaunay_edge[a]=!0,f(e,i),i.clearDelaunayEdges(),n)}function L(e,t,i,n){var o=F(t,n,e)
if(o===B.CW)return i.pointCCW(n)
if(o===B.CCW)return i.pointCW(n)
throw new V("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[t,n,e])}function I(e,t,i,n,o,r){var a=o.neighborAcross(r)
k(a,"FLIP failed due to missing triangle")
var s=a.oppositePoint(o,r)
if(U(i,n.pointCCW(i),n.pointCW(i),s))M(e,i,s,a,s)
else{var l=L(t,i,a,s)
I(e,t,i,n,a,l)}}var k=e("./assert"),V=e("./pointerror"),N=e("./triangle"),D=e("./advancingfront").Node,H=e("./utils"),O=H.EPSILON,B=H.Orientation,F=H.orient2d,U=H.inScanArea,z=H.isAngleObtuse
i.triangulate=n},{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(e,t,i){"use strict"
var n=e("./pointerror"),o=e("./point"),r=e("./triangle"),a=e("./sweep"),s=e("./advancingfront"),l=s.Node,c=.3,u=function(e,t){if(this.p=e,this.q=t,e.y>t.y)this.q=e,this.p=t
else if(e.y===t.y)if(e.x>t.x)this.q=e,this.p=t
else if(e.x===t.x)throw new n("poly2tri Invalid Edge constructor: repeated points!",[e])
this.q._p2t_edge_list||(this.q._p2t_edge_list=[]),this.q._p2t_edge_list.push(this)},d=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1}
d.prototype.clear=function(){this.left_node=null,this.bottom_node=null,this.right_node=null,this.width=0,this.left_highest=!1}
var h=function(){this.constrained_edge=null,this.right=!1},p=function(e,t){t=t||{},this.triangles_=[],this.map_=[],this.points_=t.cloneArrays?e.slice(0):e,this.edge_list=[],this.pmin_=this.pmax_=null,this.front_=null,this.head_=null,this.tail_=null,this.af_head_=null,this.af_middle_=null,this.af_tail_=null,this.basin=new d,this.edge_event=new h,this.initEdges(this.points_)}
p.prototype.addHole=function(e){this.initEdges(e)
var t,i=e.length
for(t=0;i>t;t++)this.points_.push(e[t])
return this},p.prototype.AddHole=p.prototype.addHole,p.prototype.addHoles=function(e){var t,i=e.length
for(t=0;i>t;t++)this.initEdges(e[t])
return this.points_=this.points_.concat.apply(this.points_,e),this},p.prototype.addPoint=function(e){return this.points_.push(e),this},p.prototype.AddPoint=p.prototype.addPoint,p.prototype.addPoints=function(e){return this.points_=this.points_.concat(e),this},p.prototype.triangulate=function(){return a.triangulate(this),this},p.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}},p.prototype.getTriangles=function(){return this.triangles_},p.prototype.GetTriangles=p.prototype.getTriangles,p.prototype.front=function(){return this.front_},p.prototype.pointCount=function(){return this.points_.length},p.prototype.head=function(){return this.head_},p.prototype.setHead=function(e){this.head_=e},p.prototype.tail=function(){return this.tail_},p.prototype.setTail=function(e){this.tail_=e},p.prototype.getMap=function(){return this.map_},p.prototype.initTriangulation=function(){var e,t=this.points_[0].x,i=this.points_[0].x,n=this.points_[0].y,r=this.points_[0].y,a=this.points_.length
for(e=1;a>e;e++){var s=this.points_[e]
s.x>t&&(t=s.x),s.x<i&&(i=s.x),s.y>n&&(n=s.y),s.y<r&&(r=s.y)}this.pmin_=new o(i,r),this.pmax_=new o(t,n)
var l=c*(t-i),u=c*(n-r)
this.head_=new o(t+l,r-u),this.tail_=new o(i-l,r-u),this.points_.sort(o.compare)},p.prototype.initEdges=function(e,t){var i,n=e.length,o=t?e.length-1:e.length
for(i=0;o>i;++i)this.edge_list.push(new u(e[i],e[(i+1)%n]))},p.prototype.getPoint=function(e){return this.points_[e]},p.prototype.addToMap=function(e){this.map_.push(e)},p.prototype.locateNode=function(e){return this.front_.locateNode(e.x)},p.prototype.createAdvancingFront=function(){var e,t,i,n=new r(this.points_[0],this.tail_,this.head_)
this.map_.push(n),e=new l(n.getPoint(1),n),t=new l(n.getPoint(0),n),i=new l(n.getPoint(2)),this.front_=new s(e,i),e.next=t,t.next=i,t.prev=e,i.prev=t},p.prototype.removeNode=function(e){},p.prototype.mapTriangleToNodes=function(e){for(var t=0;3>t;++t)if(!e.getNeighbor(t)){var i=this.front_.locatePoint(e.pointCW(e.getPoint(t)))
i&&(i.triangle=e)}},p.prototype.removeFromMap=function(e){var t,i=this.map_,n=i.length
for(t=0;n>t;t++)if(i[t]===e){i.splice(t,1)
break}},p.prototype.meshClean=function(e){for(var t,i,n=[e];t=n.pop();)if(!t.isInterior())for(t.setInterior(!0),this.triangles_.push(t),i=0;3>i;i++)t.constrained_edge[i]||n.push(t.getNeighbor(i))},t.exports=p},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(e,t,i){"use strict"
var n=e("./xy"),o=function(e,t,i){this.points_=[e,t,i],this.neighbors_=[null,null,null],this.interior_=!1,this.constrained_edge=[!1,!1,!1],this.delaunay_edge=[!1,!1,!1]},r=n.toString
o.prototype.toString=function(){return"["+r(this.points_[0])+r(this.points_[1])+r(this.points_[2])+"]"},o.prototype.getPoint=function(e){return this.points_[e]},o.prototype.GetPoint=o.prototype.getPoint,o.prototype.getPoints=function(){return this.points_},o.prototype.getNeighbor=function(e){return this.neighbors_[e]},o.prototype.containsPoint=function(e){var t=this.points_
return e===t[0]||e===t[1]||e===t[2]},o.prototype.containsEdge=function(e){return this.containsPoint(e.p)&&this.containsPoint(e.q)},o.prototype.containsPoints=function(e,t){return this.containsPoint(e)&&this.containsPoint(t)},o.prototype.isInterior=function(){return this.interior_},o.prototype.setInterior=function(e){return this.interior_=e,this},o.prototype.markNeighborPointers=function(e,t,i){var n=this.points_
if(e===n[2]&&t===n[1]||e===n[1]&&t===n[2])this.neighbors_[0]=i
else if(e===n[0]&&t===n[2]||e===n[2]&&t===n[0])this.neighbors_[1]=i
else{if(!(e===n[0]&&t===n[1]||e===n[1]&&t===n[0]))throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call")
this.neighbors_[2]=i}},o.prototype.markNeighbor=function(e){var t=this.points_
e.containsPoints(t[1],t[2])?(this.neighbors_[0]=e,e.markNeighborPointers(t[1],t[2],this)):e.containsPoints(t[0],t[2])?(this.neighbors_[1]=e,e.markNeighborPointers(t[0],t[2],this)):e.containsPoints(t[0],t[1])&&(this.neighbors_[2]=e,e.markNeighborPointers(t[0],t[1],this))},o.prototype.clearNeighbors=function(){this.neighbors_[0]=null,this.neighbors_[1]=null,this.neighbors_[2]=null},o.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1,this.delaunay_edge[1]=!1,this.delaunay_edge[2]=!1},o.prototype.pointCW=function(e){var t=this.points_
return e===t[0]?t[2]:e===t[1]?t[0]:e===t[2]?t[1]:null},o.prototype.pointCCW=function(e){var t=this.points_
return e===t[0]?t[1]:e===t[1]?t[2]:e===t[2]?t[0]:null},o.prototype.neighborCW=function(e){return e===this.points_[0]?this.neighbors_[1]:e===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]},o.prototype.neighborCCW=function(e){return e===this.points_[0]?this.neighbors_[2]:e===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]},o.prototype.getConstrainedEdgeCW=function(e){return e===this.points_[0]?this.constrained_edge[1]:e===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]},o.prototype.getConstrainedEdgeCCW=function(e){return e===this.points_[0]?this.constrained_edge[2]:e===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]},o.prototype.getConstrainedEdgeAcross=function(e){return e===this.points_[0]?this.constrained_edge[0]:e===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]},o.prototype.setConstrainedEdgeCW=function(e,t){e===this.points_[0]?this.constrained_edge[1]=t:e===this.points_[1]?this.constrained_edge[2]=t:this.constrained_edge[0]=t},o.prototype.setConstrainedEdgeCCW=function(e,t){e===this.points_[0]?this.constrained_edge[2]=t:e===this.points_[1]?this.constrained_edge[0]=t:this.constrained_edge[1]=t},o.prototype.getDelaunayEdgeCW=function(e){return e===this.points_[0]?this.delaunay_edge[1]:e===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]},o.prototype.getDelaunayEdgeCCW=function(e){return e===this.points_[0]?this.delaunay_edge[2]:e===this.points_[1]?this.delaunay_edge[0]:this.delaunay_edge[1]},o.prototype.setDelaunayEdgeCW=function(e,t){e===this.points_[0]?this.delaunay_edge[1]=t:e===this.points_[1]?this.delaunay_edge[2]=t:this.delaunay_edge[0]=t},o.prototype.setDelaunayEdgeCCW=function(e,t){e===this.points_[0]?this.delaunay_edge[2]=t:e===this.points_[1]?this.delaunay_edge[0]=t:this.delaunay_edge[1]=t},o.prototype.neighborAcross=function(e){return e===this.points_[0]?this.neighbors_[0]:e===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]},o.prototype.oppositePoint=function(e,t){var i=e.pointCW(t)
return this.pointCW(i)},o.prototype.legalize=function(e,t){var i=this.points_
if(e===i[0])i[1]=i[0],i[0]=i[2],i[2]=t
else if(e===i[1])i[2]=i[1],i[1]=i[0],i[0]=t
else{if(e!==i[2])throw new Error("poly2tri Invalid Triangle.legalize() call")
i[0]=i[2],i[2]=i[1],i[1]=t}},o.prototype.index=function(e){var t=this.points_
if(e===t[0])return 0
if(e===t[1])return 1
if(e===t[2])return 2
throw new Error("poly2tri Invalid Triangle.index() call")},o.prototype.edgeIndex=function(e,t){var i=this.points_
if(e===i[0]){if(t===i[1])return 2
if(t===i[2])return 1}else if(e===i[1]){if(t===i[2])return 0
if(t===i[0])return 2}else if(e===i[2]){if(t===i[0])return 1
if(t===i[1])return 0}return-1},o.prototype.markConstrainedEdgeByIndex=function(e){this.constrained_edge[e]=!0},o.prototype.markConstrainedEdgeByEdge=function(e){this.markConstrainedEdgeByPoints(e.p,e.q)},o.prototype.markConstrainedEdgeByPoints=function(e,t){var i=this.points_
t===i[0]&&e===i[1]||t===i[1]&&e===i[0]?this.constrained_edge[2]=!0:t===i[0]&&e===i[2]||t===i[2]&&e===i[0]?this.constrained_edge[1]=!0:(t===i[1]&&e===i[2]||t===i[2]&&e===i[1])&&(this.constrained_edge[0]=!0)},t.exports=o},{"./xy":11}],10:[function(e,t,i){"use strict"
function n(e,t,i){var n=(e.x-i.x)*(t.y-i.y),o=(e.y-i.y)*(t.x-i.x),r=n-o
return r>-a&&a>r?s.COLLINEAR:r>0?s.CCW:s.CW}function o(e,t,i,n){var o=(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)
if(o>=-a)return!1
var r=(e.x-i.x)*(n.y-i.y)-(n.x-i.x)*(e.y-i.y)
return a>=r?!1:!0}function r(e,t,i){var n=t.x-e.x,o=t.y-e.y,r=i.x-e.x,a=i.y-e.y
return 0>n*r+o*a}var a=1e-12
i.EPSILON=a
var s={CW:1,CCW:-1,COLLINEAR:0}
i.Orientation=s,i.orient2d=n,i.inScanArea=o,i.isAngleObtuse=r},{}],11:[function(e,t,i){"use strict"
function n(e){return"("+e.x+";"+e.y+")"}function o(e){var t=e.toString()
return"[object Object]"===t?n(e):t}function r(e,t){return e.y===t.y?e.x-t.x:e.y-t.y}function a(e,t){return e.x===t.x&&e.y===t.y}t.exports={toString:o,toStringBase:n,compare:r,equals:a}},{}]},{},[6])(6)}),function(){"use strict"
var e=Autodesk.Viewing
e.EventDispatcher=function(){},e.EventDispatcher.prototype={constructor:e.EventDispatcher,apply:function(t){t.addEventListener=e.EventDispatcher.prototype.addEventListener,t.hasEventListener=e.EventDispatcher.prototype.hasEventListener,t.removeEventListener=e.EventDispatcher.prototype.removeEventListener,t.fireEvent=e.EventDispatcher.prototype.fireEvent,t.dispatchEvent=e.EventDispatcher.prototype.fireEvent},addEventListener:function(e,t){void 0===this.listeners&&(this.listeners={}),"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push(t)},hasEventListener:function(e,t){if(void 0===this.listeners)return!1
var i=this.listeners
return void 0!==i[e]&&-1!==i[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0===this.listeners&&(this.listeners={}),this.listeners[e]instanceof Array)for(var i=this.listeners[e],n=0,o=i.length;o>n;n++)if(i[n]===t){i.splice(n,1)
break}},fireEvent:function(e){if(void 0===this.listeners&&(this.listeners={}),"string"==typeof e&&(e={type:e}),!e.target)try{e.target=this}catch(t){}if(!e.type)throw new Error("event type unknown.")
if(this.listeners[e.type]instanceof Array)for(var i=this.listeners[e.type].slice(),n=0;n<i.length;n++)i[n].call(this,e)}}}(),Autodesk.Viewing.FileLoader=function(e){this.viewer=e},Autodesk.Viewing.FileLoader.prototype.constructor=Autodesk.Viewing.FileLoader,Autodesk.Viewing.FileLoader.prototype.loadFile=function(e,t,i,n){return!1},function(){"use strict"
var e=function(){function e(e,t,i){return o[e]?!1:(o[e]={loader:i,extensions:t},!0)}function t(e){return o[e]?o[e].loader:null}function i(e){return o[e]?(delete o[e],!0):!1}function n(e){e=e?e.toLowerCase():""
for(var t in o){var i=o[t]
if(i)for(var n=0;n<i.extensions.length;n++)if(i.extensions[n].toLowerCase()===e)return i.loader}return null}var o={}
return{registerFileLoader:e,getFileLoader:t,getFileLoaderForExtension:n,unregisterFileLoader:i}}
Autodesk.Viewing.FileLoaderManager=new e}(),function(){function e(e){for(var t=0;t<o.length;++t)document.addEventListener(o[t],e,!1)}function t(e){for(var t=0;t<o.length;++t)document.removeEventListener(o[t],e,!1)}var i=Autodesk.Viewing,n=Autodesk.Viewing.Private,o=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"]
i.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2},i.ScreenModeDelegate=function(t){this.viewer=t,this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this),this.getMode()===i.ScreenMode.kFullScreen&&e(this.bindFullscreenEventListener)},i.ScreenModeDelegate.prototype.uninitialize=function(){t(this.bindFullscreenEventListener),this.viewer=null},i.ScreenModeDelegate.prototype.isModeSupported=function(e){return!0},i.ScreenModeDelegate.prototype.setMode=function(e){var t=this.getMode()
return e!==t&&this.isModeSupported(e)?(this.doScreenModeChange(t,e),this.onScreenModeChanged(t,e),!0):!1},i.ScreenModeDelegate.prototype.getMode=function(){throw"Implement getMode() in derived class"},i.ScreenModeDelegate.prototype.getNextMode=function(){var e,t=this.getMode(),n=i.ScreenMode
return t===n.kNormal&&this.isModeSupported(n.kFullBrowser)?e=n.kFullBrowser:t===n.kNormal&&this.isModeSupported(n.kFullScreen)?e=n.kFullScreen:t===n.kFullBrowser&&this.isModeSupported(n.kFullScreen)?e=n.kFullScreen:t===n.kFullBrowser&&this.isModeSupported(n.kNormal)?e=n.kNormal:t===n.kFullScreen&&this.isModeSupported(n.kNormal)?e=n.kNormal:t===n.kFullScreen&&this.isModeSupported(n.kFullBrowser)&&(e=n.kFullBrowser),e},i.ScreenModeDelegate.prototype.getEscapeMode=function(){return this.getMode()!==i.ScreenMode.kNormal?i.ScreenMode.kNormal:void 0},i.ScreenModeDelegate.prototype.fullscreenEventListener=function(){if(inFullscreen())this.viewer.resize()
else{var e=i.ScreenMode
this.doScreenModeChange(e.kFullScreen,e.kNormal),this.onScreenModeChanged(e.kFullScreen,e.kNormal)}},i.ScreenModeDelegate.prototype.doScreenModeChange=function(e,t){throw"Implement doScreenModeChange() in derived class"},i.ScreenModeDelegate.prototype.onScreenModeChanged=function(n,o){n===i.ScreenMode.kFullScreen?t(this.bindFullscreenEventListener):o===i.ScreenMode.kFullScreen&&e(this.bindFullscreenEventListener),this.viewer.resize(),this.viewer.fireEvent({type:i.FULLSCREEN_MODE_EVENT,mode:o})},i.ApplicationScreenModeDelegate=function(e){i.ScreenModeDelegate.call(this,e)},i.ApplicationScreenModeDelegate.prototype=Object.create(i.ScreenModeDelegate.prototype),i.ApplicationScreenModeDelegate.prototype.constructor=i.ApplicationScreenModeDelegate,i.ApplicationScreenModeDelegate.prototype.isModeSupported=function(e){return e!==i.ScreenMode.kFullBrowser},i.ApplicationScreenModeDelegate.prototype.getMode=function(){return inFullscreen()?i.ScreenMode.kFullScreen:i.ScreenMode.kNormal},i.ApplicationScreenModeDelegate.prototype.doScreenModeChange=function(e,t){var n=this.viewer.container
t===i.ScreenMode.kNormal?(n.classList.remove("viewer-fill-browser"),exitFullscreen()):t===i.ScreenMode.kFullScreen&&(n.classList.add("viewer-fill-browser"),launchFullscreen(n))},i.NullScreenModeDelegate=function(e){i.ScreenModeDelegate.call(this,e)},i.NullScreenModeDelegate.prototype=Object.create(i.ScreenModeDelegate.prototype),i.NullScreenModeDelegate.prototype.constructor=i.ScreenModeDelegate,i.NullScreenModeDelegate.prototype.isModeSupported=function(e){return!1},i.NullScreenModeDelegate.prototype.getMode=function(){return i.ScreenMode.kNormal},i.ScreenModeMixin=function(){},i.ScreenModeMixin.prototype={setScreenModeDelegate:function(e){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),e?this.screenModeDelegateClass=e:null===e?this.screenModeDelegateClass=i.NullScreenModeDelegate:this.screenModeDelegateClass=i.ApplicationScreenModeDelegate},getScreenModeDelegate:function(){return this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this)),this.screenModeDelegate},isScreenModeSupported:function(e){return this.getScreenModeDelegate().isModeSupported(e)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(e){var t=n.logger
if(t){var i={category:"screen_mode",value:e}
t.log(i)}return this.getScreenModeDelegate().setMode(e)},getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var e=this.getScreenModeDelegate().getNextMode()
return void 0!==e?this.setScreenMode(e):!1},escapeScreenMode:function(){var e=this.getScreenModeDelegate().getEscapeMode()
return void 0!==e?this.setScreenMode(e):!1},apply:function(e){var t=i.ScreenModeMixin.prototype
e.setScreenModeDelegate=t.setScreenModeDelegate,e.getScreenModeDelegate=t.getScreenModeDelegate,e.isScreenModeSupported=t.isScreenModeSupported,e.canChangeScreenMode=t.canChangeScreenMode,e.setScreenMode=t.setScreenMode,e.getScreenMode=t.getScreenMode,e.nextScreenMode=t.nextScreenMode,e.escapeScreenMode=t.escapeScreenMode}}}(),function(){"use strict"
var e=Autodesk.Viewing,t={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in"}
e.ModelUnits=t
var i=function(e){this.myData=e,this.sharedPath=null,this.propWorker=null}
e.EventDispatcher.prototype.apply(i.prototype),i.prototype.constructor=i,i.prototype.setData=function(e){this.myData=e},i.prototype.getData=function(){return this.myData},i.prototype.getRoot=function(){return this.myData&&this.myData.instanceTree?this.myData.instanceTree.root:null},i.prototype.getRootId=function(){return this.myData&&this.myData.instanceTree?this.myData.instanceTree.getRootId():0},i.prototype.getBoundingBox=function(){return this.myData?this.myData.bbox:null},i.prototype.getUnitScale=function(){var e
switch(e=this.is2d()?this.getMetadata("page_dimensions","model_units",null):this.getMetadata("distance unit","value",null)){case"meter":case"m":return 1
case"foot":case"ft":return.3048
case"inch":case"in":return.0254
case"centimeter":case"cm":return.01
case"millimeter":case"mm":return.001
default:return 1}},i.prototype.getUnitString=function(){var e
switch(e=this.is2d()?this.getMetadata("page_dimensions","page_units",null):this.getMetadata("distance unit","value",null)){case"meter":case"m":return t.METER
case"foot":case"ft":return t.FOOT
case"inch":case"in":return t.INCH
case"centimeter":case"cm":return t.CENTIMETER
case"millimeter":case"mm":return t.MILLIMETER
default:return null}},i.prototype.getUnitString2d=function(){var e
switch(e=this.getMetadata("page_dimensions","model_units",null)){case"meter":case"m":return t.METER
case"foot":case"ft":return t.FOOT
case"inch":case"in":return t.INCH
case"centimeter":case"cm":return t.CENTIMETER
case"millimeter":case"mm":return t.MILLIMETER
default:return null}},i.prototype.getMetadata=function(e,t,i){if(this.myData){var n=this.myData.metadata
if(n){var o=n[e]
if(void 0!==o){if(!t)return o
var r=o[t]
if(void 0!==r)return r}}}return i},i.prototype.getDefaultCamera=function(){var e=this.myData
if(!e)return null
var t=null,i=e.cameras?e.cameras.length:0
if(i>0){var n=this.getMetadata("default camera","index",null)
if(null!==n&&e.cameras[n])t=e.cameras[n]
else{for(var o=0;i>o;o++){var r=e.cameras[o]
if(r.isPerspective){t=r
break}}t||(t=e.cameras[0])}}return t},i.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)},i.prototype.geomPolyCount=function(){return this.myData?this.myData.geomPolyCount:null},i.prototype.instancePolyCount=function(){return this.myData?this.myData.instancePolyCount:null},i.prototype.getLayersRoot=function(){return this.is2d()?this.myData?this.myData.layersRoot:null:(console.warn("Autodesk.Viewing.Model.getLayersRoot is not yet implemented for 3D"),null)},i.prototype.is2d=function(){return!(!this.myData||!this.myData.is2d)},i.prototype.isLoadDone=function(){return!(!this.myData||!this.myData.loadDone)},i.prototype.isObjectTreeCreated=function(){return!!this.myData.instanceTree},i.prototype.getProperties=function(e,t,i){this.myData&&this.myData.propWorker.getProperties(e,t,i)},i.prototype.getExternalIdMapping=function(e,t){this.myData&&this.myData.propWorker.getExternalIdMapping(e,t)},i.prototype.getObjectTree=function(e,t){!this.myData&&t?t():this.myData.propWorker.getObjectTree(e,t)},i.prototype.search=function(e,t,i,n){var o=this
this.isLoadDone()?this.myData.propWorker.searchProperties(e,n,t,i):this.getObjectTree(function(){o.myData.propWorker.searchProperties(e,n,t,i)})}
var n=function(e){var t=.001,i=e
if(Math.abs(i[0])<t)if(Math.abs(i[4])>t)for(var n=0;4>n;n++){var o=i[n]
i[n]=i[n+4],i[n+4]=o}else for(var n=0;4>n;n++){var o=i[n]
i[n]=i[n+8],i[n+8]=o}if(Math.abs(i[5])<t)for(var n=4;8>n;n++){var o=i[n]
i[n]=i[n+4],i[n+4]=o}},o=function(e,t,i,n){var o,r,a,s,l,c,u=!1
a=n[i[i.length-1]].x,s=n[i[i.length-1]].y,o=s>=t
for(var d=0,h=i.length;h>d;++d)l=n[i[d]].x,c=n[i[d]].y,r=c>=t,o!=r&&(c-t)*(a-l)>=(l-e)*(s-c)==r&&(u=!u),o=r,a=l,s=c
return u},r=function(e,t,i,n){for(var r=!1,a=0;a<i.length;a++)o(e,t,i[a],n)&&(r=!r)
return r}
i.prototype.getPageToModelTransform=function(e){var t=this.myData,i=t.metadata,o=i.page_dimensions,r=t.viewports[e]
if(!r)return new THREE.Matrix4
t.viewportTransforms||(t.viewportTransforms=new Array(t.viewports.length))
var a=t.viewportTransforms[e]
if(a)return a
var s=new LmvMatrix4(!0).set(o.logical_width/o.page_width,0,0,o.logical_offset_x,0,o.logical_height/o.page_height,0,o.logical_offset_y,0,0,1,0,0,0,0,1),l=r.transform.slice()
n(l)
var c=new LmvMatrix4(!0)
c.elements.set(l)
var u=new LmvMatrix4(!0)
return u.getInverse(c),u.multiply(s),t.viewportTransforms[e]=u,u},i.prototype.pageToModel=function(e,t,i){var n=.01,o=this.getPageToModelTransform(i),r=(new THREE.Vector3).set(e.x,e.y,0).applyMatrix4(o),a=(new THREE.Vector3).set(t.x,t.y,0).applyMatrix4(o),s=e.distanceTo(t),l=r.distanceTo(a)
if(Math.abs(l-s)<n){for(var c=this.pointInClip(e,i),u=r.clone(),d=a.clone(),h=0;h<c.length;h++){var p=this.getPageToModelTransform(c[h])
if(r.set(e.x,e.y,0).applyMatrix4(p),a.set(t.x,t.y,0).applyMatrix4(p),l=r.distanceTo(a),Math.abs(l-s)>n)break}h>=c.length&&(r=u,a=d)}e.x=r.x,e.y=r.y,t.x=a.x,t.y=a.y},i.prototype.pointInClip=function(e,t){for(var i=this.myData.clips,n=[],o=0;o<i.length;o++)if(o!==t){for(var a=[],s=[],l=i[o].contourCounts,c=i[o].points,u=0,d=[],h=0;h<l.length;h++){for(var p=0;p<l[h];p++)a.push(u),u++
s.push(a),a=[]}for(var h=0;h<c.length;h+=2){var f={x:c[h],y:c[h+1]}
d.push(f)}var m=r(e.x,e.y,s,d)
m&&n.push(o)}return n},i.prototype.getTopoIndex=function(e){if(this.myData&&this.myData.fragments){var t=this.myData.fragments.topoIndexes
if(t)return t[e]}},i.prototype.getTopology=function(e){if(this.myData){var t=this.myData.topology
if(t){var i=t[e]
if(i)return i}}},i.prototype.hasTopology=function(){if(this.myData){var e=this.myData.topology
if(e)return!0}},i.prototype.getAttributeToIdMap=function(e,t){var i=this
this.isLoadDone()?this.myData.propWorker.attributeToIdMap(e,t):this.getObjectTree(function(){i.myData.propWorker.attributeToIdMap(e,t)})},e.Model=i}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var e=Autodesk.Viewing.Private
e.inWorkerThread="undefined"!=typeof self&&"undefined"==typeof window,e.ViewingService={},e.ViewingService.generateUrl=function(t,i,n,o){if(0!==n.indexOf("urn:"))return n
var r=t+"/"
return"items"!==i&&(n=n.substr(4)),r+="bubbles"===i&&0==e.env.indexOf("Autodesk")?n:i+"/"+n},e.ViewingService.get=function(t,i,n,o,r,a){function s(e){r(c.status,c.statusText,{url:n})}function l(e){200===c.status?o(c.response?c.response:c.responseText):s(e)}var a=a?a:{},n=e.ViewingService.generateUrl(t,i,n,a)
a.queryParams&&(n=n+"?"+a.queryParams)
var c=new XMLHttpRequest
try{var u=a.hasOwnProperty("asynchronous")?a.asynchronous:!0
if(c.open(a.noBody?"HEAD":"GET",n,u),a.hasOwnProperty("responseType")&&(c.responseType=a.responseType),c.withCredentials=!0,a.hasOwnProperty("withCredentials")&&(c.withCredentials=a.withCredentials),a.headers)for(var d in a.headers)c.setRequestHeader(d,a.headers[d])
u&&(c.onload=l,c.onerror=s,c.ontimeout=s),c.send(),a.skipAssetCallback||(e.inWorkerThread?self.postMessage({assetRequest:[n,a.headers,null]}):e.assets.push([n,a.headers,null])),u||l(null)}catch(h){r(c.status,c.statusText,{url:n,exception:h})}}}()
var Xhr=function(){var e=function(e,t,i){this.xhr=new XMLHttpRequest,this.errorHandler=e,this.success=!1,this.viewing_url=i,this.auth=t}
return e.prototype.generateUrl=function(e,t,i){var n=e.indexOf("urn:")
if(0===n&&this.viewing_url){var o=i&&i.feature?i.feature:null
o?"render"==o?(e=e.substr(4),e=this.viewing_url+"/"+o+"/"+encodeURIComponent(e)):"bubbles"==o?(e=e.substr(4),e=this.viewing_url+"/"+o+"/"+encodeURIComponent(e)):"comments"==o?(e=e.substr(4),e=this.viewing_url+"/"+o+"/file/"+encodeURIComponent(e)):e=this.viewing_url+"/"+o+"/"+encodeURIComponent(e.substr(n)):e=this.viewing_url+"/items/"+encodeURIComponent(e.substr(n))}return t&&(e=e+"?"+t),e},e.prototype.addHeaders=function(e){for(var t in e)this.xhr.setRequestHeader(t,e[t])},e.prototype.get=function(e,t,i,n,o,r,a){var s=this.generateUrl(e,r,{feature:o,oss_url:a})
try{this.xhr.open("GET",s,!!n),this.xhr.responseType=i,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),n&&(this.xhr.onload=n),this.addHeaders(t),this.xhr.send()}catch(l){return this.errorHandler&&this.errorHandler.networkFailure(s,l),null}return this.errorCheck(s,200),this.xhr.response},e.prototype.post=function(e,t,i,n,o,r){var a=this.generateUrl(e,null,{feature:r})
t["Content-Type"]||(t["Content-Type"]="application/json")
try{this.xhr.open("POST",a,!!o),this.xhr.responseType=n,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),o&&(this.xhr.onload=o),this.addHeaders(t),this.xhr.send(i)}catch(s){return this.errorHandler&&this.errorHandler.networkFailure(a,s),null}return this.errorCheck(a,200,201),this.xhr.response},e.prototype.getRange=function(e,t,i,n,o,r){var e=this.generateUrl(path)
t.Range="bytes="+n+"-"+o
try{this.xhr.open("GET",e,!!r),this.xhr.responseType=i,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),r&&(this.xhr.onload=r),this.addHeaders(t),this.xhr.send()}catch(a){return this.errorHandler&&this.errorHandler.networkFailure(e,a),null}return this.errorCheck(e,206),this.xhr.response},e.prototype.head=function(e){var e=this.generateUrl(path)
try{this.xhr.open("GET",e,!1),this.success=!1,this.auth&&(this.xhr.withCredentials=!0),this.addHeaders([]),this.xhr.send()}catch(t){return this.errorHandler&&this.errorHandler.networkFailure(e,t),null}this.errorCheck(e,200)
var i=[]
return i["Accept-Ranges"]=this.xhr.getResponseHeader("Accept-Ranges"),i["Content-Length"]=this.xhr.getResponseHeader("Content-Length"),i},e.prototype.errorCheck=function(e,t){if(4===this.xhr.readyState&&this.xhr.status){var i
for(i=1;i<arguments.length&&this.xhr.status!==arguments[i];i++);i===arguments.length&&this.errorHandler?this.errorHandler.unsuccessfulResponse(e,this.xhr.status,this.xhr.statusText):this.success=!0}else this.success=!0},e}(),XhrErrorHandler=function(){var e=function(e){this.host=e,this.ignoreFileNotFound=!1}
return e.prototype.networkFailure=function(e,t){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:e,exception:t.toString(),stack:t.stack})},e.prototype.unsuccessfulResponse=function(e,t,i){403==t?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:e,httpStatus:t,httpStatusText:i}):404==t?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:e,httpStatus:t,httpStatusText:i}):t>=500&&600>t?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:e,httpStatus:t,httpStatusText:i}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:e,httpStatus:t,httpStatusText:i})},e}()
if("undefined"!=typeof window){var RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null
if(navigator.mozGetUserMedia)webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(e,t,i){var n=null,o=e.split(":")
if(0===o[0].indexOf("stun"))n={url:e}
else if(0===o[0].indexOf("turn")&&(-1!==e.indexOf("transport=udp")||-1===e.indexOf("?transport"))){var r=e.split("?")
n={url:r[0],credential:i,username:t}}return n},attachMediaStream=function(e,t){console.log("Attaching media stream"),e.mozSrcObject=t,e.play()},reattachMediaStream=function(e,t){console.log("Reattaching media stream"),e.mozSrcObject=t.mozSrcObject,e.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]}
else if(navigator.webkitGetUserMedia){var match=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)
webrtcDetectedBrowser="chrome",webrtcDetectedVersion=match?parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]):40,createIceServer=function(e,t,i){var n=null,o=e.split(":")
if(0===o[0].indexOf("stun"))n={url:e}
else if(0===o[0].indexOf("turn"))if(28>webrtcDetectedVersion){var r=e.split("turn:")
n={url:"turn:"+t+"@"+r[1],credential:i}}else n={url:e,credential:i,username:t}
return n},RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(e,t){"undefined"!=typeof e.srcObject?e.srcObject=t:"undefined"!=typeof e.mozSrcObject?e.mozSrcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):console.log("Error attaching stream to element.")},reattachMediaStream=function(e,t){e.src=t.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})}else console.log("Browser does not appear to be WebRTC-capable")}!function(){"use strict"
function e(e,t){function o(){return i.config.userName&&i.config.userName.length?i.config.userName:m?m.slice(0,5):"Unknown"}function r(e){switch(e.type){case"txt":c(e)
break
case"joinok":l(e)
break
case"join_error":break
case"sessionId":stderr("Connect successful, your id is: "+e.id),m=e.id
break
case"joined":e.userStatus="joined",a(e)
break
case"left":e.userStatus="left",s(e)
break
case"camera":case"pointer":break
default:stderr(e)}var t=e.roomId,i={type:f[e.type],data:e,channelId:t}
A.dispatchEvent(i)}function a(e){if(e.user.name&&e.user.name.length||(e.user.name=e.user.id.slice(0,5)),e.roomId){var t=y[e.roomId]
t?(t.users.push(e.user),stderr(e.user+" joined room "+e.roomId)):stderr("Channel "+e.roomId+" does not exist for socket "+m)}}function s(e){stderr(e.user+" left room "+e.room)
for(var t in y){for(var i=y[t].users,n=-1,o=0;o<i.length;o++)if(i[o].id==e.user){n=o
break}-1!=n&&i.splice(n,1),delete y[t].userSet[e.user]}}function l(e){var t=y[e.roomId]
stderr("joined channel "+e.roomId),e.users&&e.users.length?t.users=e.users:t.users=[]
for(var i=0;i<t.users.length;i++)t.users[i].name&&t.users[i].name.length||(t.users[i].name=t.users[i].id.slice(0,5))
var n=o(),r=Autodesk.Viewing.i18n.translate("you"),a={id:m,name:n+" ("+r+")",isSelf:!0,status:0}
t.userSet[m]||(t.users.push(a),t.userSet[m]=a),0!=a.id.indexOf(n)&&A.sendChatMessage("/nick "+n,e.roomId)}function c(e){if(0==e.msg.indexOf("/nick ")){var t=A.getUserById(e.from,e.roomId),i=e.msg.slice(6)
if(i.length&&(t.name=i,t.id==m)){var n=Autodesk.Viewing.i18n.translate("you")
t.name+=" ("+n+")"}A.dispatchEvent({type:"userListChange",data:e,channelId:e.roomId})}}function u(e){g<v.length?(stderr("Connect failed, trying another server..."),p.disconnect(),p=null,g++,A.connect(A.sessionID)):A.dispatchEvent({type:"socketError",data:e})}function d(e){A.dispatchEvent({type:"socketError",data:e})}function h(e){g=0
for(var t in E)A.join(t)}var p,f={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange","private":"privateMessage",join_error:"socketError"},m=null,v=Array.isArray(e)?e:[e],g=0,E={},y={},A=this
this.connect=function(e){return p?void 0:"undefined"!=typeof window.WebSocket?(n||(n="undefined"!=typeof lmv_io?lmv_io:io),this.sessionID=e,p=n.connect(v[g]+"?sessionID="+e,{path:t,forceNew:!0}),p.on("connect",h),p.on("message",r),p.on("connect_error",u),p.on("error",d),!0):!1},this.join=function(e){return p&&p.connected?(delete E[e],y[e]={id:e,users:[],userSet:{}},void p.emit("join",{roomId:e,name:o()})):void(E[e]=1)},this.disconnect=function(){p&&(p.disconnect(),p=null,y={},m=null)},this.sendMessage=function(e,t,i){var n={type:e,from:m,msg:t,roomId:i}
p.emit("message",n)},this.sendPrivateMessage=function(e,t){var i={type:"private",target:e,from:m,msg:t}
p.emit("message",i)},this.sendChatMessage=function(e,t){var i={type:"txt",from:m,msg:e,roomId:t}
p.emit("message",i),r(i)},this.getUserById=function(e,t){for(var i=y[t].users,n=0;n<i.length;n++)if(i[n].id==e)return i[n]
return null},this.getLocalId=function(){return m},this.getChannelInfo=function(e){return y[e]},this.isConnected=function(){return p}}var t=Autodesk.Viewing,i=t.Private
i.config={userName:""},i.setUserName=function(e){i.config.userName=e}
var n
e.prototype.constructor=e,t.EventDispatcher.prototype.apply(e.prototype)
var o={}
e.GetInstance=function(e,t){e||(e=i.EnvironmentConfigurations[i.env].LMV.RTC),Array.isArray(e)||(e=[e])
var n=o[e[0]]
return n?n:(n=new i.MessageClient(e,t),o[e[0]]=n,n)},Autodesk.Viewing.Private.MessageClient=e}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var t=Autodesk.Viewing,i=t.Private
i.P2PClient=function(t){function i(e){try{c=new RTCPeerConnection(E),c.onicecandidate=function(e){e.candidate?m.sendPrivateMessage(u,{type:"candidate",label:e.candidate.sdpMLineIndex,id:e.candidate.sdpMid,candidate:e.candidate.candidate}):stderr("End of candidates.")},c.ondatachannel=function(e){stderr("Data channel added."),p=e.channel,p.onmessage=a,f.dispatchEvent({type:"dataChannelAdded",data:e.channel})},c.onaddstream=function(e){stderr("Remote stream added."),h=e.stream,f.dispatchEvent({type:"remoteStreamAdded",data:e.stream})},c.onremovestream=function(e){stderr("Remote stream removed. Event: ",e),h=null,f.dispatchEvent({type:"remoteStreamRemoved",data:e.stream})},e&&(p=c.createDataChannel("sendDataChannel",{reliable:!1,ordered:!1}),p.onmessage=a)}catch(t){return stderr("Failed to create PeerConnection, exception: "+t.message),void alert("Cannot create RTCPeerConnection object.")}}function n(t){stderr("createOffer() error: ",e)}function o(e){if(c.setLocalDescription(e),m.sendPrivateMessage(u,e),g.length){for(var t=0;t<g.length;t++)c.addIceCandidate(g[t])
g=[]}}function r(e){for(var t=e.split("\n"),i=!1,n=!1,o=!1,r=0;r<t.length;r++)0==t[r].indexOf("a=mid:data")&&(i=!0),0==t[r].indexOf("a=mid:video")&&(o=!0),0==t[r].indexOf("a=mid:audio")&&(n=!0)
return i&&!o&&!n}function a(e){var t=JSON.parse(e.data)
switch(t.type){case"camera":f.dispatchEvent({type:"cameraChange",data:t})
break
case"joystick":f.dispatchEvent({type:"joystick",data:t})
break
case"state":f.dispatchEvent({type:"viewerState",data:t})}}function s(e){var t=e.data.msg
if(stderr("Client received message:"+JSON.stringify(t)),"offer"!=t.type||v)if("answer"===t.type&&v)c.setRemoteDescription(new RTCSessionDescription(t))
else if("candidate"===t.type){var i=new RTCIceCandidate({sdpMLineIndex:t.label,candidate:t.candidate})
v?c.addIceCandidate(i):g.push(i)}else"bye"===t&&v&&(f.dispatchEvent({type:"remoteHangup",data:null}),stderr("Session terminated."),l())
else stderr("Received offer. Accepting."),f.receiveCall(e.data)}function l(){v=!1,c.close(),c=null,d=null,h=null,u=null}var c,u,d,h,p,f=this,m=t,v=!1,g=[],E={iceServers:[{url:"stun:stun.l.google.com:19302"}]},y={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},A={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}}
m.addEventListener("privateMessage",s),this.hangup=function(){stderr("Hanging up."),v&&(m.sendPrivateMessage(u,"bye"),l())},this.initUserMedia=function(e){function t(t){stderr("Adding local stream."),e&&e(t),f.dispatchEvent({type:"localStreamAdded",data:t})}function i(e){stderr("getUserMedia error: ",e)}var n={video:!0,audio:!0}
window.getUserMedia(n,t,i),stderr("Getting user media with constraints",n)},this.callUser=function(e,t){return u?void stderr("Already in a call. Ignoring call request."):(u=e,stderr("Calling user "+u),void(t?(i(!0),v=!0,stderr("Sending data channel offer to peer"),c.createOffer(o,n)):this.initUserMedia(function(e){d=e,v||"undefined"==typeof d||(i(!1),c.addStream(d),v=!0,stderr("Sending audio/video offer to peer"),c.createOffer(o,n))})))},this.receiveCall=function(e){u=e.from,u||(u=e.senderId)
var t=e.msg.sdp
r(t)?(i(!0),v=!0,c.setRemoteDescription(new RTCSessionDescription(e.msg)),stderr("Sending data-only answer to peer."),c.createAnswer(o,null,A)):this.initUserMedia(function(t){d=t,v||"undefined"==typeof d||(i(!1),c.addStream(d),v=!0),c.setRemoteDescription(new RTCSessionDescription(e.msg)),stderr("Sending audio+video answer to peer."),c.createAnswer(o,null,y)})},this.getCurrentCallTarget=function(){return u},this.dataChannel=function(){return p}},i.P2PClient.prototype.constructor=i.P2PClient,Autodesk.Viewing.EventDispatcher.prototype.apply(i.P2PClient.prototype)}(),function(){"use strict"
function e(e){if(this.queue=[],e.eventCallback&&(this.callback=e.eventCallback),this.sessionId=e.sessionId,!this.sessionId){var i=Date.now()+""
this.sessionId=parseFloat((1e4*Math.random()|0)+""+i.substring(4))}this.endpoint=e.endpoint?e.endpoint+"/logs":null,this.flushThreshold=e.flushThreshold||10
var n=this
n.ready=!1,n.retries=0,this.lastFlushTime=Date.now(),this.heartbeat=null
var o={category:"viewer_start",touch:isTouchDevice(),env:t.env,referer:window.location.href,version:LMV_VIEWER_VERSION}
this.log(o)}var t=Autodesk.Viewing.Private
e.prototype.setupWS=function(){var e=this
if(e.reconnectPending=!1,this.endpoint){stderr("Opening web socket.")
var t=function(){e.ready=!0,e.lastConnectTime=Date.now(),stderr("Web socket opened successfully."),e.retries>0&&e.socket.send({category:"reconnect",sessionId:this.sessionId}),e.flush()},i=function(){e.reconnectPending||e.xhr||(e.ready=!1,e.retries<3?(stderr("Attempting web socket reconnect."),e.retries++,e.reconnectPending=!0,setTimeout(function(){e.setupWS()},5e3)):(stderr("Giving up on web sockets. Trying POST."),e.setupXHR()))},n=function(e){console.log(e.message),i()},o=function(t){var n=Date.now()
n-e.lastConnectTime>6e4?(stderr("Web socket closed due to inactivity."),e.socket=null,e.ready=!1,e.retries=0):i()}
try{this.socket=new WebSocket("wss://"+this.endpoint,"lmv-log-v1"),this.socket.onopen=t,this.socket.onerror=n,this.socket.onclose=o,this.socket.onmessage=function(e){console.log(e.data)}}catch(r){e.setupXHR()}}},e.prototype.setupXHR=function(){this.socket=null,this.xhr=new XMLHttpRequest,this.ready=!0,this.retries=0,this.flush()
var e=this
this.heartbeat&&clearInterval(this.heartbeat),this.heartbeat=setInterval(function(){e.flush()},6e4),"undefined"!=typeof window&&window.addEventListener("beforeunload",function(){e.log({category:"viewer_stop"},!0)})},e.prototype.flush=function(){if(!(this.retries>2)&&this.queue.length&&this.ready){var e=this,t=this.queue
this.queue=[]
var i=JSON.stringify(t)
if(this.socket)try{this.socket.send(i)}catch(n){}else if(this.endpoint)try{var o=this.xhr
o.open("POST","https://"+this.endpoint,!0),o.send(i),o.onreadystatechange=function(){4==o.readyState&&200!==o.status&&(e.retries++,e.queue.unshift(t))}}catch(n){}else stderr(this.queue)
this.lastFlushTime=Date.now()}},e.prototype.log=function(e,i){t.offline||(this.callback&&this.callback(e),this.retries>2||(e.timestamp=Date.now(),e.sessionId=this.sessionId,this.queue.push(e),this.socket||this.ready?(this.socket||this.queue.length>this.flushThreshold||e.timestamp-this.lastFlushTime>6e4||i)&&this.flush():this.setupWS()))},Autodesk.Viewing.Private.Logger=e}()
var Autocam=Autocam||function(e,t){function i(t){A=!0,e.target.copy(v.center),e.pivot.copy(v.pivot),e.worldup?e.worldup.copy(v.sceneUpDirection):e.up.copy(v.sceneUpDirection),v.cameraChangedCallback&&v.cameraChangedCallback(t),A=!1}function n(e,t){var i=e.clone()
return Math.abs(i.clone().dot(t))<Number.MIN_VALUE?(i.normalize(),i):(i=o(e,t),i.length()<Number.MIN_VALUE&&(i=r(t)),i.normalize(),i)}function o(e,t){t.normalize()
var i=e.clone().dot(t),n=t.clone().multiplyScalar(i)
return n=e.clone().sub(n)}function r(e){for(var t=new THREE.Vector3(0,0,0),i=[new THREE.Vector3(0,1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,1,1),new THREE.Vector3(1,0,1),new THREE.Vector3(1,1,0),new THREE.Vector3(1,1,1)],n=0;7>n;n++)if(Math.abs(i[n].dot(e))<Number.MIN_VALUE){t=i[n]
break}return t}function a(e,t){var i=new THREE.Vector2(0,0)
return i.x=e/window.innerWidth,i.y=t/window.innerHeight,i}function s(t){t.y=Math.abs(t.y-window.innerHeight)
var i,n,o=e.position,r=v.center,a=r.clone().sub(o),s=e.up,l=a.clone().cross(s),c=a.clone().length(),u=c*Math.tan(THREE.Math.degToRad(e.leftFov)),d=c*Math.tan(THREE.Math.degToRad(e.rightFov)),h=c*Math.tan(THREE.Math.degToRad(e.topFov)),p=c*Math.tan(THREE.Math.degToRad(e.bottomFov)),f=u+d,m=h+p,g=t.x*f/window.innerWidth,E=g-u,y=t.y*m/window.innerHeight,A=y-p
return s=s.clone().normalize().clone().multiplyScalar(A),l=l.clone().normalize().clone().multiplyScalar(E),v.ortho?(i=o.clone().add(l).clone().add(s),n=a):(i=o,n=a.clone().add(s).clone().add(l)),{rayO:i,rayD:n}}function l(e,t,i){var n,o,r,a
n=o=r=a=0
var s=0,l=null,c=null,u=v.snapOrbitDeadZone,d=v.orbitMultiplier
return"h"==e?(n=v.snapOrbitThresholdH,o=v.snapOrbitAccelerationAX,r=v.snapOrbitAccelerationBX,a=1-v.snapOrbitAccelerationPointX,c=v.lockDeltaX,l=v.lockedX):(n=v.snapOrbitThresholdV,o=v.snapOrbitAccelerationAY,r=v.snapOrbitAccelerationBY,a=1-v.snapOrbitAccelerationPointY,c=v.lockDeltaY,l=v.lockedY),l?(c+=i,-u>c?(s=(c+u)*d*1/r,l=!1):c>u&&(s=(c-u)*d*1/r,l=!1)):(s=Math.abs(t)>n?i*d:Math.abs(t)>a*n?i*t>0?i*d*o:i*d*1/o:i*t>0?i*d*r:i*d*1/r,s*t>0&&Math.abs(s)>Math.abs(t)&&(this.lockDeltaX=this.lockDeltaY=0,l=!0,s=t)),s}function c(){return v.combined}function u(e,t){var i=30,n=!1,o=window.innerWidth,r=e.x%o,a=window.innerHeight,s=e.y%a,l=r>0?r-t.x:o+r-t.x,c=s>0?s-t.y:a+s-t.y
return Math.abs(l)<i&&Math.abs(c)<i&&(n=!0),n}function d(e,t,i){i.x=(e.x-t.x)/window.innerWidth,e.x=t.x+(e.x-t.x)%window.innerWidth,i.y=(e.y-t.y)/window.innerHeight,e.y=t.y+(e.y-t.y)%window.innerHeight}function h(e,t,i){if(!F||!e){if(e){var n=30,o=new THREE.Vector2,r=t.x,a=t.y
d(t,i,o),O=window.innerWidth*o.x,B=window.innerHeight*o.y,r<i.x?r-=2*n:r+=2*n,a<i.y?a-=2*n:a+=2*n}F=e}}function p(e,t,i){if(0===t)return 0
var n=e,o=v.saveEye.clone().sub(worldUp.clone().multiplyScalar(i+n)),r=v.saveEye.clone().sub(worldUp.clone().multiplyScalar(i)),a=0,s=(v.maxSceneBound-v.minSceneBound)/1e3
v.topLimit&&t>0?(a=v.maxSceneBound-s,v.topLimit=!1):v.bottomLimit&&0>t?(a=v.minSceneBound+s,v.bottomLimit=!1):a=o.dot(worldUp)
var l=r.dot(worldUp)
return a<v.minSceneBound?l<v.minSceneBound&&(v.bottomLimit=!0,n=0):a>v.maxSceneBound&&l>v.maxSceneBound&&(v.topLimit=!0,n=0),n}function f(e){var t=Math.pow(e,2)
0>e&&(t=-t)
var i=a(0,t),n=v.maxSceneBound-v.minSceneBound,o=.01*n
i.y*=o
var r=v.userHeightSpeed*i.y
return r=p(r,e,v.m_amount)}function m(e){var t=v.sceneFrontDirection.clone().cross(v.sceneUpDirection),i=Math.abs(Math.abs(e.dot(v.sceneUpDirection))-1),n=Math.abs(Math.abs(e.dot(v.sceneFrontDirection))-1),o=Math.abs(Math.abs(e.dot(t))-1)
return 1e-5>i||1e-5>n||1e-5>o}var v=this,g=null,E=null,A=!1
this.cube=null,this.camera=e,this.renderer="WEBGL",this.startState={},this.navApi=t,this.orthographicFaces=!1,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.canvas=null
var T,b=Date.now(),w=!1
this.dtor=function(){this.cube=null,this.cameraChangedCallback=null,this.pivotDisplayCallback=null,this.canvas=null},this.showPivot=function(e){this.pivotDisplayCallback&&this.pivotDisplayCallback(e)},this.setWorldUpVector=function(e){A||e&&e.lengthSq()>0&&!e.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(e),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.cube&&requestAnimationFrame(this.cube.render))},this.getWorldUpVector=function(){return this.sceneUpDirection.clone()},this.getWorldRightVector=function(){var e=this.sceneUpDirection.clone()
return Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},this.getWorldFrontVector=function(){var e=this.getWorldUpVector()
return e.cross(this.getWorldRightVector()).normalize()},this.goToView=function(e){if(!this.navApi.getIsLocked()){var t={position:e.position.clone(),up:e.up.clone(),center:e.center.clone(),pivot:e.pivot.clone(),fov:e.fov,worldUp:e.worldUp.clone(),isOrtho:e.isOrtho}
v.elapsedTime=0,this.animateTransition(t)}},this.getCurrentView=function(){return{position:e.position.clone(),up:e.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:e.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:e.isPerspective===!1}},this.setCurrentViewAsHome=function(e){e?(this.navApi.setRequestFitToView(!0),w=!0):this.homeVector=this.getCurrentView()},this.setHomeViewFrom=function(e){var t=e.pivot?e.pivot:this.center,i=e.target?e.target:this.pivot,n=e.worldup?e.worldup:this.sceneUpDirection
this.homeVector={position:e.position.clone(),up:e.up.clone(),center:i.clone(),pivot:t.clone(),fov:e.fov,worldUp:n.clone(),isOrtho:e.isPerspective===!1},this.originalHomeVector={position:e.position.clone(),up:e.up.clone(),center:i.clone(),pivot:t.clone(),fov:e.fov,worldUp:n.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:e.isPerspective===!1}},this.toPerspective=function(){e.isPerspective||(e.toPerspective(),i(!1))},this.toOrthographic=function(){e.isPerspective&&(e.toOrthographic(),i(!1))},this.setOrthographicFaces=function(e){this.orthographicFaces=e},this.goHome=function(){this.navApi.getIsLocked()||(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))},this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position),this.homeVector.up.copy(this.originalHomeVector.up),this.homeVector.center.copy(this.originalHomeVector.center),this.homeVector.pivot.copy(this.originalHomeVector.pivot),this.homeVector.fov=this.originalHomeVector.fov,this.homeVector.worldUp.copy(this.originalHomeVector.worldUp),this.homeVector.isOrtho=this.originalHomeVector.isOrtho,this.goHome()},this.getView=function(){return this.center.clone().sub(e.position)},this.setCameraUp=function(t){var i=this.dir.clone(),n=i.cross(t).normalize()
0===n.lengthSq()&&(i.copy(this.dir),t.z>t.y?i.y+=1e-4:i.z+=1e-4,n=i.cross(t).normalize()),e.up.copy(n).cross(this.dir).normalize()},function W(){requestAnimationFrame(W)
var e=Date.now()
T=e-b,b=e}(),this.ortho=!1,this.center=e.target?e.target.clone():new THREE.Vector3(0,0,0),this.pivot=e.pivot?e.pivot.clone():this.center.clone(),this.sceneUpDirection=e.worldup?e.worldup.clone():e.up.clone(),this.sceneFrontDirection=this.getWorldFrontVector(),this.dir=this.getView(),this.setCameraUp(e.up),this.saveCenter=this.center.clone(),this.savePivot=this.pivot.clone(),this.saveEye=e.position.clone(),this.saveUp=e.up.clone()
var _,C,S,R
this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),this.setHomeViewFrom(e)
var M,P,L=new THREE.Quaternion,I=new THREE.Quaternion,k=new THREE.Quaternion,V=new THREE.Quaternion
this.userPanSpeed=.5,this.userLookSpeed=2,this.userHeightSpeed=5,this.walkMultiplier=1,this.userZoomSpeed=1.015,this.orbitMultiplier=5,this.currentlyAnimating=!1,e.keepSceneUpright=!0,this.preserveOrbitUpDirection=!0,this.alignOrbitUpDirection=!0,this.constrainOrbitHorizontal=!1,this.constrainOrbitVertical=!1,this.doCustomOrbit=!1,this.snapOrbitDeadZone=.045,this.snapOrbitThresholdH=this.snapOrbitThresholdV=THREE.Math.degToRad(15),this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5,this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2,this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5,this.alignDirTable=new Array(26),this.alignDirTable[0]=new THREE.Vector3(-1,0,0),this.alignDirTable[1]=new THREE.Vector3(1,0,0),this.alignDirTable[2]=new THREE.Vector3(0,-1,0),this.alignDirTable[3]=new THREE.Vector3(0,1,0),this.alignDirTable[4]=new THREE.Vector3(0,0,-1),this.alignDirTable[5]=new THREE.Vector3(0,0,1),this.alignDirTable[6]=new THREE.Vector3(-1,-1,0),this.alignDirTable[7]=new THREE.Vector3(-1,1,0),this.alignDirTable[8]=new THREE.Vector3(1,-1,0),this.alignDirTable[9]=new THREE.Vector3(1,1,0),this.alignDirTable[10]=new THREE.Vector3(0,-1,-1),this.alignDirTable[11]=new THREE.Vector3(0,-1,1),this.alignDirTable[12]=new THREE.Vector3(0,1,-1),this.alignDirTable[13]=new THREE.Vector3(0,1,1),this.alignDirTable[14]=new THREE.Vector3(-1,0,-1),this.alignDirTable[15]=new THREE.Vector3(1,0,-1),this.alignDirTable[16]=new THREE.Vector3(-1,0,1),this.alignDirTable[17]=new THREE.Vector3(1,0,1),this.alignDirTable[18]=new THREE.Vector3(-1,-1,-1),this.alignDirTable[19]=new THREE.Vector3(-1,-1,1),this.alignDirTable[20]=new THREE.Vector3(-1,1,-1),this.alignDirTable[21]=new THREE.Vector3(-1,1,1),this.alignDirTable[22]=new THREE.Vector3(1,-1,-1),this.alignDirTable[23]=new THREE.Vector3(1,-1,1),this.alignDirTable[24]=new THREE.Vector3(1,1,-1),this.alignDirTable[25]=new THREE.Vector3(1,1,1),this.combined=!1,this.useSnap=!1,this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new THREE.Vector3(0,0,0),this.topLimit=!1,this.bottomLimit=!1,this.minSceneBound=0,this.maxSceneBound=0
var N={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1}
this.shotParams=N
var D,H
this.zoomDelta=new THREE.Vector2
var O,B,F,U=0,z=new THREE.Vector3,G=new THREE.Vector3
this.rewindParams={history:[],startTime:void 0,thumbnailSize:56,thumbnailGapSize:12,maxHistorySize:25,snappingEnabled:!0,timelineIndex:0,timelineIndexSlide:0,open:!1,openLocation:new THREE.Vector2(0,0),openBracket:new THREE.Vector2(0,0),openBracketA:new THREE.Vector2(0,0),openBracketB:new THREE.Vector2(0,0),openLocationOrigin:new THREE.Vector2(0,0),locationOffset:new THREE.Vector2(0,0),snapOffset:new THREE.Vector2(0,0),slideOffset:new THREE.Vector2(0,0),snapped:!0,resetWeights:!1,recordEnabled:!1,elementIsRecording:!1},this.viewCubeMenuOpen=!1,this.menuSize=new THREE.Vector2(0,0),this.menuOrigin=new THREE.Vector2(0,0),e.lookAt(this.center),this.setCube=function(e){this.cube=e},this.loadObject=function(e,t,i){loader=new THREE.JSONLoader,loader.load(e,function(e,n){var o=new THREE.MeshPhongMaterial(n)
mesh=new THREE.Mesh(e,o),mesh.scale=t,mesh.position.copy(i),mesh.geometry.computeBoundingBox()
var r=mesh.geometry.boundingBox.clone()
G.set(r.max.x,r.max.y,r.max.z),z.set(r.min.x,r.min.y,r.min.z),G.multiply(t),z.multiply(t),scene.add(mesh),objects.push(mesh)})},this.sync=function(t){t.isPerspective!==e.isPerspective&&(t.isPerspective?e.toPerspective():(e.toOrthographic(),t.saveFov&&(e.saveFov=t.saveFov))),e.fov=t.fov,e.position.copy(t.position),t.target&&(this.center.copy(t.target),e.target.copy(t.target)),t.pivot&&(this.pivot.copy(t.pivot),e.pivot.copy(t.pivot)),this.dir.copy(this.center).sub(e.position),this.setCameraUp(t.up)
var i=t.worldup?t.worldup:t.up
i.distanceToSquared(this.sceneUpDirection)>1e-4&&this.setWorldUpVector(i),w&&!this.navApi.getTransitionActive()&&(w=!1,this.setCurrentViewAsHome(!1)),this.cube&&requestAnimationFrame(this.cube.render)},this.refresh=function(){this.cube&&this.cube.refreshCube()},THREE.Box2.prototype.setCenter=function(e){var t=new THREE.Vector2(Math.abs(this.max.x-this.min.x)/2,Math.abs(this.max.y-this.min.y)/2)
return this.min.copy(e).sub(t),this.max.copy(e).add(t),this},THREE.Box2.prototype.getIcon2DCoords=function(e,t){var i=this.center
t.set((e.x-i.x)/(this.size().x/2),(e.y-i.y)/(this.size().y/2))},THREE.Matrix3.prototype.makeRotationFromQuaternion=function(e){var t=this.elements,i=e.x,n=e.y,o=e.z,r=e.w,a=i+i,s=n+n,l=o+o,c=i*a,u=i*s,d=i*l,h=n*s,p=n*l,f=o*l,m=r*a,v=r*s,g=r*l
return t[0]=1-(h+f),t[3]=u-g,t[6]=d+v,t[1]=u+g,t[4]=1-(c+f),t[7]=p-m,t[2]=d-v,t[5]=p+m,t[8]=1-(c+h),this},THREE.Quaternion.prototype.setFromRotationMatrix3=function(e){var t,i=e.elements,n=i[0],o=i[3],r=i[6],a=i[1],s=i[4],l=i[7],c=i[2],u=i[5],d=i[8],h=n+s+d
return h>0?(t=.5/Math.sqrt(h+1),this.w=.25/t,this.x=(u-l)*t,this.y=(r-c)*t,this.z=(a-o)*t):n>s&&n>d?(t=2*Math.sqrt(1+n-s-d),this.w=(u-l)/t,this.x=.25*t,this.y=(o+a)/t,this.z=(r+c)/t):s>d?(t=2*Math.sqrt(1+s-n-d),this.w=(r-c)/t,this.x=(o+a)/t,this.y=.25*t,this.z=(l+u)/t):(t=2*Math.sqrt(1+d-n-s),this.w=(a-o)/t,this.x=(r+c)/t,this.y=(l+u)/t,this.z=.25*t),this},THREE.Quaternion.prototype.rotate=function(e){var t=(new THREE.Matrix4).makeRotationFromQuaternion(this),i=t.elements,n=(new THREE.Matrix3).set(i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],i[10])
return e.applyMatrix3(n)},THREE.Vector3.prototype.findAngleWith=function(e,t){var i=0,n=this.clone().normalize().clone().dot(e.clone().normalize()),o=this.clone().cross(e).clone().normalize()
if(o.clone().length()<Number.MIN_VALUE)i=n>0?0:180
else{var r=o.clone().dot(t.clone().normalize())
t=r>0?o:-o
var a=(new THREE.Quaternion).setFromAxisAngle(t,90*THREE.Math.degToRad)
a=a.clone().rotate(e).clone().normalize().clone().dot(this),i=Math.acos(n)*THREE.Math.radToDeg,Math.abs(i-90)<Number.MIN_VALUE&&(i=90),(90>i&&n*a>0||i>90&&0>n*a||90==i&&a>0)&&(i=-1*i)}return i=THREE.Math.degToRad(i)},"contains"in String.prototype||(String.prototype.contains=function(e,t){return-1!==String.prototype.indexOf.call(this,e,t)}),Math.linearClamp=function(e,t,i){return t>=e?0:e>=i?1:(e-t)/(i-t)},Math.easeClamp=function(e,t,i){if(t>=e)return 0
if(e>=i)return 1
var n=(e-t)/(i-t)
return.5*(Math.sin((n-.5)*Math.PI)+1)},Math.linearInterp=function(e,t,i){return t*(1-e)+i*e},Math.equalityClamp=function(e,t,i){return t>=e?t:e>=i?i:e},Math.round2=function(e){return Math.round(100*e)/100},Math.round1=function(e){return Math.round(10*e)/10},this.animateTransition=function(t){if(t){var n=!1,o=0
if(this.setCameraOrtho(t.isOrtho),v.elapsedTime>=N.duration)return o=1,v.center.copy(t.center),v.pivot.copy(t.pivot),e.position.copy(t.position),e.up.copy(t.up),t.isOrtho||(e.fov=t.fov),n=!t.worldUp.equals(this.sceneUpDirection),n&&this.setWorldUpVector(t.worldUp),this.currentlyAnimating=!1,i(n),this.showPivot(!1),this.cube&&requestAnimationFrame(this.cube.render),this.addHistoryElement(),void this.navApi.setTransitionActive(!1)
this.currentlyAnimating=!0,this.showPivot(!0),this.navApi.setTransitionActive(!0)
var r=N.destinationPercent
o=Math.easeClamp(v.elapsedTime/N.duration,0,r),oneMinusTime=1-o,v.elapsedTime+=T/500
var a=v.center.clone().multiplyScalar(oneMinusTime).add(t.center.clone().multiplyScalar(o)),s=e.position.clone().multiplyScalar(oneMinusTime).add(t.position.clone().multiplyScalar(o)),l=e.up.clone().multiplyScalar(oneMinusTime).add(t.up.clone().multiplyScalar(o)),c=e.pivot.clone().multiplyScalar(oneMinusTime).add(t.pivot.clone().multiplyScalar(o)),u=this.sceneUpDirection.clone().multiplyScalar(oneMinusTime).add(t.worldUp.clone().multiplyScalar(o)),d=e.fov*oneMinusTime+t.fov*o
v.center.copy(a),v.pivot.copy(c),e.position.copy(s),e.up.copy(l),t.isOrtho||(e.fov=d),n=u.distanceToSquared(this.sceneUpDirection)>1e-4,n&&this.setWorldUpVector(u),e.lookAt(v.center),i(n),this.cube&&requestAnimationFrame(this.cube.render),requestAnimationFrame(function(){v.animateTransition(t)})}},this.sphericallyInterpolateTransition=function(t){var n,o,r,a=0
if(this.currentlyAnimating=!0,this.navApi.setTransitionActive(!0),v.elapsedTime>=N.duration)a=1,this.currentlyAnimating=!1
else{var s=N.destinationPercent
a=Math.easeClamp(v.elapsedTime/N.duration,0,s),v.elapsedTime+=T/500}if(1===a)o=H.position,n=H.center,r=H.up
else{var l=new THREE.Matrix3,c=L.clone()
c.slerp(I,a),l.makeRotationFromQuaternion(c)
var u=Math.linearInterp(a,M,P),d=l.elements
n=D.center.clone().multiplyScalar(1-a).add(H.center.clone().multiplyScalar(a)),o=n.clone().sub(new THREE.Vector3(d[0],d[1],d[2]).multiplyScalar(u)),r=new THREE.Vector3(d[3],d[4],d[5])}v.center.copy(n),e.position.copy(o),e.up.copy(r),v.navApi.getUsePivotAlways()||v.pivot.copy(n),e.lookAt(v.center),this.currentlyAnimating===!0?(this.showPivot(!0),requestAnimationFrame(function(){v.sphericallyInterpolateTransition(t)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.addHistoryElement(),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),t&&t()),i(!1),this.cube&&requestAnimationFrame(this.cube.render)},this.getOrientation=function(){if(this.cube){var t=Math.round1(e.up.x),i=Math.round1(e.up.y),n=Math.round1(e.up.z),o=this.sceneFrontDirection.clone(),r=this.sceneUpDirection.clone(),a=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize()
o.x=Math.round1(o.x),o.y=Math.round1(o.y),o.z=Math.round1(o.z),r.x=Math.round1(r.x),r.y=Math.round1(r.y),r.z=Math.round1(r.z),a.x=Math.round1(a.x),a.y=Math.round1(a.y),a.z=Math.round1(a.z)
var s=a.clone().multiplyScalar(-1),l=r.clone().multiplyScalar(-1),c=o.clone().multiplyScalar(-1)
switch(this.cube.currentFace){case"front":if(r.x==t&&r.y==i&&r.z==n)return"up"
if(l.x==t&&l.y==i&&l.z==n)return"down"
if(a.x==t&&a.y==i&&a.z==n)return"right"
if(s.x==t&&s.y==i&&s.z==n)return"left"
break
case"right":if(r.x==t&&r.y==i&&r.z==n)return"up"
if(l.x==t&&l.y==i&&l.z==n)return"down"
if(c.x==t&&c.y==i&&c.z==n)return"left"
if(o.x==t&&o.y==i&&o.z==n)return"right"
break
case"left":if(r.x==t&&r.y==i&&r.z==n)return"up"
if(l.x==t&&l.y==i&&l.z==n)return"down"
if(o.x==t&&o.y==i&&o.z==n)return"left"
if(c.x==t&&c.y==i&&c.z==n)return"right"
break
case"back":if(r.x==t&&r.y==i&&r.z==n)return"up"
if(l.x==t&&l.y==i&&l.z==n)return"down"
if(s.x==t&&s.y==i&&s.z==n)return"right"
if(a.x==t&&a.y==i&&a.z==n)return"left"
break
case"top":if(c.x==t&&c.y==i&&c.z==n)return"down"
if(o.x==t&&o.y==i&&o.z==n)return"up"
if(a.x==t&&a.y==i&&a.z==n)return"right"
if(s.x==t&&s.y==i&&s.z==n)return"left"
break
case"bottom":if(o.x==t&&o.y==i&&o.z==n)return"down"
if(c.x==t&&c.y==i&&c.z==n)return"up"
if(a.x==t&&a.y==i&&a.z==n)return"right"
if(s.x==t&&s.y==i&&s.z==n)return"left"}}},this.setCameraOrtho=function(t){t&&e.isPerspective&&e.toOrthographic(),t||e.isPerspective||e.toPerspective()},this.resetOrientation=function(){this.setCameraOrtho(this.originalHomeVector.isOrtho),this.sceneUpDirection.copy(this.originalHomeVector.worldUp),this.sceneFrontDirection.copy(this.originalHomeVector.worldFront),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.setCameraUp(this.sceneUpDirection),i(!0)},this.setCurrentViewAsFront=function(){this.cube&&(this.cube.currentFace="front"),this.sceneUpDirection.copy(e.up.clone()),this.sceneFrontDirection.copy(this.getView()).normalize(),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),this.orthographicFaces&&this.setCameraOrtho(!0),i(!0)},this.setCurrentViewAsTop=function(){this.cube&&(this.cube.currentFace="top"),this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize(),this.sceneFrontDirection.copy(e.up),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),i(!0)},this.calculateCubeTransform=function(t){var i=this.sceneUpDirection.clone(),n=this.sceneFrontDirection.clone(),o=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize()
D=e.clone(),D.center=v.center.clone(),D.pivot=v.pivot.clone(),H=e.clone(),H.center=v.center.clone(),H.pivot=v.pivot.clone()
var r=new THREE.Vector3(0,0,0)
t.contains("back")&&(r=r.add(n)),t.contains("front")&&(r=r.sub(n)),t.contains("top")&&(r=r.add(i)),t.contains("bottom")&&(r=r.sub(i)),t.contains("right")&&(r=r.add(o)),t.contains("left")&&(r=r.sub(o))
var a=i,s=r.clone().normalize()
if(1-Math.abs(s.dot(i))<Number.MIN_VALUE)for(var l=this.getView().normalize(),c=[n.clone(),n.clone().negate(),o.clone(),o.clone().negate()],u=s.dot(i)>0?1:-1,d=l.clone().add(e.up.clone().multiplyScalar(u)).normalize(),h=-2,p=0;4>p;p++){var f=d.dot(c[p])
f>h&&(h=f,a=c[p].multiplyScalar(u))}P=M=this.getView().length(),H.position.copy(H.center.clone().add(r.multiplyScalar(P/r.length()))),H.up.copy(a)
var m=D.center.clone().sub(D.position).normalize(),g=m.clone().cross(D.up).normalize(),E=g.clone().cross(m).normalize(),y=new THREE.Matrix3
y.set(m.x,E.x,g.x,m.y,E.y,g.y,m.z,E.z,g.z),L.setFromRotationMatrix3(y),m=H.center.clone().sub(H.position).normalize(),g=m.clone().cross(H.up).normalize(),E=g.clone().cross(m).normalize(),y.set(m.x,E.x,g.x,m.y,E.y,g.y,m.z,E.z,g.z),k.setFromAxisAngle(m,0),V.setFromAxisAngle(E,0),I.setFromRotationMatrix3(y),I.multiply(k).multiply(V).normalize()},this.centerShot=function(t){(!D||t)&&(v.elapsedTime=0,D=H=e.clone(),D.center=v.center)
var n=v.pivot.clone(),o=n.clone().sub(D.position),r=D.center.clone().sub(D.position).normalize(),a=D.up.clone(),s=r.clone().cross(a).normalize()
a=s.clone().cross(r).normalize()
var l=s.clone().multiplyScalar(s.dot(o)),c=a.clone().multiplyScalar(a.dot(o)),u=l.clone().add(c)
H.position.copy(D.position.clone().add(u)),H.center=n,H.pivot=n
var d=0
if(v.elapsedTime>=N.duration)d=1
else{var h=N.destinationPercent
d=Math.easeClamp(v.elapsedTime/N.duration,0,h),v.elapsedTime+=T/2e3}var p=e.position.clone().multiplyScalar(1-d).add(H.position.clone().multiplyScalar(d)),f=v.center.clone().multiplyScalar(1-d).add(H.center.clone().multiplyScalar(d)),m=v.pivot.clone().multiplyScalar(1-d).add(H.pivot.clone().multiplyScalar(d))
e.position.copy(p),v.center.copy(f),v.pivot.copy(m),e.lookAt(v.center),i(!1),1===d?this.addHistoryElement():requestAnimationFrame(function(){v.centerShot(!1)})},this.levelShot=function(){var t=this.getView(),i=t.length(),n=this.sceneUpDirection.clone(),o=e.up.clone().normalize(),r=t.normalize(),a=r.dot(n)
if(1-Math.abs(a)>Number.MIN_VALUE){var s=r.clone().cross(n)
r=n.clone().cross(s),r.normalize()}else r=o.clone()
r.multiplyScalar(i)
var l={center:r.add(e.position),up:n,position:e.position,pivot:v.center.clone().add(r),fov:e.fov,worldUp:n}
v.elapsedTime=0,v.animateTransition(l)},this.fitToWindow=function(){var t=this.getView(),i=e.up.clone()
t.normalize(),i.normalize(),H=e.clone(),H.center=v.center,i=n(i,t),i.normalize(),H.up.copy(i)
var o=t.clone().cross(i)
o.normalize()
var r=z.clone(),a=G.clone(),s=[r,a],l=new THREE.Vector3(a.x-r.x,a.y-r.y,a.z-r.z)
s[2]=new THREE.Vector3(a.x,r.y,a.z),s[3]=new THREE.Vector3(a.x,r.y,r.z),s[4]=new THREE.Vector3(a.x,a.y,r.z),s[5]=new THREE.Vector3(r.x,a.y,a.z),s[6]=new THREE.Vector3(r.x,a.y,r.z),s[7]=new THREE.Vector3(r.x,r.y,a.z)
for(var c=0;8>c;c++){var u=s[c].clone().sub(e.position)
s[c].setX(u.clone().dot(o)),s[c].setY(u.clone().dot(i)),s[c].setZ(u.clone().dot(t))}var d,h,p,f,m=THREE.Math.degToRad(e.topFov),g=THREE.Math.degToRad(e.bottomFov),E=THREE.Math.degToRad(e.leftFov),y=THREE.Math.degToRad(e.rightFov)
d=E>=0?Number.MAX_VALUE:Number.MIN_VALUE,h=y>=0?Number.MAX_VALUE:Number.MIN_VALUE,p=m>=0?Number.MAX_VALUE:Number.MIN_VALUE,f=g>=0?Number.MAX_VALUE:Number.MIN_VALUE
for(var A=1/Math.tan(y),T=-1/Math.tan(E),b=1/Math.tan(m),w=-1/Math.tan(g),_=0;8>_;_++){var x=s[_].clone(),C=x.z-T*x.x
d=E>=0?Math.min(d,C):Math.max(d,C),C=x.z-A*x.x,h=y>=0?Math.min(h,C):Math.max(h,C),C=x.z-b*x.y,p=m>=0?Math.min(p,C):Math.max(p,C),C=x.z-w*x.y,f=g>=0?Math.min(f,C):Math.max(f,C)}var S=(h-d)/(T-A),R=T*S+d,M=(f-p)/(b-w),P=b*M+p,L=0
if(P>=R){var I=(m-g)/2
if(Math.abs(I)>Number.MIN_VALUE){var k=1/Math.tan(I)
M=M-P/k+R/k}L=R}else{var V=(y-E)/2
if(Math.abs(V)>Number.MIN_VALUE){var N=1/Math.tan(V)
S=S-R/N+P/N}L=P}var D=new THREE.Vector3(S,M,L),O=o.clone().multiplyScalar(D.x),B=i.clone().multiplyScalar(D.y),F=t.clone().multiplyScalar(D.z)
D=O.clone().add(B.clone().add(F)),H.position.add(D)
var U=l.clone().sub(H.position).dot(t)
H.center=H.position.clone().add(t.multiplyScalar(U)),H.pivot=l.clone()
var W={center:H.center,up:H.up,position:H.position,pivot:H.pivot,fov:e.fov,worldUp:v.sceneUpDirection.clone()}
v.elapsedTime=0,v.animateTransition(W)},this.updatePivotPosition=function(t){var i,n,o=new THREE.Vector3(t.x/window.innerWidth*2-1,2*-(t.y/window.innerHeight)+1,.5)
if(o=o.unproject(e),i=new THREE.Raycaster(e.position,o.sub(e.position).normalize()),n=i.intersectObjects(objects),"zoom"==v.mode)if(void 0!==n[0]){var r=n[0].point
v.pivot.copy(r)}else{var a=s(t)
v.pivot.copy(a.rayO.clone().add(a.rayD))}else if(void 0!==n[0]){wheel.cursorImage("pivot")
var r=n[0].point
v.isMouseDown||v.pivot.copy(r)}else wheel.cursorImage("SWInvalidArea")},this.onDrawHeight=function(t,i,n,o,r){var a=86,s=new THREE.Vector3(0,1,0),l=e.position.clone().dot(s),c=Math.linearClamp(l,v.minSceneBound,v.maxSceneBound),u=c-.5
E&&(E.find("img#updownImageA").remove(),E.prepend('<img src="'+r+'SWheighthandleA.png" id="updownImageA" style="position:fixed; z-index:9999; top:'+(n-a*u)+"px; left:"+i+'px;"/>'),o||E.prepend('<img src="'+r+'SWheighthandleI.png" id="updownImageI" style="position:fixed; z-index:9998; top:'+(n-a*u)+"px; left:"+i+'px;"/>'))},this.drawDropdownMenu=function(e,t,i,n,o,r,a){var s=0
if(g)r.appendChild(g)
else{g=document.createElement("div"),g.className="dropDownMenu",g.style.top="100px",g.style.left="-400px"
for(var l=0,c=0,u=0;u<e.length;u++){var d
if(null===e[u])d=document.createElement("li"),d.style.height="1px",l+=1,d.style.backgroundColor="#E0E0E0"
else{var h=Autodesk.Viewing.i18n.translate(e[u])
if(c=h.length>c?h.length:c,i[u]){d=document.createElement("div")
var p=document.createElement("input"),f=document.createElement("label")
p.type="radio",p.className="dropDownMenuCheck",f.innerHTML=h,f.className="dropDownMenuCheckText",d.appendChild(p),d.appendChild(f),d.className="dropDownMenuCheckbox"}else d=document.createElement("li"),d.textContent=h,d.className=t[u]?"dropDownMenuItem":"dropDownMenuItemDisabled"
d.id="menuItem"+s,s++,l+=25,d.setAttribute("data-i18n",e[u])}g.appendChild(d)}r.appendChild(g),g.style.minWidth=Math.max(256,7.4*c)+"px"
var m=g.getBoundingClientRect().width
this.menuSize.x=m,this.menuSize.y=l}s=0
for(var u=0;u<e.length;u++)if(null!==e[u]){if(i[u]){var v="menuItem"+s,E=document.getElementById(v)
E&&(E.children[0].checked=i[u]())}s++}var y=o-15,A=n+1,T=this.canvas.getBoundingClientRect()
A+this.menuSize.x>T.right&&(A=n-this.menuSize.x-1),y+this.menuSize.y>T.bottom&&(y=T.bottom-this.menuSize.y),y-=a.y,A-=a.x,g.style.top=y+"px",g.style.left=A+"px",this.menuOrigin.x=A,this.menuOrigin.y=y},this.removeDropdownMenu=function(e){e.removeChild(g)},this.isFaceView=function(){var t=this.center.clone().sub(e.position).normalize()
return m(t)&&m(e.up)},this.startInteraction=function(e,t){this.startCursor=new THREE.Vector2(e,t),this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),saveUp:this.camera.up.clone()},this.lockDeltaX=0,this.lockedX=!1,this.lastSnapRotateX=0,this.lockDeltaY=0,this.lockedY=!1,this.lastSnapRotateY=0,this.lastSnapDir=new THREE.Vector3(0,0,0)},this.orbit=function(t,n,o,r){if(!this.navApi.getIsLocked()&&this.currentlyAnimating!==!0){var s="wheel"
if(v.orthographicFaces&&!e.isPerspective&&(e.toPerspective(),r&&r.saveEye.copy(this.camera.position)),r&&(s="cube"),"cube"==s?(this.saveCenter.copy(r.saveCenter),this.saveEye.copy(r.saveEye),this.savePivot.copy(r.savePivot),this.saveUp.copy(r.saveUp),this.useSnap=!0,this.doCustomOrbit=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(e.position),this.saveUp.copy(e.up),this.useSnap=!1,this.doCustomOrbit=!1),c()&&void 0==C&&(C=this.saveCenter.clone(),_=this.saveEye.clone(),R=this.savePivot.clone(),S=this.saveUp.clone()),this.preserveOrbitUpDirection){var u=a(t.x-n.x,t.y-n.y),d=a(o.x,o.y),h=this.sceneUpDirection.clone(),p=this.sceneFrontDirection.clone(),f=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize(),m=c()?R:this.savePivot,g=c()?_:this.saveEye,E=c()?C:this.saveCenter,y=c()?S:this.saveUp,A=m.clone().sub(g).normalize(),T=E.clone().sub(g).normalize(),b=T.clone().cross(y),w=g.clone().sub(m).length(),x=g.clone().sub(E).length(),M=A.clone().multiplyScalar(-1),P=T.clone().multiplyScalar(-1),L=b,I=y.clone(),k=0,V=0
if(!this.constrainOrbitHorizontal){var N=h.dot(this.saveUp),D=.009;-D>N&&(u.x=-u.x,d.x=-d.x)
var H=0
H=c()?d.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+l("h",k,-d.x):u.x*this.orbitMultiplier,this.lastSnapRotateX=H
var O=(new THREE.Quaternion).setFromAxisAngle(h,-H)
M.applyQuaternion(O),P.applyQuaternion(O),L.applyQuaternion(O),I.applyQuaternion(O)}if(!this.constrainOrbitVertical){var B=p.clone().multiplyScalar(p.dot(L)),F=f.clone().multiplyScalar(f.dot(L)),U=B.clone().add(F)
U.clone().normalize()
var z=0
if(c())z=d.y*this.orbitMultiplier
else{var G=l("v",V,d.y)
z=this.useSnap?this.lastSnapRotateY+G:u.y*this.orbitMultiplier}var W=(new THREE.Quaternion).setFromAxisAngle(U,-z)
if(this.navApi.getOrbitPastWorldPoles())M.applyQuaternion(W).normalize(),P.applyQuaternion(W).normalize(),I.applyQuaternion(W).normalize()
else{var j=I.clone()
j.applyQuaternion(W).normalize()
var X=h.dot(j)
if(0>X){var Y=P.clone()
Y.applyQuaternion(W).normalize()
var q=Y.angleTo(h)
Math.abs(q)>.5*Math.PI&&(q-=q>0?Math.PI:-Math.PI),z-=q,W.setFromAxisAngle(U,-z),M.applyQuaternion(W).normalize(),P.applyQuaternion(W).normalize(),I.applyQuaternion(W).normalize()}else M.applyQuaternion(W).normalize(),P.applyQuaternion(W).normalize(),I.applyQuaternion(W).normalize()}this.lastSnapRotateY=z}var K=M.multiplyScalar(w).add(m)
e.position.copy(K),e.up.copy(I),this.center.copy(K),this.center.sub(P.multiplyScalar(x)),c()&&(C.copy(this.center),_.copy(e.position),R.copy(this.pivot),S.copy(e.up))}e.lookAt(this.center),i(!1)}},this.endInteraction=function(){},this.look=function(t){if(!this.navApi.getIsLocked()){var n=a(t.x,t.y),o=this.userLookSpeed,r=this.getView(),s=e.up,l=r.clone().cross(s).normalize(),c=this.sceneUpDirection.clone(),u=n.clone()
u.x*=Math.PI,u.y*=Math.PI/e.aspect,u.multiplyScalar(o)
var d=(new THREE.Quaternion).setFromAxisAngle(l,-u.y)
if(e.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var h=s.clone()
if(h.applyQuaternion(d).normalize(),h.dot(c)<0){var p=r.clone()
p.applyQuaternion(d)
var f=p.angleTo(c)
Math.abs(f)>.5*Math.PI&&(f-=f>0?Math.PI:-Math.PI),u.y-=f,d.setFromAxisAngle(l,-u.y)}}r=d.clone().rotate(r),s=d.clone().rotate(s),s.normalize()
var m=e.keepSceneUpright?c:s,v=(new THREE.Quaternion).setFromAxisAngle(m,-u.x)
r=v.clone().rotate(r),s=v.clone().rotate(s),this.center.copy(r.add(e.position)),e.up.copy(s),e.lookAt(this.center),i(!1)}},this.pan=function(t){if(!this.navApi.getIsLocked()){t=a(t.x,t.y)
var n=this.getView(),o=e.up.clone().cross(n),r=n.clone().cross(o)
o.normalize(),r.normalize(),n.normalize()
var s=this.pivot.clone().sub(e.position),l=n.clone().dot(s),c=l*(Math.tan(THREE.Math.degToRad(e.leftFov))+Math.tan(THREE.Math.degToRad(e.rightFov))),u=l*(Math.tan(THREE.Math.degToRad(e.topFov))+Math.tan(THREE.Math.degToRad(e.bottomFov))),d=t.x*Math.abs(c),h=t.y*Math.abs(u),p=new THREE.Vector3,f=o.clone().multiplyScalar(d),m=r.clone().multiplyScalar(h)
p=f.clone().add(m).clone().multiplyScalar(this.userPanSpeed),e.position.add(p),this.center.add(p),e.lookAt(this.center),i(!1)}},this.zoom=function(t){if(!this.navApi.getIsLocked()){var n=this.userZoomSpeed,o=Number.MAX_VALUE,r=t.x+t.y,a=Math.pow(n,r),s=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(a)),l=s.clone().add(v.D.clone().multiplyScalar(v.D.clone().dot(this.pivot.clone().sub(s).clone())))
if(!(a>=o)){if(r>0){var c=0
Math.pow(n,r-c)
if(c>r)return void(U=0)
e.position.copy(s),this.center.copy(l)
var u=s.clone().sub(this.saveEye).dot(v.D)
u>o?(e.position.copy(this.saveEye.sub(v.D).clone().multiplyScalar(o)),U=o>0?-1:0):U=-(u/o)}else e.position.copy(s),this.center.copy(l)
e.lookAt(this.center),i(!1)}}},this.walk=function(t,n,o,r,s){if(!this.navApi.getIsLocked()){var l=this.sceneUpDirection.clone(),c=this.sceneFrontDirection.clone(),d=this.sceneFrontDirection.clone().cross(this.sceneUpDirection),p=!0,f=.01
u(t,n)?(wheel.cursorImage("SWWalk"),h(!0,t,n),x=n.x,y=n.y):h(!1,t,n),x=t.x,y=t.y
var m=a(x-n.x,y-n.y),v=-m.x,g=-m.y,E=0>v?-1:1,A=0>g?-1:1,T=Math.abs(v),b=Math.abs(g),w=new THREE.Vector2(30,30)
w=a(w.x,w.y),T=u(t,n)?0:Math.abs(v)-w.x,b=u(t,n)?0:Math.abs(g)-w.y
var _=.25
T/=_,b/=_,T=1>T?Math.easeClamp(T,0,1):Math.pow(T,1),b=1>b?Math.easeClamp(b,0,1):Math.pow(b,1)
var C=T>0?T*E:0,S=b>0?b*A:0,R=this.getView(),M=R.length()
R.normalize()
var P=R.clone().cross(e.up)
P.normalize()
var L=d.clone().multiplyScalar(d.clone().dot(R)),I=c.clone().multiplyScalar(c.clone().dot(R)),k=I.clone().add(L)
k=k.clone().length()>Number.MIN_VALUE?k.normalize():e.up
var V=1,N=S*(this.walkMultiplier*V),D=p?k:R
if(p){var H=Math.cos(.65)
1!=H&&(l.clone().dot(e.up)<-Number.MIN_VALUE&&l.clone().dot(R)<-H||l.clone().dot(e.up)>Number.MIN_VALUE&&l.clone().dot(R)>H)&&(D=-D)}var O=-C*this.walkMultiplier*.05,B=e.up
p&&((l.clone().dot(e.up)<-Number.MIN_VALUE||Math.abs(l.clone().dot(e.up))<Number.MIN_VALUE&&l.clone().dot(R)>Number.MIN_VALUE)&&(O=-O),B=l)
var F=(new THREE.Quaternion).setFromAxisAngle(B,O)
F.normalize(),R=F.clone().rotate(R),R.normalize(),e.up.copy(F.clone().rotate(e.up)),e.up.normalize(),e.position.add(D.clone().multiplyScalar(N)),this.center.copy(e.position.clone().add(R.clone().multiplyScalar(M))),D=p?l:e.up,D.normalize(),0===N&&(N=f),e.lookAt(this.center),i(!1)}},this.updown=function(t){if(!this.navApi.getIsLocked()){var n=t,o=f(n)
v.m_amount+=o
var r=new THREE.Vector3(0,1,0),a=v.saveEye.clone().sub(r.clone().multiplyScalar(v.m_amount)),s=a.clone().dot(r)
e.position.copy(a),s<v.minSceneBound&&e.position.add(r.clone().multiplyScalar(v.minSceneBound-s)),s>v.maxSceneBound&&e.position.add(r.clone().multiplyScalar(v.maxSceneBound-s)),this.center.copy(e.position.clone().add(v.saveCenter.clone().sub(v.saveEye))),e.lookAt(this.center),i(!1)}},this.addHistoryElement=function(){},this.addIntermediateHistoryElement=function(){this.rewindParams.snapped?this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.slideOffset.x>0?this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.history=this.rewindParams.history.slice(0,this.rewindParams.timelineIndex+1),this.addHistoryElement()},this.clearHistory=function(){this.rewindParams.history.length=0,this.rewindParams.timelineIndex=0,this.rewindParams.timelineIndexSlide=0,this.rewindParams.resetWeights=!0},this.openTimeline=function(e){this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights&&(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=this.rewindParams.snappingEnabled),0===this.rewindParams.history.length&&this.addHistoryElement()
for(var t=0;t<this.rewindParams.history.length;t++){var i=t-this.rewindParams.timelineIndex,n=this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize
this.rewindParams.history[t].thumbnailBounds.setCenter(new THREE.Vector2(e.x+i*n,e.y).add(this.rewindParams.slideOffset)),this.rewindParams.resetWeights&&(this.rewindParams.history[t].weight=t==this.rewindParams.timelineIndex?1:0)}this.rewindParams.resetWeights&&(this.rewindParams.resetWeights=!1)
var n=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize)
if(this.rewindParams.open=!0,this.rewindParams.openLocation=e.clone(),this.rewindParams.openLocationOrigin=e.clone(),this.rewindParams.openBracket=e.clone(),this.rewindParams.openBracketA=new THREE.Vector2(n,e.y),this.rewindParams.openBracketB=new THREE.Vector2(window.innerWidth-n,e.y),this.rewindParams.openBracketA.x>this.rewindParams.openBracketB.x){var o=this.rewindParams.openBracketA.x
this.rewindParams.openBracketA.x=this.rewindParams.openBracketB.x,this.rewindParams.openBracketB.x=o}this.rewindParams.locationOffset=new THREE.Vector2(0,0),this.rewindParams.snapOffset=new THREE.Vector2(0,0)},this.slideTimeline=function(e){if(this.rewindParams.open&&0!==this.rewindParams.history.length){var t=e.clone().add(this.rewindParams.locationOffset),i=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),n=i,o=window.innerWidth-i,r=this.rewindParams.history[0].thumbnailBounds.center().x,a=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x,s=0
if(t.x<this.rewindParams.openBracketA.x){s=t.x-this.rewindParams.openBracketA.x
var l=r-s
l>n&&(s=Math.min(s+(l-n),0))}if(t.x>this.rewindParams.openBracketB.x){s=t.x-this.rewindParams.openBracketB.x
var c=a-s
o>c&&(s=Math.max(s+(c-o),0))}this.rewindParams.openLocation.x+=s,this.rewindParams.openBracketA.x+=s,this.rewindParams.openBracketB.x+=s,this.rewindParams.openBracket.x=t.x-(this.rewindParams.openLocation.x-this.rewindParams.openLocationOrigin.x)
var u=new THREE.Vector2(-s,0),d=t.clone().sub(this.rewindParams.openLocation.clone().sub(this.rewindParams.openLocationOrigin))
u.x+=this.rewindParams.snapOffset.x,this.rewindParams.snapOffset.x=0
var h=!1
if(this.rewindParams.snappingEnabled)for(var p=4,f=16,m=0;m<this.rewindParams.history.length;m++){var v=this.rewindParams.history[m].thumbnailBounds.center().add(u)
if(Math.abs(v.x-d.x)<p||this.rewindParams.snapped&&Math.abs(v.x-d.x)<f){h=!0,0!==s?(this.rewindParams.snapOffset.x=v.x-d.x,u.x-=this.rewindParams.snapOffset.x):this.rewindParams.openBracket.x+=v.x-d.x,d.x=v.x
break}}this.rewindParams.snapped=h
for(var g=-1,E=0,y=0;y<this.rewindParams.history.length;y++){var A=this.rewindParams.history[y].thumbnailBounds.clone()
if(this.rewindParams.history[y].thumbnailBounds.setCenter(this.rewindParams.history[y].thumbnailBounds.center().add(u)),this.rewindParams.history[y].thumbnail){var T=this.rewindParams.history[y].thumbnailBounds.center().x-this.rewindParams.thumbnailSize/2
$("#rewindFrame"+y).css("left",T),$("#rewindBorder"+y).css("left",T-4)}var b=new THREE.Vector2(2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize))
A.setFromCenterAndSize(A.center(),b)
var w=new THREE.Vector2(0,0)
A.getIcon2DCoords(d,w)
var _=1-Math.abs(Math.equalityClamp(w.x,-1,1))
this.rewindParams.history[y].weight=_,0===y&&d.x<A.center().x&&(this.rewindParams.history[y].weight=1),y===this.rewindParams.history.length-1&&d.x>A.center().x&&(this.rewindParams.history[y].weight=1),E+=this.rewindParams.history[y].weight,this.rewindParams.history[y].weight>g&&(g=this.rewindParams.history[y].weight,this.rewindParams.snappingEnabled&&1==this.rewindParams.history[y].weight?(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=!0):this.rewindParams.slideOffset.x=this.rewindParams.history[y].thumbnailBounds.center().x-d.x,this.rewindParams.timelineIndexSlide=y)}for(var x=0;x<this.rewindParams.history.length;x++)this.rewindParams.history[x].weight=this.rewindParams.history[x].weight/E
var C=this.rewindParams.history[0].thumbnailBounds.center().x,S=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x
this.rewindParams.openBracket.x<C?(this.rewindParams.locationOffset.x+=C-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=C):this.rewindParams.openBracket.x>S&&(this.rewindParams.locationOffset.x+=S-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=S)}},this.shiftBackOneElement=function(){0!==this.rewindParams.history.length&&(this.rewindParams.timelineIndex>0||0!==this.rewindParams.slideOffset.x)&&((this.rewindParams.snapped||this.rewindParams.slideOffset.x>0)&&this.rewindParams.timelineIndex--,this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights=!0,v.elapsedTime=0,this.animateToRewindIndex())},this.animateToRewindIndex=function(){var t=this.rewindParams.timelineIndex,n=0
if(v.elapsedTime>=N.duration)n=1
else{var o=N.destinationPercent
n=Math.easeClamp(v.elapsedTime/N.duration,0,o),v.elapsedTime+=T/500}v.center.copy(v.center.clone().multiplyScalar(1-n).clone().add(this.rewindParams.history[t].camera.center.clone().multiplyScalar(n))),e.position.copy(e.position.clone().multiplyScalar(1-n).clone().add(this.rewindParams.history[t].camera.position.clone().multiplyScalar(n))),e.up.copy(this.rewindParams.history[t].camera.up),v.pivot.copy(v.center),e.lookAt(v.center),i(!1),this.cube&&requestAnimationFrame(this.cube.render),1!==n&&requestAnimationFrame(function(){v.animateToRewindIndex()})},this.closeTimeline=function(){this.rewindParams.timelineIndex!=this.rewindParams.timelineIndexSlide&&(this.rewindParams.timelineIndex=this.rewindParams.timelineIndexSlide),this.rewindParams.open=!1},this.getInterpolatedCamera=function(){var t=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1e4)
t.center=new THREE.Vector3(0,0,0),t.pivot=new THREE.Vector3(0,0,0),t.leftFov=0,t.rightFov=0,t.topFov=0,t.bottomFov=0,t.up.set(0,0,0)
for(var n=0;n<this.rewindParams.history.length;n++){var o=this.rewindParams.history[n].camera,r=this.rewindParams.history[n].weight
t.center.add(o.center.clone().multiplyScalar(r)),t.position.add(o.position.clone().multiplyScalar(r)),t.up.add(o.up.clone().multiplyScalar(r)),t.rotation.add(o.rotation.clone().multiplyScalar(r)),t.pivot.add(o.pivot.clone().multiplyScalar(r)),t.leftFov+=o.leftFov*r,t.rightFov+=o.rightFov*r,t.topFov+=o.topFov*r,t.bottomFov+=o.bottomFov*r}e.position.copy(t.position),e.up.copy(t.up),e.rotation=t.rotation,e.leftFov=t.leftFov,e.rightFov=t.rightFov,e.topFov=t.topFov,e.bottomFov=t.bottomFov,v.center.copy(t.center),v.pivot.copy(t.pivot),e.lookAt(v.center),e.up.normalize(),i(!1)}}
if(Autocam.ViewCube=function(e,t,i,n){function o(e,t){var i={}
return 0===e.type.indexOf("touch")?e.touches.length>0?(i.clientX=e.touches[0].clientX,i.clientY=e.touches[0].clientY,i.pageX=e.touches[0].pageX,i.pageY=e.touches[0].pageY,i.screenX=e.touches[0].screenX,i.screenY=e.touches[0].screenY,i.movementX=i.screenX-t.prevX,i.movementY=i.screenY-t.prevY,i.which=a.navApi.getUseLeftHandedInput()?3:1):i=t.prevCoords:(i.clientX=e.clientX,i.clientY=e.clientY,i.pageX=e.pageX,i.pageY=e.pageY,i.screenX=e.screenX,i.screenY=e.screenY,i.which=e.which,W?(i.movementX=e.movementX||e.mozMovementX||e.webkitMovementX||0,i.movementY=e.movementY||e.mozMovementY||e.webkitMovementY||0):(i.movementX=i.screenX-t.prevX,i.movementY=i.screenY-t.prevY)),t.prevX=i.screenX,t.prevY=i.screenY,t.prevCoords=i,i}var r=this,a=t,s=t.camera
t.setCube(this),r.currentFace="front"
var l,c,u,d,h,p,f=["top,front","top right","top,left","top,back","bottom,front","bottom,right","bottom,left","bottom,back","left,front","front,right","right,back","back,left"],m=["front,top,right","back,top,right","front,top,left","back,top,left","front,bottom,right","back,bottom,right","front,bottom,left","back,bottom,left"],v=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],g=[!0,null,!0,!0,!0,null,!0,!0,!0,null,!0,!0,!0],E=[null,null,function(){return!a.orthographicFaces&&!s.isPerspective},function(){return!a.orthographicFaces&&s.isPerspective},function(){return a.orthographicFaces},null,null,null,null,null,null,null,null]
r.camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2e3),r.camera.position.copy(s.position),r.center=new THREE.Vector3(0,0,0),r.camera.lookAt(r.center)
var y,A,T,b,w,_,x,C,S,R,M,P,L,I,k=[],V=[],N=[],D=[],H=[],O=null,B=null,F=null,U=0,z=0,G=!0,W=!1,j=!1,X=!1,Y=-1!=navigator.userAgent.search("Chrome"),q=-1!=navigator.platform.search("Win32"),K=!1,Z=!1,Q=[]
this.width=0,this.height=0,this.animSpeed=500,this.animate=!0,this.compass=!1,this.viewScaleFactorCompass=1.5,this.viewScale=1,this.draggable=!0,this.wantHomeButton=!1,this.wantRollArrows=!0,this.wantContextMenu=!0,this.inactiveOpacity=.5
var J=function(e){var t=e.getBoundingClientRect()
return{x:t.left,y:t.top,w:t.width,h:t.height}},$=function(e){e.preventDefault(),e.stopPropagation(),j=document.pointerLockElement===i||document.mozPointerLockElement===i||document.webkitPointerLockElement===i},ee=function(){var e=i.getBoundingClientRect()
r.width=e.width,r.height=e.height,I=J(i),x=r.width/2,C=r.height/2,p=new THREE.PerspectiveCamera(70,r.height/r.width,1,1e4),p.position.set(0,0,500),l=new THREE.Scene,c=new THREE.Scene,u=new THREE.Scene,d=new THREE.Scene,h=new THREE.Scene,G=!0,U=200,r.viewScale=3.5*U
var t=THREE.LinearFilter,o=Autodesk.Viewing.Private.getResourceUrl,s="res/textures/",f=n||s,m=(new THREE.DDSLoader).load(o(f+"VCcrossRGBA8small.dds"))
m.minFilter=m.maxFilter=t
var v=THREE.ShaderLib.cube,g=new THREE.ShaderMaterial({fragmentShader:v.fragmentShader,vertexShader:v.vertexShader,uniforms:THREE.UniformsUtils.clone(v.uniforms),depthWrite:!1})
g.uniforms.tCube.value=m
var E=new THREE.BoxGeometry(U,U,U,4,4,4),k=new THREE.BoxGeometry(U+1,U+1,U+1,4,4,4)
y=new THREE.Mesh(E,g),y.position.set(0,0,0),c.add(y)
var N=oe(o(s+"VCedge1.png"))
N.minFilter=N.maxFilter=t,A=new THREE.Mesh(k,new THREE.MeshBasicMaterial({map:N,overdraw:!1,transparent:!0,shading:THREE.SmoothShading})),A.position.set(0,0,0),d.add(A)
var H=U,O=new THREE.Geometry,B=new THREE.Vector3(-30,0,0),F=new THREE.Vector3(30,0,0),z=new THREE.Vector3(0,-30,0)
O.vertices.push(B),O.vertices.push(F),O.vertices.push(z),O.faces.push(new THREE.Face3(1,0,2)),O.computeFaceNormals()
var j=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),X=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),Y=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),q=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),K=new THREE.PlaneBufferGeometry(.5*U,.3*U,2,2),Z=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),ee=new THREE.Mesh(O,j),te=new THREE.Mesh(K,Z)
ee.position.set(0,H,0),te.position.set(0,.9*H,.1)
var ie=new THREE.Mesh(O,X),ne=new THREE.Mesh(K,Z)
ie.position.set(0,-H,0),ne.position.set(0,.9*-H,.1),ie.rotation.z+=Math.PI,ne.rotation.z+=Math.PI
var ae=new THREE.Mesh(O,Y),se=new THREE.Mesh(K,Z)
ae.position.set(H,0,0),se.position.set(.9*H,0,.1),ae.rotation.z-=Math.PI/2,se.rotation.z-=Math.PI/2
var ce=new THREE.Mesh(O,q),ue=new THREE.Mesh(K,Z)
ce.position.set(-H,0,0),ue.position.set(.9*-H,0,.1),ce.rotation.z+=Math.PI/2,ue.rotation.z+=Math.PI/2,_=new THREE.Object3D,_.position.set(0,0,0),_.add(ee),_.add(ie),_.add(ae),_.add(ce),h.add(te),h.add(ne),h.add(se),h.add(ue),h.add(_),V.push(te),V.push(ne),V.push(se),V.push(ue)
var de=new THREE.PlaneBufferGeometry(U/3,U/3,2,2),pe=new THREE.MeshBasicMaterial({map:oe(o(s+"VChome.png")),transparent:!0,shading:THREE.FlatShading})
T=new THREE.Mesh(de,pe),T.position.set(-U,U,0),P=D.length,h.add(T),D.push(T)
var fe=new THREE.PlaneBufferGeometry(1.5*U,1.5*U,2,2),me=new THREE.MeshBasicMaterial({map:oe(o(s+"VCarrows.png")),shading:THREE.FlatShading,transparent:!0}),ve=new THREE.Mesh(fe,me)
ve.position.set(.5*U+20,.5*U+20,0)
var ge=new THREE.PlaneBufferGeometry(.6*U,.45*U,2,2),Ee=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),ye=new THREE.Mesh(ge,Ee)
ye.position.set(.5*U+20,U+20,.1)
var Ae=new THREE.PlaneBufferGeometry(.45*U,.6*U,2,2),Te=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),be=new THREE.Mesh(Ae,Te)
be.position.set(U+20,.5*U+20,.1),h.add(ve),h.add(ye),h.add(be),S=D.length,D.push(ye),R=D.length,D.push(be),M=D.length,D.push(ve)
var we=new THREE.PlaneBufferGeometry(U/2.3,U/2.3,2,2),_e=new THREE.MeshBasicMaterial({map:oe(o(s+"VCcontext.png")),transparent:!0,shading:THREE.FlatShading})
w=new THREE.Mesh(we,_e),w.position.set(U,-U,0),L=D.length,h.add(w),D.push(w)
var xe=new THREE.Geometry
xe.vertices.push(new THREE.Vector3(0,0,0)),xe.vertices.push(new THREE.Vector3(-U/2,-U/2-20,-U/2)),xe.vertices.push(new THREE.Vector3(U/2,-U/2-20,-U/2)),xe.vertices.push(new THREE.Vector3(U/2,-U/2-20,U/2)),xe.vertices.push(new THREE.Vector3(-U/2,-U/2-20,U/2)),xe.faces.push(new THREE.Face3(4,3,2)),xe.faces.push(new THREE.Face3(4,2,1))
var Ce
Ce=new THREE.MeshBasicMaterial({color:0,transparent:!0,opacity:.5}),b=new THREE.Mesh(xe,Ce),l.add(b),re(),"CANVAS"===a.renderer.toUpperCase()?r.renderer=new THREE.CanvasRenderer:"WEBGL"===a.renderer.toUpperCase()?r.renderer=new FireflyWebGLRenderer({alpha:!0,antialias:!0}):(console.log("Incorrect use of Autocam.renderer property"),r.renderer=new THREE.CanvasRenderer),r.useTransparency(!0),r.setSize(r.width,r.height),r.camera.topFov=r.camera.bottomFov=r.camera.fov/2,r.camera.leftFov=r.camera.rightFov=r.camera.aspect*r.camera.fov/2,r.renderer.autoClear=!1,r.renderer.setSize(r.width,r.height),r.renderer.sortObjects=!1,i.appendChild(r.renderer.domElement),i.addEventListener("touchstart",le,!1),i.addEventListener("mousedown",le,!1),i.addEventListener("mousemove",he,!1),W=!1,W&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock||i.webkitRequestPointerLock,document.addEventListener("pointerlockchange",$,!1),document.addEventListener("mozpointerlockchange",$,!1),document.addEventListener("webkitpointerlockchange",$,!1)),Q.push(oe(o(s+"VChomeS.png"))),Q.push(oe(o(s+"VCarrowsS0.png"))),Q.push(oe(o(s+"VCarrowsS1.png"))),Q.push(oe(o(s+"VChome.png"))),Q.push(oe(o(s+"VCarrows.png"))),Q.push(oe(o(s+"VCcontext.png"))),Q.push(oe(o(s+"VCcontextS.png")))},te=function(){a.navApi.getIsLocked()||(i.style.opacity="1.0",Z=!1),requestAnimationFrame(r.render)},ie=function(e){if(Z||a.viewCubeMenuOpen||a.navApi.getIsLocked())a.navApi.getIsLocked()||(i.style.opacity=1)
else{var t=Math.max(4*Math.abs((e.clientX-I.x)/I.w-.5)-1,0),n=Math.max(4*Math.abs((e.clientY-I.y)/I.h-.5)-1,0),o=Math.max(0,Math.min(Math.sqrt(t*t+n*n),1))
i.style.opacity=1-o*(1-r.inactiveOpacity)}},ne=function(){a.viewCubeMenuOpen||(i.style.opacity=r.inactiveOpacity,Z=!0,requestAnimationFrame(r.render))},oe=function(e){var t=new Image
t.crossOrigin="anonymous"
var i=new THREE.Texture(t)
return t.onload=function(){i.needsUpdate=!0,z++,z>=11&&requestAnimationFrame(r.render)},t.src=e,i},re=function(){var e,t=[],i=[]
t[0]=ve(0,0),t[1]=ve(0,Math.PI/2),t[2]=ve(0,-Math.PI/2),t[3]=ve(0,Math.PI),t[4]=ve(Math.PI/2,0),t[5]=ve(Math.PI/2,Math.PI/2),t[6]=ve(Math.PI/2,-Math.PI/2),t[7]=ve(Math.PI/2,Math.PI),i[0]=me(0,0,0),i[1]=me(0,Math.PI/2,0),i[2]=me(0,-Math.PI/2,0),i[3]=me(0,Math.PI,0),i[4]=me(Math.PI/2,0,0),i[5]=me(Math.PI/2,Math.PI/2,0),i[6]=me(Math.PI/2,-Math.PI/2,0),i[7]=me(Math.PI/2,Math.PI,0),i[8]=me(0,0,Math.PI/2),i[9]=me(0,0,-Math.PI/2),i[10]=me(-Math.PI/2,0,-Math.PI/2),i[11]=me(-Math.PI,0,-Math.PI/2),k.push(fe(0,0)),k[0].name="front",N.push(k[0]),H.push(k[0]),u.add(k[0]),k.push(fe(0,Math.PI/2)),k[1].name="right",N.push(k[1]),H.push(k[1]),u.add(k[1]),k.push(fe(0,Math.PI)),k[2].name="back",N.push(k[2]),H.push(k[2]),u.add(k[2]),k.push(fe(0,-Math.PI/2)),k[3].name="left",N.push(k[3]),H.push(k[3]),u.add(k[3]),k.push(fe(Math.PI/2,0)),k[4].name="bottom",N.push(k[4]),H.push(k[4]),u.add(k[4]),k.push(fe(-Math.PI/2,0)),k[5].name="top",N.push(k[5]),H.push(k[5]),u.add(k[5]),e=k.length
var n
for(n=0;n<t.length;n++)k.push(t[n]),k[e+n].name=m[n],u.add(k[e+n]),N.push(k[e+n]),H.push(k[e+n])
for(e=k.length,n=0;n<i.length;n++)k.push(i[n]),k[e+n].name=f[n],u.add(k[e+n]),N.push(k[e+n]),H.push(k[e+n])},ae=function(e,t,i){var n,o,r=new THREE.Vector3
return r.copy(e),r=r.unproject(t),n=new THREE.Raycaster(t.position,r.sub(t.position).normalize()),o=n.intersectObjects(i)},se=function(e,t){var i=e.clientX-t.x,n=e.clientY-t.y
return i=i/t.w*2-1,n=(t.h-n)/t.h*2-1,new THREE.Vector3(i,n,.5)},le=function(e){if(e.preventDefault(),e.stopPropagation(),!a.navApi.getIsLocked()&&!a.currentlyAnimating){var t=o(e,r)
I=J(i),i.removeEventListener("mousemove",he,!1),document.addEventListener("mouseup",de,!1),document.addEventListener("touchend",de,!1),a.navApi.getUsePivotAlways()||(a.pivot.copy(a.center),a.navApi.setPivotPoint(a.center),a.navApi.setPivotSetFlag(!1)),a.startInteraction(t.pageX,t.pageY)
var n,s
0==a.rewindParams.history.length&&a.addHistoryElement(),a.rewindParams.snapped&&a.rewindParams.timelineIndex+1==a.rewindParams.history.length||a.addIntermediateHistoryElement()
var l=a.navApi.getUseLeftHandedInput()?1:3
if(t.which!==l){if(r.animSpeed<=0)return void console.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation")
s=se(t,I),n=ae(s,r.camera,H),n.length>0&&(ye(),r.draggable&&(document.addEventListener("mousemove",ce,!1),document.addEventListener("touchmove",ce,!1),W&&(i.requestPointerLock(),X=Y&&q)))}}},ce=function(e){if(e.preventDefault(),e.stopPropagation(),r.animSpeed<=0)return document.removeEventListener("mousemove",ce,!1),document.removeEventListener("touchmove",ce,!1),void console.error("animSpeed cannot be 0 or less")
if(!a.currentlyAnimating){var t=o(e,r)
if(W&&X&&(X=!1,t.movementX=t.movementY=0),j&&(t.movementX>300||t.movementY>300)&&(t.movementX=0,t.movementY=0),t.movementX===t.movementY&&0===t.movementX)return void(a.currentlyAnimating=!1)
G=!1,K=!0,a.showPivot(!0),a.currentCursor=new THREE.Vector2(t.pageX,t.pageY),a.orbit(a.currentCursor,a.startCursor,new THREE.Vector3(-t.movementX,t.movementY,0),a.startState),r.camera.lookAt(r.center),requestAnimationFrame(r.render)}},ue=function(e){e||(document.removeEventListener("mouseup",de,!1),document.removeEventListener("touchend",de,!1)),document.removeEventListener("mousemove",ce,!1),document.removeEventListener("touchmove",ce,!1),i.addEventListener("mousemove",he,!1),j&&document.exitPointerLock()},de=function(e){e.preventDefault(),e.stopPropagation()
var t,n,l
if(a.currentlyAnimating||K)return a.endInteraction(),a.showPivot(!1),K=!1,void ue(!1)
var c=o(e,r)
if(a.viewCubeMenuOpen){var u=c.clientX-I.x,d=c.clientY-I.y
if(a.menuOrigin.x<=u&&u<=a.menuOrigin.x+a.menuSize.x&&a.menuOrigin.y<=d&&d<=a.menuOrigin.y+a.menuSize.y){var h=Math.floor((d-5-a.menuOrigin.y)/25)
switch(h){case 0:a.goHome()
break
case 1:a.setOrthographicFaces(!1),a.toOrthographic()
break
case 2:a.setOrthographicFaces(!1),a.toPerspective()
break
case 3:a.setOrthographicFaces(!0),G?a.toOrthographic():a.toPerspective()
break
case 4:a.setCurrentViewAsHome(!1)
break
case 5:a.setCurrentViewAsHome(!0)
break
case 6:a.resetHome()
break
case 7:a.setCurrentViewAsFront()
break
case 8:a.setCurrentViewAsTop()
break
case 9:a.resetOrientation()}}return a.viewCubeMenuOpen=!1,a.removeDropdownMenu(i),(c.clientX<I.x||c.clientX>I.w+I.x||c.clientY<I.y||c.clientY>I.h+I.y)&&ne(),r.mouseMoveSave&&r.processMouseMove(r.mouseMoveSave),void ue(!1)}var f=a.navApi.getUseLeftHandedInput()?1:3
if(c.which===f)return a.viewCubeMenuOpen=!0,a.drawDropdownMenu(v,g,E,c.clientX,c.clientY,i,I),void ue(!0)
var m=se(c,I)
if(t=ae(m,r.camera,H),n=ae(m,p,V),l=ae(m,p,D),n.length>0&&G){var y=a.getOrientation()
switch(r.currentFace){case"front":switch(y){case"up":n[0].object===V[0]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[1]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[2]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[3]&&(a.calculateCubeTransform("left"),r.currentFace="left")
break
case"right":n[0].object===V[0]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[1]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[2]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[3]&&(a.calculateCubeTransform("top"),r.currentFace="top")
break
case"down":n[0].object===V[0]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[1]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[2]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[3]&&(a.calculateCubeTransform("right"),r.currentFace="right")
break
case"left":n[0].object===V[0]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[1]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[2]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[3]&&(a.calculateCubeTransform("bottom"),r.currentFace="bottom")}break
case"right":switch(y){case"up":n[0].object===V[0]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[1]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[2]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[3]&&(a.calculateCubeTransform("front"),r.currentFace="front")
break
case"right":n[0].object===V[0]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[1]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[2]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[3]&&(a.calculateCubeTransform("top"),r.currentFace="top")
break
case"down":n[0].object===V[0]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[1]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[2]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[3]&&(a.calculateCubeTransform("back"),r.currentFace="back")
break
case"left":n[0].object===V[0]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[1]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[2]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[3]&&(a.calculateCubeTransform("bottom"),r.currentFace="bottom")}break
case"left":switch(y){case"up":n[0].object===V[0]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[1]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[2]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[3]&&(a.calculateCubeTransform("back"),r.currentFace="back")
break
case"right":n[0].object===V[0]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[1]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[2]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[3]&&(a.calculateCubeTransform("top"),r.currentFace="top")
break
case"down":n[0].object===V[0]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[1]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[2]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[3]&&(a.calculateCubeTransform("front"),r.currentFace="front")
break
case"left":n[0].object===V[0]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[1]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[2]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[3]&&(a.calculateCubeTransform("bottom"),r.currentFace="bottom")}break
case"back":switch(y){case"up":n[0].object===V[0]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[1]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[2]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[3]&&(a.calculateCubeTransform("right"),r.currentFace="right")
break
case"right":n[0].object===V[0]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[1]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[2]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[3]&&(a.calculateCubeTransform("top"),r.currentFace="top")
break
case"down":n[0].object===V[0]?(a.calculateCubeTransform("bottom"),r.currentFace="bottom"):n[0].object===V[1]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[2]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[3]&&(a.calculateCubeTransform("left"),r.currentFace="left")
break
case"left":n[0].object===V[0]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[1]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[2]?(a.calculateCubeTransform("top"),r.currentFace="top"):n[0].object===V[3]&&(a.calculateCubeTransform("bottom"),r.currentFace="bottom")}break
case"top":switch(y){case"up":n[0].object===V[0]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[1]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[2]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[3]&&(a.calculateCubeTransform("left"),r.currentFace="left")
break
case"right":n[0].object===V[0]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[1]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[2]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[3]&&(a.calculateCubeTransform("back"),r.currentFace="back")
break
case"down":n[0].object===V[0]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[1]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[2]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[3]&&(a.calculateCubeTransform("right"),r.currentFace="right")
break
case"left":n[0].object===V[0]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[1]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[2]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[3]&&(a.calculateCubeTransform("front"),r.currentFace="front")}break
case"bottom":switch(y){case"up":n[0].object===V[0]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[1]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[2]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[3]&&(a.calculateCubeTransform("left"),r.currentFace="left")
break
case"right":n[0].object===V[0]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[1]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[2]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[3]&&(a.calculateCubeTransform("front"),r.currentFace="front")
break
case"down":n[0].object===V[0]?(a.calculateCubeTransform("back"),r.currentFace="back"):n[0].object===V[1]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[2]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[3]&&(a.calculateCubeTransform("right"),r.currentFace="right")
break
case"left":n[0].object===V[0]?(a.calculateCubeTransform("left"),r.currentFace="left"):n[0].object===V[1]?(a.calculateCubeTransform("right"),r.currentFace="right"):n[0].object===V[2]?(a.calculateCubeTransform("front"),r.currentFace="front"):n[0].object===V[3]&&(a.calculateCubeTransform("back"),r.currentFace="back")}}a.elapsedTime=0,a.sphericallyInterpolateTransition()}if(l.length>0){if(a.elapsedTime=0,r.wantHomeButton&&l[0].object===D[P])return a.goHome(),void ue(!1)
if(r.wantContextMenu&&l[0].object===D[L])return a.viewCubeMenuOpen=!0,a.drawDropdownMenu(v,g,E,c.clientX,c.clientY,i,I),void ue(!0)
if(r.wantRollArrows&&G&&(l[0].object===D[S]||l[0].object===D[R])){var A=l[0].object===D[R],T={center:a.center.clone(),position:s.position.clone(),pivot:s.pivot.clone(),fov:s.fov,worldUp:a.sceneUpDirection.clone(),isOrtho:s.isPerspective===!1},b=a.center.clone().sub(s.position).normalize()
A?T.up=s.up.clone().cross(b):(T.up=s.up.clone().multiplyScalar(-1),T.up.cross(b)),T.up.normalize(),a.elapsedTime=0,a.animateTransition(T)}}t.length>0&&(r.currentFace=t[0].object.name,a.orthographicFaces&&-1!==r.currentFace.indexOf(",")&&a.setCameraOrtho(!1),a.calculateCubeTransform(r.currentFace),a.elapsedTime=0,r.mouseMoveSave=e,a.sphericallyInterpolateTransition(function(){r.mouseMoveSave&&r.processMouseMove(r.mouseMoveSave)})),ue(!1)}
this.processMouseMove=function(e){var t,i,n
if(a.viewCubeMenuOpen||a.currentlyAnimating)return void(r.mouseMoveSave=e)
r.mouseMoveSave=null
var s=o(e,r),l=se(s,I)
if(t=ae(l,r.camera,N),i=ae(l,p,V),n=ae(l,p,D),O&&!K&&(O.material.color.setHex(14540253),O=null,requestAnimationFrame(r.render)),i.length>0&&!K){O=i[0].object
for(var c=_.children.length;--c>=0;)if(O===V[c]){O=_.children[c],O.material.color.setHex(45055)
break}requestAnimationFrame(r.render)}B&&!K&&(B.material.opacity=0,B=null,requestAnimationFrame(r.render)),t.length>0&&!K&&(B=t[0].object,B.material.opacity=.3,requestAnimationFrame(r.render)),n.length>0&&!K?F!==n[0].object&&(r.wantHomeButton&&n[0].object===D[P]?(F=n[0].object,D[P].material.map=Q[0]):r.wantRollArrows&&n[0].object===D[S]?(F=n[0].object,D[M].material.map=Q[1]):r.wantRollArrows&&n[0].object===D[R]?(F=n[0].object,D[M].material.map=Q[2]):r.wantContextMenu&&n[0].object===D[L]?(F=n[0].object,D[L].material.map=Q[6]):r.wantHomeButton&&F===D[P]?(F=null,D[P].material.map=Q[3]):!r.wantRollArrows||F!==D[S]&&F!==D[R]&&F!==D[M]?r.wantContextMenu&&F===D[L]&&(F=null,D[L].material.map=Q[5]):(F=null,D[M].material.map=Q[4]),requestAnimationFrame(r.render)):null===F||K||(r.wantHomeButton&&F===D[P]?(F=null,D[P].material.map=Q[3]):!r.wantRollArrows||F!==D[S]&&F!==D[R]&&F!==D[M]?r.wantContextMenu&&F===D[L]&&(F=null,D[L].material.map=Q[5]):(F=null,D[M].material.map=Q[4]),requestAnimationFrame(r.render))}
var he=function(e){a.navApi.getIsLocked()||r.processMouseMove(e)},pe=function(){I=J(i),r.width=i.offsetWidth,r.height=i.offsetHeight,x=r.width/2,C=r.height/2,r.camera.aspect=r.width/r.height,r.camera.updateProjectionMatrix(),r.camera.topFov=r.camera.bottomFov=r.camera.fov/2,r.camera.leftFov=r.camera.rightFov=r.camera.aspect*r.camera.fov/2,r.renderer.setSize(r.width,r.height),requestAnimationFrame(r.render)},fe=function(e,t){var i,n=45,o=60,r=n+o,a=new THREE.Geometry,s=new THREE.Vector3(0,0,0),l=new THREE.Vector3(o,-o,r),c=new THREE.Vector3(o,o,r),u=new THREE.Vector3(-o,o,r),d=new THREE.Vector3(-o,-o,r)
return a.vertices.push(s),a.vertices.push(l),a.vertices.push(c),a.vertices.push(u),a.vertices.push(d),a.faces.push(new THREE.Face3(1,2,3)),a.faces.push(new THREE.Face3(1,3,4)),a.applyMatrix((new THREE.Matrix4).makeRotationX(e)),a.applyMatrix((new THREE.Matrix4).makeRotationY(t)),a.computeFaceNormals(),a.computeVertexNormals(),i=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),new THREE.Mesh(a,i)},me=function(e,t,i){var n,o,r=45,a=60,s=r+a,l=new THREE.Geometry,c=new THREE.Vector3(a,s,s),u=new THREE.Vector3(-a,s,s),d=new THREE.Vector3(-a,a,s),h=new THREE.Vector3(a,a,s),p=new THREE.Vector3(a,s,a),f=new THREE.Vector3(-a,s,a),m=new THREE.Vector3(-a,s,s),v=new THREE.Vector3(a,s,s)
return l.vertices.push(c),l.vertices.push(u),l.vertices.push(d),l.vertices.push(h),l.vertices.push(p),l.vertices.push(f),l.vertices.push(m),l.vertices.push(v),l.faces.push(new THREE.Face3(0,1,2)),l.faces.push(new THREE.Face3(0,2,3)),l.faces.push(new THREE.Face3(4,5,6)),l.faces.push(new THREE.Face3(4,6,7)),l.applyMatrix((new THREE.Matrix4).makeRotationX(e)),l.applyMatrix((new THREE.Matrix4).makeRotationY(t)),l.applyMatrix((new THREE.Matrix4).makeRotationZ(i)),l.computeFaceNormals(),l.computeVertexNormals(),n=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),o=new THREE.Mesh(l,n)},ve=function(e,t){var i,n,o=45,r=60,a=o+r,s=new THREE.Geometry,l=new THREE.Vector3(a,a,a),c=new THREE.Vector3(r,a,a),u=new THREE.Vector3(r,r,a),d=new THREE.Vector3(a,r,a),h=new THREE.Vector3(a,a,r),p=new THREE.Vector3(a,a,a),f=new THREE.Vector3(a,r,a),m=new THREE.Vector3(a,r,r),v=new THREE.Vector3(a,a,a),g=new THREE.Vector3(a,a,r),E=new THREE.Vector3(r,a,r),y=new THREE.Vector3(r,a,a)
return s.vertices.push(l),s.vertices.push(c),s.vertices.push(u),s.vertices.push(d),s.vertices.push(h),s.vertices.push(p),s.vertices.push(f),s.vertices.push(m),s.vertices.push(v),s.vertices.push(g),s.vertices.push(E),s.vertices.push(y),s.faces.push(new THREE.Face3(0,1,2)),s.faces.push(new THREE.Face3(0,2,3)),s.faces.push(new THREE.Face3(4,5,6)),s.faces.push(new THREE.Face3(4,6,7)),s.faces.push(new THREE.Face3(8,9,10)),s.faces.push(new THREE.Face3(8,10,11)),s.applyMatrix((new THREE.Matrix4).makeRotationX(e)),s.applyMatrix((new THREE.Matrix4).makeRotationY(t)),s.computeFaceNormals(),s.computeVertexNormals(),i=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0}),n=new THREE.Mesh(s,i)},ge=function(e){var t=a.cubeFront.clone(),i=a.sceneUpDirection.clone(),n=t.clone().cross(i)
i.copy(n).cross(t),t.normalize(),i.normalize(),n.normalize()
var o=new THREE.Vector3(t.x,i.x,n.x).multiplyScalar(e.x)
return o.add(new THREE.Vector3(t.y,i.y,n.y).multiplyScalar(e.y)),o.add(new THREE.Vector3(t.z,i.z,n.z).multiplyScalar(e.z)),o}
this.render=function(){var e=r.compass?r.viewScaleFactorCompass*r.viewScale:r.viewScale,t=a.center.clone().sub(s.position).normalize(),i=s.up.normalize()
t=ge(t),i=ge(i),r.camera.position.copy(t),r.camera.position.multiplyScalar(-e/r.camera.position.length()),r.camera.up=i.normalize(),r.camera.lookAt(r.center),Ee()
var n=r.renderer
n&&(n.clear(),n.render(l,r.camera),n.render(c,r.camera),n.render(d,r.camera),n.render(u,r.camera),n.render(h,p))}
var Ee=function(){G=a.isFaceView(),!G||Z||a.currentlyAnimating?ye():Ae(),Z?Te():be(),Z?we():_e()},ye=function(){h.remove(_),D[M].material.opacity=0,D[L].material.opacity=0},Ae=function(){h.add(_)
var e=r.wantRollArrows?1:0
D[M].material.opacity=e,D[L].material.opacity=e},Te=function(){w.material.opacity=0},be=function(){w.material.opacity=r.wantContextMenu?1:0},we=function(){T.material.opacity=0},_e=function(){T.material.opacity=r.wantHomeButton?1:0}
this.refreshCube=function(){pe()},this.setSize=function(e,t){if(r.width=e,r.height=t,i.children.length>1)for(var n=1;n<i.children.length;n++)i.children[n].style.bottom=(r.height/5).toString()+"px"
pe()},this.useTransparency=function(e){Z=e,e?(i.onmouseover=te,i.onmousemove=ie,i.onmouseout=ne,ne()):(i.onmouseover=null,i.onmouseout=null,i.onmousemove=null,i.style.opacity="1.0")},this.dtor=function(){this.renderer=null},ee()},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.ToolController=function(e,t,i,n,o){function r(e,i){return t.navigation.getUseLeftHandedInput()&&0===e||s&&1===e||a&&!c&&0===e&&i.ctrlKey}this.domElement=t.canvasWrap,this.selector=e.selector,this.autocam=i,this.lastClickX=-1,this.lastClickY=-1,this.scrollInputEnabled=!0
var a=-1!=navigator.userAgent.search("Mac OS"),s=-1!=navigator.userAgent.search("Firefox"),l=-1!==navigator.userAgent.search("Chrome"),c=-1!==navigator.userAgent.search("Safari")&&!l,u=(2*Math.PI,0),d=2,h=2,p=500,f={},m=[],v=!1,g=-1,E=-1,y=!1,A=null,T=void 0,b=!1,w={},_=this,x={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,LCOMMAND:91,RCOMMAND:93,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,SEMICOLONMOZ:59,EQUALSMOZ:61,d:68,f:70,h:72,o:79,p:80,x:88,y:89,z:90,DASHMOZ:109,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,DASHMOZNEW:173,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222,COMMANDMOZ:224}
this.__registerToolByName=function(e,t){f[t]=e},this.registerTool=function(e){var t=e.getNames()
if(!t||0==t.length)return console.log("Cannot register tool with no name."),!1
for(var i=!1,o=0;o<t.length;++o)"default"!==t[o]&&(this.__registerToolByName(e,t[o]),i=!0)
return e.utilities=n,e.controller=this,e.register&&e.register(),i},this.deregisterTool=function(e){this.deactivateTool(e.getName())
var t=e.getNames()
if(!t||0==t.length)return!1
for(var i=t.length;--i>=0;)this.__deregisterToolName(t[i])
return e.deregister&&e.deregister(),e.utilities=null,e.controller=null,!0},this.__deregisterToolName=function(e){function t(e){for(var t=m.length;--t>=0;)m[t]===e&&(f[e].deactivate(e),m.splice(t,1))}e in f&&(t(e),delete f[e])},this.getTool=function(e){return f[e]},this.getActiveToolName=function(){var e=m.length
return e>0?m[e-1]:"default"},this.activateTool=function(e){if(v)return!1
var i=f[e]
if(i){var n=null
return"intercept"===m[m.length-1]&&(n=m.pop()),m.push(e),i.activate(e),n&&m.push(n),t.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:e,active:!0}),!0}return stderr("activateTool not found: "+e),!1},this.deactivateTool=function(e){if(v)return!1
for(var i=m.length;--i>=0;)if(m[i]===e)return m.splice(i,1),f[e].deactivate(e),t.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:e,active:!1}),!0
return stderr("deactivateTool not found: "+e),!1},this.getToolNames=function(){return Object.keys(f)},this.setDefaultTool=function(e){var t=this.getDefaultTool()
return e&&e!==t?(this.__registerToolByName(e,"default"),t&&t.deactivate("default"),e.activate("default"),!0):!1},this.getDefaultTool=function(){return f["default"]},this.setDefaultTool(o),this.setIsLocked=function(e){var t=v
return v=!!e,t},this.getIsLocked=function(){return v},this.__checkCursor=function(){for(var e=null,i=m.length;--i>=0;){var n=f[m[i]]
if("getCursor"in n&&(e=n.getCursor()))break}e||(e="auto"),A!=e&&(t.canvas.style.cursor=e,A=e)},this.update=function(e){this.__checkCursor()
var i=!1
n&&n.update()&&(i=!0)
for(var o=m.length;--o>=0;){var r=f[m[o]]
"update"in r&&r.update(e)&&(i=!0)}if(t.navigation.getCamera().dirty?(t.navigation.updateCamera(),i=!0,this.cameraUpdated=!0):this.cameraUpdated=!1,i)t.navigation.updateCamera(),this.moveDelay=Date.now()+150
else if(0!==this.moveDelay){var a=this.moveDelay-Date.now()
a>0?i=!0:this.moveDelay=0}return i},this.__clientToCanvasCoords=function(e,i,n){var o=t.navigation.getScreenViewport(),r=o.width,a=o.height,s=e.clientX-o.left,l=e.clientY-o.top
e.canvasX=s,e.canvasY=l,e.normalizedX=s/r*2-1,e.normalizedY=(a-l)/a*2-1,i&&i.set(s/r,l/a,0),n&&n.set(s,l)},this.__invokeStack=function(e,t,i){for(var n=m.length;--n>=0;){var o=m[n],r=f[o]
if(e in r&&r[e](t,i))return!0}var a=this.getDefaultTool()
return e in a&&a[e](t,i)?!0:!1},this.distributeEvent=function(e,t,i){return this.__invokeStack(e,t,i)},this.handleResize=function(){t.navigation.setScreenViewport(t.container.getBoundingClientRect())
for(var e=m.length;--e>=0;){var i=f[m[e]]
"handleResize"in i&&i.handleResize()}},this.handleSingleClick=function(e){var t=this.applyButtonMappings(e)
this.lastClickX=e.clientX,this.lastClickY=e.clientY,this.__invokeStack("handleSingleClick",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleDoubleClick=function(e){var t=this.applyButtonMappings(e)
this.__invokeStack("handleDoubleClick",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleSingleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleSingleTap",e)&&(e.preventDefault(),e.stopPropagation())},this.handleDoubleTap=function(e){this.lastClickX=e.canvasX,this.lastClickY=e.canvasY,this.__invokeStack("handleDoubleTap",e)&&(e.preventDefault(),e.stopPropagation())},this.handleWheelInput=function(e,t){this.__invokeStack("handleWheelInput",e)&&(t.preventDefault(),t.stopPropagation())},this.applyButtonMappings=function(e){var i=e.button
return"buttons"in e&&(e.firefoxSpoof?i=u:!y||1&e.buttons?i===d&&1&e.buttons&&(i=u,e.firefoxSpoof=y=!0):(e.firefoxSpoof=!0,y=!1,i=u)),t.navigation.getUseLeftHandedInput()&&(i=i===u?d:i===d?u:i),i},this.applyKeyMappings=function(e,t){switch(e.keyCode){case x.LCOMMAND:case x.RCOMMAND:case x.COMMANDMOZ:return a&&e.metaKey&&e.shiftKey?null:x.CONTROL
case x.SHIFT:return t&&a&&e.metaKey?null:x.SHIFT
case x.EQUALSMOZ:return x.EQUALS
case x.DASHMOZNEW:case x.DASHMOZ:return x.DASH}return e.keyCode},this.handleKeyDown=function(e){var t=this.applyKeyMappings(e,!0)
t&&this.__invokeStack("handleKeyDown",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleKeyUp=function(e){var t=this.applyKeyMappings(e,!0)
t&&this.__invokeStack("handleKeyUp",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleButtonDown=function(e,t){this.__invokeStack("handleButtonDown",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleButtonUp=function(e,t){this.__invokeStack("handleButtonUp",e,t)&&(e.preventDefault(),e.stopPropagation())},this.handleMouseMove=function(e){this.__invokeStack("handleMouseMove",e)&&(e.preventDefault(),e.stopPropagation())},this.handleBlur=function(e){this.__invokeStack("handleBlur",e)&&(e.preventDefault(),e.stopPropagation())},this.keydown=function(e){if(!(!_.domElement.contains(T)||document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement)){if(document.activeElement){var t=document.activeElement.getAttribute("contenteditable")
if("true"===t||""===t)return}a&&e.metaKey&&e.keyCode!=x.LCOMMAND&&e.keyCode!=x.RCOMMAND||_.handleKeyDown(e)}},this.keyup=function(e){a&&e.metaKey&&e.keyCode!=x.LCOMMAND&&e.keyCode!=x.RCOMMAND||_.handleKeyUp(e)},this.mousedown=function(e){function t(e){var n=_.applyButtonMappings(e)
n===i&&(document.removeEventListener("mouseup",t),_.mouseup(e))}_isIE11&&inFullscreen()||document.activeElement.blur(),_.__clientToCanvasCoords(e)
var i=_.applyButtonMappings(e)
if(_.handleButtonDown(e,i),g=e.canvasX,E=e.canvasY,r(i,e)){var n=w,o=void 0!==n.time&&e.timeStamp-n.time<p,a=void 0!==n.x&&void 0!==n.y&&Math.abs(n.x-e.canvasX)<=h&&Math.abs(n.y-e.canvasY)<=h;(!o||!a||n.clickCount&&2<=n.clickCount)&&(n.clickCount=0),n.clickCount?1===n.clickCount&&(n.clickCount=2):(n.clickCount=1,n.x=e.canvasX,n.y=e.canvasY,n.time=e.timeStamp)}document.addEventListener("mouseup",t,!1),_.registerWindowMouseMove()},this.mousemove=function(e){_.__clientToCanvasCoords(e)
var t=g-e.canvasX,i=E-e.canvasY;(Math.abs(t)>h||Math.abs(i)>h)&&(g=-1,E=-1),_.handleMouseMove(e)},this.mouseup=function(e){_.__clientToCanvasCoords(e)
var t=_.applyButtonMappings(e)
_.handleButtonUp(e,t)
var i=g-e.canvasX,n=E-e.canvasY
if(g=-1,E=-1,Math.abs(i)<=h&&Math.abs(n)<=h&&_.handleSingleClick(e),r(t,e)){var o=w
2===o.clickCount&&(_.handleDoubleClick(e),o.clickCount=0,o.x=void 0,o.y=void 0,o.time=void 0)}_.unregisterWindowMouseMove()},this.doubleclick=function(e){_.__clientToCanvasCoords(e),g=e.canvasX,E=e.canvasY,_.handleDoubleClick(e)},this.mousewheel=function(e){if(_.scrollInputEnabled){var t=0
e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail),_.handleWheelInput(t,e)}},this.blur=function(e){_.handleBlur(e)},this.mouseover=function(e){T=e.target},this.registerWindowMouseMove=function(){window.addEventListener("mousemove",_.mousemove),window.addEventListener("mouseover",_.mouseover),_.domElement.removeEventListener("mousemove",_.mousemove),_.domElement.removeEventListener("mouseover",_.mouseover)},this.unregisterWindowMouseMove=function(){window.removeEventListener("mousemove",_.mousemove),window.removeEventListener("mouseover",_.mouseover),_.domElement.addEventListener("mousemove",_.mousemove),_.domElement.addEventListener("mouseover",_.mouseover)},this.enableMouseButtons=function(e){e&&!b?(this.domElement.addEventListener("mousedown",this.mousedown),this.domElement.addEventListener("dblclick",this.doubleclick),this.domElement.addEventListener("mousemove",this.mousemove),this.domElement.addEventListener("mouseover",this.mouseover)):!e&&b&&(this.domElement.removeEventListener("mousedown",this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover))
var t=b
return b=e,t},this.enableMouseButtons(!0),this.domElement.addEventListener("mousewheel",this.mousewheel,!1),this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1),window.addEventListener("keydown",this.keydown,!1),window.addEventListener("keyup",this.keyup,!1),window.addEventListener("blur",this.blur,!1),this.uninitialize=function(){b&&(this.domElement.removeEventListener("mousemove",this.mousemove),this.domElement.removeEventListener("mouseover",this.mouseover),window.removeEventListener("mousemove",_.mousemove),window.removeEventListener("mouseover",_.mouseover)),window.removeEventListener("keydown",this.keydown),window.removeEventListener("keyup",this.keyup),window.removeEventListener("blur",this.blur),this.domElement=null,this.selector=null,this.autocam=null,f=null,m=null,_=null,n=null,t=null,e=null,T=null},this.set2DMode=function(e){},this.setAutocam=function(e){},this.syncCamera=function(){},this.recordHomeView=function(){var e=t.navigation.getCamera()
i.sync(e),i.setHomeViewFrom(e)},this.setMouseWheelInputEnabled=function(e){this.scrollInputEnabled=e}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.ViewingUtilities=function(e,t,i){function n(e){var t=500,i=32512,n=.6,o=0,r=new THREE.SphereGeometry(1),a=new THREE.MeshPhongMaterial({color:i,ambient:i,opacity:n,transparent:!0}),s=new THREE.Mesh(r,a),l=e
l.createOverlayScene("pivot"),s.visible=!1,this.shown=function(){return s.visible},this.show=function(e,i,r){s.scale.x=i,s.scale.y=i,s.scale.z=i,s.position.set(e.x,e.y,e.z),a.opacity=n,s.visible=!0,l.addOverlay("pivot",s),l.invalidate(!1,!1,!0),o=r?Date.now()+t:0},this.hide=function(){s.visible&&(s.visible=!1,l.removeOverlay("pivot",s),l.invalidate(!1,!1,!0),o=0)},this.fade=function(){if(o>0){var e=o-Date.now()
if(0>=e)return this.hide(),!0
var i=e/t*n
return a.opacity=i,!0}return!1},this.fading=function(){return o>0}}function o(e,t,i){var n=t.clone().sub(e)
if(0===n.lengthSq())return n.copy(i)
var o=n.clone().cross(i)
return 0===o.lengthSq()&&(i.z>i.y?n.y-=1e-4:n.z-=1e-4,o.crossVectors(n,i)),o.cross(n).normalize()}this.autocam=t,this.viewerImpl=e
var r=5,a=i.getCamera(),s={},l={},c=new n(this.viewerImpl)
this.transitionView=function(e,n,r,s,l,c){l=l||i.getWorldUpVector()
var u=c?o(e,n,l):s
u||(u=a.up)
var d={position:e,center:n,pivot:n,fov:r,up:u,worldUp:l,isOrtho:a.isPerspective===!1}
t.goToView(d)},this.goHome=function(){t.goHome()},this.getHitPoint=function(e,t){t=1-t,e=2*e-1,t=2*t-1
var i=new THREE.Vector3(e,t,1),n=this.viewerImpl.hitTestViewport(i,!1)
return n?n.intersectPoint:null},this.activatePivot=function(e){var t=a.isPerspective?i.getPivotPlaneDistance():i.getEyeVector().length(),n=i.getVerticalFov(),o=2*t*Math.tan(THREE.Math.degToRad(.5*n)),s=i.getScreenViewport(),l=window.devicePixelRatio||1,u=r*o/(s.height*l)
c.show(i.getPivotPoint(),u,e)},this.pivotActive=function(e,t){return e=e&&!i.getIs2D(),t=t||!1,!e&&c.shown()?void c.hide():void(e&&this.activatePivot(t))},this.pivotUpdate=function(){c.shown()&&c.fade()&&this.viewerImpl.invalidate(!1,!1,!0)},this.setPivotPoint=function(e,t,n){i.setPivotPoint(e),t||i.setTarget(e),n&&i.setPivotSetFlag(!0),this.setTemporaryPivot(null),i.getIs2D()||c.shown()&&this.activatePivot(c.fading())},this.savePivot=function(e){e||(e="default"),s[e]=i.getPivotPoint(),l[e]=i.getPivotSetFlag()},this.restorePivot=function(e){if(e||(e="default"),s[e]){var t=l[e]
this.setPivotPoint(s[e],!0,t),t||i.setPivotSetFlag(!1),delete s[e],delete l[e]}},this.setTemporaryPivot=function(e){if(e){var t=i.getPivotPoint(),n=i.getPivotSetFlag()
this.setPivotPoint(e,!0,n),s.TEMP=t,l.TEMP=n}else delete s.TEMP,delete l.TEMP},this.removeTemporaryPivot=function(){this.restorePivot("TEMP")},this.getBoundingBox=function(e){return this.viewerImpl.getFitBounds(e)},this.fitToView=function(e){var t=i.fitBounds(e,this.viewerImpl.getFitBounds(!1))
return this.activatePivot(!0),t},this.update=function(){i.getRequestFitToView()&&!i.getTransitionActive()&&(i.setRequestFitToView(!1),this.fitToView()),i.getRequestHomeView()&&!i.getTransitionActive()&&(i.setRequestHomeView(!1),this.goHome())
var e=i.getRequestTransition()
return e&&!i.getTransitionActive()&&(i.setRequestTransition(!1),this.transitionView(e.position,e.coi,e.fov,e.up,e.worldUp,e.reorient)),!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.DefaultHandler=function(e,t,i){this.clickConfig=null,this.getNames=function(){return["default"]},this.getName=function(){return this.getNames()[0]},this.setClickBehavior=function(e){this.clickConfig=e},this.getClickBehavior=function(){return this.clickConfig},this.activate=function(e){},this.deactivate=function(e){},this.handleAction=function(t,n){for(var o=0;o<t.length;++o)switch(t[o]){case"selectOnly":e.selector&&n&&e.selector.setSelection([n.dbId],n.model)
break
case"deselectAll":e.selector&&e.selector.setSelection([])
break
case"selectToggle":e.selector&&n&&e.selector.toggleSelection(n.dbId,n.model)
break
case"isolate":n&&e.isolate(n.dbId)
break
case"showAll":e.showAll()
break
case"setCOI":n&&n.intersectPoint&&(i.setPivotPoint(n.intersectPoint,!0,!0),i.pivotActive(!0,!0))
break
case"hide":n&&e.hide(n.dbId)
break
case"show":n&&e.show(n.dbId)
break
case"toggleVisibility":n&&e.toggleVisibility(n.dbId)
break
case"focus":e.selector&&(n?e.selector.setSelection([n.dbId],n.model):e.selector.setSelection([]),i.fitToView())}},this.handleSingleClick=function(t,n){var o=t.ctrlKey||t.metaKey,r=t.shiftKey,a=t.altKey
if(0===n){var s=new THREE.Vector3(t.normalizedX,t.normalizedY,1),l=e.hitTestViewport(s,!1),c="click"
o&&(c+="Ctrl"),r&&(c+="Shift"),a&&(c+="Alt")
var u=l?"onObject":"offObject"
if(this.clickConfig&&this.clickConfig[c]&&this.clickConfig[c][u])return this.handleAction(this.clickConfig[c][u],l),!0}else if(1===n&&r&&!a&&!o){var s=new THREE.Vector3(t.normalizedX,t.normalizedY,1),l=e.hitTestViewport(s,!1)
if(l&&l.intersectPoint)return i.setPivotPoint(l.intersectPoint,!0,!0),i.pivotActive(!0,!0),!0}return!1},this.handleDoubleClick=function(n,o){if(e.selector&&0===o){var r=new THREE.Vector3(n.normalizedX,n.normalizedY,1),a=e.hitTestViewport(r,!1)
return a?e.selector.setSelection([a.dbId],a.model):e.selector.clearSelection(),i.fitToView(),!0}return 1===o?(t.fitBounds(!1,i.getBoundingBox(!0)),t.setPivotSetFlag(!1),!0):!1},this.handleSingleTap=function(i){if(i.clientX=i.pointers[0].clientX,i.clientY=i.pointers[0].clientY,e.api.triggerSingleTapCallback(i),i.hasOwnProperty("pointers")&&2===i.pointers.length)return t.setRequestHomeView(!0),!0
if(e.selector){var n=new THREE.Vector3(i.normalizedX,i.normalizedY,1),o=e.hitTestViewport(n,!1)
return o?(e.selector.setSelection([o.dbId],o.model),e.api.triggerSelectionChanged([o.dbId])):(e.selector.clearSelection(),e.api.triggerSelectionChanged(null)),!0}return!1},this.handleDoubleTap=function(t){t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerDoubleTapCallback(t)
var n=this.handleSingleTap(t,0)
return i.fitToView(),n},this.handlePressHold=function(t){return"press"===t.type?(t.clientX=t.pointers[0].clientX,t.clientY=t.pointers[0].clientY,e.api.triggerContextMenu(t)):!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.GestureHandler=function(e){var t=e.navigation,i=["gestures"],n=this,o=!0,r=!0,a=null,s=isTouchDevice()
t.setIsTouchDevice(s),s&&(a=new Hammer.Manager(e.canvasWrap,{recognizers:[[Hammer.Pan,{event:"drag",pointers:1}],[Hammer.Tap,{event:"doubletap",taps:2,interval:300,threshold:6,posThreshold:30}],[Hammer.Tap,{event:"doubletap2",pointers:2,taps:2,interval:300,threshold:6,posThreshold:40}],[Hammer.Tap,{event:"singletap2",pointers:2,threshold:3}],[Hammer.Tap,{event:"singletap",threshold:2}],[Hammer.Press,{event:"press",time:500}],[Hammer.Pan,{event:"drag3",pointers:3,threshold:15}],[Hammer.Pan,{event:"pan",pointers:2,threshold:20}],[Hammer.Pinch,{enable:!0,threshold:.05}],[Hammer.Rotate,{enable:!0,threshold:7}]],inputClass:Hammer.TouchInput}),e.canvasWrap.addEventListener("touchstart",this.onTouchStart,!1)),this.onTouchStart=function(e){e.preventDefault()},this.getNames=function(){return i},this.getName=function(){return i[0]},this.__clientToCanvasCoords=function(e){var i,n,o=t.getScreenViewport(),r=o.width,a=o.height
e.hasOwnProperty("center")?(i=e.center.x-o.left,n=e.center.y-o.top):(i=e.pointers[0].clientX-o.left,n=e.pointers[0].clientY-o.top),e.canvasX=i,e.canvasY=n,e.normalizedX=i/r*2-1,e.normalizedY=(a-n)/a*2-1},this.distributeGesture=function(e){function t(e,t){return-1!==e.indexOf(t,e.length-t.length)}n.__clientToCanvasCoords(e),n.controller.distributeEvent("handleGesture",e)&&e.preventDefault(),t(e.type,"end")&&a.stop()},this.onSingleTap=function(e){n.__clientToCanvasCoords(e),n.controller.distributeEvent("handleSingleTap",e)&&e.preventDefault()},this.onDoubleTap=function(e){n.__clientToCanvasCoords(e),n.controller.distributeEvent("handleDoubleTap",e)&&e.preventDefault()},this.onPressHold=function(e){n.__clientToCanvasCoords(e),"press"===e.type?o=n.controller.enableMouseButtons(!1):n.controller.enableMouseButtons(o),n.controller.distributeEvent("handlePressHold",e)&&e.preventDefault()},this.activate=function(e){a&&(a.on("dragstart dragmove dragend",this.distributeGesture),a.on("singletap",this.onSingleTap),a.on("singletap2",this.onSingleTap),a.on("doubletap",this.onDoubleTap),a.on("doubletap2",this.onDoubleTap),a.on("press pressup",this.onPressHold),a.on("drag3start drag3move drag3end",this.distributeGesture),r&&(a.on("panstart panmove panend",this.distributeGesture),a.on("pinchstart pinchmove pinchend",this.distributeGesture),a.on("rotatestart rotatemove rotateend",this.distributeGesture)),a.get("doubletap2").recognizeWith("doubletap"),a.get("singletap2").recognizeWith("singletap"),a.get("singletap").requireFailure("doubletap"))},this.deactivate=function(e){a&&(a.off("dragstart dragmove dragend",this.distributeGesture),a.off("singletap",this.onSingleTap),a.off("singletap2",this.onSingleTap),a.off("doubletap",this.onDoubleTap),a.off("doubletap2",this.onDoubleTap),a.off("press pressup",this.onPressHold),a.off("drag3start drag3move drag3end",this.distributeGesture),r&&(a.off("panstart panmove panend",this.distributeGesture),a.off("pinchstart pinchmove pinchend",this.distributeGesture),a.off("rotatestart rotatemove rotateend",this.distributeGesture)))},this.update=function(){return!1},this.handleBlur=function(e){return!1},this.disableTwoFingerSwipe=function(){r=!1,a&&(a.remove(Hammer.Pan),a.remove(Hammer.Pinch),a.remove(Hammer.Rotate),a.off("panstart panmove panend",this.distributeGesture),a.off("pinchstart pinchmove pinchend",this.distributeGesture),a.off("rotatestart rotatemove rotateend",this.distributeGesture))}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.OrbitDollyPanTool=function(e,t){function i(){var e=fe
return Y===j&&!e.SHIFT&&!(e.ALT^e.CONTROL)||Y===j&&e.SHIFT&&e.CONTROL||Y===W&&!e.SHIFT&&!e.CONTROL||Y===W&&e.ALT||Y===W&&e.CONTROL&&!e.ALT||Y===G&&e.SHIFT&&!e.CONTROL&&!e.ALT||"pan"===S&&Y!==W&&!e.ALT&&!("pinch"===R)||e.SPACE}function n(){var e=fe
return Y===j&&e.SHIFT&&!e.ALT&&!e.CONTROL||Y===j&&e.ALT&&!e.SHIFT&&!e.CONTROL||"dolly"===S&&!e.ALT&&!("pinch"===R)}function o(){var e=fe
return!(e.CONTROL||e.ALT||e.SHIFT||Y!==j&&Y!==W)}function r(){return Y===W&&fe.SHIFT?C[1]:n()||0!==ee.z?o()?"pan":"dolly":i()?"pan":"pan"===R||"pinch"===R?"dollypan":S}function a(){var e=b.getPivotPoint().sub(b.getPosition())
return e.dot(b.getEyeVector())<=0}function s(e,t){var i={left:0,top:0,width:window.innerWidth,height:window.innerHeight}
se.set((e-.5*i.width-i.left)/(.5*i.width),(.5*i.height+i.top-t)/(.5*i.height),0)
var n=se.length()
return ue?n<Math.SQRT1_2?se.z=Math.sqrt(1-n*n):se.z=.5/n:n>1?se.normalize():se.z=Math.sqrt(1-n*n),ne.copy(w.position).sub(w.pivot),re.copy(w.up).setLength(se.y),re.add(ae.copy(w.up).cross(ne).setLength(se.x)),re.add(ne.setLength(se.z)),re}function l(){ne.subVectors(w.position,w.pivot),oe.subVectors(w.position,w.target)
var e=oe.length()
oe.normalize()
var t=Math.acos(te.dot(ie)/te.length()/ie.length())
t&&(t*=A,le.crossVectors(te,ie).normalize(),ce.setFromAxisAngle(le,-t),ne.applyQuaternion(ce),w.up.applyQuaternion(ce),ie.applyQuaternion(ce),oe.applyQuaternion(ce),de?te.copy(ie):(ce.setFromAxisAngle(le,t*(he-1)),te.applyQuaternion(ce))),w.position.addVectors(w.pivot,ne),w.target.subVectors(w.position,oe.multiplyScalar(e)),w.dirty=!0}function c(e,t){return-1!==e.indexOf(t,e.length-t.length)}function u(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,i=e.pointers[1].clientY-e.pointers[0].clientY
return Math.sqrt(t*t+i*i)}var d,h,p=this,f=.001,m=1e-5,v=1.5,g=.01,E=20,y=100,A=2,T=-1!=navigator.userAgent.search("Mac OS"),b=t.navigation,w=b.getCamera(),_=["orbit","freeorbit","dolly","pan"],x=_[0],C=[x],S=x,R=null,M=1,P=1,L=0,I=0,k=!1,V=null,N=!1,D=0,H=null,O=null,B={SHIFT:16,CONTROL:17,ALT:18,SPACE:32,PAGEUP:33,PAGEDOWN:34,LEFT:37,UP:38,RIGHT:39,DOWN:40,ZERO:48,EQUALS:187,DASH:189},F=-5,U=-4,z=-1,G=0,W=1,j=2,X=3,Y=F,q=new THREE.Vector3,K=new THREE.Vector3,Z=new THREE.Vector2,Q=new THREE.Vector2,J=new THREE.Vector2,$=new THREE.Vector2,ee=new THREE.Vector3,te=new THREE.Vector3,ie=new THREE.Vector3,ne=new THREE.Vector3,oe=new THREE.Vector3,re=new THREE.Vector3,ae=new THREE.Vector3,se=new THREE.Vector3,le=new THREE.Vector3,ce=new THREE.Quaternion,ue=!1,de=!0,he=.2,pe=[!1,!1,!1,!1,!1,!1],fe={SHIFT:0,ALT:0,CONTROL:0,SPACE:0},me=.6,ve=5,ge=.025,Ee=.01,ye=.6,Ae=1,Te=ve,be=ge
this.getNames=function(){return _},this.getName=function(){return _[0]},this.activate=function(e){C.push(e),S=e},this.deactivate=function(e){var t=C.length-1
t>0&&C[t]===e&&(C.pop(),S=C[t-1])},this.adjustDollyLookSpeed=function(e){0===e?(be=ge,Te=ve):(be*=e>0?1.1:.9,Te*=e>0?1.1:.9,1e-6>be&&(be=1e-6),1e-6>Te&&(Te=1e-6))},this.getDollySpeed=function(e){var t=b.getEyeVector(),i=b.getPosition(),n=e.clone().sub(i).dot(t.normalize()),o=n*be
return Math.abs(o)<Ee?0>o?-Ee:Ee:o},this.getLookSpeed=function(){return Te},this.coiIsActive=function(){return b.getPivotSetFlag()&&b.isPointVisible(b.getPivotPoint())},this.adjustSpeed=function(e){this.adjustDollyLookSpeed(e),this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())},this.initTracking=function(e,t){var i
if(w.isPerspective){i=.5*(w.near+w.far)
var n=this.utilities.getHitPoint(e,t),o=b.getPosition()
if(n&&n.sub){var r=n.sub(o),a=b.getEyeVector().normalize()
i=Math.abs(a.dot(r))}else{var s=b.getPivotSetFlag()&&b.isPointVisible(b.getPivotPoint())
if(s){var l=b.getPivotPlaneDistance()
l>m&&(i=l)}}}else i=b.getEyeVector().length()
Ae=i},this.initOrbit=function(){this.utilities.setTemporaryPivot(a()?b.getTarget():null)},this.getCursor=function(){switch(x){case"freeorbit":case"orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto"
case"dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto"
case"pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null},this.getMotionDelta=function(e,t){var i=b&&b.getReverseZoomDirection()?-v:v
T&&(i*=-1),pe[0]&&(K.x+=g,J.x+=E),pe[1]&&(K.x-=g,J.x-=E),pe[2]&&(K.y+=g,J.y+=E),pe[3]&&(K.y-=g,J.y-=E),pe[4]&&(K.z+=i),pe[5]&&(K.z-=i)
var n=K.x-q.x,o=K.y-q.y,r=K.z-q.z
Math.abs(n)<f&&(n=0),Math.abs(o)<f&&(o=0),Math.abs(r)<f&&(r=0),e.set(n,o,r),t&&t.set(J.x-Q.x,J.y-Q.y)},this.stepMotionDelta=function(e,t){t?(q.x+=e.x*me,q.y+=e.y*me,q.z+=e.z*me):q.copy(K),Q.copy(J)},this.update=function(){var e,i=!1,n=!1
this.getMotionDelta(ee,$)
var o=ee.x,r=ee.y,a=ee.z
if(k||this.checkInteractionMode(),k=Y>z,k&&this.controller.setIsLocked(!0),0!==o||0!==r||0!==a){switch(x){case"orbit":this.utilities.autocam&&this.utilities.autocam.startState&&($.x=-$.x,V&&this.utilities.autocam.orbit(J,V,$.multiplyScalar(A),this.utilities.autocam.startState))
break
case"freeorbit":l()
break
case"dolly":var s,c,u
a*=ye,Y>=G?(r=-r,a=Math.abs(o)>Math.abs(r)?o:r,a*=y,o=0,r=0,c=u=.5):(e=b.getScreenViewport(),c=d/e.width,u=h/e.height),s=!b.getIs2D()&&b.getZoomTowardsPivot()?this.coiIsActive()?b.getPivotPoint():b.getWorldPoint(.5,.5):b.getWorldPoint(c,u),b.dollyFromPoint(a*this.getDollySpeed(s),s)
break
case"pan":b.panRelative(-o,r,Ae)
break
case"dollypan":(0!==o||0!==r)&&b.panRelative(-o,r,Ae),e=b.getScreenViewport(),c=d/e.width,u=h/e.height,s=b.getWorldPoint(c,u)
var p=b.getPosition(),f=b.getIs2D()?p.sub(s).length():Ae,v=L/I-1,g=v*f
b.dollyFromPoint(g,s),L=I,P=M,Ae=f+g}n=!0}return this.stepMotionDelta(ee,"pan"!==x&&"dollypan"!==x),Y===z&&Math.abs(a)<m&&(this.interactionEnd(z),i=!0,n=!0),(fe.SHIFT||fe.ALT)&&-1!==_.indexOf(t.getActiveNavigationTool())&&(n=!0),!N&&(i||Y>F)&&(Y>z&&(q.copy(K),this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),Y=F,k&&this.controller.setIsLocked(!1),k=!1,V=null,R=null),n?this.utilities.pivotActive(b.getPivotSetFlag(),z>=Y):this.utilities.pivotUpdate(),w.dirty},this.checkInteractionMode=function(){var e=r()
e!==x&&(x=e,("pan"===x&&Y>z||"dollypan"===x)&&this.initTracking(q.x,q.y))},this.interactionStart=function(e,t){(t||e>Y)&&(Y=e,N=!0,e>z&&("pan"===x&&this.initTracking(q.x,q.y),"orbit"===x&&this.initOrbit()),this.utilities.pivotActive(b.getPivotSetFlag(),e===z),this.utilities.autocam&&(this.utilities.autocam.sync(w),this.utilities.autocam.startInteraction(Q.x,Q.y),V=Q.clone()))},this.interactionCheck=function(){(pe[0]||pe[1]||pe[2]||pe[3]||pe[4]||pe[5]||fe.SHIFT||fe.CONTROL||fe.ALT||fe.SPACE)&&this.interactionStart(U,!0)},this.interactionEnd=function(e){e===Y&&(e!==z&&this.utilities.pivotActive(!1),N=!1)},this.handleWheelInput=function(t){if(this.isDragging)return!1
if(b.getIs2D()){var i=b.getScreenViewport(),n=e.intersectGround(d+i.width,h+i.height)
this.utilities.setPivotPoint(n,!0,!0)}b.getReverseZoomDirection()&&(t*=-1),K.z+=t,D+=t
var o=Date.now()
return H||(H=o),O=o,0!=t&&this.interactionStart(z),!0},this.resetKeys=function(){this.autoMove(-1,!1),fe.SHIFT=0,fe.CONTROL=0,fe.ALT=0,fe.SPACE=0},this.autoMove=function(e,t){t&&this.isDragging||(0>e?pe[0]=pe[1]=pe[2]=pe[3]=pe[4]=pe[5]=t:pe[e]=t,t||this.interactionEnd(U),this.interactionCheck())},this.updateModifierState=function(e){fe.CONTROL=T&&e.metaKey||e.ctrlKey?1:0,fe.SHIFT=e.shiftKey?1:0,fe.ALT=e.altKey?1:0},this.handleKeyDown=function(e,t){this.updateModifierState(e)
var i=!1
switch(t){case B.EQUALS:this.adjustSpeed(1),i=!0
break
case B.DASH:this.adjustSpeed(-1),i=!0
break
case B.ZERO:this.adjustSpeed(0),i=!0
break
case B.LEFT:this.autoMove(0,!0),i=!0
break
case B.RIGHT:this.autoMove(1,!0),i=!0
break
case B.PAGEUP:this.autoMove(2,!0),i=!0
break
case B.PAGEDOWN:this.autoMove(3,!0),i=!0
break
case B.UP:this.autoMove(4,!0),i=!0
break
case B.DOWN:this.autoMove(5,!0),i=!0
break
default:return!1}return this.isDragging||this.interactionStart(U),i},this.handleKeyUp=function(e,t){this.updateModifierState(e)
var i=!1
switch(t){case B.LEFT:this.autoMove(0,!1),i=!0
break
case B.RIGHT:this.autoMove(1,!1),i=!0
break
case B.PAGEUP:this.autoMove(2,!1),i=!0
break
case B.PAGEDOWN:this.autoMove(3,!1),i=!0
break
case B.UP:this.autoMove(4,!1),i=!0
break
case B.DOWN:this.autoMove(5,!1),i=!0
break
default:return!1}return i&&(this.interactionEnd(U),N||this.interactionCheck()),i},this.handleDollyPan=function(e){d=e.canvasX,h=e.canvasY
var t=b.getScreenViewport()
J.x=Z.x+e.deltaX,J.y=Z.y+e.deltaY,K.x=J.x/t.width,K.y=J.y/t.height,I=u(e),c(e.type,"start")&&(L=I,P=1),M=e.scale},this.handleGesture=function(e){switch(e.type){case"dragstart":return R="drag",this.handleButtonDown(e,0)
case"dragmove":return"drag"===R?this.handleMouseMove(e):!1
case"dragend":return"drag"===R?(this.handleButtonUp(e,0),R=null,!0):!1
case"panstart":return R="pan",this.isDragging=!0,q.x=.5*(e.normalizedX+1),q.y=1-.5*(e.normalizedY+1),Z.set(e.canvasX,e.canvasY),Q.set(e.canvasX,e.canvasY),this.interactionStart(X),this.handleDollyPan(e),!0
case"panmove":return"pan"===R?this.handleDollyPan(e):!1
case"panend":return"pan"===R?(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(X),!0):!1
case"pinchstart":return this.isDragging=!0,R="pinch",q.x=.5*(e.normalizedX+1),q.y=1-.5*(e.normalizedY+1),Z.set(e.canvasX,e.canvasY),Q.set(e.canvasX,e.canvasY),this.interactionStart(X),this.handleDollyPan(e),!0
case"pinchmove":return"pinch"===R?this.handleDollyPan(e):!1
case"pinchend":return"pinch"===R?(this.isDragging=!1,this.handleDollyPan(e),this.interactionEnd(X),!0):!1}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),q.x=.5*(e.normalizedX+1),q.y=1-.5*(e.normalizedY+1),Q.set(e.canvasX,e.canvasY),K.copy(q),J.copy(Q),te.copy(s(e.canvasX,e.canvasY)),ie.copy(te),d=e.canvasX,h=e.canvasY,this.isDragging=!0,this.interactionStart(t),!0},this.handleButtonUp=function(e,t){return this.updateModifierState(e),K.x=.5*(e.normalizedX+1),K.y=1-.5*(e.normalizedY+1),J.set(e.canvasX,e.canvasY),ie.copy(s(e.canvasX,e.canvasY)),te.copy(ie),d=e.canvasX,h=e.canvasY,this.interactionEnd(t),this.isDragging=!1,!0},this.handleMouseMove=function(t){return this.updateModifierState(t),this.isDragging?(K.x=.5*(t.normalizedX+1),K.y=1-.5*(t.normalizedY+1),J.set(t.canvasX,t.canvasY),ie.copy(s(t.canvasX,t.canvasY)),d=t.canvasX,h=t.canvasY,!0):(q.x=.5*(t.normalizedX+1),q.y=1-.5*(t.normalizedY+1),Q.set(t.canvasX,t.canvasY),K.x=q.x,K.y=q.y,J.copy(Q),d=t.canvasX,h=t.canvasY,e.rolloverObject(d,h),!1)},this.handleBlur=function(e){this.resetKeys(),this.interactionEnd(Y)},t.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(e){p.handleBlur(e)})},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.HotGestureTool=function(e){var t=(-1!=navigator.userAgent.search("Mac OS"),e.navigation),i=(t.getCamera(),["hottouch"]),n={SHIFT:0,ALT:0,CONTROL:0},o=null,r=null,a=!1,s=!1,l=null,c={SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,LCOMMAND:91,RCOMMAND:93,COMMANDMOZ:224},u="worldup",d="fov"
this.getNames=function(){return i},this.getName=function(){return i[0]},this.activate=function(e){},this.deactivate=function(e){},this.__checkStart=function(){l&&(this.controller.distributeEvent("handleGesture",l),l=null)},this.update=function(){if(this.controller.getIsLocked())return!1
var t=e.getActiveNavigationTool(),i=a===!1&&s===!0,n=a===!0&&s===!1
if(i||n){var l=i?u:d
if(t===l)return!1
if(t===o)return e.setActiveNavigationTool(l),o=l,this.__checkStart(),!1
r=t,e.setActiveNavigationTool(l),o=l,this.__checkStart()}else o&&(e.setActiveNavigationTool(r),o=null,r=null)
return!1},this.resetKeys=function(){n.SHIFT=0,n.CONTROL=0,n.ALT=0},this.updateModifierState=function(e){n.CONTROL=e.ctrlKey?1:0,n.SHIFT=e.shiftKey?1:0,n.ALT=e.altKey?1:0},this.handleGesture=function(e){if(e===l)return!1
switch(e.type){case"drag3start":l=e,a=!0
break
case"drag3move":break
case"drag3end":a=!1
break
case"rotatestart":l=e,s=!0
break
case"rotatemove":break
case"rotateend":s=!1}return!1},this.handleKeyDown=function(e,t){switch(this.updateModifierState(e),t){case c.SHIFT:n.SHIFT=1
break
case c.CONTROL:n.CONTROL=1
break
case c.ALT:n.ALT=1}return!1},this.handleKeyUp=function(e,t){switch(this.updateModifierState(e),t){case c.SHIFT:n.SHIFT=0
break
case c.CONTROL:n.CONTROL=0
break
case c.ALT:n.ALT=0}return!1},this.handleButtonDown=function(e,t){return this.updateModifierState(e),!1},this.handleButtonUp=function(e,t){return this.updateModifierState(e),!1},this.handleMouseMove=function(e){return this.updateModifierState(e),!1},this.handleBlur=function(e){return this.resetKeys(),!1}},AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.HotkeyManager=function(){function e(){return m}function t(){return m[0]}function i(e,t){return e-t}function n(e,t,n){var o=u.some(function(t){return t.id===e})
if(o)return!1
for(var r=0;r<t.length;r++)u.push({id:e,keys:t[r].keycodes.sort(i).join(),onPress:t[r].onPress,onRelease:t[r].onRelease,options:n||{}})
return!0}function o(e){for(var t=!1,i=u.length-1;i>=0;i--)u[i].id===e&&(u.splice(i,1),t=!0)
return t}function r(){var e,t,i=d.join()
for(t=0;t<p.length;)e=p[t],e.keys===i?p.splice(t,1):t++
for(t=0;t<h.length;)e=h[t],e.keys!==i?h.splice(t,1):t++}function a(e,t){if(-1===d.indexOf(t)){for(var i=d.join(),n=d.slice(0),o=0;o<d.length&&d[o]<t;)o++
d.splice(o,0,t)
var a=d.join(),s=d.slice(0)
r()
var l,c=[],f=[]
for(o=u.length-1;o>=0;o--)l=u[o],l.keys===i&&l.onRelease?c.unshift(l):l.keys===a&&l.onPress&&f.unshift(l)
for(o=c.length-1;o>=0&&(l=c[o],!l.onRelease(n));o--)l.options.tryUntilSuccess&&p.unshift(l)
for(o=f.length-1;o>=0&&(l=f[o],!l.onPress(s));o--)l.options.tryUntilSuccess&&h.unshift(l)}}function s(e,t){var i=d.join(),n=d.slice(0),o=d.indexOf(t)
o>-1&&d.splice(o,1)
var a=d.join(),s=d.slice(0)
r()
var l,c=[],f=[]
for(o=u.length-1;o>=0;o--)l=u[o],l.keys===i&&l.onRelease?c.unshift(l):l.keys===a&&l.onPress&&f.unshift(l)
for(o=c.length-1;o>=0&&(l=c[o],!l.onRelease(n));o--)l.options.tryUntilSuccess&&p.unshift(l)
for(o=f.length-1;o>=0&&(l=f[o],!l.onPress(s));o--)l.options.tryUntilSuccess&&h.unshift(l)}function l(){var e,t
for(t=0;t<p.length;)e=p[t],e.onRelease(e.keys.split())===!0?p.splice(t,1):t++
for(t=0;t<h.length;)e=h[t],e.onPress(e.keys.split())===!0?h.splice(t,1):t++
return!1}function c(){for(var e=d.length-1;e>=0;e--)s(null,d[e])}var u=[],d=[],h=[],p=[],f={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222},m=["hotkeys"]
return{pushHotkeys:n,popHotkeys:o,handleKeyDown:a,handleKeyUp:s,handleBlur:c,getName:t,getNames:e,activate:function(){},deactivate:function(){},update:l,KEYCODES:f}},Autodesk.Viewing.theHotkeyManager=new Autodesk.Viewing.HotkeyManager,AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.FovTool=function(e){function t(e){return 0>e&&e>-3?-3:e>0&&3>e?3:e}var i=.001,n=1e-5,o=-1,r=.6,a=100,s=e.navigation,l=s.getCamera(),c=["fov"],u=!1,d=0,h=null,p=null,f=!1,m=0,v=-5,g=-1,E=0,y=2,A=v,T=new THREE.Vector3,b=new THREE.Vector3,w=new THREE.Vector3,_=null
this.getNames=function(){return c},this.getName=function(){return c[0]},this.activate=function(e){m=0},this.deactivate=function(e){A=v},this.getCursor=function(){return 0!==m&&A===v?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"},this.getMotionDelta=function(e){var t=b.x-T.x,n=b.y-T.y,o=b.z-T.z
Math.abs(t)<i&&(t=0),Math.abs(n)<i&&(n=0),Math.abs(o)<i&&(o=0),e.set(t,n,o)},this.stepMotionDelta=function(e,t){t?(T.x+=e.x*r,T.y+=e.y*r,T.z+=e.z*r):T.copy(b)},this.getAccumulatedWheelDelta=function(){var e=Date.now(),i=0
return p&&e-p>a?(i=t(d),d=0,h=null,p=null,f=!1):h&&e-h>a&&(f?Math.abs(d)>=3&&(i=d,d=0):(i=t(d),f=!0,d=0)),i},this.update=function(){var e=!1,t=A>v
if(A>v){this.controller.setIsLocked(!0),this.getMotionDelta(w)
var i=w.x,r=w.y,a=w.z
if(0!==i||0!==r||0!==a)if(t=!0,A>=E)r=-r,a=Math.abs(i)>Math.abs(r)?i:r,0!==a&&(a*=o,s.setVerticalFov(s.getVerticalFov()*(1+a),!0))
else{var c=this.getAccumulatedWheelDelta()/3
0!==c&&s.setFocalLength(s.getFocalLength()+c,!0)}this.stepMotionDelta(w,!0),A===g&&Math.abs(a)<n&&(this.interactionEnd(g),e=!0)}return t?this.utilities.pivotActive(s.getPivotSetFlag(),!0):this.utilities.pivotUpdate(),!u&&(e||A>v)&&(A>g&&T.copy(b),A=v,this.controller.setIsLocked(!1)),l.dirty},this.interactionStart=function(e,t){(t||e>A)&&(A=e,u=!0),s.toPerspective()},this.interactionEnd=function(e){e===A&&(e!==g&&this.utilities.pivotActive(!1),u=!1)},this.handleWheelInput=function(e){if(A>g)return!1
s.getReverseZoomDirection()&&(e*=-1),b.z+=e,d+=e
var t=Date.now()
return h||(h=t),p=t,0!=e&&this.interactionStart(g),!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return this.handleButtonDown(e,0)
case"dragmove":return this.handleMouseMove(e)
case"dragend":return this.handleButtonUp(e,0)
case"drag3start":return _="drag",this.handleButtonDown(e,0)
case"drag3move":return"drag"===_?this.handleMouseMove(e):!1
case"drag3end":return"drag"===_&&this.handleButtonUp(e,0),_=null,!1}return!1},this.handleButtonDown=function(e,t){return m+=1<<t,t!==y?(T.x=.5*(e.normalizedX+1),T.y=1-.5*(e.normalizedY+1),b.copy(T),this.interactionStart(t),!0):!1},this.handleButtonUp=function(e,t){return m-=1<<t,t!==y?(b.x=.5*(e.normalizedX+1),b.y=1-.5*(e.normalizedY+1),this.interactionEnd(t),!0):!1},this.handleMouseMove=function(e){return b.x=.5*(e.normalizedX+1),b.y=1-.5*(e.normalizedY+1),A>g},this.handleBlur=function(e){return this.interactionEnd(A),!1}},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.WorldUpTool=function(e,t){function i(e,t){function i(e,t){var i=Math.abs(e-t)
return i>h?i:Math.min(h-i,i)}function n(e,t){var i=m(e)
return i.distanceToSquared(t)<f?!0:(M.set(-t.x,-t.y,-t.z),i.distanceToSquared(M)<f)}function a(e,t){for(var o=Z+Q+2*Math.PI/180,r=0;6>r;++r)if(W[r]!==$)for(var a=r+1;6>a;++a)if(W[a]!==$){var s=i(W[r],W[a])
if(o>s){if(e[r]<e[a]&&!n(r,t)||n(a,t)){W[r]=$
break}W[a]=$}}}function l(e){return e>h?e:0>=e?e+Math.PI:e-Math.PI}function c(e,t,i){var n=e.clone().normalize(),o=new Array(3),r=new Array(6)
o[0]=d(1,0,0,n),o[1]=d(0,1,0,n),o[2]=d(0,0,1,n)
var s,c=t.clone().cross(n).normalize()
for(s=0;3>s;++s){var u=o[s]
r[s]=u.length(),r[s]<ee?W[s]=$:(u.multiplyScalar(1/r[s]),W[s]=Math.atan2(c.dot(u),t.dot(u)))}for(W[3]=l(W[0]),W[4]=l(W[1]),W[5]=l(W[2]),r[3]=r[0],r[4]=r[1],r[5]=r[2],a(r,i),s=0;6>s;++s)if(W[s]!==$){var h=M.set(0,0,1)
P.setFromAxisAngle(h,W[s])
var p=M.set(0,.54,0)
p.applyQuaternion(P),z[s].position.copy(p),z[s].visible=!0}else z[s].visible=!1}function u(){F=new THREE.Object3D
var e=new THREE.RingGeometry(.5-.01*k,.5,60),t=new THREE.Mesh(e,S)
D=t
var i=.007*k,n=new THREE.BoxGeometry(.93,i,i),o=new THREE.BoxGeometry(i,.93,i),r=new THREE.BoxGeometry(i,i,.93)
H=new THREE.Mesh(n,S),O=new THREE.Mesh(o,S),B=new THREE.Mesh(r,S),F.add(H),F.add(O),F.add(B),U=new THREE.Mesh(new THREE.CircleGeometry(.005),S),F.add(U),z=new Array(6),G=new Array(6)
for(var a=0;6>a;++a){var s=.005*k,l=.0025*k
z[a]=new THREE.Mesh(new THREE.CircleGeometry(s,16),S),G[a]=new THREE.Mesh(new THREE.CircleGeometry(l,16),S),G[a].visible=!1,z[a].add(G[a]),t.add(z[a])}return F.add(t),F}function p(e,t,i,n,o){return F||(F=u()),s.orient(D,t,L.position,n),c(i,o,n),F.scale.x=e,F.scale.y=e,F.scale.z=e,F.position.copy(t),F}function m(e){if(R.set(0,0,0),e>=0){var t=e>=3?-1:1
e%=3,0===e&&(R.x=t),1===e&&(R.y=t),2===e&&(R.z=t)}return Y&&R.multiplyScalar(-1),R}function v(e,t){for(var n=i(W[0],e),o=0,r=1;6>r;++r){var a=i(W[r],e)
n>a&&(n=a,o=r)}return j=n,t>n?o:-1}function g(e){s.setIsLocked(!1),s.setWorldUpVector(e,!0),s.setIsLocked(!0)}function E(e){if(0!==e){var t=30*Math.PI/180,i=M.copy(L.position).sub(N).normalize()
P.setFromAxisAngle(i,e)
var n=s.getWorldUpVector(),o=Math.abs(i.angleTo(n));(t>o||Math.PI-o<t)&&n.copy(s.getCameraUpVector()),n.applyQuaternion(P),g(n)}}function y(){if(!q){var e=v(X,Z)
if(e>=0)return j=0,q=!0,X=W[e],m(e)}return!1}function A(){if(q){var e=v(X,Q)
if(0>e)return q=!1,!0
j=0}return!1}function T(e,t,i,n){var o=t>e
if(o){var r=m(i)
return r.distanceToSquared(n)<f}return!1}function b(e,t){var n=e.dot(t),o=0>n
o&&(t=t.clone().multiplyScalar(-1)),s.orient(U,N,L.position,t),U.position.copy(t.multiplyScalar(.495))
for(var r=!1,a=q?Q:Z,l=0;6>l;++l){var c=i(W[l],X),u=T(c,a,l,e)
u&&(r=!0)
var d=u?4:3*(1-3*c/Math.PI)
1>d&&(d=1),d*=k,G[l].visible=u
var h=z[l]
h.scale.x=d,h.scale.y=d,h.scale.z=d}return H.visible=r,O.visible=r,B.visible=r,r}function w(e){X+=e,X>Math.PI?X-=h:X<=-Math.PI&&(X=h+X)
var t=y()
if(t)K=X,g(t)
else if(A()){var i=X-K
E(i),K=0}else{if(q)return!1
E(e)}return!0}var _=12303291,x=30,C=2*Math.tan(THREE.Math.degToRad(.5*x)),S=new THREE.MeshPhongMaterial({color:_,ambient:_,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),R=new THREE.Vector3,M=new THREE.Vector3,P=new THREE.Quaternion,L=new THREE.PerspectiveCamera(x,t.aspect,t.near,t.far),I=t,k=1,V=1,N=null,D=null,H=null,O=null,B=null,F=null,U=null,z=null,G=null,W=new Array(6),j=0,X=0,Y=!1,q=!0,K=0,Z=5*Math.PI/180,Q=7*Math.PI/180,J=1,$=1e3,ee=.1
e.createOverlayScene("roll",null,null,L),this.updateRollCamera=function(e,t){L.position.copy(I.position),L.quaternion.copy(I.quaternion),L.up.copy(I.up),L.aspect=I.aspect,e&&t&&(L.near=t-e,L.far=t+e),L.updateProjectionMatrix()},this.isSnapped=function(){return q},this.resize=function(){var e=J*C,t=e*I.aspect,i=(I.aspect<1?t:e)*V
F.scale.x=i,F.scale.y=i,F.scale.z=i},this.start=function(t,i){this.updateHUD(t,i),e.addOverlay("roll",F)},this.updateHUD=function(e,t){N=e,o>t?t=o:t>r&&(t=r),V=t,k=r/t
var i=R.copy(e).sub(I.position)
J=i.length()
var n=J*C,a=n*I.aspect,l=(I.aspect<1?a:n)*t
this.updateRollCamera(l,J)
var c=s.getWorldUpVector(),u=s.getCameraUpVector()
p(l,e,i,c,u),X=0,K=0
var d=c.dot(u)
Y=0>d,q=b(c,u)},this.handleRoll=function(e,t,i){if(this.updateRollCamera(),b(s.getWorldUpVector(),s.getCameraUpVector()),0!==e||0!==t){var n=i.x-e-.5,o=i.y-t-.5,r=i.x-.5,a=i.y-.5
return w(Math.atan2(a,r)-Math.atan2(o,n))}return!1},this.handleRollTouch=function(e){this.updateRollCamera(),b(s.getWorldUpVector(),s.getCameraUpVector())
var t=e-X
return Math.abs(t)>.001?w(t):!1},this.end=function(){e.removeOverlay("roll",F)}}function n(e){var t=e.pointers[1].clientX-e.pointers[0].clientX,i=e.pointers[1].clientY-e.pointers[0].clientY,n=Math.sqrt(t*t+i*i),o=s.getScreenViewport()
return n/Math.min(o.width,o.height)}var o=.35,r=.8,a=.65,s=t.navigation,l=s.getCamera(),c=["worldup"],u=this,d=function(){var e=new THREE.Vector3
return function(t,i,n,o){var r=new THREE.Vector3(t,i,n),a=o.dot(r)
return e.copy(o),e.multiplyScalar(a),r.sub(e)}}(),h=2*Math.PI,p=.001,f=1e-5,m=!1,v=!1,g=!1,E=new i(e,l),y=new THREE.Vector3,A=new THREE.Vector3,T=new THREE.Vector3,b=null,w=0,_={x:.5,y:.5},x=1
this.getNames=function(){return c},this.getName=function(){return c[0]},this.activate=function(e){t.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),g=!1},this.deactivate=function(e){E.end(),s.setIsLocked(!1),t.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),this.utilities.restorePivot(),b=null,m=!1,g=!1},this.getCursor=function(){return"auto"},this.getMotionDelta=function(e){var t=A.x-y.x,i=A.y-y.y,n=A.z-y.z
Math.abs(t)<p&&(t=0),Math.abs(i)<p&&(i=0),Math.abs(n)<p&&(n=0),e.set(t,i,n)},this.stepMotionDelta=function(){y.copy(A)},this.update=function(){if(!g){var e=s.getEyeVector(),t=.5*(l.near+l.far)
e.normalize().multiplyScalar(t)
var i=e.add(l.position)
this.utilities.savePivot(),this.utilities.setPivotPoint(i,!0,!0),this.utilities.pivotActive(!0)
var n=a
E.start(i,n),g=!0}var o=v
this.getMotionDelta(T)
var r=T.x,c=T.y,u=T.z
return(v||"roll"===b||m&&(0!==r||0!==c||0!==u))&&(v="roll"===b?E.handleRollTouch(w):E.handleRoll(r,c,A)),this.stepMotionDelta(),l.dirty&&(o=!0),o},this.handleResize=function(){E.resize(),v=!0},this.handleGesture=function(e){switch(e.type){case"dragstart":return b="drag",this.handleButtonDown(e,0)
case"dragmove":return this.handleMouseMove(e)
case"dragend":return b=null,this.handleButtonUp(e,0)
case"rotatestart":return s.setIsLocked(!0),t.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),b="roll",w=THREE.Math.degToRad(e.rotation),_={x:.5*(e.normalizedX+1),y:1-.5*(e.normalizedY+1)},x=n(e),!0
case"rotatemove":return w=THREE.Math.degToRad(e.rotation),"roll"===b
case"rotateend":return s.setIsLocked(!1),t.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),w=THREE.Math.degToRad(e.rotation),b=null,!1}return!1},this.handleWheelInput=function(e){return!0},this.handleCameraChange=function(){var e=s.getEyeVector(),t=.5*(l.near+l.far)
e.normalize().multiplyScalar(t)
var i=e.add(l.position)
E.updateHUD(i,a)},this.handleButtonDown=function(e,i){return y.x=.5*(e.normalizedX+1),y.y=1-.5*(e.normalizedY+1),A.copy(y),m=!0,b=null,s.setIsLocked(!0),this.controller.setIsLocked(!0),t.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,u.handleCameraChange),!0},this.handleButtonUp=function(e,i){return A.x=.5*(e.normalizedX+1),A.y=1-.5*(e.normalizedY+1),m=!1,v=!0,s.setIsLocked(!1),this.controller.setIsLocked(!1),t.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,u.handleCameraChange),!0},this.handleMouseMove=function(e){return A.x=.5*(e.normalizedX+1),A.y=1-.5*(e.normalizedY+1),!0},this.handleBlur=function(e){return m=!1,b=null,!1}},function(){"use strict"
function e(e,t){function n(){return t.getData().instanceTree}function o(){var o=[],r=[],a=h.selectedObjectIds,s=n()
for(var l in a){var c=parseInt(l)
c&&(o.push(c),s&&s.enumNodeFragments(c,function(e){r.push(e)},!1))}var u={type:i.SELECTION_CHANGED_EVENT,fragIdsArray:r,dbIdArray:o,nodeArray:o,model:t}
e.api.fireEvent(u)}function r(){var e=!1,t=h.selectedObjectIds,i=n()
for(var r in t){var a=parseInt(r),s=i.isNodeHidden(a)
a&&s&&(u(a),e=!0)}e&&o()}function a(i){var o=n()
if(p[i]>0)p[i]--,0==p[i]&&e.highlightObjectNode(t,i,!1)
else if(p[i]<0)throw"Selection State machine broken. Negatively selected object!"
o&&o.enumNodeChildren(i,function(e){a(e)},!1)}function s(i,o){var r=n()
p[i]?p[i]++:(e.highlightObjectNode(t,i,!0,o),p[i]=1),r&&r.enumNodeChildren(i,function(e){s(e,!0)},!1)}function l(e){return void 0!==e&&h.selectedObjectIds[e]?!0:void 0}function c(e){var t=n()
t&&(e=n().findNodeForSelection(e,h.selectionMode))
var i=l(e)
i||(h.selectedObjectIds[e]=e,h.selectionCount++,s(e))}function u(e){var t=l(e)
t&&(a(e),h.selectedObjectIds[e]=0,h.selectionCount--)}function d(e){if(h.selectionCount!==e.length)return!1
for(var t=0;t<e.length;t++)if(!l(e[t]))return!1
return!0}var h=this
this.selectedObjectIds={},this.selectionCount=0,this.selectionMode=i.SelectionMode.LEAF_OBJECT
var p={}
this.getSelectionLength=function(){return h.selectionCount},this.getSelection=function(){var e=[],t=h.selectedObjectIds
for(var i in t)if(t[i]){var n=parseInt(i)
e.push(n)}return e},this.clearSelection=function(e){if(this.selectionCount>0){var t=h.selectedObjectIds
for(var i in t){var n=parseInt(i)
void 0!==n&&a(n)}h.selectedObjectIds={},h.selectionCount=0,e||o()}},this.toggleSelection=function(e){return e?(l(e)?u(e):c(e),void o()):void console.error("Attempting to select node 0.")},this.setSelectionMode=function(e){this.clearSelection(!0),this.selectionMode=e},this.setSelection=function(e){if(!d(e)&&(this.clearSelection(!0),null!=e&&0!==e.length)){for(var t=0;t<e.length;t++)c(e[t])
o()}},this.getSelectionBounds=function(){var e=new THREE.Box3,i=new THREE.Box3,o=n(),r=t.getFragmentList(),a=h.selectedObjectIds
for(var s in a){var l=parseInt(s)
o.enumNodeFragments(l,function(t){r.getWorldBounds(t,i),e.union(i)},!0)}return e},this.getSelectionVisibility=function(){var e=!1,t=!1,i=h.selectedObjectIds
for(var o in i){var r=parseInt(o)
if(r){var a=n()
if(a&&a.isNodeHidden(r)?t=!0:e=!0,e&&t)break}}return{hasVisible:e,hasHidden:t}},this.dtor=function(){this.selectedObjectIds=null},e.api.addEventListener(i.ISOLATE_EVENT,function(e){r()}),e.api.addEventListener(i.HIDE_EVENT,function(e){r()})}function t(t){function i(){n.length>1&&stderr("This selection call does not yet support multiple models.")}var n=[]
this.addModel=function(i){-1==n.indexOf(i)&&(i.selector=new e(t,i),n.push(i))},this.removeModel=function(e){var t=n.indexOf(e)
e.selector=null,n.splice(t,1)},this.getSelectionLength=function(){return i(),n[0].selector.getSelectionLength()},this.getSelection=function(){return i(),n[0].selector.getSelection()},this.clearSelection=function(e){for(var t=0;t<n.length;t++)n[t].selector.clearSelection(e)},this.toggleSelection=function(e,t){t||(i(),t=n[0]),t.selector.toggleSelection(e)},this.setSelectionMode=function(e){for(var t=0;t<n.length;t++)n[t].selector.setSelectionMode(e)},this.setSelection=function(e,t){e&&0!==e.length?(t||(i(),t=n[0]),t.selector.setSelection(e)):this.clearSelection()},this.getSelectionBounds=function(){if(1==n.length)return n[0].selector.getSelectionBounds()
for(var e=new THREE.Box3,t=0;t<n.length;t++){var i=n[t].selector.getSelectionBounds()
e.union(i)}return e},this.getSelectionVisibility=function(){return i(),n[0].selector.getSelectionVisibility()},this.dtor=function(){for(var e=0;e<n.length;e++)n[e].selector.dtor()}}var i=Autodesk.Viewing,n=i.Private
n.Selector=e,n.MultiModelSelector=t}(),function(){"use strict"
function e(e){this.viewer=e,this.models=[]}var t=Autodesk.Viewing,i=function(e,t){this.viewerImpl=e,this.model=t,this.isolatedNodes=[],this.hiddenNodes=[]}
i.prototype.getInstanceTree=function(){return this.model?this.model.getData().instanceTree:null},i.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)},i.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)},i.prototype.isolate=function(e){var t=this.getInstanceTree().getRootId(),i="number"==typeof e&&e===t||"object"==typeof e&&e.dbId===t
e&&!i?this.isolateMultiple(Array.isArray(e)?e:[e]):this.isolateNone()},i.prototype.isolateNone=function(){this.model.setAllVisibility(!0),this.viewerImpl.sceneUpdated(!0)
var e=this.model?this.model.getRootId():null
e&&this.setVisibilityOnNode(e,!0),this.hiddenNodes=[],this.isolatedNodes=[],this.viewerImpl.invalidate(!0)
var i={type:t.ISOLATE_EVENT,nodeIdArray:[],model:this.model}
this.viewerImpl.api.fireEvent(i)},i.prototype.isolateMultiple=function(e){if(e&&0!=e.length){var i=this.model.getRootId()
i&&this.setVisibilityOnNode(i,!1),this.model.setAllVisibility(!1),this.viewerImpl.sceneUpdated(!0),this.isolatedNodes=e.slice(0),this.hiddenNodes=[]
for(var n=0;n<e.length;n++)this.setVisibilityOnNode(e[n],!0)
var o={type:t.ISOLATE_EVENT,nodeIdArray:e,model:this.model}
this.viewerImpl.api.fireEvent(o)}else this.isolateNone()
this.viewerImpl.invalidate(!0)},i.prototype.hide=function(e){var i
if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.setVisibilityOnNode(e[n],!1)
e.length>0&&(i={type:t.HIDE_EVENT,nodeIdArray:e})}else this.setVisibilityOnNode(e,!1),i={type:t.HIDE_EVENT,nodeIdArray:[e]}
i&&this.viewerImpl.api.fireEvent(i)},i.prototype.show=function(e){var i
if(Array.isArray(e)){for(var n=0;n<e.length;++n)this.setVisibilityOnNode(e[n],!0)
e.length>0&&(i={type:t.SHOW_EVENT,nodeIdArray:e})}else this.setVisibilityOnNode(e,!0),i={type:t.SHOW_EVENT,nodeIdArray:[e]}
i&&this.viewerImpl.api.fireEvent(i)},i.prototype.toggleVisibility=function(e){var i=this.getInstanceTree().isNodeHidden(e)
this.setVisibilityOnNode(e,i)
var n={type:i?t.SHOW_EVENT:t.HIDE_EVENT,nodeIdArray:[e]}
this.viewerImpl.api.fireEvent(n)},i.prototype.setVisibilityOnNode=function(e,t){var i=this.viewerImpl,n=this.model,o=this.getInstanceTree(),r=!t
o?o.enumNodeChildren(e,function(e){o.setNodeHidden(e,r),o.enumNodeFragments(e,function(e){n.setVisibility(e,t)},!1)},!0):n.setVisibility(e,t),i.sceneUpdated(!0),this.updateNodeVisibilityTracking(e,t)},i.prototype.updateNodeVisibilityTracking=function(e,t){var i=t
if(this.isolatedNodes.length>0){var n=this.isolatedNodes.indexOf(e)
i&&-1===n?this.isolatedNodes.push(e):i||-1===n||this.isolatedNodes.splice(n,1)}else{var o=this.hiddenNodes.indexOf(e)
i||-1!==o?i&&-1!==o&&this.hiddenNodes.splice(o,1):this.hiddenNodes.push(e)}var r=this.getInstanceTree()
r&&r.root&&r.root.dbId===e&&(t?(this.isolatedNodes=[],this.hiddenNodes=[]):(this.isolatedNodes=[],this.hiddenNodes=[e]))},i.prototype.setNodeOff=function(e,t){var i=this.viewerImpl,n=this.model,o=this.getInstanceTree()
o?o.enumNodeChildren(e,function(e){o.setNodeOff(e,t),o.enumNodeFragments(e,function(e){n.getFragmentList().setFragOff(e,t)},!1)},!0):n.getFragmentList().setFragOff(e,t),i.sceneUpdated(!0)},t.Private.VisibilityManager=i,e.prototype.addModel=function(e){-1==this.models.indexOf(e)&&(e.visibilityManager=new i(this.viewer,e),this.models.push(e))},e.prototype.removeModel=function(e){var t=this.models.indexOf(e)
e.visibilityManager=null,this.models.splice(t,1)},e.prototype.warn=function(){this.models.length>1&&stderr("This selection call does not yet support multiple models.")},e.prototype.getIsolatedNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getIsolatedNodes()},e.prototype.getHiddenNodes=function(e){return e||(this.warn(),e=this.models[0]),e.visibilityManager.getHiddenNodes()},e.prototype.isolate=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.isolate(e)},e.prototype.hide=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.hide(e)},e.prototype.show=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.show(e)},e.prototype.toggleVisibility=function(e,t){t||(this.warn(),t=this.models[0]),t.visibilityManager.toggleVisibility(e)},e.prototype.setVisibilityOnNode=function(e,t,i){i||(this.warn(),i=this.models[0]),i.visibilityManager.setVisibilityOnNode(e,t)},e.prototype.setNodeOff=function(e,t,i){i||(this.warn(),i=this.models[0]),i.visibilityManager.setNodeOff(e,t)},t.Private.MultiModelVisibilityManager=e}(),!LMV_WORKER_URL)var LMV_WORKER_URL="src/workers/MainWorker.js"
if(void 0==ENABLE_INLINE_WORKER)var ENABLE_INLINE_WORKER=!1
!function(){"use strict"
var e=Autodesk.Viewing,t=e.Private,i=null,n=!1,o=[]
t.initWorkerScript=function(e,r){if(ENABLE_INLINE_WORKER&&!i){if(o.push({successCB:e}),n)return
var a=new XMLHttpRequest,s=LMV_WORKER_URL,l=t.getResourceUrl(LMV_WORKER_URL)
l&&(s=l),a.open("GET",s,!0),a.withCredentials=!1,a.onload=function(){n=!1
var e
window.URL=window.URL||window.webkitURL
try{e=new Blob([a.responseText],{type:"application/javascript"})}catch(t){e=new BlobBuilder,e.append(a.responseText),e=e.getBlob()}i=URL.createObjectURL(e)
var r=o.concat()
o=[]
for(var s=0;s<r.length;++s)r[s].successCB&&r[s].successCB()},n=!0,a.send()}else e&&e()},t.createWorker=function(){return ENABLE_INLINE_WORKER?new Worker(i):new Worker(t.getResourceUrl(LMV_WORKER_URL))},t.createWorkerWithIntercept=function(){function e(e){if(!n)return null
for(var t=0;t<n.length;++t)if(n[t].arg===e){var i=n[t].callback
return n.splice(t,1),0===n.length&&(n=null),i}return null}var i=t.createWorker()
i.checkEvent=function(e){return e.data&&e.data.assetRequest?(t.assets&&t.assets.push(e.data.assetRequest),!0):!1}
var n=[]
return i.addEventListenerWithIntercept=function(e){var t=function(t){i.checkEvent(t)||e(t)}
return n||(n=[]),n.push({arg:e,callback:t}),i.addEventListener("message",t,!1),t},i.removeEventListenerWithIntercept=function(t){var n=e(t)
n&&i.removeEventListener("message",n,!1)},i.clearAllEventListenerWithIntercept=function(){if(n)for(var e=n.concat(),t=0;t<e.length;++t)i.removeEventListenerWithIntercept(e[t].arg)},i}}(),function(){"use strict"
function e(e){var t=e.data
if(t&&t.debug)return void stderr(t.message)
if(t.cbId){var i=d[t.cbId]
t&&t.error?i[1]&&i[1](t.error):i[0]&&i[0](t.result),delete d[t.cbId]}}function t(e,t){var i=u++
return d[i]=[e,t],i}var i="GET_PROPERTIES",n="SEARCH_PROPERTIES",o="BUILD_EXTERNAL_ID_MAPPING",r="GET_OBJECT_TREE",a="ATTRIBUTES_MAP",s=Autodesk.Viewing,l=s.Private,c=function(e,t,i){this.sharedDbPath=e,this.propWorker=null,this.eventTarget=i,this.svf=t,this.domainParam=auth?"domain="+encodeURIComponent(window.location.origin):""}
c.prototype.dtor=function(){this.propWorker&&(this.propWorker.clearAllEventListenerWithIntercept(),this.propWorker.terminate(),this.propWorker=null)}
var u=1,d={}
c.prototype.load=function(){var i=this
this.propWorker||(this.propWorker=l.createWorkerWithIntercept(),this.propWorker.addEventListenerWithIntercept(e))
var n=function(e){var t=e.instanceTree,n=e.instanceBoxes
t?(i.svf.instanceTree=new l.InstanceTree(t,n,e.objectCount,e.maxTreeDepth),i.svf.fragToNodeDone=!0):e.objectCount&&(i.svf.hasObjectProperties=e.objectCount),i.eventTarget.fireEvent({type:s.OBJECT_TREE_CREATED_EVENT,svf:i.svf})},o=function(e){i.propertyDbError=e,i.eventTarget.fireEvent({type:s.OBJECT_TREE_UNAVAILABLE_EVENT,svf:i.svf})},a=t(n,o),c=l.pathToURL(this.svf.basePath)
this.sharedDbPath&&!this.svf.propertydb.values.length&&(c=this.sharedDbPath,stderr("Using shared property db: "+c))
var u={operation:r,url:c,propertydb:this.svf.propertydb,headers:s.HTTP_REQUEST_HEADERS,fragToDbId:this.svf.fragments.fragId2dbId,fragBoxes:this.svf.fragments.boxes,auth:auth,viewing_url:VIEWING_URL,oss_url:OSS_URL,cbId:a,queryParams:this.domainParam}
this.propWorker.postMessage(u)},c.prototype.asyncPropertyOperation=function(e,i,n){var o=this
if(o.svf.instanceTree||o.svf.hasObjectProperties)e.cbId=t(i,n),this.propWorker.postMessage(e)
else if(o.propertyDbError)n&&n(o.propertyDbError)
else{var r=function(t){o.eventTarget.removeEventListener(s.OBJECT_TREE_CREATED_EVENT,r),o.eventTarget.removeEventListener(s.OBJECT_TREE_UNAVAILABLE_EVENT,r),t.svf.instanceTree||t.svf.hasObjectProperties||o.propertyDbError?o.asyncPropertyOperation(e,i,n):n&&n({code:s.UNKNOWN_FAILURE,msg:"Failed to load properties"})}
o.eventTarget.addEventListener(s.OBJECT_TREE_CREATED_EVENT,r),o.eventTarget.addEventListener(s.OBJECT_TREE_UNAVAILABLE_EVENT,r)}},c.prototype.getProperties=function(e,t,n){this.asyncPropertyOperation({operation:i,dbId:e},t,n)},c.prototype.searchProperties=function(e,t,i,o){this.asyncPropertyOperation({operation:n,searchText:e,attributeNames:t},i,o)},c.prototype.getExternalIdMapping=function(e,t){this.asyncPropertyOperation({operation:o},e,t)},c.prototype.getObjectTree=function(e,t){var i=this
if(i.svf.instanceTree)e(i.svf.instanceTree)
else if(i.propertyDbError||"hasObjectProperties"in i.svf)t&&t(i.propertyDbError)
else{var n=function(){i.eventTarget.removeEventListener(s.OBJECT_TREE_CREATED_EVENT,n),i.eventTarget.removeEventListener(s.OBJECT_TREE_UNAVAILABLE_EVENT,n),i.getObjectTree(e,t)}
i.eventTarget.addEventListener(s.OBJECT_TREE_CREATED_EVENT,n),i.eventTarget.addEventListener(s.OBJECT_TREE_UNAVAILABLE_EVENT,n)}},c.prototype.attributeToIdMap=function(e,t){this.asyncPropertyOperation({operation:a},e,t)},l.PropDbLoader=c}(),function(){"use strict"
var e=isMobileDevice()?2:6,t="LOAD_GEOMETRY",i="LOAD_SVF",n="LOAD_SVF_CONTD",o=Autodesk.Viewing,r=Autodesk.Viewing.Private,a=function(e){this.viewer3DImpl=e,this.next_pack=0,this.loading=!1,this.loadedPacksCount=0,this.loadedPacks=[],this.tmpMatrix=new THREE.Matrix4,this.logger=r.logger,this.loadTime=0,this.domainParam=auth?"domain="+encodeURIComponent(window.location.origin):"",this.onDemandLoading=!1,this.cullGeometryOnLoading=!1,this.pageOutGeometryEnabled=!1}
a.prototype.dtor=function(){if(this.svf=null,this.options=null,this.svfWorker&&(this.svfWorker.clearAllEventListenerWithIntercept(),this.svfWorker.terminate(),this.svfWorker=null),this.pack_workers){for(var e=0;e<this.pack_workers.length;e++)this.pack_workers[e].clearAllEventListenerWithIntercept(),this.pack_workers[e].terminate()
this.pack_workers=null}},r.pathToURL=function(e){if(-1!==e.indexOf("://")||0===e.indexOf("urn:"))return e
var t=window.location.pathname,i=t.lastIndexOf("/")
t=t.substr(0,i+1)
var n=window.location.protocol+"//"+window.location.host+t+e
return n},a.prototype.loadFile=function(e,t,i,n){if(this.loading)return console.log("Loading of SVF already in progress. Ignoring new request."),!1
this.dtor(),this.viewer3DImpl.model&&!t.globalOffset&&(t.globalOffset=this.viewer3DImpl.model.getData().globalOffset)
var o=e.indexOf("urn:")
if(-1!=o){e=decodeURIComponent(e)
var a=e.substr(o,e.substr(o).indexOf("/"))
stderr("Extracted URN: "+a)
var s=a.lastIndexOf(":")
this.svfUrn=a.substr(s+1)}else this.svfUrn=e
this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.options=t
var l=this
return r.initWorkerScript(function(){l.loadSvfCB(e,t,i,n)}),!0},a.prototype.interceptManifest=void 0,a.prototype.loadSvfCB=function(t,a,s,l){this.t0=(new Date).getTime(),this.failedToLoadSomeGeometryPacks=null
var c=this,u={url:r.pathToURL(t),headers:o.HTTP_REQUEST_HEADERS,objectIds:a.ids,globalOffset:a.globalOffset,auth:auth,viewing_url:VIEWING_URL,oss_url:OSS_URL,queryParams:this.domainParam,bvhOptions:{isWeakDevice:isAndroidDevice()||isIOSDevice()}},d=this.svfWorker=r.createWorkerWithIntercept(),h=function(t){var i=function(){d.clearAllEventListenerWithIntercept(),d.terminate(),c.svfWorker=null,d=null}
if(t.data&&t.data.manifest)c.interceptManifest(t.data.manifest),u.operation=n,u.manifest=t.data.manifest,d.postMessage(u)
else if(t.data&&t.data.svf){var a=c.svf=t.data.svf
c.failedToLoadSomeGeometryPacks&&(l&&l(c.failedToLoadSomeGeometryPacks.code,c.failedToLoadSomeGeometryPacks.msg),c.failedToLoadSomeGeometryPacks=null),c.onSvfLoadDone(a)
var h=c.model=new r.RenderModel(a)
h.initialize(c),h.loader=c,s&&s(c.model),c.viewer3DImpl.api.fireEvent({type:o.MODEL_ROOT_LOADED_EVENT,svf:a})
var p=a.geompacks.length
if(c.svf.loadDone=!1,0==p)c.onGeomLoadDone()
else if(a.fragments.length>r.FRAGS_PERSISTENT_MAX_COUNT?(c.onDemandLoading=r.onDemandLoading,c.cullGeometryOnLoading=r.cullGeometryOnLoading):(c.onDemandLoading=!1,c.cullGeometryOnLoading=!1),stderr("SVF on demand loading: "+c.onDemandLoading),stderr("SVF culling geometry on loading: "+c.cullGeometryOnLoading),c.onDemandLoading)c.loadedPacksCount=0
else if(p)for(var f=Math.min(p,e),m=0;f>m;m++){var v=a.geompacks[m]
v.loading=!0,c.loadGeometryPack(v.id,v.uri),c.next_pack=m+1}1==t.data.progress&&(c.loading=!1,i()),a.fragments.polygonCounts||(a.fragments.polygonCounts=new Int32Array(a.fragments.length))}else t.data&&t.data.bvh?1==t.data.progress&&(c.svf.bvh||(c.svf.bvh=t.data.bvh,c.model.setBVH(new NodeArray(c.svf.bvh.nodes,c.svf.bvh.useLeanNodes),c.svf.bvh.primitives),c.viewer3DImpl.invalidate(!1,!0)),c.loading=!1,i()):t.data&&t.data.progress?1==t.data.progress&&(c.loading=!1,i()):t.data&&t.data.error?(c.loading=!1,i(),l&&l(t.data.error.code,t.data.error.msg,t.data.error.args.httpStatus,t.data.error.args.httpStatusText)):t.data&&t.data.debug?stderr(t.data.message):(stderr("SVF download failed."),c.loading=!1,i())}
return d.addEventListenerWithIntercept(h),u.operation=i,u.interceptManifest=!!this.interceptManifest,d.postMessage(u),!0},a.prototype.loadGeometryPackOnDemand=function(i){var n=this
if(n.onDemandLoading){var a=n.svf.geompacks[i]
if(!a.loading){var s,l=function(e){if(e.data&&e.data.mesh){if(n.processReceivedMesh(e.data),e.data.progress>=1){n.pack_workers[e.data.workerId].queued-=1,n.svf.geompacks[e.data.packId].loading=!1
var t=n.model.geomPacksMissingLastFrame(),i=t.indexOf(e.data.packId)
i>=0&&t.splice(i,1)
for(var o=!0,r=0;r<n.pack_workers.length;r++)if(0!=n.pack_workers[r].queued){o=!1
break}-1==n.loadedPacks.indexOf(e.data.packId)&&n.loadedPacks.push(e.data.packId),o&&0==n.model.geomPacksMissingLastFrame().length&&(n.loadedPacks.length==n.svf.geompacks.length?n.onGeomLoadDone():n.onGeomPackFilesLoadDone())}}else if(e.data&&e.data.progress){n.pack_workers[e.data.workerId].queued-=1,n.loadedPacksCount++
var a,l=null,t=n.model.geomPacksMissingLastFrame()
for(s=0;s<t.length&&(a=t[s],l=n.svf.geompacks[a],l.loading);++s);l&&!l.loading&&n.loadGeometryPackOnDemand(a),n.viewer3DImpl.signalProgress(100*n.loadedPacks.length/n.svf.geompacks.length)}else e.data&&e.data.debug?stderr(e.data.message):e.data&&e.data.error?n.failedToLoadSomeGeometryPacks={code:e.data.error.code,msg:e.data.error.msg}:(n.pack_workers[e.data.workerId].queued-=2,n.svf.geompacks[e.data.packId].loading=!1)}
if(!this.pack_workers)for(this.pack_workers=[],s=0;e>s;s++){var c=r.createWorkerWithIntercept()
c.addEventListenerWithIntercept(l),c.queued=0,this.pack_workers.push(c)}var u=0,d=this.pack_workers[0].queued
for(s=1;e>s;s++)this.pack_workers[s].queued<d&&(u=s,d=this.pack_workers[s].queued)
if(d>2)return void n.model.addGeomPackMissingLastFrame(i)
var h,p,f=a.uri
h=this.pack_workers[u],h.queued+=2,p=u,a.loading=!0,n.svf.partPacksLoadDone=!1
var m=r.pathToURL(this.svf.basePath+f),v={operation:t,url:m,packId:parseInt(i),headers:o.HTTP_REQUEST_HEADERS,workerId:p,auth:auth,viewing_url:VIEWING_URL,oss_url:OSS_URL,queryParams:this.domainParam}
h.postMessage(v)}}},a.prototype.loadGeometryPack=function(i,n){var a,s,l,c,u=this,d=function(t){if(t.data&&t.data.mesh){if(u.processReceivedMesh(t.data),t.data.progress>=1){u.pack_workers[t.data.workerId].queued-=1,u.loadedPacksCount++,u.viewer3DImpl.signalProgress(100*u.loadedPacksCount/u.svf.geompacks.length)
var i=!0
for(c=0;c<u.pack_workers.length;c++)if(0!=u.pack_workers[c].queued){i=!1
break}if(i){for(c=0;e>c;c++)u.pack_workers[c].clearAllEventListenerWithIntercept(),u.pack_workers[c].terminate()
u.pack_workers=null}u.svf.fragments.numLoaded==u.svf.fragments.length&&(u.svf.proteinMaterials&&PROTEIN_ROOT&&PRISM_ROOT||u.viewer3DImpl.matman().loadTextures(u.svf),u.onGeomLoadDone())}}else if(t.data&&t.data.progress){if(u.pack_workers[t.data.workerId].queued-=1,u.next_pack<u.svf.geompacks.length){var n=null,o=u.model.geomPacksMissingLastFrame()
for(l=0;l<o.length&&(n=u.svf.geompacks[o[l]],!n||n.loading);++l);if(!n||n.loading)for(;u.next_pack<u.svf.geompacks.length&&(n=u.svf.geompacks[u.next_pack++],n.loading););n&&!n.loading?(n.loading=!0,u.loadGeometryPack(n.id,n.uri)):(u.viewer3DImpl.modelQueue().enforceBvh=!1,u.svf.fragments.packIds=null)}}else t.data&&t.data.debug?stderr(t.data.message):t.data&&t.data.error?u.failedToLoadSomeGeometryPacks={code:t.data.error.code,msg:t.data.error.msg}:u.pack_workers[t.data.workerId].queued-=2}
if(!this.pack_workers)for(this.pack_workers=[],l=0;e>l;l++){var h=r.createWorkerWithIntercept()
h.addEventListenerWithIntercept(d),h.queued=0,this.pack_workers.push(h)}var p=0,f=this.pack_workers[0].queued
for(l=1;e>l;l++)this.pack_workers[l].queued<f&&(p=l,f=this.pack_workers[l].queued)
a=this.pack_workers[p],a.queued+=2,s=p
var m=r.pathToURL(this.svf.basePath+n),v={operation:t,url:m,packId:parseInt(i),headers:o.HTTP_REQUEST_HEADERS,workerId:s,auth:auth,viewing_url:VIEWING_URL,oss_url:OSS_URL,queryParams:this.domainParam}
a.postMessage(v)},a.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,i=this.svf,n=i.fragments,o=n.mesh2frag[t]
if(void 0===o)return void stderr("Mesh "+t+" was not referenced by any fragments.")
if(Array.isArray(o)||(o=[o]),this.cullGeometryOnLoading){for(var a=!0,s=0;s<o.length;++s){if(o[s]<r.FRAGS_PERSISTENT_COUNT){a=!1
break}if(a=a&&this.viewer3DImpl.modelQueue().checkCull(o[s],!0,!0),!a)break}if(a)return void(e.mesh=null)}BufferGeometryUtils.meshToGeometry(e)
var l=o.length,c=this.model,u=c.getFragmentList().getGeometryId(o[0]),d=c.getGeometryList().addGeometry(e.geometry,l,u)
this.cullGeometryOnLoading&&l>1&&null==c.getFragmentList().geomidsmap[d]&&(c.getFragmentList().geomidsmap[d]={n:l,t:0})
for(var h=e.geometry.attributes.index.array||e.geometry.ib,p=h.length/3,s=0;s<o.length;s++){var f=0|o[s]
c.getFragmentList().getOriginalWorldMatrix(f,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new THREE.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix))
var m=n.materials[f].toString()
n.polygonCounts&&(n.polygonCounts[f]=p)
var v=this.viewer3DImpl.createThreeMesh(this.model,e.geometry,m,this.tmpMatrix)
c.activateFragment(f,v,!!this.options.placementTransform)}this.onDemandLoading||(n.mesh2frag[t]=null),n.numLoaded+=o.length,i.geomPolyCount>i.nextRepaintPolys&&(i.numRepaints++,i.nextRepaintPolys+=1e4*Math.pow(1.5,i.numRepaints),this.viewer3DImpl.invalidate(!1,!0))},a.prototype.onSvfLoadDone=function(e){e.geomPolyCount=0,e.instancePolyCount=0,e.geomMemory=0,e.fragments.numLoaded=0,e.meshCount=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.nextRepaintPolys=1e4,e.numRepaints=0,e.urn=this.svfUrn,e.basePath=""
var t=this.currentLoadPath.lastIndexOf("/");-1!=t&&(e.basePath=this.currentLoadPath.substr(0,t+1))
var i=Date.now()
this.loadTime+=i-this.t0,stderr("SVF load: "+(i-this.t0))
var n=!(this.onDemandLoading&&(isAndroidDevice()||isIOSDevice()))
if(n&&this.loadPropertyDb(),this.viewer3DImpl.matman().convertMaterials(e),this.t0=i,e.bbox=(new THREE.Box3).copy(e.bbox),e.cameras)for(var o=0;o<e.cameras.length;o++){var r=e.cameras[o]
r.position=(new THREE.Vector3).copy(r.position),r.target=(new THREE.Vector3).copy(r.target),r.up=(new THREE.Vector3).copy(r.up)}e.proteinMaterials&&PROTEIN_ROOT&&PRISM_ROOT&&this.viewer3DImpl.matman().loadTextures(e),stderr("scene bounds: "+JSON.stringify(e.bbox)),this.viewer3DImpl.signalProgress(5,"Hold on, getting the model..."),this.viewer3DImpl.invalidate(!1,!1)},a.prototype.addTransparencyFlagsToMaterials=function(e){for(var t in e){var i=e[t],n=i.userassets,o=i.materials,r=o[n[0]]
i.transparent=r.transparent}},a.prototype.makeBVH=function(e){var t=performance.now(),i=e.materials?e.materials.materials:null
i&&this.addTransparencyFlagsToMaterials(i),e.bvh=new BVHBuilder(e.fragments,i),e.bvh.build({isWeakDevice:isAndroidDevice()||isIOSDevice()})
var n=performance.now()
stderr("BVH build time: "+(n-t))},a.prototype.onGeomPackFilesLoadDone=function(){stderr("Part of geom pack files are load done."),this.svf.partPacksLoadDone=!0,this.viewer3DImpl.invalidate(!1,!0)},a.prototype.onGeomLoadDone=function(){function e(e){var t={command:"assets",data:e}
window.webkit.messageHandlers.callbackHandler.postMessage(t)}this.svf.loadDone=!0,this.onDemandLoading||(this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null)
var t=Date.now(),i="Fragments load time: "+(t-this.t0)
if(this.loadTime+=t-this.t0,(!this.svf.bvh||this.options.placementTransform)&&(this.makeBVH(this.svf),this.model.setBVH(this.svf.bvh.nodes,this.svf.bvh.primitives)),stderr(i),this.logger){var n={category:"model_load_stats",is_f2d:!1,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,fragments_count:this.model.getFragmentList().getCount(),urn:this.svfUrn}
this.logger.log(n,!0)}r.assets&&window.webkit&&(e(r.assets),r.assets=null),this.currentLoadPath=null,this.viewer3DImpl.onLoadComplete(this.model)},a.prototype.loadPropertyDb=function(){this.svf.propWorker=new r.PropDbLoader(this.sharedDbPath,this.svf,this.viewer3DImpl.api),this.svf.propWorker.load()},r.SvfLoader=a,o.FileLoaderManager.registerFileLoader("svf",["svf"],r.SvfLoader)}(),function(){"use strict"
function e(e){this.viewer3DImpl=e,this.loading=!1,this.tmpMatrix=new THREE.Matrix4,this.logger=r.logger,this.loadTime=0,this.domainParam=auth?"domain="+encodeURIComponent(window.location.origin):""}var t="PARSE_F2D",i="STREAM_F2D",n="PARSE_F2D_FRAME",o=Autodesk.Viewing,r=Autodesk.Viewing.Private
e.prototype.dtor=function(){this.svf=null,this.options=null},e.prototype.loadFile=function(e,t,i,n){if(this.loading)return console.log("Loading of SVF already in progress. Ignoring new request."),!1
this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null),this.streamingWorker&&(this.streamingWorker.terminate(),this.streamingWorker=null)
var o=e.indexOf("urn:")
if(-1!=o){e=decodeURIComponent(e)
var a=e.substr(o,e.substr(o).indexOf("/"))
stderr("Extracted URN: "+a)
var s=a.lastIndexOf(":")
this.svfUrn=a.substr(s+1)}else this.svfUrn=e
this.sharedDbPath=t.sharedPropertyDbPath,this.currentLoadPath=e,this.options=t,this.options.placementTransform?this.modelScale=this.options.placementTransform.getMaxScaleOnAxis():this.modelScale=1,this.isf2d=!0
var l=this
return r.initWorkerScript(function(){l.loadFydoCB(e,t,i,n)}),!0},e.prototype.loadFydoCB=function(e,a,s,l){this.t0=Date.now()
var c=r.pathToURL(e),u=this.streamingWorker=r.createWorker(),d=this.parsingWorker=r.createWorker(),h=this,p=function(e){if(e.data&&"F2DBLOB"==e.data.type){var i={operation:t,data:e.data.buffer,metadata:e.data.metadata,manifest:e.data.manifest,basePath:e.data.basePath,f2dLoadOptions:a,url:c}
d.postMessage(i,[i.data]),u.terminate()}else if(e.data&&"F2DSTREAM"==e.data.type){var i={operation:n,data:e.data.frames,url:c,f2dLoadOptions:a}
e.data.metadata&&(i.metadata=e.data.metadata,i.manifest=e.data.manifest),e.data.finalFrame&&(i.finalFrame=!0),e.data.progress&&h.viewer3DImpl.signalProgress(100*e.data.progress),d.postMessage(i,i.data?[i.data]:void 0),e.data.finalFrame&&u.terminate()}else e.data&&"F2DAssetURL"==e.data.type?r.assets=r.assets.concat(e.data.urls):e.data&&e.data.debug?stderr(e.data.message):e.data&&e.data.error?(h.loading=!1,u.terminate(),l&&l.call(this,e.data.error.code,e.data.error.msg,e.data.error.args.httpStatus,e.data.error.args.httpStatusText)):(stderr("F2D download failed."),h.loading=!1,u.terminate())},f=function(e){if(e.data&&e.data.f2d){var t=h.svf=e.data.f2d
d.terminate(),stderr("Num polylines: "+t.numPolylines),stderr("Line segments: "+t.numLineSegs),stderr("Circular arcs: "+t.numCircles),stderr("Ellipitcal arcs:"+t.numEllipses),stderr("Plain triangles:"+t.numTriangles),stderr("Total # of op codes generated by fydo.parse: "+t.opCount),h.onSvfLoadDone(h.svf)
var i=h.model=new r.RenderModel(t)
i.initialize(i,this),i.loader=h,s&&s(h.model),h.viewer3DImpl.api.fireEvent({type:o.MODEL_ROOT_LOADED_EVENT,svf:h.svf})
for(var n=0;n<t.meshes.length;n++)h.processReceivedMesh2D(t.meshes[n],n)
t.meshes=null,h.onGeomLoadDone(),h.loading=!1}else if(e.data&&e.data.f2dframe){var a=0
if(e.data.meshes){var c=e.data.bbox
h.svf.bbox=new THREE.Box3(c.min,c.max),a=e.data.baseIndex}else h.svf=e.data.f2dframe,a=e.data.baseIndex
var t=h.svf
if(t.fragments&&t.fragments.initialized)t.maxObjectNumber=e.data.maxObjectNumber,t.viewports=e.data.viewports,t.currentVpId=e.data.currentVpId,t.clips=e.data.clips
else{h.onSvfLoadDone(t)
var i=h.model=new r.RenderModel(t)
i.initialize(i,this),i.loader=h,s&&s(h.model),h.viewer3DImpl.api.fireEvent({type:o.MODEL_ROOT_LOADED_EVENT,svf:t})}if(e.data.meshes&&e.data.meshes.length){for(var n=0;n<e.data.meshes.length;n++)h.processReceivedMesh2D(e.data.meshes[n],a+n)
e.data.finalFrame&&(h.onGeomLoadDone(),h.loading=!1,d.terminate())}}else e.data&&e.data.progress||(e.data&&e.data.debug?stderr(e.data.message):e.data&&e.data.error?(h.loading=!1,d.terminate(),stderr("Error while parsing F2d: "+JSON.stringify(e.data.error.args)),l&&l.call(this,e.data.error.code,e.data.error.msg,e.data.error.args.httpStatus,e.data.error.args.httpStatusText)):(stderr("F2D download failed."),h.loading=!1,d.terminate()))}
u.addEventListener("message",p,!1),d.addEventListener("message",f,!1)
var m={operation:i,url:c,headers:o.HTTP_REQUEST_HEADERS,objectIds:a.ids,auth:auth,viewing_url:VIEWING_URL,oss_url:OSS_URL,queryParams:this.domainParam}
return u.postMessage(m),!0},e.prototype.processReceivedMesh=function(e){var t=e.packId+":"+e.meshIndex,i=this.svf,n=i.fragments,o=n.mesh2frag[t]
if(void 0===o)return void stderr("Mesh "+t+" was not referenced by any fragments.")
Array.isArray(o)||(o=[o]),BufferGeometryUtils.meshToGeometry(e)
for(var r=o.length,a=this.model,s=(a.getGeometryList().addGeometry(e.geometry,r),e.geometry.attributes.index.array||e.geometry.ib),l=s.length/3,c=0;c<o.length;c++){var u=0|o[c]
a.getFragmentList().getOriginalWorldMatrix(u,this.tmpMatrix),this.options.placementTransform&&(this.tmpMatrix=(new THREE.Matrix4).multiplyMatrices(this.options.placementTransform,this.tmpMatrix))
var d=n.materials[u].toString()
n.polygonCounts&&(n.polygonCounts[u]=l)
var h=this.viewer3DImpl.createThreeMesh(this.model,e.geometry,d,this.tmpMatrix)
a.activateFragment(u,h)}n.mesh2frag[t]=null,n.numLoaded+=o.length
var p=n.numLoaded
i.geomPolyCount>i.nextRepaintPolys&&(i.numRepaints++,i.nextRepaintPolys+=1e4*Math.pow(1.5,i.numRepaints),this.viewer3DImpl.invalidate(!1,!0)),p%20==0&&this.viewer3DImpl.invalidate(!1,!0)},e.prototype.processReceivedMesh2D=function(e,t){var i={mesh:e,is2d:!0,packId:"0",meshIndex:t},n="0:"+t,o=this.svf.fragments,r=Object.keys(i.mesh.dbIds).map(function(e){return parseInt(e)})
o.fragId2dbId[t]=r
for(var a=0;a<r.length;a++){var s=r[a],l=o.dbId2fragId[s]
Array.isArray(l)?l.push(t):"undefined"!=typeof l?o.dbId2fragId[s]=[l,t]:o.dbId2fragId[s]=t}o.mesh2frag[n]=t,e.material.modelScale=this.modelScale,o.materials[t]=this.viewer3DImpl.matman().create2DMaterial(this.svf,e.material),o.length++,this.processReceivedMesh(i)},e.prototype.onSvfLoadDone=function(e){e.fragments={},e.fragments.mesh2frag={},e.fragments.materials=[],e.fragments.fragId2dbId=[],e.fragments.dbId2fragId=[],e.fragments.length=0,e.fragments.initialized=!0,e.geomPolyCount=0,e.instancePolyCount=0,e.geomMemory=0,e.fragments.numLoaded=0,e.meshCount=0,e.gpuNumMeshes=0,e.gpuMeshMemory=0,e.nextRepaintPolys=1e4,e.numRepaints=0,e.urn=this.svfUrn,e.basePath=""
var t=this.currentLoadPath.lastIndexOf("/");-1!=t&&(e.basePath=this.currentLoadPath.substr(0,t+1))
var i=Date.now()
this.loadTime+=i-this.t0,stderr("SVF load: "+(i-this.t0)),this.t0=i,e.bbox=(new THREE.Box3).copy(e.bbox),stderr("scene bounds: "+JSON.stringify(e.bbox)),this.viewer3DImpl.signalProgress(5,"Hold on, getting the model..."),this.viewer3DImpl.invalidate(!1,!1)},e.prototype.onGeomLoadDone=function(){function e(e){var t={command:"assets",data:e}
window.webkit.messageHandlers.callbackHandler.postMessage(t)}this.svf.loadDone=!0,this.svf.fragments.entityIndexes=null,this.svf.fragments.mesh2frag=null
var t=Date.now(),i="Fragments load time: "+(t-this.t0)
if(this.loadTime+=t-this.t0,this.loadPropertyDb(),stderr(i),this.logger){var n={category:"model_load_stats",is_f2d:!0,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.model.getGeometryList().geomMemory,meshes_count:this.model.getGeometryList().geoms.length,urn:this.svfUrn}
this.logger.log(n,!0)}r.assets&&window.webkit&&(e(r.assets),r.assets=null),this.currentLoadPath=null,this.isf2d=void 0,this.viewer3DImpl.onLoadComplete(this.model)},e.prototype.loadPropertyDb=function(){this.svf.propWorker=new r.PropDbLoader(this.sharedDbPath,this.svf,this.viewer3DImpl.api),this.svf.propWorker.load()},r.F2DLoader=e,o.FileLoaderManager.registerFileLoader("f2d",["f2d"],r.F2DLoader)}(),function(e){"use strict"
function t(e,t){var i=t||65536
this.useInstancing=e,this.stride=12,this.vb=new ArrayBuffer(4*this.stride*(this.useInstancing?i/4:i)),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.vcount=0,this.useInstancing?this.ib=null:this.ib=new Uint16Array(i),this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-(1/0),this.dbIds={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0}var i=16,n=32,o=48,r=64,a=80,s=0,l=1,c=2,u=3,d=4,h=2*Math.PI,p=6,f=7,m=8,v=9
t.prototype.expandStride=function(){var e=2,t=this.stride
if(!(t>=12)){for(var i=this.stride+e,n=new ArrayBuffer(i*(this.vb.byteLength/t)),o=new Uint8Array(this.vb),r=new Uint8Array(n),a=0,s=this.vcount;s>a;a++)for(var l=a*t*4,c=a*i*4,u=0;4*t>u;u++)r[c+u]=o[l+u]
this.vb=n,this.vbf=new Float32Array(n),this.vbi=new Int32Array(n),this.stride=i}},t.prototype.addToBounds=function(e,t){e<this.minx&&(this.minx=e),e>this.maxx&&(this.maxx=e),t<this.miny&&(this.miny=t),t>this.maxy&&(this.maxy=t)},t.prototype.setVertexFlag=function(e,t,i,n){var o=n|i|t<<16
this.vbi[e*this.stride+v]=o},t.prototype.addVertexTriangleGeom=function(e,t,i,n,o,r,a,s,l){for(var c=this.vcount,u=this.useInstancing?1:4,d=0;u>d;d++){var h=(c+d)*this.stride,v=this.vbf
v[h]=e,v[h+1]=t,v[h+2]=i,v[h+3]=n,v[h+4]=o,v[h+5]=r,this.vbi[h+p]=a,this.vbi[h+f]=s,this.vbi[h+m]=l<<16,this.vcount++,this.dbIds[s]=1}return c},t.prototype.addVertexLine=function(e,t,i,n,o,r,a,s,l,c){for(var u=this.vcount,d=this.useInstancing?1:4,h=0;d>h;h++){var v=(u+h)*this.stride,g=this.vbf
g[v]=e,g[v+1]=t,g[v+2]=i,g[v+3]=n,g[v+4]=r,g[v+5]=o,this.vbi[v+p]=a,this.vbi[v+f]=s,this.vbi[v+m]=l<<16|c,this.dbIds[s]=1,this.vcount++}return u},t.prototype.addVertexArc=function(e,t,i,n,o,r,a,s,l,c,u){for(var d=this.vcount,h=this.useInstancing?1:4,v=0;h>v;v++){var g=(d+v)*this.stride,E=this.vbf
E[g]=e,E[g+1]=t,E[g+2]=i,E[g+3]=n,E[g+4]=s,E[g+5]=o,this.vbi[g+p]=l,this.vbi[g+f]=c,this.vbi[g+m]=u<<16|0,o!=r&&(E[g+10]=r,E[g+11]=a),this.dbIds[c]=1,this.vcount++}return d},t.prototype.addVertex=function(e,t,i,n,o,r,a,s,l){if(!this.useInstancing){var c=this.vcount,u=c*this.stride,d=this.vbf
return d[u]=e,d[u+1]=t,d[u+2]=i,d[u+3]=n,d[u+4]=o,d[u+5]=0,this.vbi[u+p]=r,this.vbi[u+f]=a,this.vbi[u+m]=l<<16|0,this.setVertexFlag(c,s,0,0),this.vcount++,this.dbIds[a]=1,c}},t.prototype.addVertexPolytriangle=function(e,t,i,n,o,r,a,s,l){this.useInstancing||(this.addVertex(e,t,i,n,o,r,a,s,l),this.addToBounds(e,t))},t.prototype.setVertexColor=function(e,t){if(!this.useInstancing){var i=e*this.stride
this.vbi[i+p]=t}},t.prototype.addTriangle=function(e,t,i){if(!this.useInstancing){var n=this.ib,o=this.icount
if(o+3>=n.length){for(var r=new Uint16Array(2*n.length),a=0;o>a;a++)r[a]=n[a]
this.ib=n=r}n[o]=e,n[o+1]=t,n[o+2]=i,this.icount+=3}},t.prototype.finalizeQuad=function(e,t,i){this.useInstancing?this.setVertexFlag(e,i,s,t):(this.addTriangle(e,e+1,e+2),this.addTriangle(e,e+2,e+3),this.setVertexFlag(e,i,l,t),this.setVertexFlag(e+1,i,u,t),this.setVertexFlag(e+2,i,d,t),this.setVertexFlag(e+3,i,c,t))},t.prototype.addSegment=function(e,t,n,o,r,a,s,l,c,u,d){var h=n-e,p=o-t,f=0;(h||p)&&(f=Math.atan2(p,h))
var m=Math.sqrt(h*h+p*p)
a*=.5
var v=this.addVertexLine(e,t,f,m,r,a,s,l,u,d)
this.finalizeQuad(v,i,c),this.addToBounds(e,t),this.addToBounds(n,o)},t.prototype.addTriangleGeom=function(e,t,i,n,o,r,s,l,c,u){this.numTriangleGeoms++
var d=this.addVertexTriangleGeom(e,t,i,n,o,r,s,l,c,u)
this.finalizeQuad(d,a,c),this.addToBounds(e,t),this.addToBounds(i,n),this.addToBounds(o,r)},t.prototype.addCircularArc=function(e,t,i,o,r,a,s,l,c,u){this.numCirculars++,0==i&&0==o&&(o=h)
var d=Math.abs(i-o)
if(d>1e-4&&Math.abs(d-h)>1e-4){var p=e+r*Math.cos(i),f=t+r*Math.sin(i)
this.addSegment(p,f,p,f,0,a,s,l,c,u)
var m=e+r*Math.cos(o),v=t+r*Math.sin(o)
this.addSegment(m,v,m,v,0,a,s,l,c,u)}else this.addToBounds(e-r,t-r),this.addToBounds(e+r,t+r)
a*=.5
var g=this.addVertexArc(e,t,i,o,r,r,0,a,s,l,u)
this.finalizeQuad(g,n,c)},t.prototype.addEllipticalArc=function(e,t,i,n,r,a,s,l,c,u,d,p){this.expandStride(),this.numEllipticals++,0==i&&0==n&&(n=h)
var f=Math.abs(i-n)
if(Math.abs(f-h)>1e-4){var m=e+r*Math.cos(i),v=t+a*Math.sin(i)
this.addSegment(m,v,m,v,0,l,c,u,d,p)
var g=e+r*Math.cos(n),E=t+a*Math.sin(n)
this.addSegment(g,E,g,E,0,l,c,u,d,p)}else this.addToBounds(e-r,t-a),this.addToBounds(e+r,t+a)
l*=.5
var y=this.addVertexArc(e,t,i,n,r,a,s,l,c,u,p)
this.finalizeQuad(y,o,d)
var f,m,v,g,E},t.prototype.addTexturedQuad=function(e,t,i,n,o,a,s){var l=.5*n,c=this.addVertexLine(e,t+l,0,i,0,l,4278255615,o,s,0)
this.finalizeQuad(c,r,a),this.addToBounds(e,t),this.addToBounds(e+i,t+n)},t.prototype.isFull=function(e){return e||(e=3),this.useInstancing?4*this.vcount+e>32767:this.vcount+e>32767},t.prototype.toMesh=function(){var e={}
e.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),e.vbstride=this.stride
var t=this.useInstancing?1:0
if(e.vblayout={fields1:{offset:0,itemSize:3,bytesPerItem:4,divisor:t},fields2:{offset:3,itemSize:3,bytesPerItem:4,divisor:t},color4b:{offset:p,itemSize:4,bytesPerItem:1,divisor:t,normalize:!0},dbId4b:{offset:f,itemSize:4,bytesPerItem:1,divisor:t,normalize:!0},linetype4b:{offset:m,itemSize:4,bytesPerItem:1,divisor:t,normalize:!1},flags4b:{offset:v,itemSize:4,bytesPerItem:1,divisor:t,normalize:!1}},this.stride>10&&(e.vblayout.extraParams={offset:10,itemSize:2,bytesPerItem:4,divisor:t,normalize:!1}),this.useInstancing){for(var i in e.vblayout)e.vblayout[i].divisor=1
e.numInstances=this.vcount
var n=new Int32Array(4)
n[0]=l,n[1]=u,n[2]=d,n[3]=c,e.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,normalize:!1,divisor:0},e.vblayout.instFlags4b.array=n.buffer
var o=e.indices=new Uint16Array(6)
o[0]=0,o[1]=1,o[2]=2,o[3]=0,o[4]=2,o[5]=3}else e.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount))
e.dbIds=this.dbIds
var r=this.maxx-this.minx,a=this.maxy-this.miny,s=Math.max(r,a)
e.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-s},max:{x:this.maxx,y:this.maxy,z:.001*s}}
var h=e.boundingSphere={}
return h.center={x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},h.radius=.5*Math.sqrt(r*r+a*a),e},e.VertexBufferBuilder=t}(Autodesk.Viewing.Private),NodeArray.prototype.setLeftChild=function(e,t){this.nodesI[e*this.node_stride+6]=t},NodeArray.prototype.getLeftChild=function(e){return this.nodesI[e*this.node_stride+6]},NodeArray.prototype.setPrimStart=function(e,t){this.is_lean_node?this.nodesI[e*this.node_stride+6]=t:this.nodesI[e*this.node_stride+8]=t},NodeArray.prototype.getPrimStart=function(e){return this.is_lean_node?this.nodesI[e*this.node_stride+6]:this.nodesI[e*this.node_stride+8]},NodeArray.prototype.setPrimCount=function(e,t){this.nodesS[e*this.node_stride_short+14]=t},NodeArray.prototype.getPrimCount=function(e){return this.nodesS[e*this.node_stride_short+14]},NodeArray.prototype.setFlags=function(e,t,i,n){this.nodesS[e*this.node_stride_short+15]=n<<3|i<<2|3&t},NodeArray.prototype.getFlags=function(e){return this.nodesS[e*this.node_stride_short+15]},NodeArray.prototype.setBox0=function(e,t){var i=e*this.node_stride,n=this.nodesF
n[i]=t[0],n[i+1]=t[1],n[i+2]=t[2],n[i+3]=t[3],n[i+4]=t[4],n[i+5]=t[5]},NodeArray.prototype.getBoxThree=function(e,t){var i=e*this.node_stride,n=this.nodesF
t.min.x=n[i],t.min.y=n[i+1],t.min.z=n[i+2],t.max.x=n[i+3],t.max.y=n[i+4],t.max.z=n[i+5]},NodeArray.prototype.setBoxThree=function(e,t){var i=e*this.node_stride,n=this.nodesF
n[i]=t.min.x,n[i+1]=t.min.y,n[i+2]=t.min.z,n[i+3]=t.max.x,n[i+4]=t.max.y,n[i+5]=t.max.z},NodeArray.prototype.makeEmpty=function(e){var t=e*this.node_stride,i=this.nodesI
i[t+6]=-1,i[t+7]=0,this.is_lean_node||(i[t+8]=-1)},NodeArray.prototype.realloc=function(e){if(this.nodeCount+e>this.nodeCapacity){var t=0|3*this.nodeCapacity/2
t<this.nodeCount+e&&(t=this.nodeCount+e)
var i=new ArrayBuffer(t*this.bytes_per_node),n=new Int32Array(i)
n.set(this.nodesI),this.nodeCapacity=t,this.nodesRaw=i,this.nodesF=new Float32Array(i),this.nodesI=n,this.nodesS=new Uint16Array(i)}},NodeArray.prototype.nextNodes=function(e){this.realloc(e)
var t=this.nodeCount
this.nodeCount+=e
for(var i=0;e>i;i++)this.makeEmpty(t+i)
return t},NodeArray.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)}
var BOX_STRIDE=6,POINT_STRIDE=3,BOX_EPSILON=1e-5,BOX_SCALE_EPSILON=1e-5,MAX_DEPTH=15,MAX_BINS=16,BVHModule=function(){"use strict"
function e(e,t,i,n){e[t]=.5*(i[n]+i[n+3]),e[t+1]=.5*(i[n+1]+i[n+4]),e[t+2]=.5*(i[n+2]+i[n+5])}function t(e,t,i){e[0]>t[i]&&(e[0]=t[i]),e[3]<t[i]&&(e[3]=t[i]),e[1]>t[i+1]&&(e[1]=t[i+1]),e[4]<t[i+1]&&(e[4]=t[i+1]),e[2]>t[i+2]&&(e[2]=t[i+2]),e[5]<t[i+2]&&(e[5]=t[i+2])}function i(e,t,i){e[0]>t[i]&&(e[0]=t[i]),e[1]>t[i+1]&&(e[1]=t[i+1]),e[2]>t[i+2]&&(e[2]=t[i+2]),e[3]<t[i+3]&&(e[3]=t[i+3]),e[4]<t[i+4]&&(e[4]=t[i+4]),e[5]<t[i+5]&&(e[5]=t[i+5])}function n(e,t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]>t[2]&&(e[2]=t[2]),e[3]<t[3]&&(e[3]=t[3]),e[4]<t[4]&&(e[4]=t[4]),e[5]<t[5]&&(e[5]=t[5])}function o(e,t,i,n){for(var o=0;3>o;o++)e[t+o]=i[n+3+o]-i[n+o]}function r(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]}function a(e){e[0]=E,e[1]=E,e[2]=E,e[3]=-E,e[4]=-E,e[5]=-E}function s(e,t){var i=e[t+3]-e[t],n=e[t+4]-e[t+1],o=e[t+5]-e[t+2]
return 0>i||0>n||0>o?0:2*(i*n+n*o+o*i)}function l(e){var t=e[3]-e[0],i=e[4]-e[1],n=e[5]-e[2]
return 0>t||0>i||0>n?0:2*(t*i+i*n+n*t)}function c(){this.vb_left=new Float32Array(6),this.vb_right=new Float32Array(6),this.cb_left=new Float32Array(6),this.cb_right=new Float32Array(6),this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1}function u(){this.box_bbox=new Float32Array(6),this.box_centroid=new Float32Array(6),this.num_prims=0}function d(){this.BL=new Float32Array(6),this.CL=new Float32Array(6),this.NL=0,this.AL=0}function h(e,n,o,r,a,s,l){for(var c=e.centroids,u=e.primitives,d=e.boxes,h=l*(1-BOX_SCALE_EPSILON)/s[r],p=a[r],f=e.sort_prims,m=n;o>=m;m++){var v=0|u[m],g=h*(c[3*v+r]-p),E=0|g
0>E?E=0:E>=l&&(E=l-1),f[m]=E,y[E].num_prims++,i(y[E].box_bbox,d,6*v),t(y[E].box_centroid,c,3*v)}}function p(e,t,i,o,a,s,c){if(s[o]<e.scene_epsilon)return void(c.best_cost=1/0)
var u=MAX_BINS
u>i-t+1&&(u=i-t+1)
for(var d=0;u>d;d++)y[d].reset()
for(var d=0;u-1>d;d++)T[d].reset()
for(c.num_bins=u,h(e,t,i,o,a,s,u),r(T[0].BL,y[0].box_bbox),r(T[0].CL,y[0].box_centroid),T[0].AL=l(T[0].BL),T[0].NL=y[0].num_prims,d=1;u-1>d;d++){var p=y[d],f=T[d]
r(f.BL,T[d-1].BL),n(f.BL,p.box_bbox),f.AL=l(f.BL),r(f.CL,T[d-1].CL),n(f.CL,p.box_centroid),f.NL=T[d-1].NL+p.num_prims}d=u-1,r(b,y[d].box_bbox),r(w,y[d].box_centroid)
var m=l(b),v=y[d].num_prims,g=d,E=m*v+T[d-1].AL*T[d-1].NL
for(r(c.vb_right,b),r(c.cb_right,y[d].box_centroid),r(c.vb_left,T[d-1].BL),r(c.cb_left,T[d-1].CL),c.num_left=T[d-1].NL,d-=1;d>=1;d--){var p=y[d]
n(b,p.box_bbox),n(w,p.box_centroid),m=l(b),v+=p.num_prims
var A=m*v+T[d-1].AL*T[d-1].NL
E>=A&&(E=A,g=d,r(c.vb_right,b),r(c.cb_right,w),r(c.vb_left,T[d-1].BL),r(c.cb_left,T[d-1].CL),c.num_left=T[d-1].NL)}c.best_split=g,c.best_cost=E}function f(e,t,i,n,o,r,a){var s,l,c=e.primitives,u=e.sort_prims,d=0,h=0|t,p=0|a.best_split
for(s=t;i>=s;s++){var f=0|c[s],m=u[s]
p>m?c[h++]=f:u[d++]=f}for(l=0;d>l;l++)c[h+l]=u[l]}function m(e,i,n,r,s,l,c,u){var d=e.primitives,h=e.centroids,p=s-r+1
p>e.frags_per_inner_node&&(p=e.frags_per_inner_node),p>u&&(p=u),i.setPrimStart(n,r),i.setPrimCount(n,p),r+=p,a(l)
for(var f=r;s>=f;f++)t(l,h,3*d[f])
o(c,0,l,0)
var m=0
return c[1]>c[0]&&(m=1),c[2]>c[m]&&(m=2),m}function v(e,t,i,n,r,a,s,l){o(_,0,a,0)
var u=e.nodes,d=s?e.frags_per_leaf_node_transparent:e.frags_per_leaf_node,h=s?e.frags_per_inner_node_transparent:e.frags_per_inner_node,v=e.max_polys_per_node,g=0
_[1]>_[0]&&(g=1),_[2]>_[g]&&(g=2),u.setBox0(t,r)
var E=0,y=0
if(e.polygonCounts)for(var A=i;n>=A&&(E+=e.polygonCounts[e.primitives[A]],y++,!(E>v));A++);var T=n-i+1,b=d>=T&&v>E||1===T
if(b||l>MAX_DEPTH||_[g]<e.scene_epsilon)return u.setLeftChild(t,-1),u.setPrimStart(t,i),u.setPrimCount(t,n-i+1),void u.setFlags(t,0,0,s?1:0)
h&&(g=m(e,u,t,i,n,a,_,y),i+=u.getPrimCount(t))
var w=new c
if(p(e,i,n,g,a,_,w),w.num_bins<0)return void u.setPrimCount(t,u.getPrimCount(t)+n-i+1)
f(e,i,n,g,a,_,w)
var x=u.nextNodes(2),C=.5*(w.vb_left[3+g]+w.vb_left[g]),S=.5*(w.vb_right[3+g]+w.vb_right[g])
u.setFlags(t,g,S>C?0:1,s?1:0),u.setLeftChild(t,x),e.recursion_stack.push([e,x+1,i+w.num_left,n,w.vb_right,w.cb_right,s,l+1]),e.recursion_stack.push([e,x,i,i+w.num_left-1,w.vb_left,w.cb_left,s,l+1])}function g(n){var r=n.boxv_o,s=n.boxc_o,l=n.boxv_t,c=n.boxc_t
a(r),a(s),a(l),a(c)
for(var u=n.centroids,d=n.boxes,h=0,p=n.prim_count;p>h;h++)e(u,3*h,d,6*h),h>=n.first_transparent?(t(c,u,3*h),i(l,d,6*h)):(t(s,u,3*h),i(r,d,6*h))
o(_,0,n.boxv_o,0)
var f=Math.max(_[0],_[1],_[2])
n.scene_epsilon=BOX_EPSILON*f}var E=1/0
c.prototype.reset=function(){this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1},u.prototype.reset=function(){this.num_prims=0,a(this.box_bbox),a(this.box_centroid)},d.prototype.reset=function(){this.NL=0,this.AL=0,a(this.BL),a(this.CL)}
for(var y=[],A=0;MAX_BINS>A;A++)y.push(new u)
for(var T=[],A=0;MAX_BINS-1>A;A++)T.push(new d)
var b=new Float32Array(6),w=new Float32Array(6),_=new Float32Array(3)
return{bvh_subdivide:v,compute_boxes:g,box_area:s}}()
BVHBuilder.prototype.sortPrimitives=function(){for(var e=new Float32Array(this.work_buf),t=this.materialDefs,i=this.materials,n=this.primitives,o=0,r=0,a=this.prim_count;a>r;r++){n[r]=r
var s=t&&t[i[r]]?t[i[r]].transparent:!1
s&&o++,l?(e[r]=BVHModule.box_area(this.boxes,BOX_STRIDE*r),s&&(e[r]=-e[r])):e[r]=s?-1:1}var l=!1
if(l)Array.prototype.sort.call(this.primitives,function(t,i){return e[i]-e[t]})
else if(o&&o<this.prim_count){for(var c=new Int32Array(o),u=0,d=0,r=0,a=this.prim_count;a>r;r++)e[r]>=0?n[u++]=n[r]:c[d++]=n[r]
n.set(c,this.prim_count-o)}this.first_transparent=this.prim_count-o},BVHBuilder.prototype.build=function(e){var t=e&&!!e.useSlimNodes
if(t)this.frags_per_leaf_node=1,this.frags_per_inner_node=0,this.frags_per_leaf_node_transparent=1,this.frags_per_inner_node_transparent=0,this.max_polys_per_node=1/0
else{var i=e.isWeakDevice?.5:1
this.frags_per_leaf_node=0|(this.polygonCounts,32*i),this.frags_per_inner_node=0|this.frags_per_leaf_node,this.frags_per_leaf_node_transparent=this.frags_per_leaf_node,this.frags_per_inner_node_transparent=0,this.max_polys_per_node=0|1e4*i}if(this.nodes&&this.nodes.is_lean_node==t)this.nodes.nodeCount=0
else{for(var n=this.prim_count/this.frags_per_leaf_node,o=1;n>o;)o*=2
this.nodes=new NodeArray(o,e?e.useSlimNodes:!1)}this.sortPrimitives(),BVHModule.compute_boxes(this)
var r=this.nodes.nextNodes(2)
for(BVHModule.bvh_subdivide(this,r,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);this.recursion_stack.length;){var a=this.recursion_stack.pop()
BVHModule.bvh_subdivide(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7])}for(BVHModule.bvh_subdivide(this,r+1,this.first_transparent,this.prim_count-1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;){var a=this.recursion_stack.pop()
BVHModule.bvh_subdivide(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7])}},function(){"use strict"
var e=(Autodesk.Viewing,Autodesk.Viewing.Private),t=16,i=32,n=48,o=64,r=80,a=(2*Math.PI,7),s=8,l=9
e.VertexBufferReader=function(e){this.vb=e.vb.buffer,this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.stride=e.vbstride,this.vcount=this.vbf.length/this.stride,this.useInstancing=!1},e.VertexBufferReader.prototype.getIdAt=function(e){return this.vbi[e*this.stride+a]},e.VertexBufferReader.prototype.getVertexFlagAt=function(e){return this.vbi[e*this.stride+l]},e.VertexBufferReader.prototype.getViewportIndexAt=function(e){return this.vbi[e*this.stride+s]>>16},e.VertexBufferReader.prototype.decodeLineAt=function(e,t,i,n){var o=this.stride*e,r=this.vbf[o],a=this.vbf[o+1],s=this.vbf[o+2],l=this.vbf[o+3],c=r+l*Math.cos(s),u=a+l*Math.sin(s)
n.onLineSegment&&n.onLineSegment(r,a,c,u,i)},e.VertexBufferReader.prototype.decodeCircularArcAt=function(e,t,i,n){var o=this.stride*e,r=this.vbf[o],a=this.vbf[o+1],s=this.vbf[o+2],l=this.vbf[o+3],c=this.vbf[o+5]
n.onCircularArc&&n.onCircularArc(r,a,s,l,c,i)},e.VertexBufferReader.prototype.decodeEllipticalArcAt=function(e,t,i,n){var o=this.stride*e,r=this.vbf[o],a=this.vbf[o+1],s=this.vbf[o+2],l=this.vbf[o+3],c=this.vbf[o+5],u=this.vbf[o+10],d=this.vbf[o+11]
n.onEllipticalArc&&n.onEllipticalArc(r,a,s,l,c,u,d,i)},e.VertexBufferReader.prototype.decodeTriangleVertex=function(e,t,i,n){var o=this.stride*e,r=this.vbf[o],a=this.vbf[o+1]
n.onTriangleVertex&&n.onTriangleVertex(r,a,i)},e.VertexBufferReader.prototype.enumGeomsForObject=function(e,a){for(var s=0;s<this.vcount;){var l=this.getVertexFlagAt(s),c=240&l,u=15&l,d=l>>16&255,h=this.getViewportIndexAt(s)
if(this.getIdAt(s)===e)switch(c){case t:this.decodeLineAt(s,d,h,a)
break
case i:this.decodeCircularArcAt(s,d,h,a)
break
case n:this.decodeEllipticalArcAt(s,d,h,a)
break
case o:break
case r:break
case 0:this.decodeTriangleVertex(s,d,h,a)}s+=u&&c?4:1}}}()
var OUTSIDE=0,INTERSECTS=1,CONTAINS=2
!function(){"use strict"
function e(){this.frustum=new THREE.Frustum,this.viewProj=new THREE.Matrix4,this.viewDir=[0,0,1],this.ar=1,this.viewport=new THREE.Vector3(1,1,1),this.areaConv=1,this.areaCullThreshold=1}e.prototype.reset=function(e){this.viewProj.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.frustum.setFromMatrix(this.viewProj)
var t=e.matrixWorldInverse.elements
this.ar=e.aspect,this.viewDir[0]=-t[2],this.viewDir[1]=-t[6],this.viewDir[2]=-t[10],this.areaConv=e.clientWidth*e.clientHeight/4},e.prototype.projectedArea=function(){function e(){i||(i=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],n=new THREE.Box2)}function t(e,t){var i=e.x,n=e.y,o=e.z,r=t.elements,a=r[3]*i+r[7]*n+r[11]*o+r[15]
0>a&&(a=-a)
var s=1/a
e.x=(r[0]*i+r[4]*n+r[8]*o+r[12])*s,e.y=(r[1]*i+r[5]*n+r[9]*o+r[13])*s}var i,n
return function(o){e()
var r=this.viewProj
i[0].set(o.min.x,o.min.y,o.min.z),i[1].set(o.min.x,o.min.y,o.max.z),i[2].set(o.min.x,o.max.y,o.min.z),i[3].set(o.min.x,o.max.y,o.max.z),i[4].set(o.max.x,o.min.y,o.min.z),i[5].set(o.max.x,o.min.y,o.max.z),i[6].set(o.max.x,o.max.y,o.min.z),i[7].set(o.max.x,o.max.y,o.max.z)
for(var a=0;8>a;a++)t(i[a],r)
return n.makeEmpty(),n.setFromPoints(i),n.min.x<-1&&(n.min.x=-1),n.min.x>1&&(n.min.x=1),n.min.y<-1&&(n.min.y=-1),n.min.y>1&&(n.min.y=1),n.max.x>1&&(n.max.x=1),n.max.x<-1&&(n.max.x=-1),n.max.y>1&&(n.max.y=1),n.max.y<-1&&(n.max.y=-1),(n.max.x-n.min.x)*(n.max.y-n.min.y)}}(),e.prototype.estimateDepth=function(e){var t=this.viewProj.elements,i=e.min.x,n=e.min.y,o=e.min.z,r=1/(t[3]*i+t[7]*n+t[11]*o+t[15]),a=(t[2]*i+t[6]*n+t[10]*o+t[14])*r
i=e.max.x,n=e.max.y,o=e.max.z,r=1/(t[3]*i+t[7]*n+t[11]*o+t[15])
var s=(t[2]*i+t[6]*n+t[10]*o+t[14])*r
return Math.min(a,s)},e.prototype.intersectsBox=function(){function e(){t||(t=new THREE.Vector3,i=new THREE.Vector3)}var t,i
return function(n){e()
for(var o=this.frustum.planes,r=0,a=0;6>a;a++){var s=o[a]
t.x=s.normal.x>0?n.min.x:n.max.x,i.x=s.normal.x>0?n.max.x:n.min.x,t.y=s.normal.y>0?n.min.y:n.max.y,i.y=s.normal.y>0?n.max.y:n.min.y,t.z=s.normal.z>0?n.min.z:n.max.z,i.z=s.normal.z>0?n.max.z:n.min.z
var l=s.distanceToPoint(t),c=s.distanceToPoint(i)
if(0>l&&0>c)return OUTSIDE
l>0&&c>0&&r++}return 6==r?CONTAINS:INTERSECTS}}(),Autodesk.Viewing.Private.FrustumIntersector=e}()
var VBIntersector=function(){"use strict"
function e(){a||(a=new THREE.Matrix4,s=new THREE.Ray,l=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3)}function t(t,i,n){e()
var o=t.geometry,r=t.material,d=r?r.side:THREE.FrontSide,h=o.attributes
a.getInverse(t.matrixWorld),s.copy(i.ray).applyMatrix4(a)
var p,f,m,v=i.precision
if(void 0!==h.index){var g=h.index.array||o.ib,E=o.vb?o.vb:h.position.array,y=o.vb?o.vbstride:3,A=o.offsets
A&&0!==A.length||(A=[{start:0,count:g.length,index:0}])
for(var T=0,b=A.length;b>T;++T)for(var w=A[T].start,_=A[T].count,x=A[T].index,C=w,S=w+_;S>C;C+=3){p=x+g[C],f=x+g[C+1],m=x+g[C+2],l.fromArray(E,p*y),c.fromArray(E,f*y),u.fromArray(E,m*y)
var R
if(R=d===THREE.BackSide?s.intersectTriangle(u,c,l,!0):s.intersectTriangle(l,c,u,d!==THREE.DoubleSide),null!==R){R.applyMatrix4(t.matrixWorld)
var M=i.ray.origin.distanceTo(R)
v>M||M<i.near||M>i.far||n.push({distance:M,point:R,face:new THREE.Face3(p,f,m,THREE.Triangle.normal(l,c,u)),faceIndex:null,fragId:t.fragId,dbId:t.dbId})}}}else for(var E=o.vb?o.vb:h.position.array,y=o.vb?o.vbstride:3,C=0,P=0,S=E.length;S>C;C+=3,P+=9){if(p=C,f=C+1,m=C+2,l.fromArray(E,p*y),c.fromArray(E,f*y),u.fromArray(E,m*y),r.side===THREE.BackSide)var R=s.intersectTriangle(u,c,l,!0)
else var R=s.intersectTriangle(l,c,u,r.side!==THREE.DoubleSide)
if(null!==R){R.applyMatrix4(t.matrixWorld)
var M=i.ray.origin.distanceTo(R)
v>M||M<i.near||M>i.far||n.push({distance:M,point:R,face:new THREE.Face3(p,f,m,THREE.Triangle.normal(l,c,u)),faceIndex:null,fragId:t.fragId,dbId:t.dbId})}}}function i(t,i,n){e()
var o=i.linePrecision,r=o*o,l=t.geometry
a.getInverse(t.matrixWorld),s.copy(i.ray).applyMatrix4(a)
var c=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Vector3,h=new THREE.Vector3,p=t.mode===THREE.LineStrip?1:2
if(l instanceof THREE.BufferGeometry){var f=l.attributes
if(void 0!==f.index){var m=l.ib?l.ib:f.index.array,v=l.vb?l.vb:f.position.array,g=l.vb?l.vbstride:3,E=l.offsets
E&&0!==E.length||(E=[{start:0,count:m.length,index:0}])
for(var y=0;y<E.length;y++)for(var A=E[y].start,T=E[y].count,b=E[y].index,w=A;A+T-1>w;w+=p){var _=b+m[w],x=b+m[w+1]
c.fromArray(v,_*g),u.fromArray(v,x*g)
var C=s.distanceSqToSegment(c,u,h,d)
if(!(C>r)){var S=s.origin.distanceTo(h)
S<i.near||S>i.far||n.push({distance:S,point:d.clone().applyMatrix4(t.matrixWorld),face:null,faceIndex:null,fragId:t.fragId,dbId:t.dbId})}}}else for(var v=l.vb?l.vb:f.position.array,g=l.vb?l.vbstride:3,w=0;w<v.length/g-1;w+=p){c.fromArray(v,g*w),u.fromArray(v,g*w+g)
var C=s.distanceSqToSegment(c,u,h,d)
if(!(C>r)){var S=s.origin.distanceTo(h)
S<i.near||S>i.far||n.push({distance:S,point:d.clone().applyMatrix4(t.matrixWorld),face:null,faceIndex:null,fragId:t.fragId,dbId:t.dbId})}}}}function n(e,n,o){e.isLine?i(e,n,o):t(e,n,o)}function o(e,t,i,r){if(e instanceof THREE.Mesh?n(e,t,i):e.raycast(t,i),r===!0)for(var a=e.children,s=0,l=a.length;l>s;s++)o(a[s],t,i,!0)}function r(e,t,i,n){o(e,t,i,n),i.sort(d)}var a,s,l,c,u,d=function(e,t){return e.distance-t.distance}
return{meshRayCast:t,lineRayCast:i,rayCast:n,intersectObject:r}}(),BufferGeometryUtils=function(){"use strict"
function e(e,t,i){var n
if(t.array)n=new THREE.BufferAttribute(t.array,t.itemSize)
else{var o=e+"|"+t.bytesPerItem+"|"+t.normalize+"|"+t.isPattern+"|"+t.divisor+"|"+t.offset
if(n=l[o])return n
n=new THREE.BufferAttribute(void 0,t.itemSize),l[o]=n}return n.bytesPerItem=t.bytesPerItem,n.normalize=t.normalize,n.isPattern=t.isPattern,i&&(n.divisor=t.divisor),t.array?geometry.byteSize+=t.array.byteLength:t.hasOwnProperty("offset")?n.itemOffset=t.offset:stderr("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton."),n}function t(e){var t=""
for(var i in e.attributes)t+=i+"|"
var n=c[t]
return n?n:(n=Object.keys(e.attributes),c[t]=n,n)}function i(){r=new THREE.BufferAttribute(void 0,1),a=function(){THREE.BufferGeometry.call(this),this.uuid=null,this.name=null,this.numInstances=void 0,this.streamingDraw=!1,this.streamingIndex=!1,this.svfid=void 0,this.vb=null,this.vbbuffer=void 0,this.ib=null,this.ibbuffer=void 0,this.vaos=void 0,this.vbNeedsUpdate=!1,this.vbstride=0,this.byteSize=0,this.attributesKeys=void 0,this.__webglInit=!1},a.prototype=Object.create(THREE.BufferGeometry.prototype),a.prototype.constructor=a}function n(){return a||i(),new a}function o(i){var o=i.mesh,a=n()
a.byteSize=0,a.vb=o.vb,a.vbbuffer=void 0,a.vbNeedsUpdate=!0,a.byteSize+=o.vb.byteLength,a.vbstride=o.vbstride,o.isLines&&(a.isLines=o.isLines),i.is2d&&(a.is2d=!0),a.numInstances=o.numInstances
for(var l in o.vblayout){var c=o.vblayout[l]
a.attributes[l]=e(l,c,a.numInstances)}s.memoryOptimizedLoading?(a.attributes.index=r,a.ib=o.indices,a.ibbuffer=void 0):a.addAttribute("index",new THREE.BufferAttribute(o.indices,1)),a.attributesKeys=t(a),a.byteSize+=o.indices.byteLength,o.vb.length/o.vbstride>65535&&stderr("Mesh with >65535 vertices. It will fail to draw."),a.boundingBox=(new THREE.Box3).copy(o.boundingBox),a.boundingSphere=(new THREE.Sphere).copy(o.boundingSphere),a.drawcalls=null,a.offsets=null,i.geometry=a,i.mesh=null}var r,a,s=Autodesk.Viewing.Private,l={},c={}
return{meshToGeometry:o}}()
!function(){"use strict"
function e(e){this.geoms=[null],this.numGeomsInMemory=0,this.geomMemory=0,this.gpuMeshMemory=0,this.gpuNumMeshes=0,this.geomPolyCount=0,this.instancePolyCount=0,this.is2d=e.is2d(),this.svf=e.getData()
var i=this.svf.geomMetadata?this.svf.geomMetadata.primCounts.length:0
if(this.geomBoxes=new Float32Array(6*Math.max(1,i)),this.svf.packFileTotalSize){var n=this.svf.packFileTotalSize-3*this.svf.primitiveCount*2
n<=t.GPU_MEMORY_LIMIT&&i<t.GPU_OBJECT_LIMIT&&(this.svf.disableStreaming=!0)}}var t=Autodesk.Viewing.Private
e.prototype.getGeometry=function(e){return this.geoms[e]},e.prototype.addGeometry=function(e,i,n){var o=t.GPU_MEMORY_LIMIT,r=2*o,a=t.GPU_OBJECT_LIMIT
if(this.isf2d&&(r*=2),this.disableStreaming||this.gpuMeshMemory<o&&this.geoms.length<a)e.streamingDraw=!1,e.streamingIndex=!1
else if(this.gpuMeshMemory>=r)e.streamingDraw=!0,e.streamingIndex=!0
else{var s
s=this.is2d?100001:e.byteSize*(i||1),1e5>s&&(e.streamingDraw=!0,e.streamingIndex=!0)}if(e.streamingDraw||(this.gpuMeshMemory+=e.byteSize,this.gpuNumMeshes+=1),this.numGeomsInMemory++,(void 0===n||0>=n)&&(n=this.geoms.length),this.geoms[n]=e,this.geomBoxes.length/6<this.geoms.length){var l=new Float32Array(6*(3*this.geoms.length/2))
l.set(this.geomBoxes),this.geomBoxes=l}var c=e.boundingBox
this.geomBoxes[6*n]=c.min.x,this.geomBoxes[6*n+1]=c.min.y,this.geomBoxes[6*n+2]=c.min.z,this.geomBoxes[6*n+3]=c.max.x,this.geomBoxes[6*n+4]=c.max.y,this.geomBoxes[6*n+5]=c.max.z,t.memoryOptimizedLoading&&!this.is2d&&(e.boundingBox=null,e.boundingSphere=null),this.geomMemory+=e.byteSize
var u=e.attributes.index.array||e.ib,d=u.length/3
return this.svf.geomPolyCount=this.geomPolyCount+=d,this.instancePolyCount+=d*(i||1),e.svfid=n,n},e.prototype.removeGeometry=function(e){var t=this.getGeometry(e)
if(!t)return 0
var i=t.byteSize
return this.geoms[e]=null,this.numGeomsInMemory--,i},e.prototype.getModelBox=function(e,t){if(!this.geoms[e])return void t.makeEmpty()
var i=6*e,n=this.geomBoxes
t.min.x=n[i],t.min.y=n[i+1],t.min.z=n[i+2],t.max.x=n[i+3],t.max.y=n[i+4],t.max.z=n[i+5]},e.prototype.dispose=function(e){for(var t=0,i=this.geoms.length;i>t;t++)this.geoms[t]&&e.deallocateGeometry(this.geoms[t])},e.prototype.printStats=function(){stderr("Total geometry size: "+this.geomMemory/1048576+" MB"),stderr("Number of meshes: "+this.geoms.length),stderr("Num Meshes on GPU: "+this.gpuNumMeshes),stderr("Net GPU geom memory used: "+this.gpuMeshMemory)},Autodesk.Viewing.Private.GeometryList=e}(),function(){"use strict"
function e(e,t,i,n){this.root=e,this.rootId=e.dbId,this.maxDepth=n,this.boxes=t,this.objectCount=i,this.nodeflags=new Int32Array(i+1),this.numHidden=0,this.numOff=0,this.createDbIdToNodeMapping()}var t=0,i=2,n=3,o=4,r=5,a=6,s=7,l=1073741824,c=2147483648,u=Autodesk.Viewing
u.SelectionMode={LEAF_OBJECT:0,FIRST_OBJECT:1,LAST_OBJECT:2},e.prototype.createDbIdToNodeMapping=function(){if(this.root){this.dbIdToNode=new Array(this.objectCount+1)
var e=this.dbIdToNode,i=this.nodeflags
!function n(o){o.dbId>=i.length&&console.warn("unexpected dbId "+o.dbId),e[o.dbId]=o
var r=o.children,s=o.flags
if(void 0!==s)i[o.dbId]=s
else{var l=r?t:a
o.flags=i[o.dbId]=l}if(r)for(var c=0;c<r.length;c++)n(r[c])}(this.root)}},e.prototype.setFlagNode=function(e,t,i){var n=this.nodeflags[e]
return!!(n&t)==i?!1:(i?this.nodeflags[e]=n|t:this.nodeflags[e]=n&~t,!0)},e.prototype.setFlagGlobal=function(e,t){var i=this.nodeflags,n=0,o=i.length
if(t)for(;o>n;n++)i[n]=i[n]|e
else for(var r=~e;o>n;n++)i[n]=i[n]&r},e.prototype.setNodeOff=function(e,t){var i=this.setFlagNode(e,l,t)
return i&&(t?this.numOff++:this.numOff--),i},e.prototype.isNodeOff=function(e){return!!(this.nodeflags[e]&l)},e.prototype.setNodeHidden=function(e,t){var i=this.setFlagNode(e,c,t)
return i&&(t?this.numHidden++:this.numHidden--),i},e.prototype.isNodeHidden=function(e){return!!(this.nodeflags[e]&c)},e.prototype.getNodeType=function(e){return this.nodeflags[e]&s},e.prototype.getNodeParentId=function(e){return this.dbIdToNode[e].parent},e.prototype.getRootId=function(){return this.rootId},e.prototype.getNodeName=function(e){return this.dbIdToNode[e].name},e.prototype.getChildCount=function(e){var t=this.dbIdToNode[e]
return t&&t.children?t.children.length:0},e.prototype.enumNodeFragments=function(e,t,i){function n(e){var o=r.dbIdToNode[e]
if(void 0!==o){var a=o.fragIds
if(void 0!==a){Array.isArray(a)||t(a)
for(var s=0;s<a.length;++s)t(a[s])}i&&r.enumNodeChildren(e,function(e){n(e)})}}var o
o="number"==typeof e?e:e.dbId
var r=this
n(o)},e.prototype.enumNodeChildren=function(e,t,i){function n(e){var o=r.dbIdToNode[e]
if(void 0!==o){if(!o.children)return
for(var a=0;a<o.children.length;a++){var s=o.children[a].dbId
t(s),i&&n(s)}}}var o
o="number"==typeof e?e:e.dbId
var r=this
i&&t(o),n(o)},e.prototype.findNodeForSelection=function(e,t){if(t===u.SelectionMode.LEAF_OBJECT)return e
var a=e
if(t===u.SelectionMode.FIRST_OBJECT){for(var s=[],l=e;l;)s.push(l),l=this.getNodeParentId(l)
for(var c=s.length-1;c>=0;c--){var d=this.getNodeType(s[c])
if(d!==r&&d!==i&&d!==n){a=s[c]
break}}}else if(t===u.SelectionMode.LAST_OBJECT)for(var l=e;l;){var d=this.getNodeType(l)
if(d===o){a=l
break}l=this.getNodeParentId(l)}return a},Autodesk.Viewing.Private.InstanceTree=e}()
var MESH_VISIBLE=1,MESH_HIGHLIGHTED=2,MESH_HIDE=4,MESH_ISLINE=8,MESH_MOVED=16,MESH_TRAVERSED=32,MESH_RENDERFLAG=128
!function(){"use strict"
function e(e,t,n){this.fragments=e,this.svfLoader=n
var o=this.fragments.length
this.geoms=t,this.isFixedSize=this.fragments.length>0,this.isFixedSize?(this.boxes=this.fragments.boxes,this.transforms=this.fragments.transforms,this.useThreeMesh=!i.memoryOptimizedLoading):(this.boxes=null,this.transforms=null,this.useThreeMesh=!0),0>=o&&(o=1),this.vizmeshes=new Array(o),this.vizflags=new Uint8Array(o),this.geomids=new Int32Array(o),this.materialids=new Int32Array(o),this.materialmap={},this.reachLimit=!1,this.traversedGeom=[],this.culledGeom=[],this.geomidsmap={},this.animxforms=null
for(var r=0;o>r;r++)this.vizflags[r]=1,this.geomids[r]=-1
this.allVisible=!0,this.allVisibleDirty=!1,this.nextAvailableFragID=o}function t(e,t){this.frags=e,this.fragId=t,this.scale=null,this.quaternion=null,this.position=null}var i=Autodesk.Viewing.Private
e.prototype.getNextAvailableFragmentId=function(){return this.nextAvailableFragID++},e.prototype.fragmentsHaveBeenAdded=function(){return this.vizflags.length>this.fragments.length},e.prototype.getSvfMaterialId=function(e){var t=this.getMaterial(e)
return t?t.svfMatId:void 0},e.prototype.requireGeometry=function(e){var t=null,i=this.geomids[e]
if(i>=0&&(t=this.geoms.getGeometry(i)),null==t&&!this.reachLimit){var n=this.fragments.packIds[e]
this.svfLoader.loadGeometryPackOnDemand(n)}return t},e.prototype.setMesh=function(e,t,i){var n=this.vizmeshes[e]
if(n&&n.parent&&n.parent.remove(n),this.vizflags.length<=e){this.isFixedSize&&(console.warn("Attempting to resize a fragments list that was initialized with fixed data. This will have a performance impact."),this.isFixedSize=!1)
var o=Math.ceil(1.5*this.vizflags.length)
this.useThreeMesh&&o<this.vizmeshes.length&&(o=this.vizmeshes.length)
var r=new Uint8Array(o)
if(r.set(this.vizflags),this.vizflags=r,this.transforms){var a=new Float32Array(12*o)
a.set(this.transforms),this.transforms=a}if(this.boxes){var s=new Float32Array(6*o)
s.set(this.boxes),this.boxes=s}if(this.geomids){var l=new Int32Array(o)
l.set(this.geomids),this.geomids=l}if(this.materialids){var c=new Int32Array(o)
c.set(this.materialids),this.materialids=c}}if(this.useThreeMesh?(this.vizmeshes[e]=t,t.fragId=e,t.dbId=0|this.fragments.fragId2dbId[e]):(this.geomids[e]=t.geometry.svfid,this.materialids[e]=t.material.id,this.materialmap[t.material.id]||(this.materialmap[t.material.id]=t.material)),this.vizflags[e]=1|(t.isLine?MESH_ISLINE:0),i){var u=t.matrixWorld,d=12*e,h=u.elements,p=this.transforms
p[d]=h[0],p[d+1]=h[1],p[d+2]=h[2],p[d+3]=h[4],p[d+4]=h[5],p[d+5]=h[6],p[d+6]=h[8],p[d+7]=h[9],p[d+8]=h[10],p[d+9]=h[12],p[d+10]=h[13],p[d+11]=h[14]
var f=new THREE.Box3
t.geometry&&t.geometry.boundingBox?f.copy(t.geometry.boundingBox):this.geoms.getModelBox(this.geomids[e],f),f.applyMatrix4(u)
var m=6*e,v=this.boxes
v[m]=f.min.x,v[m+1]=f.min.y,v[m+2]=f.min.z,v[m+3]=f.max.x,v[m+4]=f.max.y,v[m+5]=f.max.z}},e.prototype.isFlagSet=function(e,t){return!!(this.vizflags[e]&t)},e.prototype.setFlagFragment=function(e,t,i){var n=this.vizflags[e]
return!!(n&t)==i?!1:(i?this.vizflags[e]=n|t:this.vizflags[e]=n&~t,!0)},e.prototype.setFlagGlobal=function(e,t){var i=this.vizflags,n=0,o=i.length
if(t)for(;o>n;n++)i[n]=i[n]|e
else for(var r=~e;o>n;n++)i[n]=i[n]&r},e.prototype.hideLines=function(e){var t=MESH_HIDE,i=this.vizflags,n=0,o=i.length
if(e)for(;o>n;n++)i[n]&MESH_ISLINE&&(i[n]=i[n]|t)
else for(var r=~t;o>n;n++)i[n]&MESH_ISLINE&&(i[n]=i[n]&r)
this.allVisibleDirty=!0},e.prototype.isFragVisible=function(e){return 1==(3&this.vizflags[e])},e.prototype.isFragOff=function(e){return!!(this.vizflags[e]&MESH_HIDE)},e.prototype.isLine=function(e){return!!(this.vizflags[e]&MESH_ISLINE)},e.prototype.areAllVisible=function(){if(this.allVisibleDirty){for(var e=this.vizflags,t=!0,i=0,n=e.length;n>i;i++)if(0===(1&e[i])){t=!1
break}this.allVisible=t,this.allVisibleDirty=!1}return this.allVisible},e.prototype.getVizmesh=function(){function e(){t||(t=new THREE.Mesh(void 0,void 0,!0),t.isTemp=!0,t.dbId=0,t.fragId=-1)}var t
return function(i){return this.useThreeMesh?this.vizmeshes[i]:(e(),t.geometry=this.getGeometry(i),t.material=this.getMaterial(i),t.dbId=this.getDbIds(i),t.fragId=i,t.visible=!0,t.isLine=this.isLine(i),t.hide=this.isFragOff(i),this.getWorldMatrix(i,t.matrixWorld),t)}}(),e.prototype.getMaterialId=function(e){return this.useThreeMesh?this.vizmeshes[e].material.id:this.materialids[e]},e.prototype.getMaterial=function(e){return this.useThreeMesh?this.vizmeshes[e].material:this.materialmap[this.materialids[e]]},e.prototype.getGeometry=function(e){return this.useThreeMesh?this.vizmeshes[e].geometry:this.geoms.getGeometry(this.geomids[e])},e.prototype.getGeometryId=function(e){return this.useThreeMesh?e:this.geomids[e]},e.prototype.setMaterial=function(e,t){this.useThreeMesh?this.vizmeshes[e].material=t:(this.materialids[e]=t.id,this.materialmap[t.id]=t)},e.prototype.getCount=function(){return this.vizflags.length},e.prototype.getDbIds=function(e){return this.fragments.fragId2dbId[e]},e.prototype.dispose=function(e){var t={type:"dispose"}
if(this.useThreeMesh)for(var i={type:"removed"},n=0;n<this.vizmeshes.length;n++){var o=this.vizmeshes[n]
o&&(o.dispatchEvent(i),o.geometry.dispatchEvent(t))}else this.geoms.dispose(e)},e.prototype.setVisibility=function(e,t){this.setFlagFragment(e,MESH_VISIBLE,t),this.allVisibleDirty=!0},e.prototype.setFragOff=function(e,t){this.setFlagFragment(e,MESH_HIDE,t),this.allVisibleDirty=!0},e.prototype.setAllVisibility=function(e){this.setFlagGlobal(MESH_VISIBLE,e),this.allVisible=e,this.allVisibleDirty=!1},e.prototype.updateAnimTransform=function(e,t,i,n){var o=this.animxforms
if(!o){var r=this.getCount()
o=this.animxforms=new Float32Array(10*r)
for(var a=0;r>a;a++){var s=10*a
o[s]=1,o[s+1]=1,o[s+2]=1,o[s+3]=0,o[s+4]=0,o[s+5]=0,o[s+6]=1,o[s+7]=0,o[s+8]=0,o[s+9]=0}}var s=10*e,l=!1
t&&(o[s]=t.x,o[s+1]=t.y,o[s+2]=t.z,l=!0),i&&(o[s+3]=i.x,o[s+4]=i.y,o[s+5]=i.z,o[s+6]=i.w,l=!0),n&&(o[s+7]=n.x,o[s+8]=n.y,o[s+9]=n.z,l=!0),this.setFlagFragment(e,MESH_MOVED,l),l||(o[s]=1,o[s+1]=1,o[s+2]=1,o[s+3]=0,o[s+4]=0,o[s+5]=0,o[s+6]=1,o[s+7]=0,o[s+8]=0,o[s+9]=0)},e.prototype.getAnimTransform=function(e,t,i,n){if(!this.animxforms)return!1
if(!this.isFlagSet(e,MESH_MOVED))return!1
var o=10*e,r=this.animxforms
return t&&(t.x=r[o],t.y=r[o+1],t.z=r[o+2]),i&&(i.x=r[o+3],i.y=r[o+4],i.z=r[o+5],i.w=r[o+6]),n&&(n.x=r[o+7],n.y=r[o+8],n.z=r[o+9]),!0},e.prototype.getOriginalWorldMatrix=function(e,t){var i=12*e,n=t.elements,o=this.transforms
if(o)n[0]=o[i],n[1]=o[i+1],n[2]=o[i+2],n[3]=0,n[4]=o[i+3],n[5]=o[i+4],n[6]=o[i+5],n[7]=0,n[8]=o[i+6],n[9]=o[i+7],n[10]=o[i+8],n[11]=0,n[12]=o[i+9],n[13]=o[i+10],n[14]=o[i+11],n[15]=1
else if(this.useThreeMesh){var r=this.getVizmesh(e)
r?t.copy(r.matrixWorld):t.identity()}else t.identity()},e.prototype.getWorldMatrix=function(){function e(){t=new THREE.Matrix4,i=new THREE.Vector3,n=new THREE.Quaternion,o=new THREE.Vector3}var t,i,n,o
return function(r,a){t||e(),this.getOriginalWorldMatrix(r,a),this.isFlagSet(r,MESH_MOVED)&&(this.getAnimTransform(r,o,n,i),t.compose(i,n,o),a.multiplyMatrices(t,a))}}(),e.prototype.getWorldBounds=function(){function e(){t=new THREE.Matrix4}var t
return function(i,n){if(t||e(),this.boxes&&!this.isFlagSet(i,MESH_MOVED)){var o=this.boxes,r=6*i
return n.min.x=o[r],n.min.y=o[r+1],n.min.z=o[r+2],n.max.x=o[r+3],n.max.y=o[r+4],void(n.max.z=o[r+5])}if(this.getWorldMatrix(i,t),this.useThreeMesh){var a=this.getVizmesh(i)
a&&a.geometry&&n.copy(a.geometry.boundingBox)}else this.geoms.getModelBox(this.geomids[i],n)
n.empty()||n.applyMatrix4(t)}}(),Autodesk.Viewing.Private.FragmentList=e,t.prototype.getWorldMatrix=function(e){return this.frags.getWorldMatrix(this.fragId,e)},t.prototype.getWorldBounds=function(e){return this.frags.getWorldBounds(this.fragId,e)},t.prototype.getAnimTransform=function(){return this.scale||(this.scale=new THREE.Vector3(1,1,1),this.quaternion=new THREE.Quaternion(0,0,0,1),this.position=new THREE.Vector3(0,0,0)),this.frags.getAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},t.prototype.updateAnimTransform=function(){return this.scale||(this.scale=new THREE.Vector3(1,1,1),this.quaternion=new THREE.Quaternion(0,0,0,1),this.position=new THREE.Vector3(0,0,0)),this.frags.updateAnimTransform(this.fragId,this.scale,this.quaternion,this.position)},t.prototype.getMaterial=function(){return this.frags.getMaterial(this.fragId)},t.prototype.setMaterial=function(e){return this.frags.setMaterial(this.fragId,e)},Autodesk.Viewing.Private.FragmentPointer=t}(),function(){"use strict"
function e(){o||(o=new THREE.Box3)}function t(t,i,n,o){this.frags=t,this.indices=i,this.start=n,this.count=o,this.lastItem=n,this.overrideMaterial=null,this.sortDone=!1,this.avgFrameTime=void 0,this.numAdded=0,this.boundingBox=new THREE.Box3,this.boundingBoxHidden=new THREE.Box3,this.sortObjects=!1,this.sortDone=!1,this.depths=null,this.indicesView=null,this.frustumCulled=!0,this.forceVisible=!1,this.renderImmediate=!t.useThreeMesh,this.renderImportance=0,e()}function i(e,t,i){var n,o=127&t[i]
switch(e){case RENDER_HIDDEN:n=!(o&MESH_VISIBLE)
break
case RENDER_HIGHLIGHTED:n=o&MESH_HIGHLIGHTED
break
default:n=1==(o&(MESH_VISIBLE|MESH_HIGHLIGHTED|MESH_HIDE))}return t[i]=o|(n?MESH_RENDERFLAG:0),n}function n(e,t,i,n){var r=!1
return i.getWorldBounds(n,o),e&&!t.intersectsBox(o)&&(r=!0),r}var o,r=Autodesk.Viewing.Private
t.prototype.getIndices=function(){return Array.isArray(this.indices)?this.indices[0]:this.indices},t.prototype.sortByMaterial=function(){if(!(this.numAdded<this.count)){var e=this.frags,t=this.getIndices()
t||stderr("Only indexed RenderSubsets can be sorted.")
var i=t.subarray(this.start,this.start+this.count)
Array.prototype.sort.call(i,function(i,n){var o=e.getMaterialId(t[i]),r=e.getMaterialId(t[n])
return void 0===o?r?1:0:void 0===r?-1:o-r}),this.numAdded=0,this.sortDone=!0}},t.prototype.sortByDepth=function(){function e(e,t){i.getGeometry(e)?(i.getWorldBounds(e,a),s[t]=r.estimateDepth(a)):s[t]=-(1/0)}function t(e,t){return s[t]-s[e]}var i,n,r,a,s
return function(l){i=this.frags,n=this.getIndices(),r=l,a=o,n||stderr("Only indexed RenderSubsets can be sorted."),(!this.indicesView||this.indicesView.length<this.count)&&(this.indicesView=n.subarray(this.start,this.start+this.count)),(!this.depths||this.depths.length<this.count)&&(this.depths=new Float32Array(this.count)),s=this.depths,this.forEachNoMesh(e),Array.prototype.sort.call(this.indicesView,t)}}(),t.prototype.onFragmentAdded=function(){return function(e){this.frags.getWorldBounds(e,o),this.boundingBox.union(o),this.sortDone=!1,this.lastItem<=e&&(this.lastItem=e+1,this.numAdded++)}}(),r.pageOutGeometryEnabled?t.prototype.forEach=function(e,t,i){for(var n=this.getIndices(),o=this.frags,a=o.getCount()>r.FRAGS_PERSISTENT_MAX_COUNT,s=this.start,l=this.lastItem;l>s;s++){var c=n?n[s]:s
if(a){if(o.isFlagSet(c,MESH_TRAVERSED)&&t==MESH_RENDERFLAG)continue
var u=o.getVizmesh(c)
if(!i&&t&&o.isFlagSet(c,t))if(u.geometry){if(t==MESH_RENDERFLAG&&o.setFlagFragment(c,MESH_TRAVERSED,!0),c>r.FRAGS_PERSISTENT_COUNT){var d=o.geomids[c],h=!0,p=o.geomidsmap[d]
null!=p&&(p.t++,h=p.n==p.t),h&&o.traversedGeom.push(d)}}else u.geometry=o.requireGeometry(c)}else var u=o.getVizmesh(c)
!(i||u&&u.geometry)||t&&!o.isFlagSet(c,t)||e(u,c)}}:t.prototype.forEach=function(e,t,i){for(var n=this.getIndices(),o=this.frags,r=this.start,a=this.lastItem;a>r;r++){var s=n?n[r]:r,l=o.getVizmesh(s)
!(i||l&&l.geometry)||t&&!o.isFlagSet(s,t)||e(l,s)}},t.prototype.forEachNoMesh=function(e,t,i){for(var n=this.getIndices(),o=this.frags,r=this.start,a=this.lastItem;a>r;r++){var s,l=n?n[r]:r
if(o.useThreeMesh){var c=o.getVizmesh(l)
c&&(s=c.geometry)}else s=o.getGeometry(l)
!i&&!s||t&&!o.isFlagSet(l,t)||e(l,r-this.start)}},t.prototype.raycast=function(){return function(e,t){if(e.ray.isIntersectionBox(this.boundingBox)!==!1){var i=this,n=o
this.forEach(function(o,r){i.frags.getWorldBounds(r,n),e.ray.isIntersectionBox(n)&&VBIntersector.rayCast(o,e,t)},MESH_VISIBLE)}}}(),t.prototype.calculateBounds=function(){function e(e){r.getWorldBounds(e,a)
var o=t[e]
1&o?i.union(a):n.union(a)}var t,i,n,r,a
return function(){this.boundingBox.makeEmpty(),this.boundingBoxHidden.makeEmpty(),t=this.frags.vizflags,i=this.boundingBox,n=this.boundingBoxHidden,r=this.frags,a=o,this.forEachNoMesh(e)}}(),r.pageOutGeometryEnabled||r.onDemandLoading?t.prototype.applyVisibility=function(){function e(e,d){if(!e&&t.useThreeMesh)return void(l&&l(d))
var h=n(c,a,t,d)
if(h){if(e?e.visible=!1:stderr("Unexpected null mesh"),o[d]=o[d]&~MESH_RENDERFLAG,d>r.FRAGS_PERSISTENT_COUNT){var p=t.geomids[d]
if(t.geoms.getGeometry(p)){var f=t.geomidsmap[p]
f||t.culledGeom.push(p)}}}else{var m=i(s,o,d)
e&&(e.visible=!!m),u=u&&!m}}var t,o,a,s,l,c,u
return function(i,n,r){u=!0,a=n,s=i,l=r
var d=a.intersectsBox(s===RENDER_HIDDEN?this.boundingBoxHidden:this.boundingBox)
return d===OUTSIDE?u:(o=this.frags.vizflags,t=this.frags,c=d!==CONTAINS,this.forEach(e,null,l),u)}}():t.prototype.applyVisibility=function(){function e(e,t){if(!e&&o.useThreeMesh||!e.geometry)return void(l&&l(t))
var d=n(c,a,o,t)
if(d)return e?e.visible=!1:stderr("Unexpected null mesh"),void(r[t]=r[t]&~MESH_RENDERFLAG)
var h=i(s,r,t)
e&&(e.visible=!!h),u=u&&!h}function t(e){if(!o.getGeometryId(e))return void(l&&l(e))
var t=n(c,a,o,e)
if(t)return void(r[e]=r[e]&~MESH_RENDERFLAG)
var d=i(s,r,e)
u=u&&!d}var o,r,a,s,l,c,u
return function(i,n,d){u=!0,a=n,s=i,l=d
var h=a.intersectsBox(s===RENDER_HIDDEN?this.boundingBoxHidden:this.boundingBox)
return h===OUTSIDE?u:(r=this.frags.vizflags,o=this.frags,c=h!==CONTAINS,d||o.useThreeMesh?this.forEach(e,null,l):this.forEachNoMesh(t,null),u)}}(),r.RenderBatch=t}(),function(){"use strict"
function e(e){for(var n=e.getFragmentList(),o=n.getCount(),r=0,a=[new Int32Array(o)],s=0;o>s;s++)a[0][s]=s
var l=i
e.is2d()&&(l/=6),(isIOSDevice()||isAndroidDevice())&&(l/=3),l=0|l
for(var c=l>0?l:i,u=0|(o+c-1)/c,d=new Array(u),s=0;u>s;s++){var h=s*c,p=d[s]=new t.RenderBatch(n,a,h,c),f=h+c
f>o&&(f=o),p.lastItem=f}this.addFragment=function(e){if(a[0].length<=e){var i=2*a[0].length
e>=i&&(i=e+1)
var o=new Int32Array(i)
o.set(a[0]),a[0]=o,this.visibleBoundsDirty=!0}a[0][e]=e
var r=0|e/c
if(d){var s=d[r]
s||(d[r]=s=new t.RenderBatch(n,a,r*c,c))}s&&s.onFragmentAdded(e)},this.reset=function(){r=0},this.nextBatch=function(){if(r==d.length)return null
var e=d[r++]
return e.renderImportance=0,e},this.getVisibleBounds=function(e,t){for(var i=0;i<d.length;i++)d[i].calculateBounds(),e.union(d[i].boundingBox),t.union(d[i].boundingBox),t.union(d[i].boundingBoxHidden)},this.rayCast=function(e,t){for(var i=0;i<d.length;i++)d[i].raycast(e,t)},this.getSceneCount=function(){return d.length},this.getGeomScenes=function(){return d},this.done=function(){return r===d.length}}var t=Autodesk.Viewing.Private,i=333
t.ModelIteratorLinear=e}(),function(){"use strict"
function e(){function e(e){var t=d[e],i=r
if(h)for(;i>o&&d[u[i-1]]>t;)u[i]=u[i-1],i--
else for(;i>o&&d[u[i-1]]<t;)u[i]=u[i-1],i--
u[i]=e,r++}function i(e){var t=s.getLeftChild(e);-1!==t&&(i(t),i(t+1)),m.makeEmpty(),-1!==t&&(s.getBoxThree(t,v),m.union(v),s.getBoxThree(t+1,v),m.union(v))
var n=s.getPrimCount(e)
n&&(m.union(c[e].boundingBox),m.union(c[e].boundingBoxHidden)),s.setBoxThree(e,m)}var n,o,r,a,s=null,l=null,c=null,u=null,d=null,h=1,p=!0,f=!1,m=new THREE.Box3,v=new THREE.Box3,g=!1
this.initialize=function(e,i,o){n=e.getFragmentList(),l=o,c=new Array(i.nodeCount),s=i,u=new Int32Array(i.nodeCount+1),d=new Float32Array(i.nodeCount)
for(var r=0;r<i.nodeCount;r++){var a=i.getPrimCount(r)
a&&(c[r]=new t.RenderBatch(n,l,i.getPrimStart(r),a),c[r].lastItem=c[r].start+a,8&i.getFlags(r)&&(c[r].sortObjects=!0),i.getBoxThree(r,c[r].boundingBox))}},this.addFragment=function(e,t){},this.reset=function(e){a=e,o=0,r=0,u[r++]=0,f=!1,g=!1},this.nextBatch=function(){for(f||o!==r||(u[r++]=1,f=!0);o!==r;){var t=h||f?u[--r]:u[o++]
s.getBoxThree(t,m)
var i=a.intersectsBox(m)
if(i!==OUTSIDE){var n=s.getLeftChild(t),l=-1!==n
if(l){var v=s.getFlags(t),E=a.viewDir[3&v]<0?1:0,y=v>>2&1,A=v>>3&1,T=h||f?1:0,b=0,w=0
if(p&&!f){var _=n+y,x=n+1-y
s.getBoxThree(_,m),d[_]=b=a.projectedArea(m),s.getBoxThree(x,m),d[x]=w=a.projectedArea(m),b>0&&e(_),w>0&&e(x)}else{E^T^A&&(y=1-y)
var _=n+y,x=n+1-y
u[r++]=_,d[_]=-1,u[r++]=x,d[x]=-1}}var C=s.getPrimCount(t)
if(0!==C){var S=c[t]
return S.renderImportance=a.projectedArea(S.boundingBox),S}}f||o!==r||(u[r++]=1,f=!0)}return g=!0,null},this.getVisibleBounds=function(e,t){for(var n=0;n<c.length;n++){var o=c[n]
o&&(o.calculateBounds(),e.union(o.boundingBox),t.union(o.boundingBox),t.union(o.boundingBoxHidden))}i(0),i(1)},this.rayCast=function(e,t){for(var i=[1,0],n=new THREE.Vector3;i.length;){var o=i.pop()
s.getBoxThree(o,m)
var r=e.ray.intersectBox(m,n)
if(null!==r){var a=s.getLeftChild(o);-1!==a&&(i.push(a),i.push(a+1))
var l=s.getPrimCount(o)
if(0!==l){var u=c[o]
u.raycast(e,t)}}}},this.getSceneCount=function(){return c.length},this.getGeomScenes=function(){return c},this.done=function(){return g}}var t=Autodesk.Viewing.Private
t.ModelIteratorBVH=e}(),function(){"use strict"
function e(e){function o(e){var t=r.getFragmentList().fragments.packIds[e];-1==T.indexOf(t)&&T.push(t)}t.Model.call(this,e)
var r=this,a=new THREE.Box3,s=new THREE.Box3,l=new THREE.Box3,c=0,u=0
this.visibleBoundsDirty=!1,this.enforceBvh=!1,this.id=n++
var d,h,p,f,m,v,g,E=!1,y=0,A=i.PAGEOUT_NONE,T=[]
this.getGeometryList=function(){return d},this.getFragmentList=function(){return h},this.initialize=function(e){d=new i.GeometryList(this)
var t=this.getData().fragments
h=new i.FragmentList(t,d,e)
var n=this.getBoundingBox()
n&&(a.copy(n),s.copy(n)),m=p=new i.ModelIteratorLinear(this)},this.dtor=function(e){this.getFragmentList().dispose(e)},this.activateFragment=function(e,t,i){h.setMesh(e,t,i),m.addFragment(e),h.getWorldBounds(e,l),a.union(l),s.union(l)},this.setFragment=function(e,t){return void 0===e&&(e=this.getFragmentList().getNextAvailableFragmentId()),h.setMesh(e,t,!0),p&&p.addFragment(e),f&&!h.fragmentsHaveBeenAdded()&&f.addFragment(e),h.getWorldBounds(e,l),a.union(l),s.union(l),e},this.setBVH=function(e,t){m=f=new i.ModelIteratorBVH,m.initialize(this,e,t)},this.resetIterator=function(e,t,n,o){if(y=0,o){T=[],A=i.PAGEOUT_NONE
var r=this.getFragmentList()
r.traversedGeom=[],r.culledGeom=[]
for(var a=r.vizflags.length,s=0;a>s;++s)r.setFlagFragment(s,MESH_TRAVERSED,!1)
for(var l in r.geomidsmap)r.geomidsmap.hasOwnProperty(l)&&(r.geomidsmap[l].t=0)}return E=!1,f&&!h.fragmentsHaveBeenAdded()&&(E=!0),m=E?f:p,u=0,g=n,v=t,m.reset(t),m},this.nextBatch=function(){for(;;){var e=m.nextBatch()
if(u++,!e)return null
this.is2d()||(e.sortObjects&&!this.getFragmentList().useThreeMesh?e.sortByDepth(v):e.sortDone||e.sortByMaterial())
var t=e.applyVisibility(g,v,this.getFragmentList().fragments.packIds?o:null)
if(!t)return e}},this.getVisibleBounds=function(e){return this.visibleBoundsDirty&&(a.makeEmpty(),s.makeEmpty(),m.getVisibleBounds(a,s,e),this.visibleBoundsDirty=!1),e?s:a},this.rayIntersect=function(e,t,i){this.visibleBoundsDirty&&this.getVisibleBounds()
var n=[]
if(i)for(var o=0;o<i.length;o++){var r=h.getVizmesh(i[o]),a=VBIntersector.rayCast(r,e,n)
a&&(a.fragId=i[o],n.push(a))}else m.rayCast(e,n)
if(!n.length)return null
n.sort(function(e,t){return e.distance-t.distance})
for(var s,o=0;o<n.length;o++){var l=n[o].fragId
if(!this.is2d()){var c=this.isFragVisible(l)
if(c){var u=h.getMaterial(l)
if(t&&u.transparent)continue
s=n[o]
var d=n[o].point,p=!1
if(u.cutplanes)for(var f=0;f<u.cutplanes.length;f++)p=p||u.cutplanes[f].dot(new THREE.Vector4(d.x,d.y,d.z,1))>1e-6
if(!p)break
s=null}}}return s&&(s.model=this),s},this.setHighlighted=function(e,t){var i=h.setFlagFragment(e,MESH_HIGHLIGHTED,t)
return i&&(t?c++:c--),i},this.setVisibility=function(e,t){h.setVisibility(e,t),this.visibleBoundsDirty=!0},this.setAllVisibility=function(e){h.setAllVisibility(e),this.visibleBoundsDirty=!0},this.hideLines=function(e){h.hideLines(e)},this.hasHighlighted=function(){return!!c},this.isFragVisible=function(e){return h.isFragVisible(e)},this.areAllVisible=function(){return h.areAllVisible()},this.getGeomScenes=function(){return m.getGeomScenes()},this.getRenderProgress=function(){return u/m.getSceneCount()},this.pageOutStatus=function(){return A},this.pageOutIfNeeded=function(e){var t=this.getGeometryList(),n=this.getFragmentList(),o=t.numGeomsInMemory
if(o>i.GEOMS_COUNT_LIMIT){var r,a,s=0,l=0,c=0,u=i.GEOMS_PAGEOUT_COUNT,r=n.culledGeom.length
for(r=r>u?u:r,c=0;r>c;c++){a=n.culledGeom[c]
var d=t.removeGeometry(a)
d>0&&(s+=d,l++)}if(n.culledGeom.splice(0,r),u-=r,u>0){var r=n.traversedGeom.length
for(c=r>u?r-u:0;r>c;++c){a=n.traversedGeom[c]
var d=t.removeGeometry(a)
d>0&&(s+=d,l++)}r=r>u?u:r,n.traversedGeom.splice(-r,r)}if(o=t.numGeomsInMemory,e&&o>i.GEOMS_COUNT_LIMIT){for(r=t.geoms.length,c=0;r>c;++c){var d=t.removeGeometry(c)
if(d>0&&(s+=d,l++),t.numGeomsInMemory<i.GEOMS_COUNT_LIMIT)break}stderr("A force page out occur. ")}if(y+=l,stderr("Unload: "+l+" , Size: "+s/1048576+"MB. Remaining: "+t.numGeomsInMemory),t.numGeomsInMemory>i.GEOMS_COUNT_LIMIT)return n.reachLimit=!0,T=[],i.PAGEOUT_FAIL}return n.reachLimit=!1,i.PAGEOUT_SUCCESS},this.frameUpdatePaging=function(e){var t=this.getFragmentList(),n=i.pageOutGeometryEnabled&&t.getCount()>i.FRAGS_PERSISTENT_MAX_COUNT
n&&!e&&(A==i.PAGEOUT_FAIL?t.traversedGeom.length>.5*i.GEOMS_PAGEOUT_COUNT&&(A=this.pageOutIfNeeded()):A=this.pageOutIfNeeded()),m.done()&&n&&(A=this.pageOutIfNeeded(),A==i.PAGEOUT_FAIL&&0==y&&this.pageOutIfNeeded(!0))},this.geomPacksMissingLastFrame=function(){return T},this.addGeomPackMissingLastFrame=function(e){-1==T.indexOf(e)&&T.push(e)}}var t=Autodesk.Viewing,i=t.Private,n=1
e.prototype=Object.create(t.Model.prototype),e.prototype.constructor=e,i.RenderModel=e}(),function(){"use strict"
function e(){var e=!1,i=!1,n=0,o=null,r=!0,a=[],s=[],l=new t.FrustumIntersector,c=new THREE.Raycaster,u=RENDER_NORMAL,d=!1,h=0,p=performance
this.checkCull=function(){var e=new THREE.Box3
return function(t,i,n){if(a[0].getFragmentList().getWorldBounds(t,e),i&&!l.intersectsBox(e))return!0
if(n){var o=l.projectedArea(e)
if(o*=l.areaConv,o<l.areaCullThreshold)return!0}return!1}}(),this.addModel=function(e){a.push(e),s.length=a.length},this.removeModel=function(e){var t=a.indexOf(e)
t>=0&&a.splice(t,1),s.length=a.length},this.isEmpty=function(){return 0===a.length},this.needsRender=function(){return e},this.resetNeedsRender=function(){e=!1},this.renderSome=function(l,c){var u,h=p.now(),f=0===n
for(r&&f&&!d&&(o=null,d=!0);;){for(var m=0,v=s[0],g=1;g<s.length;g++){var E=s[g]
null!==E&&(v||(m=g,v=E),E.renderImportance>v.renderImportance&&(m=g,v=E))}var y=!1
if(v){s[m]=a[m].nextBatch(),l(v),n++,u=p.now()
var A=u-h
h=u,void 0===v.avgFrameTime?v.avgFrameTime=A:v.avgFrameTime=.8*v.avgFrameTime+.2*A,c-=v.avgFrameTime
var T=!1
if(r&&f&&null!==o?v==o&&(T=!0):0>=c&&(T=!0),T){y=!0
break}}if(!v){i=!0
break}if(y)break}r&&f&&null==o&&(o=v)
for(var g=0;g<a.length;g++)a[g].frameUpdatePaging(f)===t.PAGEOUT_FAIL&&(e=!0)
return(i||!f)&&(o=null,d=!1),c},this.reset=function(e,t,o){if(h++,i=!1,u=t,n=0,this.resetNeedsRender(),l.reset(e),a.length)for(var r=0;r<a.length;r++)a[r].resetIterator(e,l,t,o),s[r]=a[r].nextBatch()},this.isDone=function(){return i||this.isEmpty()},this.setAllVisibility=function(e){for(var t=0;t<a.length;t++)a[t].setAllVisibility(e)},this.hideLines=function(e){for(var t=0;t<a.length;t++)a[t].hideLines(e)},this.hasHighlighted=function(){for(var e=0;e<a.length;e++)if(a[e].hasHighlighted())return!0
return!1},this.areAllVisible=function(){for(var e=0;e<a.length;e++)if(!a[e].areAllVisible())return!1
return!0},this.invalidateVisibleBounds=function(){for(var e=0;e<a.length;e++)a[e].visibleBoundsDirty=!0},this.getVisibleBounds=function(e){return a[0].getVisibleBounds(e)},this.rayIntersect=function(e,t,i,n){if(c.set(e,t),a.length>1){for(var o=[],r=0;r<a.length;r++){var s=a[r].rayIntersect(c,i,n)
s&&o.push(s)}return o.length?(o.sort(function(e,t){return e.distance-t.distance}),o[0]):null}return a[0].rayIntersect(c,i,n)},this.getRenderProgress=function(){return a[0].getRenderProgress()},this.getFragmentList=function(){return a[0].getFragmentList()},this.getGeometryList=function(){return a[0].getGeometryList()},this.getSceneCount=function(){return a[0].getSceneCount()},this.getModels=function(){return a},this.getGeomScenes=function(){return a[0].getGeomScenes()},this.geomPacksMissingLastFrame=function(){return a[0].geomPacksMissingLastFrame()},this.explode=function(e){if(a.length){for(var t=0;t<a.length;t++){var i=a[t],n=i.getData(),o=i.getVisibleBounds(!0).center(),r=i.getFragmentList(),s=new THREE.Vector3
if(e*=2,n.instanceTree&&n.instanceTree.boxes&&0!==e){var l=e*(n.instanceTree.maxDepth-1)+1,c=0|l,u=l-c,d=n.instanceTree.boxes
!function y(t,i,o,a,l,h,p,f){var m=2*e
i==c&&(m*=u)
var v=6*t,g=.5*(d[v]+d[v+3]),E=.5*(d[v+1]+d[v+4]),A=.5*(d[v+2]+d[v+5])
if(i>0&&c>=i){var T=(g-o)*m,b=(E-a)*m,w=(A-l)*m
h+=T,p+=b,f+=w}n.instanceTree.enumNodeChildren(t,function(e){y(e,i+1,g,E,A,h,p,f)},!1),n.instanceTree.enumNodeFragments(t,function(e){s.x=h,s.y=p,s.z=f,r.updateAnimTransform(e,null,null,s)},!1)}(n.instanceTree.getRootId(),0,o.x,o.y,o.x,0,0,0)}else for(var h=r.fragments.boxes,p=0,f=r.getCount();f>p;p++)if(0==e)r.updateAnimTransform(p)
else{var m=6*p,v=.5*(h[m]+h[m+3]),g=.5*(h[m+1]+h[m+4]),E=.5*(h[m+2]+h[m+5])
v=e*(v-o.x),g=e*(g-o.y),E=e*(E-o.z),s.x=v,s.y=g,s.z=E,r.updateAnimTransform(p,null,null,s)}}this.invalidateVisibleBounds()}}}var t=Autodesk.Viewing.Private
t.RenderScene=e}()
var PackDepthShaderChunk=["vec4 packDepth( const in float depth ) {","vec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;","enc = fract(enc);","enc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);","return enc;","}","float unpackDepth( const in vec4 rgba_depth ) {","return dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );","}"].join("\n"),TonemapShaderChunk=["float luminance_post(vec3 rgb) {","return dot(rgb, vec3(0.299, 0.587, 0.114));","}","float luminance_pre(vec3 rgb) {","return dot(rgb, vec3(0.212671, 0.715160, 0.072169));","}","vec3 xyz2rgb(vec3 xyz) {","vec3 R = vec3( 3.240479, -1.537150, -0.498535);","vec3 G = vec3(-0.969256,  1.875992,  0.041556);","vec3 B = vec3( 0.055648, -0.204043,  1.057311);","vec3 rgb;","rgb.b = dot(xyz, B);","rgb.g = dot(xyz, G);","rgb.r = dot(xyz, R);","return rgb;","}","vec3 rgb2xyz(vec3 rgb) {","vec3 X = vec3(0.412453, 0.35758, 0.180423);","vec3 Y = vec3(0.212671, 0.71516, 0.0721688);","vec3 Z = vec3(0.0193338, 0.119194, 0.950227);","vec3 xyz;","xyz.x = dot(rgb, X);","xyz.y = dot(rgb, Y);","xyz.z = dot(rgb, Z);","return xyz;","}","vec3 xyz2xyY(vec3 xyz) {","float sum = xyz.x + xyz.y + xyz.z;","sum = 1.0 / sum;","vec3 xyY;","xyY.z = xyz.y;","xyY.x = xyz.x * sum;","xyY.y = xyz.y * sum;","return xyY;","}","vec3 xyY2xyz(vec3 xyY) {","float x = xyY.x;","float y = xyY.y;","float Y = xyY.z;","vec3 xyz;","xyz.y = Y;","xyz.x = x * (Y / y);","xyz.z = (1.0 - x - y) * (Y / y);","return xyz;","}","float toneMapCanon_T(float x)","{","float xpow = pow(x, 1.60525727);","float tmp = ((1.05542877*4.68037409)*xpow) / (4.68037409*xpow + 1.0);","return clamp(tmp, 0.0, 1.0);","}","const float Shift = 1.0 / 0.18;","float toneMapCanonFilmic_NoGamma(float x) {","x *= Shift;","const float A = 0.2;","const float B = 0.34;","const float C = 0.002;","const float D = 1.68;","const float E = 0.0005;","const float F = 0.252;","const float scale = 1.0/0.833837;","return (((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F) * scale;","}","vec3 toneMapCanonFilmic_WithGamma(vec3 x) {","x *= Shift;","const float A = 0.27;","const float B = 0.29;","const float C = 0.052;","const float D = 0.2;","const float F = 0.18;","const float scale = 1.0/0.897105;","return (((x*(A*x+C*B))/(x*(A*x+B)+D*F))) * scale;","}","vec3 toneMapCanonOGS_WithGamma_WithColorPerserving(vec3 x) {","vec3 outColor = x.rgb;","outColor = min(outColor, vec3(3.0));","float inLum = luminance_pre(outColor);","if (inLum > 0.0) {","float outLum = toneMapCanon_T(inLum);","outColor = outColor * (outLum / inLum);","outColor = clamp(outColor, vec3(0.0), vec3(1.0));","}","float gamma = 1.0/2.2;","outColor = pow(outColor, vec3(gamma));","return outColor;","}"].join("\n"),OrderedDitheringShaderChunk=["vec3 orderedDithering(vec3 col) {","const vec4 m0 = vec4( 1.0, 13.0,  4.0, 16.0);","const vec4 m1 = vec4( 9.0,  5.0, 12.0,  8.0);","const vec4 m2 = vec4( 3.0, 15.0,  2.0, 14.0);","const vec4 m3 = vec4(11.0,  7.0, 10.0,  6.0);","int i = int(mod(float(gl_FragCoord.x), 4.0));","int j = int(mod(float(gl_FragCoord.y), 4.0));","vec4 biasRow;","if      (i==0) biasRow = m0;","else if (i==1) biasRow = m1;","else if (i==2) biasRow = m2;","else           biasRow = m3;","float bias;","if      (j==0) bias = biasRow.x;","else if (j==1) bias = biasRow.y;","else if (j==2) bias = biasRow.z;","else           bias = biasRow.w;","return col + bias / 17.0 / 256.0;","}"].join("\n"),CutPlanesShaderChunk=["#if NUM_CUTPLANES > 0","uniform vec4 cutplanes[NUM_CUTPLANES];","#ifdef CUTPLANES_LINE","uniform vec3 cutplanesOutlineColor;","uniform float cutplanesOutlineThickness;","#endif","bool checkCutPlanes(vec3 worldPosition) {","bool isCut = false;","#ifdef CUTPLANES_LINE","bool isCutEdge = false;","float eyeDist = length(vViewPosition);","#endif","for (int i=0; i<NUM_CUTPLANES; i++) {","float dotPlane = dot(vec4(worldPosition, 1.0), cutplanes[i]);","isCut = isCut || (dotPlane > 0.0);","#ifdef CUTPLANES_LINE","isCutEdge = isCutEdge || (dotPlane > -cutplanesOutlineThickness*eyeDist);","#endif","}","if (isCut) {","discard;","return true;","}","#ifdef CUTPLANES_LINE","else if (isCutEdge) {","gl_FragColor = vec4(cutplanesOutlineColor, 1.0);","return true;","}","#endif","return false;","}","#endif"].join("\n"),PackNormalsShaderChunk=["#define kPI 3.14159265358979","vec2 encodeNormal (vec3 n)","{","return (vec2(atan(n.y,n.x)/kPI, n.z)+1.0)*0.5;","}","vec3 decodeNormal (vec2 enc)","{","vec2 ang = enc * 2.0 - 1.0;","vec2 scth = vec2(sin(ang.x * kPI), cos(ang.x * kPI));","vec2 scphi = vec2(sqrt(1.0 - ang.y * ang.y), ang.y);","return vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y);","}"].join("\n"),HatchPatternShaderChunk=["#ifdef HATCH_PATTERN","uniform vec2 hatchParams;","uniform vec3 hatchTintColor;","uniform float hatchTintIntensity;","float curveGaussian(float r, float invWidth) {","float amt = clamp(r * invWidth, 0.0, 1.0);","float exponent = amt * 3.5;","return exp(-exponent*exponent);","}","vec4 calculateHatchPattern(vec2 hatchParams, vec2 coord, vec4 fragColor, vec3 hatchTintColor, float hatchTintIntensity ) {","float hatchSlope = hatchParams.x;","float hatchPeriod = hatchParams.y;","if (abs(hatchSlope) <= 1.0) {","float hatchPhase = coord.y - hatchSlope * coord.x;","float dist = abs(mod((hatchPhase), (hatchPeriod)));","if (dist < 1.0) {","fragColor = vec4(0.0,0.0,0.0,1.0);","} else {","fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);","}","} else {","float hatchPhase = - coord.y / hatchSlope + coord.x;","float dist = abs(mod((hatchPhase), (hatchPeriod)));","if (dist < 1.0) {","fragColor = vec4(0.0,0.0,0.0,1.0);","} else {","fragColor.xyz = mix(fragColor.xyz, hatchTintColor, hatchTintIntensity);","}","}","return fragColor;","}","#endif"].join("\n"),EnvSamplingShaderChunk=["uniform float envRotationSin;","uniform float envRotationCos;","vec3 adjustLookupVector(in vec3 lookup) {","return vec3(","envRotationCos * lookup.x - envRotationSin * lookup.z,","lookup.y,","envRotationSin * lookup.x + envRotationCos * lookup.z);","}"].join("\n")
if(function(){"use strict"
var e=function(e,t){this.textureID=void 0!==t?t:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,defines:THREE.UniformsUtils.clone(e.defines)}),this.renderToScreen=!1,this.enabled=!0,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1)
var i=new THREE.BufferGeometry,n=new Float32Array(9)
n[0]=-1,n[1]=-1,n[2]=0,n[3]=3,n[4]=-1,n[5]=0,n[6]=-1,n[7]=3,n[8]=0
var o=new Float32Array(6)
o[0]=0,o[1]=0,o[2]=2,o[3]=0,o[4]=0,o[5]=2
var r=new Float32Array(9)
r[0]=0,r[1]=0,r[2]=1,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=1,i.addAttribute("position",new THREE.BufferAttribute(n,3)),i.addAttribute("normal",new THREE.BufferAttribute(r,3)),i.addAttribute("uv",new THREE.BufferAttribute(o,2)),this.quad=new THREE.Mesh(i,this.material),this.scene=new THREE.Scene,this.scene.add(this.quad)}
e.prototype={render:function(e,t,i,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i),this.renderToScreen||!t?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}},Autodesk.Viewing.Shaders.LmvShaderPass=e}(),FireflyWebGLProgram=function(){var e=0,t=function(e){var t,i,n=[]
for(var o in e)t=e[o],t!==!1&&(i="#define "+o+" "+t,n.push(i))
return n.join("\n")},i=function(e,t,i){for(var n={},o=0,r=i.length;r>o;o++){var a=i[o]
n[a]=e.getUniformLocation(t,a)}return n},n=function(e,t,i){for(var n={},o=0,r=i.length;r>o;o++){var a=i[o]
n[a]=e.getAttribLocation(t,a)}return n},o=function(e,t,i,n,o){var r=n?"1.0-":"",a="texture2D("+e+", (UV))",s=""
return o=o||"vec4(0.0)",t&&i?s="((UV).x < 0.0 || (UV).x > 1.0 || (UV).y < 0.0 || (UV).y > 1.0) ? "+o+" : ":t?s="((UV).x < 0.0 || (UV).x > 1.0) ? "+o+" : ":i&&(s="((UV).y < 0.0 || (UV).y > 1.0) ? "+o+" : "),"#define GET_"+e.toUpperCase()+"(UV) ("+s+r+a+")"}
return function(r,a,s,l){var c=r,u=c.context,d=s.defines,h=s.__webglShader.uniforms,p=s.attributes,f=s.__webglShader.vertexShader,m=s.__webglShader.fragmentShader,v=s.index0AttributeName
void 0===v&&l.morphTargets===!0&&(v="position")
var g="SHADOWMAP_TYPE_BASIC"
l.shadowMapType===THREE.PCFShadowMap?g="SHADOWMAP_TYPE_PCF":l.shadowMapType===THREE.PCFSoftShadowMap&&(g="SHADOWMAP_TYPE_PCF_SOFT")
var E="ENVMAP_TYPE_CUBE",y="ENVMAP_MODE_REFLECTION",A="ENVMAP_BLENDING_MULTIPLY"
l.envMap
var T,b,w=r.gammaFactor>0?r.gammaFactor:1,_=t(d),x=u.createProgram()
s instanceof THREE.RawShaderMaterial?(T="",b=""):(T=["precision "+l.precision+" float;","precision "+l.precision+" int;",_,l.supportsVertexTextures?"#define VERTEX_TEXTURES":"",c.gammaInput?"#define GAMMA_INPUT":"",c.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+w,l.mrtNormals?"#define MRT_NORMALS":"",l.mrtIdBuffer?"#define MRT_ID_BUFFER":"","#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,"#define MAX_BONES "+l.maxBones,"#define NUM_CUTPLANES "+l.numCutplanes,l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+y:"",l.irradianceMap?"#define USE_IRRADIANCEMAP":"",l.lightMap?"#define USE_LIGHTMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals?"#define USE_MORPHNORMALS":"",l.wrapAround?"#define WRAP_AROUND":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+g:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.useFragDepthExt?"#define USE_LOGDEPTHBUF_EXT":"",l.packedNormals?"#define UNPACK_NORMALS":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","#ifdef UNPACK_NORMALS","attribute vec2 normal;","#else","attribute vec3 normal;","#endif","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","	attribute vec3 color;","#endif",""].join("\n"),b=[l.bumpMap||l.normalMap?"#extension GL_OES_standard_derivatives : enable":"",!l.mrtIdBuffer&&!l.mrtNormals||"undefined"!=typeof _isIE11&&_isIE11?"":"#extension GL_EXT_draw_buffers : enable",l.mrtIdBuffer?"#define gl_FragColor gl_FragData[0]":"",l.haveTextureLod?"#define HAVE_TEXTURE_LOD":"",_,"#define MAX_DIR_LIGHTS "+l.maxDirLights,"#define MAX_POINT_LIGHTS "+l.maxPointLights,"#define MAX_SPOT_LIGHTS "+l.maxSpotLights,"#define MAX_HEMI_LIGHTS "+l.maxHemiLights,"#define MAX_SHADOWS "+l.maxShadows,"#define NUM_CUTPLANES "+l.numCutplanes,l.alphaTest?"#define ALPHATEST "+l.alphaTest:"",c.gammaInput?"#define GAMMA_INPUT":"",c.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+w,l.mrtNormals?"#define MRT_NORMALS":"",l.mrtIdBuffer?"#define MRT_ID_BUFFER":"","#define TONEMAP_OUTPUT "+(l.tonemapOutput||0),l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+E:"",l.envMap?"#define "+y:"",l.envMap?"#define "+A:"",l.irradianceMap?"#define USE_IRRADIANCEMAP":"",l.envGammaEncoded?"#define ENV_GAMMA":"",l.irrGammaEncoded?"#define IRR_GAMMA":"",l.envRGBM?"#define ENV_RGBM":"",l.irrRGBM?"#define IRR_RGBM":"",l.lightMap?"#define USE_LIGHTMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.vertexColors?"#define USE_COLOR":"",l.metal?"#define METAL":"",l.clearcoat?"#define CLEARCOAT":"",l.wrapAround?"#define WRAP_AROUND":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+g:"",l.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",l.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.hatchPattern?"#define HATCH_PATTERN":"",l.mapInvert?"#define MAP_INVERT":"",o("map",l.mapClampS,l.mapClampT,!1,"vec4(vec3(0.0), 1.0)"),o("bumpMap",l.bumpMapClampS,l.bumpMapClampT),o("normalMap",l.normalMapClampS,l.normalMapClampT),o("specularMap",l.specularMapClampS,l.specularMapClampT),o("alphaMap",l.alphaMapClampS,l.alphaMapClampT,l.alphaMapInvert),"#ifdef USE_ENVMAP","#ifdef HAVE_TEXTURE_LOD","#extension GL_EXT_shader_texture_lod : enable","#endif","#endif","#extension GL_OES_standard_derivatives : enable","precision "+l.precisionFragment+" float;","precision "+l.precisionFragment+" int;","uniform highp mat4 viewMatrix;","uniform highp mat4 projectionMatrix;","uniform highp vec3 cameraPosition;","#ifdef USE_ENVMAP","uniform mat4 viewMatrixInverse;","#endif",""].join("\n"))
var C=new THREE.WebGLShader(u,u.VERTEX_SHADER,T+f),S=new THREE.WebGLShader(u,u.FRAGMENT_SHADER,b+m)
u.attachShader(x,C),u.attachShader(x,S),void 0!==v&&u.bindAttribLocation(x,0,v),u.linkProgram(x),u.getProgramParameter(x,u.LINK_STATUS)===!1&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",u.getProgramParameter(x,u.VALIDATE_STATUS)),console.error("gl.getError()",u.getError())),""!==u.getProgramInfoLog(x)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",u.getProgramInfoLog(x)),u.deleteShader(C),u.deleteShader(S)
var R=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","viewMatrixInverse","mvpMatrix","dbId"]
l.logarithmicDepthBuffer&&R.push("logDepthBufFC")
for(var M in h)R.push(M)
this.uniforms=i(u,x,R),R=["position","normal","uv","uv2","tangent","color","lineDistance"]
for(var P in p)R.push(P)
return this.attributes=n(u,x,R),this.attributesKeys=Object.keys(this.attributes),this.id=e++,this.code=a,this.usedTimes=1,this.program=x,this.vertexShader=C,this.fragmentShader=S,this}}(),FireflyWebGLRenderer=function(e){function t(e){e.__webglVertexBuffer=Ie.createBuffer(),e.__webglColorBuffer=Ie.createBuffer(),e.__webglLineDistanceBuffer=Ie.createBuffer(),De.info.memory.geometries++}function i(e){e.__webglVertexBuffer=Ie.createBuffer(),e.__webglNormalBuffer=Ie.createBuffer(),e.__webglTangentBuffer=Ie.createBuffer(),e.__webglColorBuffer=Ie.createBuffer(),e.__webglUVBuffer=Ie.createBuffer(),e.__webglUV2Buffer=Ie.createBuffer(),e.__webglSkinIndicesBuffer=Ie.createBuffer(),e.__webglSkinWeightsBuffer=Ie.createBuffer(),e.__webglFaceBuffer=Ie.createBuffer(),e.__webglLineBuffer=Ie.createBuffer()
De.info.memory.geometries++}function n(e,t){var i=e.vertices.length,n=t.material
if(n.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[])
for(var o in n.attributes){var r=n.attributes[o]
if(!r.__webglInitialized||r.createUniqueBuffers){r.__webglInitialized=!0
var a=1
"v2"===r.type?a=2:"v3"===r.type?a=3:"v4"===r.type?a=4:"c"===r.type&&(a=3),r.size=a,r.array=new Float32Array(i*a),r.buffer=Ie.createBuffer(),r.buffer.belongsToAttribute=o,r.needsUpdate=!0}e.__webglCustomAttributesList.push(r)}}}function o(e,t){var i=e.vertices.length
e.__vertexArray=new Float32Array(3*i),e.__colorArray=new Float32Array(3*i),e.__lineDistanceArray=new Float32Array(1*i),e.__webglLineCount=i,n(e,t)}function r(e,t){var i=t.geometry,n=e.faces3,o=3*n.length,r=1*n.length,s=3*n.length,u=a(t,e),h=d(u),p=l(u),f=c(u)
e.__vertexArray=new Float32Array(3*o),p&&(e.__normalArray=new Float32Array(3*o)),i.hasTangents&&(e.__tangentArray=new Float32Array(4*o)),f&&(e.__colorArray=new Float32Array(3*o)),h&&(i.faceVertexUvs.length>0&&(e.__uvArray=new Float32Array(2*o)),i.faceVertexUvs.length>1&&(e.__uv2Array=new Float32Array(2*o))),t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*o),e.__skinWeightArray=new Float32Array(4*o))
var m=null!==st.get("OES_element_index_uint")&&r>21845?Uint32Array:Uint16Array
e.__typeArray=m,e.__faceArray=new m(3*r),e.__lineArray=new m(2*s)
if(e.__webglFaceCount=3*r,e.__webglLineCount=2*s,u.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[])
for(var v in u.attributes){var g=u.attributes[v],E={}
for(var y in g)E[y]=g[y]
if(!E.__webglInitialized||E.createUniqueBuffers){E.__webglInitialized=!0
var A=1
"v2"===E.type?A=2:"v3"===E.type?A=3:"v4"===E.type?A=4:"c"===E.type&&(A=3),E.size=A,E.array=new Float32Array(o*A),E.buffer=Ie.createBuffer(),E.buffer.belongsToAttribute=v,g.needsUpdate=!0,E.__original=g}e.__webglCustomAttributesList.push(E)}}e.__inittedArrays=!0}function a(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function s(e){return e&&void 0!==e.shading&&e.shading===THREE.SmoothShading}function l(e){return e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial?!1:s(e)?THREE.SmoothShading:THREE.FlatShading}function c(e){return e.vertexColors?e.vertexColors:!1}function d(e){return e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e instanceof THREE.ShaderMaterial?!0:!1}function h(e,t){var i,n,o,r,a,s,l,c,u,d,h,p,f=e.vertices,m=e.colors,v=e.lineDistances,g=f.length,E=m.length,y=v.length,A=e.__vertexArray,T=e.__colorArray,b=e.__lineDistanceArray,w=e.verticesNeedUpdate,_=e.colorsNeedUpdate,x=e.lineDistancesNeedUpdate,C=e.__webglCustomAttributesList
if(w){for(i=0;g>i;i++)r=f[i],a=3*i,A[a]=r.x,A[a+1]=r.y,A[a+2]=r.z
Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglVertexBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,A,t)}if(_){for(n=0;E>n;n++)s=m[n],a=3*n,T[a]=s.r,T[a+1]=s.g,T[a+2]=s.b
Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglColorBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,T,t)}if(x){for(o=0;y>o;o++)b[o]=v[o]
Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglLineDistanceBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,b,t)}if(C)for(l=0,c=C.length;c>l;l++)if(p=C[l],p.needsUpdate&&(void 0===p.boundTo||"vertices"===p.boundTo)){if(a=0,d=p.value.length,1===p.size)for(u=0;d>u;u++)p.array[u]=p.value[u]
else if(2===p.size)for(u=0;d>u;u++)h=p.value[u],p.array[a]=h.x,p.array[a+1]=h.y,a+=2
else if(3===p.size)if("c"===p.type)for(u=0;d>u;u++)h=p.value[u],p.array[a]=h.r,p.array[a+1]=h.g,p.array[a+2]=h.b,a+=3
else for(u=0;d>u;u++)h=p.value[u],p.array[a]=h.x,p.array[a+1]=h.y,p.array[a+2]=h.z,a+=3
else if(4===p.size)for(u=0;d>u;u++)h=p.value[u],p.array[a]=h.x,p.array[a+1]=h.y,p.array[a+2]=h.z,p.array[a+3]=h.w,a+=4
Ie.bindBuffer(Ie.ARRAY_BUFFER,p.buffer),Ie.bufferData(Ie.ARRAY_BUFFER,p.array,t)}}function p(e,t,i,n,o){if(e.__inittedArrays){var r,a,s,u,h,p,f,m,v,g,E,y,A,T,b,w,_,x,C,S,R,M,P,L,I,k,V,N=l(o),D=c(o),H=d(o),O=N===THREE.SmoothShading,B=0,F=0,U=0,z=0,G=0,W=0,j=0,X=0,Y=0,q=0,K=0,Z=e.__vertexArray,Q=e.__uvArray,J=e.__uv2Array,$=e.__normalArray,ee=e.__tangentArray,te=e.__colorArray,ie=e.__webglCustomAttributesList,ne=e.__faceArray,oe=e.__lineArray,re=t.geometry,ae=re.verticesNeedUpdate,se=re.elementsNeedUpdate,le=re.uvsNeedUpdate,ce=re.normalsNeedUpdate,ue=re.tangentsNeedUpdate,de=re.colorsNeedUpdate,he=re.vertices,pe=e.faces3,fe=re.faces,me=re.faceVertexUvs[0],ve=re.faceVertexUvs[1]
re.colors
if(ae){for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],y=he[u.a],A=he[u.b],T=he[u.c],Z[F]=y.x,Z[F+1]=y.y,Z[F+2]=y.z,Z[F+3]=A.x,Z[F+4]=A.y,Z[F+5]=A.z,Z[F+6]=T.x,Z[F+7]=T.y,Z[F+8]=T.z,F+=9
Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglVertexBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,Z,i)}if(de&&D){for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],f=u.vertexColors,m=u.color,3===f.length&&D===THREE.VertexColors?(x=f[0],C=f[1],S=f[2]):(x=m,C=m,S=m),te[Y]=x.r,te[Y+1]=x.g,te[Y+2]=x.b,te[Y+3]=C.r,te[Y+4]=C.g,te[Y+5]=C.b,te[Y+6]=S.r,te[Y+7]=S.g,te[Y+8]=S.b,Y+=9
Y>0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglColorBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,te,i))}if(ue&&re.hasTangents){for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],v=u.vertexTangents,b=v[0],w=v[1],_=v[2],ee[j]=b.x,ee[j+1]=b.y,ee[j+2]=b.z,ee[j+3]=b.w,ee[j+4]=w.x,ee[j+5]=w.y,ee[j+6]=w.z,ee[j+7]=w.w,ee[j+8]=_.x,ee[j+9]=_.y,ee[j+10]=_.z,ee[j+11]=_.w,j+=12
Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglTangentBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,ee,i)}if(ce&&N){for(r=0,a=pe.length;a>r;r++)if(u=fe[pe[r]],h=u.vertexNormals,p=u.normal,3===h.length&&O)for(R=0;3>R;R++)P=h[R],$[W]=P.x,$[W+1]=P.y,$[W+2]=P.z,W+=3
else for(R=0;3>R;R++)$[W]=p.x,$[W+1]=p.y,$[W+2]=p.z,W+=3
Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglNormalBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,$,i)}if(le&&me&&H){for(r=0,a=pe.length;a>r;r++)if(s=pe[r],g=me[s],void 0!==g)for(R=0;3>R;R++)L=g[R],Q[U]=L.x,Q[U+1]=L.y,U+=2
U>0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglUVBuffer),Ie.bufferData(Ie.ARRAY_BUFFER,Q,i))}if(le&&ve&&H){for(r=0,a=pe.length;a>r;r++)if(s=pe[r],E=ve[s],void 0!==E)for(R=0;3>R;R++)I=E[R],J[z]=I.x,J[z+1]=I.y,z+=2
z>0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,e.__webglUV2Buffer),Ie.bufferData(Ie.ARRAY_BUFFER,J,i))}if(se){for(r=0,a=pe.length;a>r;r++)ne[G]=B,ne[G+1]=B+1,ne[G+2]=B+2,G+=3,oe[X]=B,oe[X+1]=B+1,oe[X+2]=B,oe[X+3]=B+2,oe[X+4]=B+1,oe[X+5]=B+2,X+=6,B+=3
Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,e.__webglFaceBuffer),Ie.bufferData(Ie.ELEMENT_ARRAY_BUFFER,ne,i),Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,e.__webglLineBuffer),Ie.bufferData(Ie.ELEMENT_ARRAY_BUFFER,oe,i)}if(ie)for(R=0,M=ie.length;M>R;R++)if(V=ie[R],V.__original.needsUpdate){if(q=0,K=0,1===V.size){if(void 0===V.boundTo||"vertices"===V.boundTo)for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],V.array[q]=V.value[u.a],V.array[q+1]=V.value[u.b],V.array[q+2]=V.value[u.c],q+=3
else if("faces"===V.boundTo)for(r=0,a=pe.length;a>r;r++)k=V.value[pe[r]],V.array[q]=k,V.array[q+1]=k,V.array[q+2]=k,q+=3}else if(2===V.size){if(void 0===V.boundTo||"vertices"===V.boundTo)for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],y=V.value[u.a],A=V.value[u.b],T=V.value[u.c],V.array[q]=y.x,V.array[q+1]=y.y,V.array[q+2]=A.x,V.array[q+3]=A.y,V.array[q+4]=T.x,V.array[q+5]=T.y,q+=6
else if("faces"===V.boundTo)for(r=0,a=pe.length;a>r;r++)k=V.value[pe[r]],y=k,A=k,T=k,V.array[q]=y.x,V.array[q+1]=y.y,V.array[q+2]=A.x,V.array[q+3]=A.y,V.array[q+4]=T.x,V.array[q+5]=T.y,q+=6}else if(3===V.size){var ge
if(ge="c"===V.type?["r","g","b"]:["x","y","z"],void 0===V.boundTo||"vertices"===V.boundTo)for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],y=V.value[u.a],A=V.value[u.b],T=V.value[u.c],V.array[q]=y[ge[0]],V.array[q+1]=y[ge[1]],V.array[q+2]=y[ge[2]],V.array[q+3]=A[ge[0]],V.array[q+4]=A[ge[1]],V.array[q+5]=A[ge[2]],V.array[q+6]=T[ge[0]],V.array[q+7]=T[ge[1]],V.array[q+8]=T[ge[2]],q+=9
else if("faces"===V.boundTo)for(r=0,a=pe.length;a>r;r++)k=V.value[pe[r]],y=k,A=k,T=k,V.array[q]=y[ge[0]],V.array[q+1]=y[ge[1]],V.array[q+2]=y[ge[2]],V.array[q+3]=A[ge[0]],V.array[q+4]=A[ge[1]],V.array[q+5]=A[ge[2]],V.array[q+6]=T[ge[0]],V.array[q+7]=T[ge[1]],V.array[q+8]=T[ge[2]],q+=9
else if("faceVertices"===V.boundTo)for(r=0,a=pe.length;a>r;r++)k=V.value[pe[r]],y=k[0],A=k[1],T=k[2],V.array[q]=y[ge[0]],V.array[q+1]=y[ge[1]],V.array[q+2]=y[ge[2]],V.array[q+3]=A[ge[0]],V.array[q+4]=A[ge[1]],V.array[q+5]=A[ge[2]],V.array[q+6]=T[ge[0]],V.array[q+7]=T[ge[1]],V.array[q+8]=T[ge[2]],q+=9}else if(4===V.size)if(void 0===V.boundTo||"vertices"===V.boundTo)for(r=0,a=pe.length;a>r;r++)u=fe[pe[r]],y=V.value[u.a],A=V.value[u.b],T=V.value[u.c],V.array[q]=y.x,V.array[q+1]=y.y,V.array[q+2]=y.z,V.array[q+3]=y.w,V.array[q+4]=A.x,V.array[q+5]=A.y,V.array[q+6]=A.z,V.array[q+7]=A.w,V.array[q+8]=T.x,V.array[q+9]=T.y,V.array[q+10]=T.z,V.array[q+11]=T.w,q+=12
else if("faces"===V.boundTo)for(r=0,a=pe.length;a>r;r++)k=V.value[pe[r]],y=k,A=k,T=k,V.array[q]=y.x,V.array[q+1]=y.y,V.array[q+2]=y.z,V.array[q+3]=y.w,V.array[q+4]=A.x,V.array[q+5]=A.y,V.array[q+6]=A.z,V.array[q+7]=A.w,V.array[q+8]=T.x,V.array[q+9]=T.y,V.array[q+10]=T.z,V.array[q+11]=T.w,q+=12
else if("faceVertices"===V.boundTo)for(r=0,a=pe.length;a>r;r++)k=V.value[pe[r]],y=k[0],A=k[1],T=k[2],V.array[q]=y.x,V.array[q+1]=y.y,V.array[q+2]=y.z,V.array[q+3]=y.w,V.array[q+4]=A.x,V.array[q+5]=A.y,V.array[q+6]=A.z,V.array[q+7]=A.w,V.array[q+8]=T.x,V.array[q+9]=T.y,V.array[q+10]=T.z,V.array[q+11]=T.w,q+=12
Ie.bindBuffer(Ie.ARRAY_BUFFER,V.buffer),Ie.bufferData(Ie.ARRAY_BUFFER,V.array,i)}n&&(delete e.__inittedArrays,delete e.__colorArray,delete e.__normalArray,delete e.__tangentArray,delete e.__uvArray,delete e.__uv2Array,delete e.__faceArray,delete e.__vertexArray,delete e.__lineArray,delete e.__skinIndexArray,delete e.__skinWeightArray)}}function f(e){if(e.streamingDraw){if(!e.streamingIndex){var t=e.attributes.index
t&&(t.buffer=Ie.createBuffer(),Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,t.buffer),Ie.bufferData(Ie.ELEMENT_ARRAY_BUFFER,t.array||e.ib,Ie.STATIC_DRAW))}}else{e.vb&&void 0===e.vbbuffer&&(e.vbbuffer=Ie.createBuffer(),e.vbNeedsUpdate=!0),e.ib&&void 0===e.ibbuffer&&(e.ibbuffer=Ie.createBuffer(),Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,e.ibbuffer),Ie.bufferData(Ie.ELEMENT_ARRAY_BUFFER,e.ib,Ie.STATIC_DRAW))
for(var i=e.attributes,n=e.attributesKeys,o=0,r=n.length;r>o;o++){var a=n[o],s=i[a],l="index"===a
if(s.array&&void 0===s.buffer&&(s.buffer=Ie.createBuffer(),s.needsUpdate=!0),s.needsUpdate===!0){var c=l?Ie.ELEMENT_ARRAY_BUFFER:Ie.ARRAY_BUFFER
Ie.bindBuffer(c,s.buffer),Ie.bufferData(c,s.array,Ie.STATIC_DRAW),s.needsUpdate=!1}}e.vbNeedsUpdate&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,e.vbbuffer),Ie.bufferData(Ie.ARRAY_BUFFER,e.vb,Ie.STATIC_DRAW),e.vbNeedsUpdate=!1)}}function m(e,t,i){var n
if(i.streamingDraw)return i.vaos=null,!1
if(i.offsets&&i.offsets.length>1)return i.vaos=null,!1
if(!Ne)return i.vaos=null,!1
void 0===i.vaos&&(i.vaos=[]),n=Ne.createVertexArrayOES(),i.vaos.push({geomhash:t.id,vao:n}),Ne.bindVertexArrayOES(n)
var o=i.attributes.index
o&&Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,i.ibbuffer||o.buffer)
for(var r=null,a=t.attributes,s=t.attributesKeys,l=i.vbstride,c=i.offsets&&i.offsets.length?i.offsets[0].index:0,u=0,d=s.length;d>u;u++){var h=s[u],p=a[h]
if(p>=0){var f=i.attributes[h]
if(!f){Ne.bindVertexArrayOES(null)
for(var u=0;u<i.vaos.length;u++)Ne.deleteVertexArrayOES(i.vaos[u].vao)
return i.vaos=null,!1}var m=Ie.FLOAT,v=f.bytesPerItem||4
1===v?m=Ie.UNSIGNED_BYTE:2===v&&(m=Ie.UNSIGNED_SHORT),Ie.enableVertexAttribArray(p),void 0!==f.itemOffset?(r!=i.vbbuffer&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,i.vbbuffer),r=i.vbbuffer),Ie.vertexAttribPointer(p,f.itemSize,m,f.normalize,4*l,4*(f.itemOffset+c*l))):(Ie.bindBuffer(Ie.ARRAY_BUFFER,f.buffer),r=f.buffer,Ie.vertexAttribPointer(p,f.itemSize,m,f.normalize,0,c*f.itemSize*v)),Ve&&i.numInstances&&Ve.vertexAttribDivisorANGLE(p,f.divisor||0)}}return!0}function v(e,t,i){var n=i.vaos
if(n){for(var o=0;o<n.length;o++)if(n[o].geomhash===t.id)return Ne.bindVertexArrayOES(n[o].vao),!0}else if(null===n)return!1
return m(e,t,i)}function g(e,t){var i=Ze[e]
return i||(i=Ie.createBuffer(),Ze[e]=i),Ie.bindBuffer(Ie.ARRAY_BUFFER,i),Ie.bufferData(Ie.ARRAY_BUFFER,t,Ie.DYNAMIC_DRAW),i}function E(e,t,i,n,o){var r=t.attributes,a=t.attributesKeys,s=0,l=void 0
if(o)if(!o.buffer&&i.streamingDraw){var c=Ze.index
c||(c=Ie.createBuffer(),Ze.index=c),Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,c),Ie.bufferData(Ie.ELEMENT_ARRAY_BUFFER,o.array||i.ib,Ie.DYNAMIC_DRAW)}else Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,i.ibbuffer||o.buffer)
for(var u=0,d=a.length;d>u;u++){var h=a[u],p=r[h]
if(p>=0){var f=i.attributes[h]
if(f){var m,v,E=void 0!==f.itemOffset
E?(m=i.vbstride,v=f.itemOffset,s!==l&&(i.streamingDraw?s=g("interleavedVB",i.vb):(s=i.vbbuffer,Ie.bindBuffer(Ie.ARRAY_BUFFER,s)),l=s)):(m=f.itemSize,v=0,i.streamingDraw?s=g(h,f.array):(s=f.buffer,Ie.bindBuffer(Ie.ARRAY_BUFFER,s)))
var y=Ie.FLOAT,A=f.bytesPerItem||4
1===A?y=Ie.UNSIGNED_BYTE:2===A&&(y=Ie.UNSIGNED_SHORT),E&&(A=4),at.enableAttribute(p),Ie.vertexAttribPointer(p,f.itemSize,y,f.normalize,m*A,(v+n*m)*A),Ve&&i.numInstances&&Ve.vertexAttribDivisorANGLE(p,f.divisor||0)}else if(e.defaultAttributeValues){var T=e.defaultAttributeValues[h]
T&&2===T.length?Ie.vertexAttrib2fv(p,e.defaultAttributeValues[h]):T&&3===T.length&&Ie.vertexAttrib3fv(p,e.defaultAttributeValues[h])}}}at.disableUnusedAttributes()}function y(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function A(e,t){return e.object.renderOrder!==t.object.renderOrder?e.object.renderOrder-t.object.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function T(e){w(e,!0)}function b(e){w(e,!1)}function w(e,t,i){if(i||e.visible!==!1){if(e instanceof THREE.Scene||e instanceof THREE.Group);else if(e instanceof Autodesk.Viewing.Private.RenderBatch)e.forEach(t?T:b)
else if(R(e),e instanceof THREE.Light)xe.push(e)
else{var n=Ce[e.id]
if(n&&(e.frustumCulled===!1||Qe.intersectsObject(e)===!0))for(var o=0,r=n.length;r>o;o++){var a=n[o]
S(a),a.render=!0,t===!0&&(et.setFromMatrixPosition(e.matrixWorld),et.applyProjection(Je),a.z=et.z)}}if(e.children)for(var o=0,r=e.children.length;r>o;o++)w(e.children[o],t,i)}}function _(e,t,i,n,o){for(var r,a=0,s=e.length;s>a;a++){var l=e[a],c=l.object,u=l.buffer
if(o)r=o
else{if(r=l.material,!r)continue
B(r)}De.setMaterialFaces(r),u instanceof THREE.BufferGeometry?De.renderBufferDirect(t,i,n,r,u,c):De.renderBuffer(t,i,n,r,u,c)}}function x(e,t){if(e.visible&&!e.hide){var i
if(Ht)i=Ht
else{if(i=e.material,!i)return
B(i)}De.setMaterialFaces(i),De.renderBufferDirect(Vt,Nt,Dt,i,e.geometry,e)}}function C(e,t,i,n,o,r){kt=t,Vt=i,Nt=n,Ht=r||null,e.forEach(x,e.forceVisible?1:128,!1)}function S(e){var t=e.object,i=e.buffer,n=t.geometry,o=t.material
if(o instanceof THREE.MeshFaceMaterial){var r=n instanceof THREE.BufferGeometry?0:i.materialIndex
o=o.materials[r],e.material=o,o.transparent?Le.push(e):Pe.push(e)}else o&&(e.material=o,o.transparent?Le.push(e):Pe.push(e))}function R(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("removed",wt))
var i=e.geometry
if(void 0===i||void 0===i.__webglInit&&(i.__webglInit=!0,i.addEventListener("dispose",_t),i instanceof THREE.BufferGeometry||(e instanceof THREE.Mesh?P(e,i):e instanceof THREE.Line&&void 0===i.__webglVertexBuffer&&(t(i),o(i,e),i.verticesNeedUpdate=!0,i.colorsNeedUpdate=!0,i.lineDistancesNeedUpdate=!0))),void 0===e.__webglActive)if(e.__webglActive=!0,e instanceof THREE.Mesh){if(i instanceof THREE.BufferGeometry)L(Ce,i,e)
else if(i instanceof THREE.Geometry)for(var n=Ot[i.id],r=0,a=n.length;a>r;r++)L(Ce,n[r],e)}else e instanceof THREE.Line||e instanceof THREE.PointCloud?L(Ce,i,e):(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&I(Se,e)}function M(e,t){for(var i,n,o=st.get("OES_element_index_uint")?4294967296:65535,r={},a=e.morphTargets?e.morphTargets.length:0,s=e.morphNormals?e.morphNormals.length:0,l={},c=[],u=0,d=e.faces.length;d>u;u++){var h=e.faces[u],p=t?h.materialIndex:0
p in r||(r[p]={hash:p,counter:0}),i=r[p].hash+"_"+r[p].counter,i in l||(n={id:Bt++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:a,numMorphNormals:s},l[i]=n,c.push(n)),l[i].vertices+3>o&&(r[p].counter+=1,i=r[p].hash+"_"+r[p].counter,i in l||(n={id:Bt++,faces3:[],materialIndex:p,vertices:0,numMorphTargets:a,numMorphNormals:s},l[i]=n,c.push(n))),l[i].faces3.push(u),l[i].vertices+=3}return c}function P(e,t){var n=e.material,o=!1;(void 0===Ot[t.id]||t.groupsNeedUpdate===!0)&&(delete Ce[e.id],Ot[t.id]=M(t,n instanceof THREE.MeshFaceMaterial),t.groupsNeedUpdate=!1)
for(var a=Ot[t.id],s=0,l=a.length;l>s;s++){var c=a[s]
void 0===c.__webglVertexBuffer?(i(c),r(c,e),t.verticesNeedUpdate=!0,t.morphTargetsNeedUpdate=!0,t.elementsNeedUpdate=!0,t.uvsNeedUpdate=!0,t.normalsNeedUpdate=!0,t.tangentsNeedUpdate=!0,t.colorsNeedUpdate=!0,o=!0):o=!1,(o||void 0===e.__webglActive)&&L(Ce,c,e)}e.__webglActive=!0}function L(e,t,i){var n=i.id
e[n]=e[n]||[],e[n].push({id:n,buffer:t,object:i,material:null,z:0})}function I(e,t){e.push({id:null,object:t,opaque:null,transparent:null,z:0})}function k(e){var t,i,n=e.geometry
if(n instanceof THREE.BufferGeometry)f(n)
else if(e instanceof THREE.Mesh){n.groupsNeedUpdate===!0&&P(e,n)
for(var o=Ot[n.id],r=0,s=o.length;s>r;r++){var l=o[r]
i=a(e,l),t=i.attributes&&V(i),(n.verticesNeedUpdate||n.morphTargetsNeedUpdate||n.elementsNeedUpdate||n.uvsNeedUpdate||n.normalsNeedUpdate||n.colorsNeedUpdate||n.tangentsNeedUpdate||t)&&p(l,e,Ie.DYNAMIC_DRAW,!n.dynamic,i)}n.verticesNeedUpdate=!1,n.morphTargetsNeedUpdate=!1,n.elementsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.tangentsNeedUpdate=!1,i.attributes&&N(i)}else e instanceof THREE.Line&&(i=a(e,n),t=i.attributes&&V(i),(n.verticesNeedUpdate||n.colorsNeedUpdate||n.lineDistancesNeedUpdate||t)&&h(n,Ie.DYNAMIC_DRAW),n.verticesNeedUpdate=!1,n.colorsNeedUpdate=!1,n.lineDistancesNeedUpdate=!1,i.attributes&&N(i))}function V(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0
return!1}function N(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function D(e){e instanceof THREE.Mesh||e instanceof THREE.PointCloud||e instanceof THREE.Line?delete Ce[e.id]:(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&H(Se,e),delete e.__webglInit,delete e.__webglActive}function H(e,t){for(var i=e.length-1;i>=0;i--)e[i].object===t&&e.splice(i,1)}function O(e,t,i,n){e.addEventListener("dispose",St)
var o=Ft[e.type]
if(o){var r=THREE.ShaderLib[o]
e.__webglShader={uniforms:THREE.UniformsUtils.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else e.__webglShader={uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}
var a=de(t),s=he(t),l={precision:me,precisionFragment:ve,supportsVertexTextures:mt,haveTextureLod:!!st.get("EXT_shader_texture_lod"),map:!!e.map,envMap:!!e.envMap,irradianceMap:!!e.irradianceMap,envIsSpherical:e.envMap&&e.envMap.mapping==THREE.SphericalReflectionMapping,envGammaEncoded:e.envMap&&e.envMap.GammaEncoded,irrGammaEncoded:e.irradianceMap&&e.irradianceMap.GammaEncoded,envRGBM:e.envMap&&e.envMap.RGBM,irrRGBM:e.irradianceMap&&e.irradianceMap.RGBM,lightMap:!!e.lightMap,bumpMap:st.get("OES_standard_derivatives")&&!!e.bumpMap,normalMap:st.get("OES_standard_derivatives")&&!!e.normalMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,vertexColors:e.vertexColors,fog:i,useFog:e.fog,fogExp:i instanceof THREE.FogExp2,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:be,maxDirLights:a.directional,maxPointLights:a.point,maxSpotLights:a.spot,maxHemiLights:a.hemi,maxShadows:s,shadowMapEnabled:De.shadowMapEnabled&&n.receiveShadow,shadowMapType:De.shadowMapType,shadowMapDebug:De.shadowMapDebug,shadowMapCascade:De.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,clearcoat:e.clearcoat,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide,mrtNormals:e.mrtNormals,mrtIdBuffer:e.mrtIdBuffer,tonemapOutput:e.tonemapOutput,packedNormals:e.packedNormals,hatchPattern:!!e.hatchParams,numCutplanes:e.cutplanes?e.cutplanes.length:0,mapInvert:e.map&&e.map.invert,mapClampS:e.map&&e.map.clampS,mapClampT:e.map&&e.map.clampT,bumpMapClampS:e.bumpMap&&e.bumpMap.clampS,bumpMapClampT:e.bumpMap&&e.bumpMap.clampT,normalMapClampS:e.normalMap&&e.normalMap.clampS,normalMapClampT:e.normalMap&&e.normalMap.clampT,specularMapClampS:e.specularMap&&e.specularMap.clampS,specularMapClampT:e.specularMap&&e.specularMap.clampT,alphaMapInvert:e.alphaMap&&e.alphaMap.invert,alphaMapClampS:e.alphaMap&&e.alphaMap.clampS,alphaMapClampT:e.alphaMap&&e.alphaMap.clampT},c=[]
o?c.push(o):(c.push(e.fragmentShader),c.push(e.vertexShader))
for(var d in e.defines)c.push(d),c.push(e.defines[d])
for(var h in l)c.push(h),c.push(l[h])
for(var p,f=c.join(),h=0,m=He.length;m>h;h++){var v=He[h]
if(v.code===f){p=v,p.usedTimes++
break}}void 0===p&&(p=new FireflyWebGLProgram(De,f,e,l),He.push(p),De.info.memory.programs=He.length),e.program=p,e.uniformsList=[]
for(u in e.__webglShader.uniforms){var g=e.program.uniforms[u]
g&&e.uniformsList.push([e.__webglShader.uniforms[u],g])}}function B(e){e.transparent===!0&&at.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha),at.setDepthTest(e.depthTest),at.setDepthWrite(e.depthWrite),at.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function F(e,t,i,n,o){Ge=0,n.needsUpdate&&(n.program&&It(n),O(n,t,i,o),n.needsUpdate=!1)
var r=!1,a=!1,s=!1,l=n.program,c=l.uniforms,u=n.__webglShader.uniforms
if(l.id!==Oe&&(Ie.useProgram(l.program),Oe=l.id,r=!0,a=!0,s=!0),n.id!==Fe&&(-1===Fe&&(s=!0),Fe=n.id,a=!0),(r||e!==Ue)&&(Ie.uniformMatrix4fv(c.projectionMatrix,!1,e.projectionMatrix.elements),be&&Ie.uniform1f(c.logDepthBufFC,2/(Math.log(e.far+1)/Math.LN2)),e!==Ue&&(Ue=e),(n instanceof THREE.ShaderMaterial||n instanceof THREE.MeshPhongMaterial||n.isPrismMaterial||n.envMap)&&null!==c.cameraPosition&&(et.setFromMatrixPosition(e.matrixWorld),Ie.uniform3f(c.cameraPosition,et.x,et.y,et.z)),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.ShaderMaterial||n.isPrismMaterial||n.skinning)&&(null!==c.viewMatrix&&Ie.uniformMatrix4fv(c.viewMatrix,!1,e.matrixWorldInverse.elements),null!==c.viewMatrixInverse&&Ie.uniformMatrix4fv(c.viewMatrixInverse,!1,$e.elements),c.mvpMatrix&&Ie.uniformMatrix4fv(c.mvpMatrix,!1,Je.elements),s?(j(u,n),X(u,!0)):X(u,!1))),a&&(i&&n.fog&&W(u,i),(n instanceof THREE.MeshPhongMaterial||n instanceof THREE.MeshLambertMaterial||n.isPrismMaterial||n.lights)&&(it&&(s=!0,ne(t),it=!1),s?(Z(u,nt),Q(u,!0)):Q(u,!1)),(n instanceof THREE.MeshBasicMaterial||n instanceof THREE.MeshLambertMaterial||n instanceof THREE.MeshPhongMaterial)&&(U(u,n),j(u,n)),n instanceof THREE.LineBasicMaterial?z(u,n):n instanceof THREE.LineDashedMaterial?(z(u,n),G(u,n)):n instanceof THREE.MeshPhongMaterial?Y(u,n):n instanceof THREE.MeshLambertMaterial?K(u,n):n instanceof THREE.MeshDepthMaterial?(u.mNear.value=e.near,u.mFar.value=e.far,u.opacity.value=n.opacity):n instanceof THREE.MeshNormalMaterial?u.opacity.value=n.opacity:n.isPrismMaterial&&(q(u,n),j(u,n)),o.receiveShadow&&!n._shadowPass&&J(u,t),n.cutplanes&&n.cutplanes.length>0&&(u.cutplanes.value=n.cutplanes,u.cutplanes._array&&u.cutplanes._array.length!=4*n.cutplanes&&(u.cutplanes._array=void 0),u.cutplanesOutlineColor&&n.cutplanesOutlineColor&&(u.cutplanesOutlineColor.value=n.cutplanesOutlineColor),u.cutplanesOutlineThickness&&n.cutplanesOutlineThickness&&(u.cutplanesOutlineThickness.value=n.cutplanesOutlineThickness)),n.hatchParams&&u.hatchParams&&(u.hatchParams.value.copy(n.hatchParams),u.hatchTintColor.value.copy(n.hatchTintColor),u.hatchTintIntensity.value=n.hatchTintIntensity),te(n.uniformsList)),$(c,o,e),null!==c.modelMatrix&&Ie.uniformMatrix4fv(c.modelMatrix,!1,o.matrixWorld.elements),null!==c.dbId){var d=o.dbId||o.fragId||0
Ie.uniform4f(c.dbId,(255&d)/255,(d>>8&255)/255,(d>>16&255)/255,(d>>24&255)/255)}return l}function U(e,t){function i(e,t,i){var n=i.offset,o=i.repeat
if(t){var r=t.value
i.matrix?r.copy(i.matrix):r.identity(),r.elements[6]+=n.x,r.elements[7]+=n.y,r.elements[0]*=o.x,r.elements[3]*=o.x,r.elements[1]*=o.y,r.elements[4]*=o.y}else e.offsetRepeat.value.set(n.x,n.y,o.x,o.y)}e.opacity.value=t.opacity,e.diffuse.value.copy(t.color),e.map.value=t.map,e.lightMap.value=t.lightMap,e.specularMap.value=t.specularMap,e.alphaMap.value=t.alphaMap,t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.alphaMap&&i(e,e.texMatrixAlpha,t.alphaMap)
var n
t.normalMap?n=t.normalMap:t.bumpMap&&(n=t.bumpMap),void 0!==n&&i(e,e.texMatrixBump,n)
var o
t.map?o=t.map:t.specularMap&&(o=t.specularMap),void 0!==o&&i(e,e.texMatrix,o),e.envMap.value=t.envMap,e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap),e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio}function z(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}function G(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function W(e,t){e.fogColor.value=t.color,t instanceof THREE.Fog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t instanceof THREE.FogExp2&&(e.fogDensity.value=t.density)}function j(e,t){e.envMap&&(e.envMap.value=t.envMap),e.irradianceMap&&(e.irradianceMap.value=t.irradianceMap),e.envMapExposure&&(e.envMapExposure.value=t.envMapExposure),e.envRotationSin&&e.envRotationCos&&(e.envRotationSin.value=t.envRotationSin,e.envRotationCos.value=t.envRotationCos)}function X(e,t){e.envMap&&(e.envMap.needsUpdate=t),e.irradianceMap&&(e.irradianceMap.needsUpdate=t),e.envMapExposure&&(e.envMapExposure.needsUpdate=t)}function Y(e,t){e.shininess.value=t.shininess
var i=Math.log(Math.max(1+1e-10,t.shininess))
e.reflMipIndex.value=Math.max(0,-.72134752*i+5.5),e.emissive.value.copy(t.emissive),e.specular.value.copy(t.specular),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB),e.exposureBias.value=t.exposureBias}function q(e,t){function i(e,t,i){e[i].value=t[i],null!=t[i]&&(e[i+"_texMatrix"].value=(new THREE.Matrix3).copy(t[i].matrix),e[i+"_invert"].value=t[i].invert)}function n(e,t,i){e[i].value=t[i],null!=t[i]&&(e[i+"_texMatrix"].value=(new THREE.Matrix3).copy(t[i].matrix),e[i+"_bumpScale"].value=(new THREE.Vector2).copy(t[i].bumpScale),e[i+"_bumpmapType"].value=t[i].bumpmapType)}switch(e.exposureBias.value=t.exposureBias,e.surface_albedo.value=(new THREE.Color).copy(t.surface_albedo),e.surface_roughness.value=t.surface_roughness,e.surface_anisotropy.value=t.surface_anisotropy,e.surface_rotation.value=t.surface_rotation,i(e,t,"surface_albedo_map"),i(e,t,"surface_roughness_map"),i(e,t,"surface_cutout_map"),i(e,t,"surface_anisotropy_map"),i(e,t,"surface_rotation_map"),n(e,t,"surface_normal_map"),t.prismType){case"PrismOpaque":e.opaque_albedo.value=(new THREE.Color).copy(t.opaque_albedo),e.opaque_luminance_modifier.value=(new THREE.Color).copy(t.opaque_luminance_modifier),e.opaque_f0.value=t.opaque_f0,e.opaque_luminance.value=t.opaque_luminance,i(e,t,"opaque_albedo_map"),i(e,t,"opaque_luminance_modifier_map"),i(e,t,"opaque_f0_map")
break
case"PrismMetal":e.metal_f0.value=(new THREE.Color).copy(t.metal_f0),i(e,t,"metal_f0_map")
break
case"PrismLayered":e.layered_f0.value=t.layered_f0,e.layered_diffuse.value=(new THREE.Color).copy(t.layered_diffuse),e.layered_fraction.value=t.layered_fraction,e.layered_bottom_f0.value=(new THREE.Color).copy(t.layered_bottom_f0),e.layered_roughness.value=t.layered_roughness,e.layered_anisotropy.value=t.layered_anisotropy,e.layered_rotation.value=t.layered_rotation,i(e,t,"layered_bottom_f0_map"),i(e,t,"layered_f0_map"),i(e,t,"layered_diffuse_map"),i(e,t,"layered_fraction_map"),i(e,t,"layered_roughness_map"),i(e,t,"layered_anisotropy_map"),i(e,t,"layered_rotation_map"),n(e,t,"layered_normal_map")
break
case"PrismTransparent":e.transparent_color.value=(new THREE.Color).copy(t.transparent_color),e.transparent_distance.value=t.transparent_distance,e.transparent_ior.value=t.transparent_ior
break
default:console.warn("Unknown prism type: "+t.prismType)}e.envExponentMin.value=t.envExponentMin,e.envExponentMax.value=t.envExponentMax,e.envExponentCount.value=t.envExponentCount}function K(e,t){e.emissive.value.copy(t.emissive),t.wrapAround&&e.wrapRGB.value.copy(t.wrapRGB)}function Z(e,t){e.ambientLightColor.value=t.ambient,e.directionalLightColor.value=t.directional.colors,e.directionalLightDirection.value=t.directional.positions,e.pointLightColor.value=t.point.colors,e.pointLightPosition.value=t.point.positions,e.pointLightDistance.value=t.point.distances,e.spotLightColor.value=t.spot.colors,e.spotLightPosition.value=t.spot.positions,e.spotLightDistance.value=t.spot.distances,e.spotLightDirection.value=t.spot.directions,e.spotLightAngleCos.value=t.spot.anglesCos,e.spotLightExponent.value=t.spot.exponents,e.hemisphereLightSkyColor.value=t.hemi.skyColors,e.hemisphereLightGroundColor.value=t.hemi.groundColors,e.hemisphereLightDirection.value=t.hemi.positions}function Q(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLightColor.needsUpdate=t,e.directionalLightDirection.needsUpdate=t,e.pointLightColor.needsUpdate=t,e.pointLightPosition.needsUpdate=t,e.pointLightDistance.needsUpdate=t,e.spotLightColor.needsUpdate=t,e.spotLightPosition.needsUpdate=t,e.spotLightDistance.needsUpdate=t,e.spotLightDirection.needsUpdate=t,e.spotLightAngleCos.needsUpdate=t,e.spotLightExponent.needsUpdate=t,e.hemisphereLightSkyColor.needsUpdate=t,e.hemisphereLightGroundColor.needsUpdate=t,e.hemisphereLightDirection.needsUpdate=t}function J(e,t){if(e.shadowMatrix)for(var i=0,n=0,o=t.length;o>n;n++){var r=t[n]
r.castShadow&&(r instanceof THREE.SpotLight||r instanceof THREE.DirectionalLight&&!r.shadowCascade)&&(e.shadowMap.value[i]=r.shadowMap,e.shadowMapSize.value[i]=r.shadowMapSize,e.shadowMatrix.value[i]=r.shadowMatrix,e.shadowDarkness.value[i]=r.shadowDarkness,e.shadowBias.value[i]=r.shadowBias,i++)}}function $(e,t,i){Re.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),Ie.uniformMatrix4fv(e.modelViewMatrix,!1,Re.elements),e.normalMatrix&&(Me.getNormalMatrix(Re),Ie.uniformMatrix3fv(e.normalMatrix,!1,Me.elements))}function ee(){var e=Ge
return e>=dt&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+dt),Ge+=1,e}function te(e){for(var t,i,n,o=0,r=e.length;r>o;o++){var a=e[o][0]
if(a.needsUpdate!==!1){var s=a.type,l=a.value,c=e[o][1]
switch(s){case"1i":Ie.uniform1i(c,l)
break
case"1f":Ie.uniform1f(c,l)
break
case"2f":Ie.uniform2f(c,l[0],l[1])
break
case"3f":Ie.uniform3f(c,l[0],l[1],l[2])
break
case"4f":Ie.uniform4f(c,l[0],l[1],l[2],l[3])
break
case"1iv":Ie.uniform1iv(c,l)
break
case"3iv":Ie.uniform3iv(c,l)
break
case"1fv":Ie.uniform1fv(c,l)
break
case"2fv":Ie.uniform2fv(c,l)
break
case"3fv":Ie.uniform3fv(c,l)
break
case"4fv":Ie.uniform4fv(c,l)
break
case"Matrix3fv":Ie.uniformMatrix3fv(c,!1,l)
break
case"Matrix4fv":Ie.uniformMatrix4fv(c,!1,l)
break
case"i":Ie.uniform1i(c,l)
break
case"f":Ie.uniform1f(c,l)
break
case"v2":Ie.uniform2f(c,l.x,l.y)
break
case"v3":Ie.uniform3f(c,l.x,l.y,l.z)
break
case"v4":Ie.uniform4f(c,l.x,l.y,l.z,l.w)
break
case"c":Ie.uniform3f(c,l.r,l.g,l.b)
break
case"iv1":Ie.uniform1iv(c,l)
break
case"iv":Ie.uniform3iv(c,l)
break
case"fv1":Ie.uniform1fv(c,l)
break
case"fv":Ie.uniform3fv(c,l)
break
case"v2v":void 0===a._array&&(a._array=new Float32Array(2*l.length))
for(var u=0,d=l.length;d>u;u++)n=2*u,a._array[n]=l[u].x,a._array[n+1]=l[u].y
Ie.uniform2fv(c,a._array)
break
case"v3v":void 0===a._array&&(a._array=new Float32Array(3*l.length))
for(var u=0,d=l.length;d>u;u++)n=3*u,a._array[n]=l[u].x,a._array[n+1]=l[u].y,a._array[n+2]=l[u].z
Ie.uniform3fv(c,a._array)
break
case"v4v":void 0===a._array&&(a._array=new Float32Array(4*l.length))
for(var u=0,d=l.length;d>u;u++)n=4*u,a._array[n]=l[u].x,a._array[n+1]=l[u].y,a._array[n+2]=l[u].z,a._array[n+3]=l[u].w
Ie.uniform4fv(c,a._array)
break
case"m3":Ie.uniformMatrix3fv(c,!1,l.elements)
break
case"m3v":void 0===a._array&&(a._array=new Float32Array(9*l.length))
for(var u=0,d=l.length;d>u;u++)l[u].flattenToArrayOffset(a._array,9*u)
Ie.uniformMatrix3fv(c,!1,a._array)
break
case"m4":Ie.uniformMatrix4fv(c,!1,l.elements)
break
case"m4v":void 0===a._array&&(a._array=new Float32Array(16*l.length))
for(var u=0,d=l.length;d>u;u++)l[u].flattenToArrayOffset(a._array,16*u)
Ie.uniformMatrix4fv(c,!1,a._array)
break
case"t":if(t=l,i=ee(),Ie.uniform1i(c,i),!t)continue
t instanceof THREE.CubeTexture||t.image instanceof Array&&6===t.image.length?ae(t,i):t instanceof THREE.WebGLRenderTargetCube?se(t,i):De.setTexture(t,i)
break
case"tv":void 0===a._array&&(a._array=[])
for(var u=0,d=a.value.length;d>u;u++)a._array[u]=ee()
Ie.uniform1iv(c,a._array)
for(var u=0,d=a.value.length;d>u;u++)t=a.value[u],i=a._array[u],t&&De.setTexture(t,i)
break
default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+s)}}}}function ie(e,t,i,n){e[t]=i.r*n,e[t+1]=i.g*n,e[t+2]=i.b*n}function ne(e){var t,i,n,o,r,a,s,l,c=0,u=0,d=0,h=nt,p=h.directional.colors,f=h.directional.positions,m=h.point.colors,v=h.point.positions,g=h.point.distances,E=h.spot.colors,y=h.spot.positions,A=h.spot.distances,T=h.spot.directions,b=h.spot.anglesCos,w=h.spot.exponents,_=h.hemi.skyColors,x=h.hemi.groundColors,C=h.hemi.positions,S=0,R=0,M=0,P=0,L=0,I=0,k=0,V=0,N=0,D=0,H=0,O=0
for(t=0,i=e.length;i>t;t++)if(n=e[t],!n.onlyShadow)if(o=n.color,s=n.intensity,l=n.distance,n instanceof THREE.AmbientLight){if(!n.visible)continue
c+=o.r,u+=o.g,d+=o.b}else if(n instanceof THREE.DirectionalLight){if(L+=1,!n.visible)continue
tt.setFromMatrixPosition(n.matrixWorld),et.setFromMatrixPosition(n.target.matrixWorld),tt.sub(et),tt.normalize(),N=3*S,f[N]=tt.x,f[N+1]=tt.y,f[N+2]=tt.z,ie(p,N,o,s),S+=1}else if(n instanceof THREE.PointLight){if(I+=1,!n.visible)continue
D=3*R,ie(m,D,o,s),et.setFromMatrixPosition(n.matrixWorld),v[D]=et.x,v[D+1]=et.y,v[D+2]=et.z,g[R]=l,R+=1}else if(n instanceof THREE.SpotLight){if(k+=1,!n.visible)continue
H=3*M,ie(E,H,o,s),et.setFromMatrixPosition(n.matrixWorld),y[H]=et.x,y[H+1]=et.y,y[H+2]=et.z,A[M]=l,tt.copy(et),et.setFromMatrixPosition(n.target.matrixWorld),tt.sub(et),tt.normalize(),T[H]=tt.x,T[H+1]=tt.y,T[H+2]=tt.z,b[M]=Math.cos(n.angle),w[M]=n.exponent,M+=1}else if(n instanceof THREE.HemisphereLight){if(V+=1,!n.visible)continue
tt.setFromMatrixPosition(n.matrixWorld),tt.normalize(),O=3*P,C[O]=tt.x,C[O+1]=tt.y,C[O+2]=tt.z,r=n.color,a=n.groundColor,ie(_,O,r,s),ie(x,O,a,s),P+=1}for(t=3*S,i=Math.max(p.length,3*L);i>t;t++)p[t]=0
for(t=3*R,i=Math.max(m.length,3*I);i>t;t++)m[t]=0
for(t=3*M,i=Math.max(E.length,3*k);i>t;t++)E[t]=0
for(t=3*P,i=Math.max(_.length,3*V);i>t;t++)_[t]=0
for(t=3*P,i=Math.max(x.length,3*V);i>t;t++)x[t]=0
h.directional.length=S,h.point.length=R,h.spot.length=M,h.hemi.length=P,h.ambient[0]=c,h.ambient[1]=u,h.ambient[2]=d}function oe(e,t,i){var n
i?(Ie.texParameteri(e,Ie.TEXTURE_WRAP_S,ue(t.wrapS)),Ie.texParameteri(e,Ie.TEXTURE_WRAP_T,ue(t.wrapT)),Ie.texParameteri(e,Ie.TEXTURE_MAG_FILTER,ue(t.magFilter)),Ie.texParameteri(e,Ie.TEXTURE_MIN_FILTER,ue(t.minFilter))):(Ie.texParameteri(e,Ie.TEXTURE_WRAP_S,Ie.CLAMP_TO_EDGE),Ie.texParameteri(e,Ie.TEXTURE_WRAP_T,Ie.CLAMP_TO_EDGE),(t.wrapS!==THREE.ClampToEdgeWrapping||t.wrapT!==THREE.ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping. ( "+t.sourceFile+" )"),Ie.texParameteri(e,Ie.TEXTURE_MAG_FILTER,ce(t.magFilter)),Ie.texParameteri(e,Ie.TEXTURE_MIN_FILTER,ce(t.minFilter)),t.minFilter!==THREE.NearestFilter&&t.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter. ( "+t.sourceFile+" )")),n=st.get("EXT_texture_filter_anisotropic"),n&&t.type!==THREE.FloatType&&t.type!==THREE.HalfFloatType&&(t.anisotropy>1||t.__oldAnisotropy)&&(Ie.texParameterf(e,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,De.getMaxAnisotropy())),t.__oldAnisotropy=t.anisotropy)}function re(e,t){if(e.width<=t&&e.height<=t)return e
var i=Math.max(e.width,e.height),n=Math.floor(e.width*t/i),o=Math.floor(e.height*t/i),r=document.createElement("canvas")
r.width=n,r.height=o
var a=r.getContext("2d")
return a.drawImage(e,0,0,e.width,e.height,0,0,n,o),r}function ae(e,t){if(6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.addEventListener("dispose",xt),e.image.__webglTextureCube=Ie.createTexture(),De.info.memory.textures++),Ie.activeTexture(Ie.TEXTURE0+t),Ie.bindTexture(Ie.TEXTURE_CUBE_MAP,e.image.__webglTextureCube),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,e.flipY)
for(var i=e instanceof THREE.CompressedTexture,n=e.image[0]instanceof THREE.DataTexture,o=[],r=0;6>r;r++)!De.autoScaleCubemaps||i||n?o[r]=n?e.image[r].image:e.image[r]:o[r]=re(e.image[r],ft)
var a=o[0],s=THREE.Math.isPowerOfTwo(a.width)&&THREE.Math.isPowerOfTwo(a.height),l=ue(e.format),c=ue(e.type)
oe(Ie.TEXTURE_CUBE_MAP,e,s)
for(var r=0;6>r;r++)if(i)for(var u,d=o[r].mipmaps,h=0,p=d.length;p>h;h++)u=d[h],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?At().indexOf(l)>-1?Ie.compressedTexImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+r,h,l,u.width,u.height,0,u.data):console.warn("Attempt to load unsupported compressed texture format"):Ie.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+r,h,l,u.width,u.height,0,l,c,u.data)
else n?Ie.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,l,o[r].width,o[r].height,0,l,c,o[r].data):Ie.texImage2D(Ie.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,l,l,c,o[r])
e.generateMipmaps&&s&&Ie.generateMipmap(Ie.TEXTURE_CUBE_MAP),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else Ie.activeTexture(Ie.TEXTURE0+t),Ie.bindTexture(Ie.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}function se(e,t){Ie.activeTexture(Ie.TEXTURE0+t),Ie.bindTexture(Ie.TEXTURE_CUBE_MAP,e.__webglTexture)}function le(e){Ie.bindTexture(Ie.TEXTURE_2D,e.__webglTexture),Ie.generateMipmap(Ie.TEXTURE_2D),Ie.bindTexture(Ie.TEXTURE_2D,null)}function ce(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?Ie.NEAREST:Ie.LINEAR}function ue(e){var t
if(e===THREE.RepeatWrapping)return Ie.REPEAT
if(e===THREE.ClampToEdgeWrapping)return Ie.CLAMP_TO_EDGE
if(e===THREE.MirroredRepeatWrapping)return Ie.MIRRORED_REPEAT
if(e===THREE.NearestFilter)return Ie.NEAREST
if(e===THREE.NearestMipMapNearestFilter)return Ie.NEAREST_MIPMAP_NEAREST
if(e===THREE.NearestMipMapLinearFilter)return Ie.NEAREST_MIPMAP_LINEAR
if(e===THREE.LinearFilter)return Ie.LINEAR
if(e===THREE.LinearMipMapNearestFilter)return Ie.LINEAR_MIPMAP_NEAREST
if(e===THREE.LinearMipMapLinearFilter)return Ie.LINEAR_MIPMAP_LINEAR
if(e===THREE.UnsignedByteType)return Ie.UNSIGNED_BYTE
if(e===THREE.UnsignedShort4444Type)return Ie.UNSIGNED_SHORT_4_4_4_4
if(e===THREE.UnsignedShort5551Type)return Ie.UNSIGNED_SHORT_5_5_5_1
if(e===THREE.UnsignedShort565Type)return Ie.UNSIGNED_SHORT_5_6_5
if(e===THREE.ByteType)return Ie.BYTE
if(e===THREE.ShortType)return Ie.SHORT
if(e===THREE.UnsignedShortType)return Ie.UNSIGNED_SHORT
if(e===THREE.IntType)return Ie.INT
if(e===THREE.UnsignedIntType)return Ie.UNSIGNED_INT
if(e===THREE.FloatType)return Ie.FLOAT
if(e===THREE.HalfFloatType)return 36193
if(e===THREE.AlphaFormat)return Ie.ALPHA
if(e===THREE.RGBFormat)return Ie.RGB
if(e===THREE.RGBAFormat)return Ie.RGBA
if(e===THREE.LuminanceFormat)return Ie.LUMINANCE
if(e===THREE.LuminanceAlphaFormat)return Ie.LUMINANCE_ALPHA
if(e===THREE.AddEquation)return Ie.FUNC_ADD
if(e===THREE.SubtractEquation)return Ie.FUNC_SUBTRACT
if(e===THREE.ReverseSubtractEquation)return Ie.FUNC_REVERSE_SUBTRACT
if(e===THREE.ZeroFactor)return Ie.ZERO
if(e===THREE.OneFactor)return Ie.ONE
if(e===THREE.SrcColorFactor)return Ie.SRC_COLOR
if(e===THREE.OneMinusSrcColorFactor)return Ie.ONE_MINUS_SRC_COLOR
if(e===THREE.SrcAlphaFactor)return Ie.SRC_ALPHA
if(e===THREE.OneMinusSrcAlphaFactor)return Ie.ONE_MINUS_SRC_ALPHA
if(e===THREE.DstAlphaFactor)return Ie.DST_ALPHA
if(e===THREE.OneMinusDstAlphaFactor)return Ie.ONE_MINUS_DST_ALPHA
if(e===THREE.DstColorFactor)return Ie.DST_COLOR
if(e===THREE.OneMinusDstColorFactor)return Ie.ONE_MINUS_DST_COLOR
if(e===THREE.SrcAlphaSaturateFactor)return Ie.SRC_ALPHA_SATURATE
if(t=st.get("WEBGL_compressed_texture_s3tc"),null!==t){if(e===THREE.RGB_S3TC_DXT1_Format)return t.COMPRESSED_RGB_S3TC_DXT1_EXT
if(e===THREE.RGBA_S3TC_DXT1_Format)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT
if(e===THREE.RGBA_S3TC_DXT3_Format)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT
if(e===THREE.RGBA_S3TC_DXT5_Format)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t=st.get("WEBGL_compressed_texture_pvrtc"),null!==t){if(e===THREE.RGB_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG
if(e===THREE.RGB_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG
if(e===THREE.RGBA_PVRTC_4BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG
if(e===THREE.RGBA_PVRTC_2BPPV1_Format)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t=st.get("EXT_blend_minmax"),null!==t){if(e===THREE.MinEquation)return t.MIN_EXT
if(e===THREE.MaxEquation)return t.MAX_EXT}return 0}function de(e){for(var t=0,i=0,n=0,o=0,r=0,a=e.length;a>r;r++){var s=e[r]
s.onlyShadow||(s instanceof THREE.DirectionalLight&&t++,s instanceof THREE.PointLight&&i++,s instanceof THREE.SpotLight&&n++,s instanceof THREE.HemisphereLight&&o++)}return{directional:t,point:i,spot:n,hemi:o}}function he(e){for(var t=0,i=0,n=e.length;n>i;i++){var o=e[i]
o.castShadow&&(o instanceof THREE.SpotLight&&t++,o instanceof THREE.DirectionalLight&&!o.shadowCascade&&t++)}return t}console.log("THREE.WebGLRenderer",THREE.REVISION),e=e||{}
var pe=void 0!==e.canvas?e.canvas:document.createElement("canvas"),fe=window.devicePixelRatio||1,me=void 0!==e.precision?e.precision:"highp",ve=void 0!==e.precision?e.precision:isMobileDevice()?"mediump":"highp",ge=void 0!==e.alpha?e.alpha:!1,Ee=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,ye=void 0!==e.antialias?e.antialias:!1,Ae=void 0!==e.stencil?e.stencil:!0,Te=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!0,be=void 0!==e.logarithmicDepthBuffer?e.logarithmicDepthBuffer:!1,we=new THREE.Color(0),_e=0,xe=[],Ce={},Se=[],Re=new THREE.Matrix4,Me=new THREE.Matrix3,Pe=[],Le=[]
this.domElement=pe,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaInput=!1,this.gammaOutput=!1,this.shadowMapEnabled=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapDebug=!1,this.shadowMapCascade=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}}
var Ie,ke,Ve,Ne,De=this,He=[],Oe=null,Be=null,Fe=-1,Ue=null,ze="",Ge=(new THREE.Frustum,new THREE.Matrix4,new THREE.Matrix4,0),We=0,je=0,Xe=pe.width,Ye=pe.height,qe=0,Ke=0,Ze={},Qe=new THREE.Frustum,Je=new THREE.Matrix4,$e=new THREE.Matrix4,et=new THREE.Vector3,tt=new THREE.Vector3,it=!0,nt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}}
try{var ot={alpha:ge,premultipliedAlpha:Ee,antialias:ye,stencil:Ae,preserveDrawingBuffer:Te}
if(Ie=pe.getContext("webgl",ot)||pe.getContext("experimental-webgl",ot),null===Ie)throw null!==pe.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context."
pe.addEventListener("webglcontextlost",function(e){e.preventDefault(),ut(),ct(),Ce={}},!1)}catch(rt){console.error(rt)}var at=new THREE.WebGLState(Ie,ue)
void 0===Ie.getShaderPrecisionFormat&&(Ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})
var st=new THREE.WebGLExtensions(Ie)
st.get("OES_texture_float"),st.get("OES_texture_float_linear"),st.get("OES_texture_half_float"),st.get("OES_texture_half_float_linear"),st.get("OES_standard_derivatives"),st.get("EXT_shader_texture_lod"),st.get("EXT_texture_filter_anisotropic"),st.get("WEBGL_compressed_texture_s3tc"),ke=st.get("WEBGL_draw_buffers"),Ve=null,Ne=st.get("OES_vertex_array_object"),be&&st.get("EXT_frag_depth")
var lt=function(e,t,i,n){Ee===!0&&(e*=n,t*=n,i*=n),Ie.clearColor(e,t,i,n)},ct=function(){Ie.clearColor(0,0,0,1),Ie.clearDepth(1),Ie.clearStencil(0),Ie.enable(Ie.DEPTH_TEST),Ie.depthFunc(Ie.LEQUAL),Ie.frontFace(Ie.CCW),Ie.cullFace(Ie.BACK),Ie.enable(Ie.CULL_FACE),Ie.enable(Ie.BLEND),Ie.blendEquation(Ie.FUNC_ADD),Ie.blendFunc(Ie.SRC_ALPHA,Ie.ONE_MINUS_SRC_ALPHA),Ie.viewport(We,je,Xe,Ye),lt(we.r,we.g,we.b,_e)},ut=function(){Oe=null,Ue=null,ze="",Fe=-1,it=!0,at.reset()}
ct(),this.context=Ie,this.state=at
var dt=Ie.getParameter(Ie.MAX_TEXTURE_IMAGE_UNITS),ht=Ie.getParameter(Ie.MAX_VERTEX_TEXTURE_IMAGE_UNITS),pt=Ie.getParameter(Ie.MAX_TEXTURE_SIZE),ft=Ie.getParameter(Ie.MAX_CUBE_MAP_TEXTURE_SIZE),mt=ht>0,vt=(mt&&st.get("OES_texture_float"),Ie.getShaderPrecisionFormat(Ie.VERTEX_SHADER,Ie.HIGH_FLOAT)),gt=Ie.getShaderPrecisionFormat(Ie.VERTEX_SHADER,Ie.MEDIUM_FLOAT),Et=Ie.getShaderPrecisionFormat(Ie.FRAGMENT_SHADER,Ie.HIGH_FLOAT),yt=Ie.getShaderPrecisionFormat(Ie.FRAGMENT_SHADER,Ie.MEDIUM_FLOAT),At=function(){var e
return function(){if(void 0!==e)return e
if(e=[],st.get("WEBGL_compressed_texture_pvrtc")||st.get("WEBGL_compressed_texture_s3tc"))for(var t=Ie.getParameter(Ie.COMPRESSED_TEXTURE_FORMATS),i=0;i<t.length;i++)e.push(t[i])
return e}}(),Tt=vt.precision>0,bt=gt.precision>0
"highp"!==me||Tt||(bt?(me="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(me="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==me||bt||(me="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),Tt=Et.precision>0,bt=yt.precision>0,"highp"!==ve||Tt||(bt?(ve="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(ve="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"!==ve||bt||(ve="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return Ie},this.forceContextLoss=function(){st.get("WEBGL_lose_context").loseContext()},this.supportsVertexTextures=function(){return mt},this.supportsFloatTextures=function(){return st.get("OES_texture_float")},this.supportsHalfFloatTextures=function(){return st.get("OES_texture_half_float_linear")},this.supportsStandardDerivatives=function(){return st.get("OES_standard_derivatives")},this.supportsCompressedTextureS3TC=function(){return st.get("WEBGL_compressed_texture_s3tc")},this.supportsMRT=function(){return ke},this.supportsBlendMinMax=function(){return st.get("EXT_blend_minmax")},this.getMaxAnisotropy=function(){var e
return function(){if(void 0!==e)return e
var t=st.get("EXT_texture_filter_anisotropic")
return e=null!==t?Ie.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}(),this.getPrecision=function(){return _precision},this.getPixelRatio=function(){return fe},this.setPixelRatio=function(e){fe=e},this.setSize=function(e,t,i){pe.width=e*fe,pe.height=t*fe,i!==!1&&(pe.style.width=e+"px",pe.style.height=t+"px"),this.setViewport(0,0,e,t)},this.setViewport=function(e,t,i,n){We=e*fe,je=t*fe,Xe=i*fe,Ye=n*fe,Ie.viewport(We,je,Xe,Ye)},this.setScissor=function(e,t,i,n){Ie.scissor(e*fe,t*fe,i*fe,n*fe)},this.enableScissorTest=function(e){e?Ie.enable(Ie.SCISSOR_TEST):Ie.disable(Ie.SCISSOR_TEST)},this.getClearColor=function(){return we},this.setClearColor=function(e,t){we.set(e),_e=void 0!==t?t:1,lt(we.r,we.g,we.b,_e)},this.getClearAlpha=function(){return _e},this.setClearAlpha=function(e){_e=e,lt(we.r,we.g,we.b,_e)},this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=Ie.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=Ie.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=Ie.STENCIL_BUFFER_BIT),Ie.clear(n)},this.clearColor=function(){Ie.clear(Ie.COLOR_BUFFER_BIT)},this.clearDepth=function(){Ie.clear(Ie.DEPTH_BUFFER_BIT)},this.clearStencil=function(){Ie.clear(Ie.STENCIL_BUFFER_BIT)},this.clearTarget=function(e,t,i,n){this.setRenderTarget(e),this.clear(t,i,n)},this.resetGLState=ut,this.updateShadowMap=function(e,t){Oe=null,_oldBlending=-1,_oldDepthTest=-1,_oldDepthWrite=-1,ze="",Fe=-1,it=!0,_oldDoubleSided=-1,_oldFlipSided=-1,initObjects(e)}
var wt=function(e){var t=e.target
t.traverse(function(e){e.removeEventListener("remove",wt),D(e)})},_t=function(e){var t=e.target
t.removeEventListener("dispose",_t),Mt(t)},xt=function(e){var t=e.target
t.removeEventListener("dispose",xt),Pt(t),De.info.memory.textures--},Ct=function(e){var t=e.target
t.removeEventListener("dispose",Ct),Lt(t),De.info.memory.textures--},St=function(e){var t=e.target
t.removeEventListener("dispose",St),It(t)},Rt=function(e){if(void 0!==e.__webglVertexBuffer&&Ie.deleteBuffer(e.__webglVertexBuffer),void 0!==e.__webglNormalBuffer&&Ie.deleteBuffer(e.__webglNormalBuffer),void 0!==e.__webglTangentBuffer&&Ie.deleteBuffer(e.__webglTangentBuffer),void 0!==e.__webglColorBuffer&&Ie.deleteBuffer(e.__webglColorBuffer),void 0!==e.__webglUVBuffer&&Ie.deleteBuffer(e.__webglUVBuffer),void 0!==e.__webglUV2Buffer&&Ie.deleteBuffer(e.__webglUV2Buffer),void 0!==e.__webglSkinIndicesBuffer&&Ie.deleteBuffer(e.__webglSkinIndicesBuffer),void 0!==e.__webglSkinWeightsBuffer&&Ie.deleteBuffer(e.__webglSkinWeightsBuffer),void 0!==e.__webglFaceBuffer&&Ie.deleteBuffer(e.__webglFaceBuffer),void 0!==e.__webglLineBuffer&&Ie.deleteBuffer(e.__webglLineBuffer),void 0!==e.__webglLineDistanceBuffer&&Ie.deleteBuffer(e.__webglLineDistanceBuffer),void 0!==e.__webglCustomAttributesList)for(var t in e.__webglCustomAttributesList)Ie.deleteBuffer(e.__webglCustomAttributesList[t].buffer)
De.info.memory.geometries--},Mt=function(e){if(e.__webglInit=void 0,e instanceof THREE.BufferGeometry){if(void 0!==e.vbbuffer&&Ie.deleteBuffer(e.vbbuffer),void 0!==e.ibbuffer&&Ie.deleteBuffer(e.ibbuffer),e.vaos)for(var t=0;t<e.vaos.length;t++)Ne.deleteVertexArrayOES(e.vaos[t].vao)
var i=e.attributes
for(var n in i)void 0!==i[n].buffer&&Ie.deleteBuffer(i[n].buffer)
De.info.memory.geometries--}else{var o=Ot[e.id]
if(void 0!==o){for(var t=0,r=o.length;r>t;t++){var a=o[t]
if(void 0!==a.numMorphTargets){for(var s=0,l=a.numMorphTargets;l>s;s++)Ie.deleteBuffer(a.__webglMorphTargetsBuffers[s])
delete a.__webglMorphTargetsBuffers}if(void 0!==a.numMorphNormals){for(var s=0,l=a.numMorphNormals;l>s;s++)Ie.deleteBuffer(a.__webglMorphNormalsBuffers[s])
delete a.__webglMorphNormalsBuffers}Rt(a)}delete Ot[e.id]}else Rt(e)}}
this.deallocateGeometry=Mt
var Pt=function(e){if(e.image&&e.image.__webglTextureCube)Ie.deleteTexture(e.image.__webglTextureCube)
else{if(!e.__webglInit)return
e.__webglInit=!1,Ie.deleteTexture(e.__webglTexture)}},Lt=function(e){e&&e.__webglTexture&&(Ie.deleteTexture(e.__webglTexture),Ie.deleteFramebuffer(e.__webglFramebuffer),Ie.deleteRenderbuffer(e.__webglRenderbuffer))},It=function(e){var t=e.program.program
if(void 0!==t){e.program=void 0
var i,n,o,r=!1
for(i=0,n=He.length;n>i;i++)if(o=He[i],o.program===t){o.usedTimes--,0===o.usedTimes&&(r=!0)
break}if(r===!0){var a=[]
for(i=0,n=He.length;n>i;i++)o=He[i],o.program!==t&&a.push(o)
He=a,Ie.deleteProgram(t),De.info.memory.programs--}}}
this.renderBufferDirect=function(e,t,i,n,o,r){if(n.visible!==!1){f(r.geometry)
var a=F(e,t,i,n,r),s=o.attributes,l=!1,c=n.wireframe?1:0,u="direct_"+o.id+"_"+a.id+"_"+c
u!==ze&&(ze=u,l=!0)
var d=v(n,a,o)
if(l=l&&!d,l&&at.initAttributes(),r instanceof THREE.Mesh){var h=s.index
if(h){var p,m,g=h.array?h.array:o.ib
g instanceof Uint32Array&&st.get("OES_element_index_uint")?(p=Ie.UNSIGNED_INT,m=4):(p=Ie.UNSIGNED_SHORT,m=2)
var y=o.offsets
y&&y.length>1&&(l=!0)
var A=0
do{var T,b,w
y&&y.length?(T=y[A].index,b=y[A].start,w=y[A].count):(T=0,b=0,w=g.length),l&&E(n,a,o,T,h),o.numInstances?Ve.drawElementsInstancedANGLE(o.isLines?Ie.LINES:Ie.TRIANGLES,w,p,b*m,o.numInstances):Ie.drawElements(o.isLines?Ie.LINES:Ie.TRIANGLES,w,p,b*m)}while(y&&++A<y.length)}else{l&&E(n,a,o,T)
var _=o.attributes.position
o.numInstances?Ve.drawArraysInstancedANGLE(o.isLines?Ie.LINE_STRIP:Ie.TRIANGLES,0,_.array.length/3,o.numInstances):Ie.drawArrays(o.isLines?Ie.LINE_STRIP:Ie.TRIANGLES,0,_.array.length/_.itemSize)}}else console.log("Only THREE.Mesh can be rendered by the Firefly renderer. Use THREE.Mesh to draw lines.")
d&&Ne.bindVertexArrayOES(null)}},this.renderBuffer=function(e,t,i,n,o,r){if(n.visible!==!1){k(r)
var a=F(e,t,i,n,r),s=a.attributes,l=!1,c=n.wireframe?1:0,u=o.id+"_"+a.id+"_"+c
if(u!==ze&&(ze=u,l=!0),l&&at.initAttributes(),!n.morphTargets&&s.position>=0&&l&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglVertexBuffer),at.enableAttribute(s.position),Ie.vertexAttribPointer(s.position,3,Ie.FLOAT,!1,0,0)),l){if(o.__webglCustomAttributesList)for(var d=0,h=o.__webglCustomAttributesList.length;h>d;d++){var p=o.__webglCustomAttributesList[d]
s[p.buffer.belongsToAttribute]>=0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,p.buffer),at.enableAttribute(s[p.buffer.belongsToAttribute]),Ie.vertexAttribPointer(s[p.buffer.belongsToAttribute],p.size,Ie.FLOAT,!1,0,0))}s.color>=0&&(r.geometry.colors.length>0||r.geometry.faces.length>0?(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglColorBuffer),at.enableAttribute(s.color),Ie.vertexAttribPointer(s.color,3,Ie.FLOAT,!1,0,0)):n.defaultAttributeValues&&Ie.vertexAttrib3fv(s.color,n.defaultAttributeValues.color)),s.normal>=0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglNormalBuffer),at.enableAttribute(s.normal),Ie.vertexAttribPointer(s.normal,3,Ie.FLOAT,!1,0,0)),s.tangent>=0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglTangentBuffer),at.enableAttribute(s.tangent),Ie.vertexAttribPointer(s.tangent,4,Ie.FLOAT,!1,0,0)),s.uv>=0&&(r.geometry.faceVertexUvs[0]?(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglUVBuffer),at.enableAttribute(s.uv),Ie.vertexAttribPointer(s.uv,2,Ie.FLOAT,!1,0,0)):n.defaultAttributeValues&&Ie.vertexAttrib2fv(s.uv,n.defaultAttributeValues.uv)),s.uv2>=0&&(r.geometry.faceVertexUvs[1]?(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglUV2Buffer),at.enableAttribute(s.uv2),Ie.vertexAttribPointer(s.uv2,2,Ie.FLOAT,!1,0,0)):n.defaultAttributeValues&&Ie.vertexAttrib2fv(s.uv2,n.defaultAttributeValues.uv2)),s.lineDistance>=0&&(Ie.bindBuffer(Ie.ARRAY_BUFFER,o.__webglLineDistanceBuffer),at.enableAttribute(s.lineDistance),Ie.vertexAttribPointer(s.lineDistance,1,Ie.FLOAT,!1,0,0))}if(at.disableUnusedAttributes(),r instanceof THREE.Mesh){var f=o.__typeArray===Uint32Array?Ie.UNSIGNED_INT:Ie.UNSIGNED_SHORT
n.wireframe?(at.setLineWidth(n.wireframeLinewidth*fe),l&&Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,o.__webglLineBuffer),Ie.drawElements(Ie.LINES,o.__webglLineCount,f,0)):(l&&Ie.bindBuffer(Ie.ELEMENT_ARRAY_BUFFER,o.__webglFaceBuffer),Ie.drawElements(Ie.TRIANGLES,o.__webglFaceCount,f,0))}else if(r instanceof THREE.Line){var m=r.mode===THREE.LineStrip?Ie.LINE_STRIP:Ie.LINES
at.setLineWidth(n.linewidth*fe),Ie.drawArrays(m,0,o.__webglLineCount)}}},this.render=function(e,t,i,n,o){if(t instanceof THREE.Camera==!1)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")
ze="",Fe=-1,Ue=null,void 0!==o&&(xe.length=0,it=!0)
var r=e.fog
e.autoUpdate===!0&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),t.worldUpTransform?$e.multiplyMatrices(t.worldUpTransform,t.matrixWorld):$e.copy(t.matrixWorld),Je.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Qe.setFromMatrix(Je)
var a=e instanceof Autodesk.Viewing.Private.RenderBatch&&e.renderImmediate
if(a||(Pe.length=0,Le.length=0,w(e,De.sortObjects===!0,e.forceVisible===!0),De.sortObjects===!0&&(Pe.sort(A),Le.sort(y))),it&&(o&&o.length&&(xe=o.slice()),ne(xe)),this.resetGLState(),this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),e.overrideMaterial){var s=e.overrideMaterial
B(s),a?C(e,"",t,xe,r,s):(_(Pe,t,xe,r,s),_(Le,t,xe,r,s))}else a?C(e,"",t,xe,r,s):(at.setBlending(THREE.NoBlending),_(Pe,t,xe,r,null),_(Le,t,xe,r,null))
this.resetGLState(),i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&le(i),at.setDepthTest(!0),at.setDepthWrite(!0)}
var kt,Vt,Nt,Dt,Ht,Ot={},Bt=0,Ft={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"firefly_basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"firefly_phong",LineBasicMaterial:"firefly_basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"}
this.setFaceCulling=function(e,t){e===THREE.CullFaceNone?Ie.disable(Ie.CULL_FACE):(t===THREE.FrontFaceDirectionCW?Ie.frontFace(Ie.CW):Ie.frontFace(Ie.CCW),e===THREE.CullFaceBack?Ie.cullFace(Ie.BACK):e===THREE.CullFaceFront?Ie.cullFace(Ie.FRONT):Ie.cullFace(Ie.FRONT_AND_BACK),Ie.enable(Ie.CULL_FACE))},this.setMaterialFaces=function(e){at.setDoubleSided(e.side===THREE.DoubleSide),at.setFlipSided(e.side===THREE.BackSide)},this.uploadTexture=function(e){void 0===e.__webglInit&&(e.__webglInit=!0,e.addEventListener("dispose",xt),e.__webglTexture=Ie.createTexture(),De.info.memory.textures++),Ie.bindTexture(Ie.TEXTURE_2D,e.__webglTexture),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,e.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,e.unpackAlignment),e.image=re(e.image,pt)
var t=e.image,i=THREE.Math.isPowerOfTwo(t.width)&&THREE.Math.isPowerOfTwo(t.height),n=ue(e.format),o=ue(e.type)
oe(Ie.TEXTURE_2D,e,i)
var r,a=e.mipmaps
if(e instanceof THREE.DataTexture)if(a.length>0&&i){for(var s=0,l=a.length;l>s;s++)r=a[s],Ie.texImage2D(Ie.TEXTURE_2D,s,n,r.width,r.height,0,n,o,r.data)
e.generateMipmaps=!1}else Ie.texImage2D(Ie.TEXTURE_2D,0,n,t.width,t.height,0,n,o,t.data)
else if(e instanceof THREE.CompressedTexture)for(var s=0,l=a.length;l>s;s++)r=a[s],e.format!==THREE.RGBAFormat&&e.format!==THREE.RGBFormat?At().indexOf(n)>-1?Ie.compressedTexImage2D(Ie.TEXTURE_2D,s,n,r.width,r.height,0,r.data):console.warn("Attempt to load unsupported compressed texture format"):Ie.texImage2D(Ie.TEXTURE_2D,s,n,r.width,r.height,0,n,o,r.data)
else if(a.length>0&&i){for(var s=0,l=a.length;l>s;s++)r=a[s],Ie.texImage2D(Ie.TEXTURE_2D,s,n,n,o,r)
e.generateMipmaps=!1}else Ie.texImage2D(Ie.TEXTURE_2D,0,n,n,o,e.image)
e.generateMipmaps&&i&&Ie.generateMipmap(Ie.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()},this.setTexture=function(e,t){Ie.activeTexture(Ie.TEXTURE0+t),e.needsUpdate?De.uploadTexture(e):Ie.bindTexture(Ie.TEXTURE_2D,e.__webglTexture)},this.initFrameBufferMRT=function(e,t){var i=e[0],n=!1
if(i&&!i.__webglFramebuffer){void 0===i.depthBuffer&&(i.depthBuffer=!0),void 0===i.stencilBuffer&&(i.stencilBuffer=!0),i.__webglFramebuffer=Ie.createFramebuffer(),Ie.bindFramebuffer(Ie.FRAMEBUFFER,i.__webglFramebuffer)
var o
i.shareDepthFrom?o=i.__webglRenderbuffer=i.shareDepthFrom.__webglRenderbuffer:i.depthBuffer&&!i.stencilBuffer?(o=i.__webglRenderbuffer=Ie.createRenderbuffer(),Ie.bindRenderbuffer(Ie.RENDERBUFFER,o),Ie.renderbufferStorage(Ie.RENDERBUFFER,Ie.DEPTH_COMPONENT16,i.width,i.height)):i.depthBuffer&&i.stencilBuffer&&(o=i.__webglRenderbuffer=Ie.createRenderbuffer(),Ie.bindRenderbuffer(Ie.RENDERBUFFER,o),Ie.renderbufferStorage(Ie.RENDERBUFFER,Ie.DEPTH_STENCIL,i.width,i.height)),i.depthBuffer&&!i.stencilBuffer?Ie.framebufferRenderbuffer(Ie.FRAMEBUFFER,Ie.DEPTH_ATTACHMENT,Ie.RENDERBUFFER,o):i.depthBuffer&&i.stencilBuffer&&Ie.framebufferRenderbuffer(Ie.FRAMEBUFFER,Ie.DEPTH_STENCIL_ATTACHMENT,Ie.RENDERBUFFER,o),n=!0}var r=Be
Ie.bindFramebuffer(Ie.FRAMEBUFFER,i.__webglFramebuffer)
for(var a=0;a<e.length;a++){var s=e[a]
if(!s.__webglTexture){var l=THREE.Math.isPowerOfTwo(s.width)&&THREE.Math.isPowerOfTwo(s.height),c=ue(s.format),u=ue(s.type)
s.addEventListener("dispose",Ct),s.__webglTexture=Ie.createTexture(),De.info.memory.textures++,Ie.bindTexture(Ie.TEXTURE_2D,s.__webglTexture),oe(Ie.TEXTURE_2D,s,l),Ie.texImage2D(Ie.TEXTURE_2D,0,c,s.width,s.height,0,c,u,null),l&&s.generateMipmaps&&Ie.generateMipmap(Ie.TEXTURE_2D)}Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0+a,Ie.TEXTURE_2D,s.__webglTexture,0)}if(ke){for(var d=[ke.COLOR_ATTACHMENT0_WEBGL],a=1;a<e.length;a++)d.push(ke.COLOR_ATTACHMENT0_WEBGL+a)
ke.drawBuffersWEBGL(d)}if(t){var h=Ie.checkFramebufferStatus(Ie.FRAMEBUFFER)
h!==Ie.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+h),delete i.__webglFramebuffer,t=!1)}return Ie.bindFramebuffer(Ie.FRAMEBUFFER,r),n&&(Ie.bindTexture(Ie.TEXTURE_2D,null),Ie.bindRenderbuffer(Ie.RENDERBUFFER,null),Ie.bindFramebuffer(Ie.FRAMEBUFFER,null)),t},this.setRenderTarget=function(e){var t
if(Array.isArray(e))this.initFrameBufferMRT(e),t=e[0]
else if(e){var i=e.__webglFramebuffer
i&&Be===i||this.initFrameBufferMRT([e]),t=e}var n,o,r,a,s
t?(n=t.__webglFramebuffer,o=t.width,r=t.height,a=0,s=0):(n=null,o=Xe,r=Ye,a=We,s=je),n!==Be&&(Ie.bindFramebuffer(Ie.FRAMEBUFFER,n),Ie.viewport(a,s,o,r),Be=n),qe=o,Ke=r},this.verifyMRTWorks=function(e){return ke?this.initFrameBufferMRT(e,!0):!1},this.readRenderTargetPixels=function(e,t,i,n,o,r){if(!(e instanceof THREE.WebGLRenderTarget))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")
if(e.__webglFramebuffer){var a=!1
e.__webglFramebuffer!==Be&&(Ie.bindFramebuffer(Ie.FRAMEBUFFER,e.__webglFramebuffer),a=!0),Ie.checkFramebufferStatus(Ie.FRAMEBUFFER)===Ie.FRAMEBUFFER_COMPLETE?Ie.readPixels(t,i,n,o,Ie.RGBA,Ie.UNSIGNED_BYTE,r):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."),a&&Ie.bindFramebuffer(Ie.FRAMEBUFFER,Be)}}},AutodeskNamespace("Autodesk.Viewing.Private"),function(){function e(e,t){var i=255*t[2]+t[3],n=Math.pow(2,(i-127)/2),o=n/t[1],r=t[0]*o,s=a[0]*r+a[3]*n+a[6]*o,l=a[1]*r+a[4]*n+a[7]*o,c=a[2]*r+a[5]*n+a[8]*o
0>s&&(s=0),0>l&&(l=0),0>c&&(c=0),e[0]=s,e[1]=l,e[2]=c}function t(e,t,i){var n=.0625*Math.sqrt(t[0]*i),o=.0625*Math.sqrt(t[1]*i),r=.0625*Math.sqrt(t[2]*i),a=Math.max(Math.max(n,o),Math.max(r,1e-6))
a>1&&(a=1)
var s=Math.ceil(255*a)/255
n>1&&(n=1),o>1&&(o=1),r>1&&(r=1),e[3]=s
var l=1/s
e[0]=n*l,e[1]=o*l,e[2]=r*l}function i(e,t,i){var n=Math.sqrt(t[0]*i),o=Math.sqrt(t[1]*i),r=Math.sqrt(t[2]*i),a=65504
n>a&&(n=a),o>a&&(o=a),r>a&&(r=a),e[0]=n,e[1]=o,e[2]=r}function n(e){s[0]=e
var t=l[0],i=0
if(0==(2147483647&t))u[i++]=t>>16
else{var n=2147483648&t,o=2139095040&t,r=8388607&t
if(0==o)u[i++]=n>>16
else if(2139095040==o)0==r?u[i++]=n>>16|31744:u[i++]=65024
else{var a,d,h=n>>16,p=(0|o>>23)-127+15
p>=31?u[i++]=n>>16|31744:0>=p?(14-p>24?a=0:(r|=8388608,a=r>>14-p,c[0]=a,a=c[0],r>>13-p&1&&(a+=1)),u[i++]=h|a):(d=p<<10,c[0]=d,d=c[0],a=r>>13,c[0]=a,a=c[0],4096&r?u[i++]=(h|d|a)+1:u[i++]=h|d|a)}}return u[0]}var o=Autodesk.Viewing.Private
o.BackgroundPresets={"Fusion Grey":[230,230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Infinity Pool":[164,175,179,164,175,179],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Custom:[230,230,230,150,150,150]}
var r=o.BackgroundPresets
o.LightPresets=[{name:"Simple Grey",path:null,tonemap:0,E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.8,.9,1],lightMultiplier:1,bgColorGradient:r["Fusion Grey"],darkerFade:!1,rotation:0},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:1,illuminance:1e3,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Photo Booth"],darkerFade:!0,rotation:0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:1,lightDirection:[.1,-.55,-1],bgColorGradient:r["Dark Grey"],darkerFade:!1,rotation:0},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:r["Grey Room"],darkerFade:!0,rotation:0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:r["Photo Booth"],darkerFade:!0,rotation:0},{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:r.Tranquility,darkerFade:!1,rotation:0},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:r["Infinity Pool"],darkerFade:!1,rotation:0},{name:"Simple White",path:null,tonemap:0,E_bias:0,directLightColor:[1,1,1],ambientColor:[.9,.9,.9],lightMultiplier:1,bgColorGradient:r.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0,rotation:0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:1,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r["Sky Blue"],darkerFade:!1,rotation:0},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r.Midnight,darkerFade:!1,rotation:0},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",tonemap:1,illuminance:1e3,E_bias:-9,directLightColor:[.5,.5,.5],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Photo Booth"],darkerFade:!0,rotation:0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:1,illuminance:1e3,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:1,illuminance:1e3,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:1,illuminance:1e3,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:1,illuminance:1e3,E_bias:-9,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Fusion Grey"],darkerFade:!0,rotation:0},{name:"Plaza",path:"Plaza",type:"logluv",tonemap:1,illuminance:24157.736,E_bias:-14,directLightColor:[.9,.9,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r.Plaza,darkerFade:!1,rotation:0},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:1,illuminance:4302.7773,E_bias:-10.461343,directLightColor:[1,1,1],ambientColor:[.25/8,.25/8,.25/8],lightMultiplier:0,bgColorGradient:r["Sky Blue"],darkerFade:!1,rotation:0}],o.DebugEnvironments=[{name:"Field",path:"field",type:"logluv",tonemap:1,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r["Sky Blue"],darkerFade:!1,rotation:0},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:1,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r["Sky Blue"],darkerFade:!1,rotation:0},{name:"Seaport",path:"seaport",type:"logluv",tonemap:1,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r["Sky Blue"],darkerFade:!1,rotation:0},{name:"Glacier",path:"glacier",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r.Midnight,darkerFade:!1,rotation:0},{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:1,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r["Sky Blue"],darkerFade:!1,rotation:0},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:r["RaaS SBS"],darkerFade:!1,rotation:0}],ENABLE_DEBUG&&(o.LightPresets=o.LightPresets.concat(o.DebugEnvironments)),o.CreateCubeMapFromColors=function(e,t){for(var i=255*e.x,n=255*e.y,o=255*e.z,r=255*t.x,a=255*t.y,s=255*t.z,l=new Uint8Array(16),c=new Uint8Array(16),u=new Uint8Array(16),d=0;4>d;d++)l[4*d]=i,l[4*d+1]=n,l[4*d+2]=o,l[4*d+3]=255,c[4*d]=r,c[4*d+1]=a,c[4*d+2]=s,c[4*d+3]=255,0|d/2?(u[4*d]=i,u[4*d+1]=n,u[4*d+2]=o,u[4*d+3]=255):(u[4*d]=r,u[4*d+1]=a,u[4*d+2]=s,u[4*d+3]=255)
var h=new THREE.DataTexture(u,2,2,THREE.RGBAFormat),p=new THREE.DataTexture(u,2,2,THREE.RGBAFormat),f=new THREE.DataTexture(c,2,2,THREE.RGBAFormat),m=new THREE.DataTexture(l,2,2,THREE.RGBAFormat),v=new THREE.DataTexture(u,2,2,THREE.RGBAFormat),g=new THREE.DataTexture(u,2,2,THREE.RGBAFormat),E=new THREE.Texture(null,THREE.CubeReflectionMapping,THREE.RepeatWrapping,THREE.RepeatWrapping,THREE.LinearFilter,THREE.LinearFilter,THREE.RGBAFormat)
return E.image=[p,h,m,f,g,v],E.needsUpdate=!0,E}
var a=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268],s=new Float32Array(1),l=new Uint32Array(s.buffer),c=new Uint16Array(1),u=new Uint16Array(1),d=new Float32Array(4),h=new Float32Array(4)
o.DecodeEnvMap=function(o,r,a){if(!o.LogLuv)return void stderr("Environment map expected to be in LogLuv format.")
for(var s=Math.pow(2,r),l=Array.isArray(o.image)?o.image:[u],c=0;c<l.length;c++)for(var u=l[c],p=0;p<u.mipmaps.length;p++){var f,m=u.mipmaps[p],v=m.data
a?(f=new Uint16Array(v.length/4*3),m.data=f):f=v.buffer
for(var g=0,E=0;E<v.length;E+=4)d[0]=v[E]/255,d[1]=v[E+1]/255,d[2]=v[E+2]/255,d[3]=v[E+3]/255,e(h,d),a?(i(d,h,s),f[g++]=n(d[0]),f[g++]=n(d[1]),f[g++]=n(d[2])):(t(d,h,s),v[E]=Math.round(255*d[0]),v[E+1]=Math.round(255*d[1]),v[E+2]=Math.round(255*d[2]),v[E+3]=Math.round(255*d[3]))}o.LogLuv=!1,a?(o.type=THREE.HalfFloatType,o.format=THREE.RGBFormat,o.RGBM=!1,o.GammaEncoded=!0):o.RGBM=!0},o.DefaultLightPreset=8,o.DefaultLightPreset2d=0}(),function(e){"use strict"
var t=[{id:"SOLID",name:"Solid",ascii_art:"_______________________________________",def:[1]},{id:"BORDER",name:"Border",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.5,-.25,.5,-.25,0,-.25]},{id:"BORDER2",name:"Border (.5x)",ascii_art:"__ __ . __ __ . __ __ . __ __ . __ __ .",def:[.25,-.125,.25,-.125,0,-.125]},{id:"BORDERX2",name:"Border (2x)",ascii_art:"____  ____  .  ____  ____  .  ___",def:[1,-.5,1,-.5,0,-.5]},{id:"CENTER",name:"Center",ascii_art:"____ _ ____ _ ____ _ ____ _ ____ _ ____",def:[1.25,-.25,.25,-.25]},{id:"CENTER2",name:"Center (.5x)",ascii_art:"___ _ ___ _ ___ _ ___ _ ___ _ ___",def:[.75,-.125,.125,-.125]},{id:"CENTERX2",name:"Center (2x)",ascii_art:"________  __  ________  __  _____",def:[2.5,-.5,.5,-.5]},{id:"DASHDOT",name:"Dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . __",def:[.5,-.25,0,-.25]},{id:"DASHDOT2",name:"Dash dot (.5x)",ascii_art:"_._._._._._._._._._._._._._._.",def:[.25,-.125,0,-.125]},{id:"DASHDOTX2",name:"Dash dot (2x)",ascii_art:"____  .  ____  .  ____  .  ___",def:[1,-.5,0,-.5]},{id:"DASHED",name:"Dashed",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ _",def:[.5,-.25]},{id:"DASHED2",name:"Dashed (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.25,-.125]},{id:"DASHEDX2",name:"Dashed (2x)",ascii_art:"____  ____  ____  ____  ____  ___",def:[1,-.5]},{id:"DIVIDE",name:"Divide",ascii_art:"____ . . ____ . . ____ . . ____ . . ____",def:[.5,-.25,0,-.25,0,-.25]},{id:"DIVIDE2",name:"Divide (.5x)",ascii_art:"__..__..__..__..__..__..__..__.._",def:[.25,-.125,0,-.125,0,-.125]},{id:"DIVIDEX2",name:"Divide (2x)",ascii_art:"________  .  .  ________  .  .  _",def:[1,-.5,0,-.5,0,-.5]},{id:"DOT",name:"Dot",ascii_art:". . . . . . . . . . . . . . . . . . . . . . . .",def:[0,-.25]},{id:"DOT2",name:"Dot (.5x)",ascii_art:"........................................",def:[0,-.125]},{id:"DOTX2",name:"Dot (2x)",ascii_art:".  .  .  .  .  .  .  .  .  .  .  .  .  .",def:[0,-.5]},{id:"HIDDEN",name:"Hidden",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __ __",def:[.25,-.125]},{id:"HIDDEN2",name:"Hidden (.5x)",ascii_art:"_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _",def:[.125,-.0625]},{id:"HIDDENX2",name:"Hidden (2x)",ascii_art:"____ ____ ____ ____ ____ ____ ____",def:[.5,-.25]},{id:"PHANTOM",name:"Phantom",ascii_art:"______  __  __  ______  __  __  ______",def:[1.25,-.25,.25,-.25,.25,-.25]},{id:"PHANTOM2",name:"Phantom (.5x)",ascii_art:"___ _ _ ___ _ _ ___ _ _ ___ _ _",def:[.625,-.125,.125,-.125,.125,-.125]},{id:"PHANTOMX2",name:"Phantom (2x)",ascii_art:"____________    ____    ____   _",def:[2.5,-.5,.5,-.5,.5,-.5]},{id:"ACAD_ISO02W100",name:"ISO dash",ascii_art:"__ __ __ __ __ __ __ __ __ __ __ __ __",def:[12,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO03W100",name:"ISO dash space",ascii_art:"__    __    __    __    __    __",def:[12,-18],pen_width:1,unit:"mm"},{id:"ACAD_ISO04W100",name:"ISO long-dash dot",ascii_art:"____ . ____ . ____ . ____ . _",def:[24,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO05W100",name:"ISO long-dash double-dot",ascii_art:"____ .. ____ .. ____ .",def:[24,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO06W100",name:"ISO long-dash triple-dot",ascii_art:"____ ... ____ ... ____",def:[24,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO07W100",name:"ISO dot",ascii_art:". . . . . . . . . . . . . . . . . . . .",def:[.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO08W100",name:"ISO long-dash short-dash",ascii_art:"____ __ ____ __ ____ _",def:[24,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO09W100",name:"ISO long-dash double-short-dash",ascii_art:"____ __ __ ____",def:[24,-3,6,-3,6,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO10W100",name:"ISO dash dot",ascii_art:"__ . __ . __ . __ . __ . __ . __ . ",def:[12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO11W100",name:"ISO double-dash dot",ascii_art:"__ __ . __ __ . __ __ . __ _",def:[12,-3,12,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO12W100",name:"ISO dash double-dot",ascii_art:"__ . . __ . . __ . . __ . .",def:[12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO13W100",name:"ISO double-dash double-dot",ascii_art:"__ __ . . __ __ . . _",def:[12,-3,12,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO14W100",name:"ISO dash triple-dot",ascii_art:"__ . . . __ . . . __ . . . _",def:[12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"ACAD_ISO15W100",name:"ISO double-dash triple-dot",ascii_art:"__ __ . . . __ __ . .",def:[12,-3,12,-3,.5,-3,.5,-3,.5,-3],pen_width:1,unit:"mm"},{id:"FENCELINE1",name:"Fenceline circle",ascii_art:"----0-----0----0-----0----0-----0--",def:[.25,-.1,["CIRC1","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"FENCELINE2",name:"Fenceline square",ascii_art:"----[]-----[]----[]-----[]----[]---",def:[.25,-.1,["BOX","ltypeshp.shx","x=-.1","s=.1"],-.1,1]},{id:"TRACKS",name:"Tracks",ascii_art:"-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-",def:[.15,["TRACK1","ltypeshp.shx","s=.25"],.15]},{id:"BATTING",name:"Batting",ascii_art:"SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS",def:[1e-4,-.1,["BAT","ltypeshp.shx","x=-.1","s=.1"],-.2,["BAT","ltypeshp.shx","r=180","x=.1","s=.1"],-.1]},{id:"HOT_WATER_SUPPLY",name:"Hot water supply",ascii_art:"---- HW ---- HW ---- HW ----",def:[.5,-.2,["HW","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.2]},{id:"GAS_LINE",name:"Gas line",ascii_art:"----GAS----GAS----GAS----GAS----GAS----GAS--",def:[.5,-.2,["GAS","STANDARD","S=.1","R=0.0","X=-0.1","Y=-.05"],-.25]},{id:"ZIGZAG",name:"Zig zag",ascii_art:"/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/",def:[1e-4,-.2,["ZIG","ltypeshp.shx","x=-.2","s=.2"],-.4,["ZIG","ltypeshp.shx","r=180","x=.2","s=.2"],-.2]}],i=function(){for(var e=t.length,i=0,n=0;e>n;n++){var o=t[n]
o.def.length>i&&(i=o.def.length)}for(var r=i+3,a=e,s=1;r>s;)s*=2
for(r=s,s=1;a>s;)s*=2
a=s
for(var l=new Uint8Array(r*a),c=0;e>c;c++){for(var u=c*r,o=t[c],d=96,h=o.unit&&"mm"==o.unit?1/25.4:1,p=o.pen_width||0,f=o.def,m=0,n=0;n<f.length;n++){var v=Math.abs(f[n]),g=.5*p>=v
g&&(v=0)
var E=0|v*d*h
m+=E,l[u+n+2]=E?E:1}l[u]=m%256,l[u+1]=m/256,l[u+f.length+2]=0}var y=new THREE.DataTexture(l,r,a,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0)
return y.generateMipmaps=!1,y.flipY=!1,y.needsUpdate=!0,y}
e.LineStyleDefs=t,e.CreateLinePatternTexture=i}(Autodesk.Viewing.Private),function(){function e(e,t){if(!e||!e.colors)return new THREE.Color(1,0,0)
var i=e.colors[t]
if(!i)return new THREE.Color(0,0,0)
var n=i.values
if(!n||!n.length)return new THREE.Color(1,0,0)
var o=n[0]
return new THREE.Color(o.r,o.g,o.b)}function t(e,t,i){if(!e||!e.scalars)return i
var n=e.scalars[t]
return n?n.values[0]:i}function i(e,t,i){if(!e||!e.booleans)return i
var n=e.booleans
return n?n[t]:i}function n(e,t,i,n){if(!e||!e[t])return n
var o=e[t][i]
return o?o.values[0]:n}function o(e,t,i,n){if(!e||!e.scalars)return n
var o=e.scalars[t]
return o?l(o.values[0],o.units,i):n}function r(e,t,i,n){if(!e||!e[t])return n
var o=e[t][i]
if(!o)return n
var r=o.connections
return r?o.connections[0]:n}function a(e){var t=e
return.04045>=t?t/=12.92:t=Math.pow((t+.055)/1.055,2.4),t}function s(e){var t,i,n
return t=a(e.r),i=a(e.g),n=a(e.b),new THREE.Color(t,i,n)}function l(e,t,i){var n=1
switch(i){case ELengthUnit.MilliMeter:n=1e3
break
case ELengthUnit.DeciMeter:n=10
break
case ELengthUnit.CentiMeter:n=100
break
case ELengthUnit.Meter:n=1
break
case ELengthUnit.KiloMeter:n=.001
break
case ELengthUnit.Inch:n=39.37008
break
case ELengthUnit.Foot:n=3.28084
break
case ELengthUnit.Mile:n=62137e-8
break
case ELengthUnit.Yard:n=1.09361
break
default:console.warn("Unsupported unit: "+i)}if("number"==typeof t)switch(t){case ELengthUnit.MilliMeter:n*=.001
break
case ELengthUnit.DeciMeter:n*=.1
break
case ELengthUnit.CentiMeter:n*=.01
break
case ELengthUnit.Meter:break
case ELengthUnit.KiloMeter:n*=1e3
break
case ELengthUnit.Inch:n*=.0254
break
case ELengthUnit.Foot:n*=.3048
break
case ELengthUnit.Mile:n*=1609.344
break
case ELengthUnit.Yard:n*=.9144
break
default:console.warn("Unsupported unit: "+t),n=1}else switch(t){case"MilliMeter":case"mm":n*=.001
break
case"DeciMeter":case"dm":n*=.1
break
case"CentiMeter":case"cm":n*=.01
break
case"Meter":case"m":break
case"KiloMeter":case"km":n*=1e3
break
case"Inch":case"in":n*=.0254
break
case"Foot":case"ft":n*=.3048
break
case"Mile":case"mi":n*=1609.344
break
case"Yard":case"yard":n*=.9144
break
default:console.warn("Unsupported unit: "+t),n=1}return e*n}function c(e,t,i){if(0==t){var r=o(e,"bumpmap_Depth",i,0),a=1,s=1
return null!=n(e,"scalars","texture_RealWorldScale")?a=s=o(e,"texture_RealWorldScale",i,1):(a=o(e,"texture_RealWorldScaleX",i,1),s=o(e,"texture_RealWorldScaleY",i,1)),a=0==a?1:1/a,s=0==s?1:1/s,new THREE.Vector2(a*r,s*r)}var l=n(e,"scalars","bumpmap_NormalScale",1)
return new THREE.Vector2(l,l)}function u(e,t){var i=o(e,"texture_RealWorldOffsetX",t,0),r=o(e,"texture_RealWorldOffsetY",t,0),a=n(e,"scalars","texture_UOffset",0),s=n(e,"scalars","texture_VOffset",0)
i+=a,r+=s
var l=1,c=1
null!=n(e,"scalars","texture_RealWorldScale")?l=c=o(e,"texture_RealWorldScale",t,1):(l=o(e,"texture_RealWorldScaleX",t,1),c=o(e,"texture_RealWorldScaleY",t,1)),l=0==l?1:1/l,c=0==c?1:1/c
var u=n(e,"scalars","texture_UScale",1),d=n(e,"scalars","texture_VScale",1)
l*=u,c*=d
var h=n(e,"scalars","texture_WAngle",1)
h*=Math.PI/180
var p={elements:[Math.cos(h)*l,Math.sin(h)*c,0,-Math.sin(h)*l,Math.cos(h)*c,0,i,r,1]}
return p}function d(o,a){var l=o.materials,c=l[o.userassets[0]],u=c.properties,d=a?v.createPrismMaterial():new THREE.MeshPhongMaterial
if(d.proteinMat=o,d.packedNormals=!0,c&&a){d.tag=c.tag,d.prismType=c.definition,void 0===d.prismType&&(d.prismType="")
var h=d.mapList
switch(d.transparent=!1,d.envExponentMin=1,d.envExponentMax=512,d.envExponentCount=10,d.surface_albedo=s(e(u,"surface_albedo",new THREE.Color(1,0,0))),h.surface_albedo_map=r(u,"colors","surface_albedo",null),d.surface_anisotropy=n(u,"scalars","surface_anisotropy",0),h.surface_anisotropy_map=r(u,"scalars","surface_anisotropy",null),d.surface_rotation=n(u,"scalars","surface_rotation",0),h.surface_rotation_map=r(u,"scalars","surface_rotation",null),d.surface_roughness=n(u,"scalars","surface_roughness",0),h.surface_roughness_map=r(u,"scalars","surface_roughness",null),h.surface_cutout_map=r(u,"textures","surface_cutout",null),h.surface_normal_map=r(u,"textures","surface_normal",null),d.prismType){case"PrismOpaque":d.opaque_albedo=s(e(u,"opaque_albedo",new THREE.Color(1,0,0))),h.opaque_albedo_map=r(u,"colors","opaque_albedo",null),d.opaque_luminance_modifier=s(e(u,"opaque_luminance_modifier",new THREE.Color(0,0,0))),h.opaque_luminance_modifier_map=r(u,"colors","opaque_luminance_modifier",null),d.opaque_f0=n(u,"scalars","opaque_f0",0),h.opaque_f0_map=r(u,"scalars","opaque_f0",null),d.opaque_luminance=n(u,"scalars","opaque_luminance",0)
break
case"PrismMetal":d.metal_f0=s(e(u,"metal_f0",new THREE.Color(1,0,0))),h.metal_f0_map=r(u,"colors","metal_f0",null)
break
case"PrismLayered":d.layered_bottom_f0=s(e(u,"layered_bottom_f0",new THREE.Color(1,1,1))),h.layered_bottom_f0_map=r(u,"colors","layered_bottom_f0",null),d.layered_diffuse=s(e(u,"layered_diffuse",new THREE.Color(1,0,0))),h.layered_diffuse_map=r(u,"colors","layered_diffuse",null),d.layered_anisotropy=n(u,"scalars","layered_anisotropy",0),h.layered_anisotropy_map=r(u,"scalars","layered_anisotropy",null),d.layered_f0=n(u,"scalars","layered_f0",0),h.layered_f0_map=r(u,"scalars","layered_f0",null),d.layered_fraction=n(u,"scalars","layered_fraction",0),h.layered_fraction_map=r(u,"scalars","layered_fraction",null),d.layered_rotation=n(u,"scalars","layered_rotation",0),h.layered_rotation_map=r(u,"scalars","layered_rotation",null),d.layered_roughness=n(u,"scalars","layered_roughness",0),h.layered_roughness_map=r(u,"scalars","layered_roughness",null),h.layered_normal_map=r(u,"textures","layered_normal",null)
break
case"PrismTransparent":d.transparent_color=s(e(u,"transparent_color",new THREE.Color(1,0,0))),d.transparent_distance=n(u,"scalars","transparent_distance",0),d.transparent_ior=n(u,"scalars","transparent_ior",0),d.transparent=!0
break
default:console.warn("Unknown prism type: "+d.prismType)}var p={}
for(var f in h)null!=h[f]&&(p["USE_"+f.toUpperCase()]="")
return p[d.prismType.toUpperCase()]="",d.defines=p,d}if(c&&!a&&"SimplePhong"==c.definition){d.tag=c.tag,d.proteinType=c.proteinType,void 0===d.proteinType&&(d.proteinType=null)
var m=d.ambient=e(u,"generic_ambient"),g=d.color=e(u,"generic_diffuse"),E=d.specular=e(u,"generic_specular"),y=d.emissive=e(u,"generic_emissive")
0==g.r&&0==g.g&&0==g.b&&0==E.r&&0==E.g&&0==E.b&&0==m.r&&0==m.g&&0==m.b&&0==y.r&&0==y.g&&0==y.b&&(g.r=g.g=g.b=.4),d.shininess=t(u,"generic_glossiness",30),d.opacity=1-t(u,"generic_transparency",0),d.reflectivity=t(u,"generic_reflectivity_at_0deg",0)
var A=i(u,"generic_is_metal")
void 0!==A&&(d.metal=A)
var T=i(u,"generic_backface_cull")
void 0===T||T||(d.side=THREE.DoubleSide),d.transparent=c.transparent}else d.ambient=197379,d.color=7829367,d.specular=3355443,d.shininess=30,d.shading=THREE.SmoothShading
return d}function h(e,t,i){auth&&(-1!=e.indexOf("/items/")?THREE.ImageUtils.crossOrigin="use-credentials":THREE.ImageUtils.crossOrigin="")
var n=e.indexOf("urn:")
return-1!=n&&(e=e.substr(0,n)+encodeURIComponent(e.substr(n)),e+="?domain="+encodeURIComponent(window.location.origin),Autodesk.Viewing.ACM_SESSION_ID&&(e+="&acmsession="+Autodesk.Viewing.ACM_SESSION_ID)),THREE.ImageUtils.loadTexture(e,t,i)}function f(e){var t=e.width,i=e.height
if(0===(t&t-1)&&0===(i&i-1))return e
for(var n=1;t>2*n;)n*=2
for(var o=1;i>2*o;)o*=2
var r=document.createElement("canvas"),a=r.getContext("2d")
return r.width=n,r.height=o,a.drawImage(e,0,0,n,o),r}function m(e){function o(e){return-1!=e.indexOf("__lineMaterial__")}function r(e,t){return o(t)?t:e.basePath+"|mat|"+t}this.viewer=e
var a=this,s=this.materials={},l=this.materialsNonHDR={}
this.textures={},this.layerMaskTex=null,this.reflectionCube=null,this.irradianceMap=null
var m=1,g=0,E=1,y=[]
this.hasPrism=!1,this.renderPrism=!0
var A=[],T=new THREE.Vector3(0,1,0)
this.defaultMaterial=new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading,reflectivity:0}),this.dtor=function(){this.cleanup(),THREE.Cache.clear(),this.viewer=null,a=null},this.findMaterial=function(e,t){var i=s[r(e,t)]
return i||(stderr("Unknown material "+t+". Using default."),i=this.defaultMaterial),i},this.setRenderPrism=function(e){this.renderPrism=e},this.convertMaterials=function(e){if(e.materials){var t=e.materials.materials,i=e.proteinMaterials?e.proteinMaterials.materials:null
for(var n in t){var o=!1
if(i){var a=i[n].materials,s=a[i[n].userassets[0]]
if(this.renderPrism&&s){var l=s.definition
o="PrismLayered"==l||"PrismMetal"==l||"PrismOpaque"==l||"PrismTransparent"==l}}var c=o?i[n]:t[n],u=d(c,o)
!_isIE11&&e.doubleSided&&(u.side=THREE.DoubleSide)
var h=r(e,n)
this.addMaterial(h,u,o)}}},this.updateMaterials=function(){for(;y.length;)for(var e=y.pop(),t=0;t<e.mats.length;t++)e.mats[t][e.slot]=e.tex,e.mats[t].needsUpdate=!0,this.viewer.invalidate(!0,!1,!1)},this.loadTexture=function(e,o){if(e&&e.proteinMat){var r=e.proteinMat.materials,s=r[e.proteinMat.userassets[0]],l=function(e,t){return h(t,THREE.UVMapping,function(t){if(a){t.image=f(t.image)
var i=a.textures[e]
if(i){i.tex||(i.tex=t)
for(var n=0;n<i.mats.length;n++)i.mats[n][i.slots[n]]=t
y.push(i)}}})}
if(e.isPrismMaterial){var d=e.mapList
for(p in d)if(null!=d[p]){var m=r[d[p]],g=m.properties,E="BumpMap"==m.definition?"bumpmap_Bitmap":"unifiedbitmap_Bitmap",A=g.uris[E].values[0]
if(A){var T=o.basePath+A+m.definition,b=a.textures[T]
if(b)b.tex?(e[p]=b.tex,e.needsUpdate=!0):(a.textures[T].mats.push(e),a.textures[T].slots.push(p))
else{var w=null
w=!PRISM_ROOT||0!==A.indexOf("1/Mats")&&0!==A.indexOf("2/Mats")&&0!==A.indexOf("3/Mats")?v.pathToURL(o.basePath+A):PRISM_ROOT+A
var _={mats:[e],slots:[p],tex:null}
a.textures[T]=_
var x=l(T,w)
x.flipY=!0,x.invert=!1,x.wrapS=THREE.RepeatWrapping,x.wrapT=THREE.RepeatWrapping,x.wrapS=n(g,"booleans","texture_URepeat",!1)?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,x.wrapT=n(g,"booleans","texture_VRepeat",!1)?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping
var C=o.proteinMaterials.scene.SceneUnit
x.matrix=u(g,C),"UnifiedBitmap"==m.definition&&(x.invert=n(g,"booleans","unifiedbitmap_Invert",!1)),"BumpMap"==m.definition&&(x.bumpmapType=n(g,"choicelists","bumpmap_Type",0),x.bumpScale=c(g,x.bumpmapType,C))}}}}else if(s&&"SimplePhong"===s.definition){var S=s.properties,R=s.textures
for(var M in R){var g=r[R[M].connections[0]].properties,A=g.uris.unifiedbitmap_Bitmap.values[0]
if(A){var P
if("generic_diffuse"==M)P="map",(!e.color||0==e.color.r&&0==e.color.g&&0==e.color.b)&&e.color.setRGB(1,1,1)
else if("generic_bump"==M){var L=i(S,"generic_bump_is_normal"),I=t(S,"generic_bump_amount",0)
null==I&&(I=1),L?(P="normalMap",I>1&&(I=1),e.normalScale=new THREE.Vector2(I,I)):(P="bumpMap",I>=1&&(I=.03),e.bumpScale=I)}else if("generic_specular"==M)P="specularMap"
else{if("generic_alpha"!=M)continue
P="alphaMap",e.transparent=!0}var k=e.proteinType&&e.proteinType.length,V=k&&0===e.proteinType.indexOf("Prism"),N=(V&&PRISM_ROOT||k&&PROTEIN_ROOT)&&(0===A.indexOf("1/Mats")||0===A.indexOf("2/Mats")||0===A.indexOf("3/Mats")),T=o.basePath+A,b=a.textures[T]
if(b)b.tex?(e[P]=b.tex,e.needsUpdate=!0):(a.textures[T].mats.push(e),a.textures[T].slots.push(P))
else{var w=null
if(N)w=V?PRISM_ROOT+A:PROTEIN_ROOT+A
else{for(var D=0;D<o.manifest.assets.length;++D){var H=o.manifest.assets[D]
if(H.id==A){w=v.pathToURL(o.basePath+H.URI)
break}}w||(w=v.pathToURL(T))}var _={mats:[e],slots:[P],tex:null}
a.textures[T]=_
var x=l(T,w)
"alphaMap"==P&&(e.transparent=!0),"bumpMap"==P||"normalMap"==P?x.anisotropy=0:x.anisotropy=this.viewer.renderer().getMaxAnisotropy(),x.flipY=!0,x.wrapS=THREE.RepeatWrapping,x.wrapT=THREE.RepeatWrapping,x.invert=i(g,"unifiedbitmap_Invert"),x.clampS=!i(g,"texture_URepeat",!0),x.clampT=!i(g,"texture_VRepeat",!0)
var O=t(g,"texture_UScale",1),B=t(g,"texture_VScale",1),F=t(g,"texture_UOffset",0),U=t(g,"texture_VOffset",0),z=t(g,"texture_WAngle",0)
x.matrix={elements:[Math.cos(z)*O,Math.sin(z)*B,0,-Math.sin(z)*O,Math.cos(z)*B,0,F,U,1]}}}}}}},this.loadTextures=function(e){for(var t in s)if(-1!=t.indexOf(e.basePath)){var i=s[t]
this.loadTexture(i,e)}},this.create2DMaterial=function(e,t,i,n){var o="__lineMaterial__"
if(t.image&&(o+="|image:"+t.image.name),t.clip&&(o+="|clip:"+JSON.stringify(t.clip)),i&&(o+="|id"),n&&(o+="|selection"),t.skipEllipticals&&(o+="|skipEllipticals"),t.skipCircles&&(o+="|skipCircles"),t.skipTriangleGeoms&&(o+="|skipTriangleGeoms"),t.useInstancing&&(o+="|useInstancing"),e&&(o+=e.basePath),o=r(null,o),!s.hasOwnProperty(o)){var l=Autodesk.Viewing.Shaders,c=new THREE.ShaderMaterial({fragmentShader:l.LineShader.fragmentShader,vertexShader:l.LineShader.vertexShader,uniforms:THREE.UniformsUtils.clone(l.LineShader.uniforms),attributes:l.LineShader.attributes,defines:THREE.UniformsUtils.clone(l.LineShader.defines),transparent:!0})
if(c.depthWrite=!1,c.depthTest=!1,c.side=THREE.DoubleSide,c.blending=THREE.NormalBlending,i?(c.defines.ID_COLOR=1,c.blending=THREE.NoBlending):n?c.defines.SELECTION_RENDERER=1:this.viewer.renderer().hasMRT()&&(c.mrtIdBuffer=1),t.skipEllipticals||(c.defines.HAS_ELLIPTICALS=1),t.skipCircles||(c.defines.HAS_CIRCLES=1),t.skipTriangleGeoms||(c.defines.HAS_TRIANGLE_GEOMS=1),t.useInstancing&&(c.defines.USE_INSTANCING=1),this.layerMaskTex&&(c.defines.HAS_LAYERS=1,c.uniforms.tLayerMask.value=a.layerMaskTex),this.lineStyleTex&&(c.defines.HAS_LINESTYLES=1,c.defines.MAX_LINESTYLE_LENGTH=a.lineStyleTex.image.width,c.uniforms.tLineStyle.value=a.lineStyleTex,c.uniforms.vLineStyleTexSize.value.set(a.lineStyleTex.image.width,a.lineStyleTex.image.height)),t.image){var u=this,d=function(e){u.viewer&&(e.image=f(e.image),e.wrapS=THREE.ClampToEdgeWrapping,e.wrapT=THREE.ClampToEdgeWrapping,e.minFilter=THREE.LinearMipMapLinearFilter,e.magFilter=THREE.LinearFilter,e.anisotropy=1,e.flipY=!0,e.generateMipmaps=!0,e.needsUpdate=!0,c.defines.HAS_RASTER_QUADS=1,c.uniforms.tRaster.value=e,-1!=t.image.dataURI.indexOf("png")&&(c.transparent=!0),c.needsUpdate=!0,u.viewer.invalidate(!1,!0,!1))}
h(t.image.dataURI,THREE.UVMapping,d)}c.modelScale=t.modelScale||1,s[o]=c}return o},this.addMaterial=function(e,t,i){function n(e){return.299*e.r+.587*e.g+.114*e.b}var o=t.proteinMat?t.proteinMat:null,r=t.proteinType&&-1!=t.proteinType.indexOf("Prism")
if(this.hasPrism=r||this.hasPrism,!i){if(t.metal)t.reflectivity||(t.reflectivity=n(t.specular)),o&&(1===t.reflectivity&&(t.reflectivity=n(t.specular)),0===t.color.r&&0===t.color.g&&0===t.color.b||(t.color.r*=.1,t.color.g*=.1,t.color.b*=.1))
else if(o)if(r){var l=!1
if("PrismLayered"==t.proteinType&&(t.clearcoat=!0,t.reflectivity=.06,o)){var c=o.materials[o.userassets[0]],u=c.categories
u&&u.length&&-1!=u[0].indexOf("Metal")&&(l=!0)}t.reflectivity=Math.sqrt(t.reflectivity),l?t.specular.copy(t.color):(t.specular.r=t.reflectivity,t.specular.g=t.reflectivity,t.specular.b=t.reflectivity)}else t.reflectivity||(t.reflectivity=.01+.06*n(t.specular)),t.specular.r*=t.reflectivity,t.specular.g*=t.reflectivity,t.specular.b*=t.reflectivity,t.opacity<1&&(t.reflectivity=1)
else t.reflectivity?(t.metal=!0,t.specular.r=t.color.r*t.reflectivity,t.specular.g=t.color.g*t.reflectivity,t.specular.b=t.color.b*t.reflectivity,t.color.r*=.1,t.color.g*=.1,t.color.b*=.1):1!==t.color.r||1!==t.color.g||1!==t.color.b||1!==t.specular.r||1!==t.specular.g||1!==t.specular.b||t.uri_map||t.uri_specularMap||(t.metal=!0,t.reflectivity=.7,t.specular.r=t.specular.g=t.specular.b=t.reflectivity,t.color.r*=.1,t.color.g*=.1,t.color.b*=.1);(t.transparent||t.uri_map&&-1!=t.uri_map.toLowerCase().indexOf(".png")||t.uri_opacityMap)&&(t.alphaTest=.01)}if(t.uri_normalMap){var d=t.bumpScale;(void 0===d||d>=1)&&(d=1),t.normalScale=new THREE.Vector2(d,d)}else void 0===t.bumpScale&&(t.uri_map||t.uri_bumpMap)?t.bumpScale=.03:t.bumpScale>=1&&(t.bumpScale=.03)
t.shininess*=.25,a.reflectionCube&&(t.envMap=a.reflectionCube),a.irradianceMap&&(t.irradianceMap=a.irradianceMap),t.exposureBias=Math.pow(2,this.viewer.renderer().getExposureBias()),t.tonemapOutput=this.viewer.renderer().getToneMapMethod(),t.envMapExposure=m,t.envRotationSin=g,t.envRotationCos=E,this.viewer.renderer().applyMRTFlags(t),t.side==THREE.DoubleSide&&this.viewer.renderer().toggleTwoSided(!0),t.cutplanes=A,t.cutplanesOutlineColor=T,s[e]=t},this.addMaterialNonHDR=function(e,t){t.cutplanes=A,t.cutplanesOutlineColor=T,l[e]=t},this.togglePolygonOffset=function(e){for(var t in s){var i=s[t]
i instanceof THREE.MeshPhongMaterial&&(i.polygonOffset=!0,i.polygonOffsetFactor=e?1:0,i.polygonOffsetUnits=e?1:0,i.needsUpdate=!0)}},this.applyGeometryFlagsToMaterial=function(e,t){t.attributes.color&&(e.vertexColors=THREE.VertexColors,e.needsUpdate=!0),!e.proteinType&&t.attributes.uv&&t.attributes.uv.isPattern&&(e.map&&!e.bumpMap&&(e.bumpMap=e.map,e.needsUpdate=!0),e.uri_map&&!e.uri_bumpMap&&(e.uri_bumpMap=e.uri_map,e.needsUpdate=!0))},this.toggleMRTSetting=function(){for(var e in s){var t=s[e]
o(e)||this.viewer.renderer().applyMRTFlags(t)}},this.updatePixelScale=function(e){var t=s
for(var i in t)if(o(i)){var n=t[i]
n.uniforms.aaRange.value=.5/(e*n.modelScale),n.uniforms.pixelsPerUnit.value=e*n.modelScale}},this.setCubeMapFromColors=function(e,t){var i=v.CreateCubeMapFromColors(e,t)
a.reflectionCube=i,a.reflectionCube.isBgColor=!0
for(var n in s){var o=s[n]
o.envMap=i,o.needsUpdate=!0}return this.viewer.invalidate(!0),a.reflectionCube},this.setCubeMap=function(e,t){var i=this,n=function(n){if(n&&(n.mapping=THREE.CubeReflectionMapping,n.LogLuv=-1!=e.indexOf("logluv"),n.RGBM=-1!=e.indexOf("rgbm"),v.DecodeEnvMap(n,t,!1)),i.reflectionCube=n,i.reflectionCube)for(var o in s){var r=s[o]
r.envMap=a.reflectionCube,r.needsUpdate=!0}else i.setCubeMapFromColors(i.viewer.clearColorTop,i.viewer.clearColorBottom)
i.viewer.invalidate(!0)}
return Array.isArray(e)?(this.reflectionCube=THREE.ImageUtils.loadTextureCube(e,THREE.CubeReflectionMapping,n),this.reflectionCube.format=THREE.RGBFormat):"string"==typeof e?-1!=e.toLowerCase().indexOf(".dds")?this.reflectionCube=(new THREE.DDSLoader).load(e,n):(this.reflectionCube=THREE.ImageUtils.loadTexture(e,THREE.SphericalReflectionMapping,n),this.reflectionCube.format=THREE.RGBFormat):n(e?e:null),i.reflectionCube},this.setIrradianceMap=function(e,t){var i=this,n=function(n){if(n){n.mapping=THREE.CubeReflectionMapping,n.LogLuv=-1!=e.indexOf("logluv"),n.RGBM=-1!=e.indexOf("rgbm"),v.DecodeEnvMap(n,t,!1)
for(var o in s){var r=s[o]
r.irradianceMap=n,r.needsUpdate=!0}i.irradianceMap=n}else if(i.irradianceMap){for(var o in s){var r=s[o]
r.irradianceMap=null,r.needsUpdate=!0}i.irradianceMap=null}i.viewer.invalidate(!0)}
return THREE.ImageUtils.crossOrigin="",Array.isArray(e)?(a.irradianceMap=THREE.ImageUtils.loadTextureCube(e,THREE.CubeReflectionMapping,n),a.irradianceMap.format=THREE.RGBFormat):"string"==typeof e?-1!=e.toLowerCase().indexOf(".dds")&&(a.irradianceMap=(new THREE.DDSLoader).load(e,n)):n(e?e:null),i.irradianceMap},this.setTonemapMethod=function(e){for(var t in s){var i=s[t]
i.tonemapOutput=e,i.needsUpdate=!0}},this.setEnvExposure=function(e){var t=Math.pow(2,e)
m=t
for(var i in s){var n=s[i]
n.envMapExposure=t,n.needsUpdate=!0}},this.setEnvRotation=function(e){g=Math.sin(e),E=Math.cos(e)
for(var t in s){var i=s[t]
i.envRotationSin=g,i.envRotationCos=E,i.needsUpdate=!0}},this.setTonemapExposureBias=function(e){var t=Math.pow(2,e)
for(var i in s){var n=s[i]
n.exposureBias=t,n.needsUpdate=!0}},this.initLayersTexture=function(e){for(var t=e.getData().layerCount,i=256,n=256,o=new Uint8Array(i*n),r=0,a=t;a>r;r++)o[r]=255
var s=new THREE.DataTexture(o,i,n,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0)
s.generateMipmaps=!1,s.flipY=!1,s.needsUpdate=!0,this.layerMaskTex=s,this.layersMap=e.getData().layersMap},this.initLineStyleTexture=function(){this.lineStyleTex=v.CreateLinePatternTexture()},this.init2DSelectionMaterial=function(e){for(var t=e.myData.maxObjectNumber||1,i=4096,n=0|Math.ceil(t/i),o=1;n>o;)o*=2
n=o
for(var r=new Uint8Array(i*n),a=0;t>a;a++)r[a]=0
var l=new THREE.DataTexture(r,i,n,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,0)
l.generateMipmaps=!1,l.flipY=!1,l.needsUpdate=!0,this.selectionTex=l
var c=this.create2DMaterial(e.getData(),{},!1,!0),u=s[c]
return u.uniforms.tSelectionTexture.value=this.selectionTex,u.uniforms.vSelTexSize.value.set(i,n),u.needsUpdate=!0,u},this.setLayerVisible=function(e,t){for(var i=this.layerMaskTex,n=i.image.data,r=this.layersMap,a=t?255:0,l=0;l<e.length;++l){var c=e[l]
n[r[c]]=a}i.needsUpdate=!0
for(var u in s)o(u)&&(s[u].needsUpdate=!0)
this.viewer.invalidate(!0)},this.isLayerVisible=function(e){return!!this.layerMaskTex.image.data[this.layersMap[e]]},this.highlightObject2D=function(e,t){var i=this.selectionTex.image.data
i[e]=t?255:0,this.selectionTex.needsUpdate=!0,this.viewer.invalidate(!1,!1,!0)},this.cloneMaterial=function(e){var t=e.isPrismMaterial?v.clonePrismMaterial(e):e.clone()
return(t instanceof THREE.MeshPhongMaterial||t.isPrismMaterial)&&(t.packedNormals=e.packedNormals,t.exposureBias=e.exposureBias,t.irradianceMap=e.irradianceMap,t.envMapExposure=e.envMapExposure,t.proteinType=e.proteinType,t.proteinMat=e.proteinMat,t.tonemapOutput=e.tonemapOutput,t.cutplanes=e.cutplanes,t.cutplanesOutlineColor=e.cutplanesOutlineColor,t.cutplanesOutlineThickness=e.cutplanesOutlineThickness),this.viewer.renderer().applyMRTFlags(t),t},this.getCutPlanes=function(){return A.slice()},this.getCutPlanesRaw=function(){return A},this.setCutPlanes=function(e){if(A.length!==(e?e.length||0:0)){for(var t in s)s[t].needsUpdate=!0,e&&e.length>0&&(s[t].side=THREE.DoubleSide)
for(var t in l)l[t].needsUpdate=!0}for(;A.length>0;)A.pop()
if(e)for(var i=0;i<e.length;i++)A.push(e[i].clone())},this.setCutPlanesOutlineColor=function(e){T.set(e.r,e.g,e.b)},this.setCutPlanesOutlineThickness=function(e){for(var t in s)s[t].cutplanesOutlineThickness=e
for(var t in l)l[t].cutplanesOutlineThickness=e},this.cleanup=function(e){var t={}
for(var i in this.textures){var n=this.textures[i];-1===i.indexOf(e.basePath)?t[i]=n:n.tex&&n.tex.dispose()}this.textures=t
var o={},r={type:"dispose"}
for(var a in s)if(e&&-1===a.indexOf(e.basePath))o[a]=s[a]
else{var l=s[a]
l.dispatchEvent(r),l.needsUpdate=!0}s=this.materials=o},this.addSimpleMaterial=function(e,t,i){var n=d(t),o=r(i,e)
this.addMaterial(o,n),this.loadTexture(n,i)},this.addMaterial("__defaultMaterial__",this.defaultMaterial)}var v=Autodesk.Viewing.Private
ELengthUnit={MilliMeter:8206,DeciMeter:8204,CentiMeter:8205,Meter:8193,KiloMeter:8201,Inch:8214,Foot:8215,Mile:8225,Yard:8221},Autodesk.Viewing.Private.MaterialManager=m}(),function(){"use strict"
var e=Autodesk.Viewing.Shaders,t=function(t,i){function n(e){return new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,defines:THREE.UniformsUtils.clone(e.defines)})}init_GroundShader()
var o,r,a,s,l,c,u,d,h,p,f,m,v=t,g=!1,E=!1,y={texSize:E?128:64,pixScale:1,blurRadius:E?5:7,debug:!1}
if(this.setTransform=function(e,t,i,n){o.left=-t.z/2,o.right=t.z/2,o.top=t.x/2,o.bottom=-t.x/2,o.near=1,o.far=t.y+o.near,o.updateProjectionMatrix(),o.position.addVectors(e,i.clone().multiplyScalar(-t.y/2-o.near)),n&&o.up.set(n.x,n.y,n.z),o.lookAt(e),a.position.set(e.x,e.y,e.z),a.rotation.set(o.rotation.x,o.rotation.y,o.rotation.z),a.scale.set(t.z,t.x,t.y),y.debug&&(m.position.set(e.x,e.y,e.z),m.rotation.set(o.rotation.x,o.rotation.y,o.rotation.z),m.scale.set(t.z,t.x,t.y)),f.uniforms.worldSize.value.copy(t)},this.renderIntoShadow=function(e){if(!e.overrideMaterial||!e.overrideMaterial.transparent){var t=e.overrideMaterial
e.overrideMaterial=u,v.render(e,o,l,!1),e.overrideMaterial=t}},this.renderShadow=function(e,t){g&&(t?v.render(r,e,t,!1):v.render(r,e))},this.postprocess=function(){E?(f.render(v,c,l),p.render(v,l,c),h.render(v,c,l)):(p.render(v,c,l),h.render(v,l,c)),g=!0},this.clear=function(){var e=v.getClearColor().getHex(),t=v.getClearAlpha()
v.setClearColor(0,0),v.clearTarget(l,!0,!0,!1),v.setClearColor(e,t),g=!1},this.setColor=function(e){d.uniforms.uShadowColor.value.x=e.r,d.uniforms.uShadowColor.value.y=e.g,d.uniforms.uShadowColor.value.z=e.b},this.getColor=function(){return new THREE.Color(d.uniforms.uShadowColor.value.x,d.uniforms.uShadowColor.value.y,d.uniforms.uShadowColor.value.z)},this.setAlpha=function(e){d.uniforms.uShadowColor.value.w=e},this.getAlpha=function(){return d.uniforms.uShadowColor.value.w},this.isValid=function(){return g},this.getDepthMaterial=function(){return u},i)for(var A in y)y[A]=i[A]||y[A]
r=new THREE.Scene,o=new THREE.OrthographicCamera,l=new THREE.WebGLRenderTarget(y.texSize,y.texSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),l.generateMipmaps=!1,c=new THREE.WebGLRenderTarget(y.texSize,y.texSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),c.generateMipmaps=!1,u=n(e.GroundDepthShader),u.side=THREE.DoubleSide,u.blending=THREE.NoBlending,h=new e.LmvShaderPass(e.GroundShadowBlurShader,"tDepth"),p=new e.LmvShaderPass(e.GroundShadowBlurShader,"tDepth"),f=new e.LmvShaderPass(e.GroundShadowAOShader,"tDepth"),h.material.defines.KERNEL_SCALE=p.material.defines.KERNEL_SCALE=(y.pixScale/y.texSize).toFixed(4),h.material.defines.KERNEL_RADIUS=p.material.defines.KERNEL_RADIUS=y.blurRadius.toFixed(2),f.material.blending=h.material.blending=p.material.blending=THREE.NoBlending,f.material.depthWrite=h.material.depthWrite=p.material.depthWrite=!1,f.material.depthTest=h.material.depthTest=p.material.depthTest=!1,h.material.defines.HORIZONTAL=1,d=n(e.GroundShadowColorShader),d.uniforms.tDepth.value=E?c:l,d.depthWrite=!1,d.transparent=!0,s=new THREE.BufferGeometry,s.addAttribute("position",new THREE.BufferAttribute(new Float32Array([-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5]),3)),s.addAttribute("uv",new THREE.BufferAttribute(new Float32Array([0,0,0,1,1,1,1,0]),2)),s.addAttribute("index",new THREE.BufferAttribute(new Uint16Array([0,1,2,2,3,0]),1)),a=new THREE.Mesh(s,d),r.add(a),y.debug&&(m=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:65280,wireframe:!0})),r.add(m)),this.setTransform(new THREE.Vector3(0,0,0),new THREE.Vector3(1,1,1),new THREE.Vector3(0,1,0))}
t.prototype.constructor=t,e.GroundShadow=t}(),function(){"use strict"
var e=Autodesk.Viewing.Shaders,t=function(t,i,n,o){init_GroundReflectionShader()
var r,a,s,l,c,u,d=t,h=d.getContext(),p=i||512,f=n||512,m=!1,v=new THREE.Color(0,0,0),g=!1,E=!1
this.inTarget=void 0,this.outTarget=void 0
var y={color:new THREE.Color(1,1,1),alpha:.3,texScale:.5,blurRadius:2,blurTexScale:.5,fadeAngle:Math.PI/18},A=function(e){var t=e.normal,i=e.constant
return(new THREE.Matrix4).set(1-2*t.x*t.x,-2*t.y*t.x,-2*t.x*t.z,-2*i*t.x,-2*t.x*t.y,1-2*t.y*t.y,-2*t.y*t.z,-2*i*t.y,-2*t.x*t.z,-2*t.y*t.z,1-2*t.z*t.z,-2*i*t.z,0,0,0,1)}
if(this.setTransform=function(e,t,i){l=e,s.normal=t,s.constant=-e.dot(t)},this.cleanup=function(){r&&r.cleanup(),this.inTarget&&this.inTarget.dispose(),this.outTarget&&this.outTarget.dispose()},this.setSize=function(t,i){p=t,f=i,this.cleanup(),this.inTarget=new THREE.WebGLRenderTarget(p*y.texScale,f*y.texScale,{magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),this.inTarget.generateMipmaps=!1,this.outTarget=new THREE.WebGLRenderTarget(p*y.texScale,f*y.texScale,{magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),this.outTarget.generateMipmaps=!1,r?r.setSize(p*y.texScale*y.blurTexScale,f*y.texScale*y.blurTexScale):r=new e.GaussianPass(p*y.texScale*y.blurTexScale,f*y.texScale*y.blurTexScale,y.blurRadius,1,{hasAlpha:!0,blending:!0,flipUV:!0})},this.updateCamera=function(e){var t=e.position.clone().sub(l).normalize(),i=Math.PI/2-t.angleTo(s.normal)
if(m=0>i,!m){if(y.fadeAngle>0){var n=Math.min(y.fadeAngle,i)/y.fadeAngle
r.setAlpha(n*y.alpha)}var o=A(s)
c=e.clone(),c.applyMatrix(o),c.projectionMatrix.elements[5]*=-1,c.matrixWorldNeedsUpdate=!0,e.worldUpTransform?c.worldUpTransform=e.worldUpTransform.clone():c.worldUpTransform=new THREE.Matrix4}},this.renderIntoReflection=function(e){m||d.render(e,c,this.inTarget)},this.renderReflection=function(e,t){m||(h.depthRange(.999999,1),a.render(d,t,this.outTarget),h.depthRange(0,1))},this.toggleEnvMapBackground=function(e){E=e,u.uniforms.envMapBackground.value=e},this.postprocess=function(e){m||(g||E?(u.uniforms.uCamDir.value=e.getWorldDirection(),u.uniforms.uCamUp.value=e.up,u.uniforms.uResolution.value.set(p,f),u.render(d,this.outTarget),d.clearTarget(this.outTarget,!1,!0,!1)):(d.setClearColor(v,1),d.clearTarget(this.outTarget,!0,!0,!1)),r.render(d,this.outTarget,this.inTarget))},this.clear=function(){d.setClearColor(v,0),d.clearTarget(this.inTarget,!0,!0,!1)},this.setClearColors=function(e,t){t?(v.setRGB(.5*(e.x+t.x),.5*(e.y+t.y),.5*(e.z+t.z)),g=!e.equals(t)&&!isAndroidDevice()&&!isIOSDevice()):(v.copy(e),g=!1),g&&(u.uniforms.color1.value.copy(e),u.uniforms.color2.value.copy(t))},this.isGroundCulled=function(){return m},this.setColor=function(e){r.setColor(y.color),y.color.set(e)},this.setAlpha=function(e){r.setAlpha(y.alpha),y.alpha=e},o)for(var T in y)y[T]=void 0!==o[T]?o[T]:y[T]
a=new e.LmvShaderPass(e.GroundReflectionDrawShader),a.material.blending=THREE.NoBlending,a.material.depthTest=!0,a.material.depthWrite=!1,u=new e.LmvShaderPass(e.BackgroundShader),u.material.blending=THREE.NoBlending,u.material.depthWrite=!1,u.material.depthTest=!1,this.setSize(p,f),r.setAlpha(y.color),r.setAlpha(y.alpha),s=new THREE.Plane(new THREE.Vector3(0,1,0),0),l=new THREE.Vector3(0,0,0)}
t.prototype.constructor=t,e.GroundReflection=t}(),function(){var e=Autodesk.Viewing.Shaders,t=function(t,i,n,o,r){init_GaussianShader()
var a,s,l,c=t,u=i,d=n||3,h=o||1,p={hasAlpha:r.hasAlpha||!1,blending:r.blending||!1,flipUV:r.flipUV||!1}
this.render=function(e,t,i){a.render(e,l,i),s.render(e,t,l)},this.setSize=function(e,t){this.cleanup(),c=e,u=t,l=new THREE.WebGLRenderTarget(e,t,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1}),l.generateMipmaps=!1,a.material.defines.KERNEL_SCALE_H=s.material.defines.KERNEL_SCALE_H=(h/c).toFixed(4),a.material.defines.KERNEL_SCALE_V=s.material.defines.KERNEL_SCALE_V=(h/u).toFixed(4),a.material.needsUpdate=s.material.needsUpdate=!0},this.cleanup=function(){l&&l.dispose()},this.setColor=function(e){s.material.uniforms.uColor.value.x=e.r,s.material.uniforms.uColor.value.y=e.g,s.material.uniforms.uColor.value.z=e.b},this.setAlpha=function(e){s.material.uniforms.uColor.value.w=e},a=new e.LmvShaderPass(e.GaussianShader),s=new e.LmvShaderPass(e.GaussianShader),this.setSize(t,i),a.material.blending=s.material.blending=THREE.NoBlending,a.material.depthWrite=s.material.depthWrite=!1,a.material.depthTest=s.material.depthTest=!1,a.material.defines.HORIZONTAL=1,a.material.defines.KERNEL_RADIUS=s.material.defines.KERNEL_RADIUS=d.toFixed(1),p.blending&&(s.material.transparent=!0,s.material.blending=THREE.NormalBlending),p.hasAlpha&&(a.material.defines.HAS_ALPHA=s.material.defines.HAS_ALPHA=""),p.flipUV&&(a.material.defines.FLIP_UV="")}
e.GaussianPass=t}(),function(){"use strict"
function e(e,t){function i(e,t,i,n,o,r,a){var s=.5*(i-e),l=.5*(n-t)
return(2*(t-i)+s+l)*a+(-3*(t-i)-2*s-l)*r+s*o+t}var n,o,r,a,s,l,c,u,d,h=[],p=[]
return n=(e.length-1)*t,o=Math.floor(n),r=n-o,h[0]=0===o?o:o-1,h[1]=o,h[2]=o>e.length-2?o:o+1,h[3]=o>e.length-3?o:o+2,l=e[h[0]],c=e[h[1]],u=e[h[2]],d=e[h[3]],a=r*r,s=r*a,p[0]=i(l[0],c[0],u[0],d[0],r,a,s),p[1]=i(l[1],c[1],u[1],d[1],r,a,s),p[2]=i(l[2],c[2],u[2],d[2],r,a,s),p}var t=Autodesk.Viewing.Private,i={LINEAR:0,CATMULLROM:1,CATMULLROM_FORWARD:2},n=function(){this.animations=[]}
n.prototype.init=function(e){if(e.initialized===!0)return e
for(var t=0;t<e.hierarchy.length;t++){for(var i=0;i<e.hierarchy[t].keys.length;i++)if(e.hierarchy[t].keys[i].time<0&&(e.hierarchy[t].keys[i].time=0),void 0!==e.hierarchy[t].keys[i].rot&&!(e.hierarchy[t].keys[i].rot instanceof THREE.Quaternion)){var n=e.hierarchy[t].keys[i].rot
Array.isArray(n)||(n=[n._x,n._y,n._z,n._w]),e.hierarchy[t].keys[i].rot=(new THREE.Quaternion).fromArray(n)}for(var i=1;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].time===e.hierarchy[t].keys[i-1].time&&(e.hierarchy[t].keys.splice(i,1),i--)
for(var i=0;i<e.hierarchy[t].keys.length;i++)e.hierarchy[t].keys[i].index=i}return e.initialized=!0,e},n.prototype.parse=function(e){function t(e,i){if(i.push(e),e.children&&!(e instanceof THREE.Camera))for(var n=0;n<e.children.length;n++)t(e.children[n],i)}var i=[]
return t(e,i),i},n.prototype.play=function(e){-1===this.animations.indexOf(e)&&this.animations.push(e)},n.prototype.stop=function(e){var t=this.animations.indexOf(e);-1!==t&&this.animations.splice(t,1)},n.prototype.update=function(e){for(var t=0;t<this.animations.length;t++)this.animations[t].update(e)}
var o=function(e,t,n){this.root=e,this.handler=n.animationHandler,this.data=this.handler.init(t),this.hierarchy=this.handler.parse(e),this.viewer=n.viewer,this.animator=n,this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.isPaused=!0,this.loop=!1,this.delta=.5,this.interpolationType=i.LINEAR,this.setStartAndEndKeyTime()}
o.prototype.setStartAndEndKeyTime=function(){if(this.data.hierarchy.length>0){var e=this.data.hierarchy[0].keys
this.startKeyTime=e[0].time,this.endKeyTime=e[e.length-1].time}else this.startKeyTime=this.endKeyTime=0},o.prototype.keyTypes=[],o.prototype.defaultKey={},o.prototype.play=function(e){this.currentTime=void 0!==e?e:0,this.isPlaying=!0,this.isPaused=!1,this.reset(),this.handler.play(this)},o.prototype.pause=function(){this.isPaused===!0?this.handler.play(this):this.handler.stop(this),this.isPaused=!this.isPaused},o.prototype.stop=function(){this.isPlaying=!1,this.isPaused=!1,this.handler.stop(this)},o.prototype["goto"]=function(e){this.isPlaying||this.play(),this.isPaused||this.pause()
var t=e-this.currentTime
this.update(t)},o.prototype.reset=function(){for(var e=0,t=this.hierarchy.length;t>e;e++){var i=this.hierarchy[e]
void 0===i.animationCache&&(i.animationCache={}),void 0===i.animationCache[this.data.name]&&(i.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:i.matrix})
for(var n=i.animationCache[this.data.name],o=0;o<this.keyTypes.length;o++){for(var r=this.keyTypes[o],a=this.data.hierarchy[e].keys[0],s=this.getNextKeyWith(r,e,1);s.time<this.currentTime&&s.index>a.index;)a=s,s=this.getNextKeyWith(r,e,s.index+1)
n.prevKey[r]=a,n.nextKey[r]=s}}this.setStartAndEndKeyTime()},o.prototype.getNextKeyWith=function(e,t,n){var o=this.data.hierarchy[t].keys
for(this.interpolationType===i.CATMULLROM||this.interpolationType===i.CATMULLROM_FORWARD?n=n<o.length-1?n:o.length-1:n%=o.length;n<o.length;n++)if(void 0!==o[n][e])return o[n]
return this.data.hierarchy[t].keys[0]},o.prototype.getPrevKeyWith=function(e,t,n){var o=this.data.hierarchy[t].keys
for(n=this.interpolationType===i.CATMULLROM||this.interpolationType===i.CATMULLROM_FORWARD?n>0?n:0:n>=0?n:n+o.length;n>=0;n--)if(void 0!==o[n][e])return o[n]
return this.data.hierarchy[t].keys[o.length-1]},o.prototype.isPlayingOutOfRange=function(){return this.isPaused===!1&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)},o.prototype.resetIfLooped=function(){this.loop===!0&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())}
var r=function(e,t,i){o.call(this,e,t,i),this.localMatrix=new THREE.Matrix4,this.root.getAnimTransform(),this.relativeTransform=t.custom&&t.custom.transform&&"abs"===t.custom.transform?!1:!0}
r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.keyTypes=["pos","rot","scl"],r.prototype.defaultKey={pos:0,rot:0,scl:0},r.prototype.update=function(){function t(){n||(n=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Quaternion)}var n,o,r,a=[]
return function(s){if(this.isPlaying!==!1&&(this.currentTime+=s*this.timeScale,t(),this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var l=0,c=this.hierarchy.length;c>l;l++){for(var u=this.hierarchy[l],d=u.animationCache[this.data.name],h=0;h<this.keyTypes.length;h++){var p=this.keyTypes[h],f=d.prevKey[p],m=d.nextKey[p]
if(m.time<=this.currentTime||f.time>=this.currentTime){for(f=this.data.hierarchy[l].keys[0],m=this.getNextKeyWith(p,l,1);m.time<this.currentTime&&m.index>f.index;)f=m,m=this.getNextKeyWith(p,l,m.index+1)
d.prevKey[p]=f,d.nextKey[p]=m}var v=f[p],g=m[p]
if(m.time!==f.time&&void 0!==v&&void 0!==g){var E=(this.currentTime-f.time)/(m.time-f.time)
if(0>E&&(E=0),E>1&&(E=1),"pos"===p)if(this.interpolationType===i.LINEAR)o.x=v[0]+(g[0]-v[0])*E,o.y=v[1]+(g[1]-v[1])*E,o.z=v[2]+(g[2]-v[2])*E,u.position.copy(o)
else{a[0]=this.getPrevKeyWith("pos",l,f.index-1).pos,a[1]=v,a[2]=g,a[3]=this.getNextKeyWith("pos",l,m.index+1).pos,E=.33*E+.33
var y=e(a,E)
if(o.x=y[0],o.y=y[1],o.z=y[2],u.position.copy(o),this.interpolationType===i.CATMULLROM_FORWARD){var A=e(a,1.01*E)
n.set(A[0],A[1],A[2]),n.sub(vector),n.y=0,n.normalize()
var T=Math.atan2(n.x,n.z)
u.rotation.set(0,T,0)}}else"rot"===p?(THREE.Quaternion.slerp(v,g,r,E),u.quaternion.copy(r)):"scl"===p&&(o.x=v[0]+(g[0]-v[0])*E,o.y=v[1]+(g[1]-v[1])*E,o.z=v[2]+(g[2]-v[2])*E,u.scale.copy(o))}}this.relativeTransform&&u.updateAnimTransform()}}}()
var a=function(e,t,i){o.call(this,e,t,i)}
a.prototype=Object.create(o.prototype),a.prototype.constructor=a,a.prototype.keyTypes=["pos","up","target","fov","perspective"],a.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0},a.prototype.update=function(){function t(){n||(n=new THREE.Vector3,o=new THREE.Vector3)}var n,o,r=[]
return function(a){if(this.isPlaying!==!1&&(this.currentTime+=a*this.timeScale,t(),this.resetIfLooped(),!this.isPlayingOutOfRange())){for(var s=0,l=this.hierarchy.length;l>s;s++){for(var c=this.hierarchy[s],u=c.animationCache[this.data.name],d=0;d<this.keyTypes.length;d++){var h=this.keyTypes[d],p=u.prevKey[h],f=u.nextKey[h]
if(f.time<=this.currentTime||p.time>=this.currentTime){for(p=this.data.hierarchy[s].keys[0],f=this.getNextKeyWith(h,s,1);f.time<this.currentTime&&f.index>p.index;)p=f,f=this.getNextKeyWith(h,s,f.index+1)
u.prevKey[h]=p,u.nextKey[h]=f}var m=p[h],v=f[h]
if(f.time!==p.time&&void 0!==m&&void 0!==v){var g=(this.currentTime-p.time)/(f.time-p.time)
0>g&&(g=0),g>1&&(g=1)
var E
if("pos"===h)E=c.position
else if("up"===h)E=c.up
else if("target"===h)E=c.target
else{if("fov"===h){c.setFov(m+(v-m)*g)
continue}if("perspective"===h){var y=g>.5?v:m
y?c.toPerspective():c.toOrthographic()
continue}}if(this.interpolationType===i.LINEAR)o.x=m[0]+(v[0]-m[0])*g,o.y=m[1]+(v[1]-m[1])*g,o.z=m[2]+(v[2]-m[2])*g,E.copy(o)
else{r[0]=this.getPrevKeyWith(h,s,p.index-1)[h],r[1]=m,r[2]=v,r[3]=this.getNextKeyWith(h,s,f.index+1)[h],g=.33*g+.33
var A=e(r,g)
if(o.x=A[0],o.y=A[1],o.z=A[2],E.copy(o),this.interpolationType===i.CATMULLROM_FORWARD){var T=e(r,1.01*g)
n.set(T[0],T[1],T[2]),n.sub(E),n.y=0,n.normalize()
var b=Math.atan2(n.x,n.z)
c.rotation.set(0,b,0)}}}}c.matrixAutoUpdate=!0,c.matrixWorldNeedsUpdate=!0}c.lookAt(c.target),this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}}()
var s=function(e,t,i,n){o.call(this,e,t,n),this.nodeId=i,this.epsilon=.1,this.root.setMaterial(this.viewer.matman().cloneMaterial(e.getMaterial()))}
s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.keyTypes=["vis","opa"],s.prototype.defaultKey={viz:1,opa:1},s.prototype.update=function(){return function(e){if(this.isPlaying!==!1&&(this.currentTime+=e*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))for(var t=0,i=this.hierarchy.length;i>t;t++)for(var n=this.hierarchy[t],o=n.animationCache[this.data.name],r=0;r<this.keyTypes.length;r++){var a=this.keyTypes[r],s=o.prevKey[a],l=o.nextKey[a]
if(l.time<=this.currentTime||s.time>=this.currentTime){for(s=this.data.hierarchy[t].keys[0],l=this.getNextKeyWith(a,t,1);l.time<this.currentTime&&l.index>s.index;)s=l,l=this.getNextKeyWith(a,t,l.index+1)
o.prevKey[a]=s,o.nextKey[a]=l}var c=s[a],u=l[a]
if(l.time!==s.time&&void 0!==c&&void 0!==u){var d=n.getMaterial()
if("vis"===a){var h=Math.abs(this.currentTime-l.time)<this.epsilon,p=h?l:s,f=h?u:c
1===f&&void 0===p.opa&&(d.transparent=!1,d.opacity=1),this.viewer.visibilityManager.setNodeOff(this.nodeId,!f)}else if("opa"===a){var m=(this.currentTime-s.time)/(l.time-s.time)
0>m&&(m=0),m>1&&(m=1)
var v=c+(u-c)*m
d.transparent=1!==v,d.opacity=v,v>0&&this.viewer.visibilityManager.setNodeOff(this.nodeId,!1)}}}}}()
var l=function(e,t,i){function n(e,t,i){var n=r.container=document.createElement("div"),o=e.name
n.id=o,n.style.cursor="pointer",n.style.visibility=i
var a=document.createElement("div")
a.id=o+"-txt",a.style.cssText="display: none;position: absolute;z-index: 1;",n.appendChild(a)
var s=document.createElement("img"),l=e.custom&&e.custom.att&&1===e.custom.att
s.src=l?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==",s.id=o+"-img",s.style.cssText="display: block;position: absolute;z-index: 1;",n.appendChild(s),t.api.container.appendChild(n),n.addEventListener("click",function(){a.style.display="none"===a.style.display?"block":"none"})
var c=32512,u=.6,d=new THREE.SphereGeometry(.01),h=new THREE.MeshPhongMaterial({color:c,ambient:c,opacity:u,transparent:!0}),p=new THREE.Mesh(d,h)
return p.visible=!1,void 0===t.overlayScenes.annotation&&t.createOverlayScene("annotation"),t.addOverlay("annotation",p),p}var r=this
null===e&&(e=n(t,i.viewer,"hidden")),o.call(this,e,t,i),this.id=t.name,this.text="",this.state="hidden",this.epsilon=.1,this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(t){r.updateText(e.position,r.text)})}
l.prototype=Object.create(o.prototype),l.prototype.constructor=l,l.prototype.keyTypes=["pos","text","vis"],l.prototype.defaultKey={pos:0,text:"",vis:1},l.prototype.stop=function(){o.prototype.stop.call(this),this.container.parentNode.removeChild(this.container),this.viewer.removeOverlay("annotation",this.root),this.root=null},l.prototype.updateText=function(e,t){function i(e,t,i){var n=e.clone(),o=new THREE.Matrix4
return t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),o.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),n.applyProjection(o),{x:(n.x+1)*i.width/2+i.offsetLeft,y:(-n.y+1)*i.height/2+i.offsetTop}}var n=i(e,this.viewer.camera,this.viewer.canvas),o=document.getElementById(this.id+"-txt")
o&&(o.innerHTML=t,o.style.left=n.x+"px",o.style.top=n.y+"px",this.text=t),o=document.getElementById(this.id+"-img"),o&&(o.style.left=n.x+"px",o.style.top=n.y-24+"px")},l.prototype.update=function(){function t(){n||(n=new THREE.Vector3,o=new THREE.Vector3)}var n,o,r=[]
return function(a){if(this.isPlaying!==!1&&(this.currentTime+=a*this.timeScale,t(),this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime){var s=document.getElementById(this.id)
return void(s&&(s.style.visibility=this.state))}for(var l=0,c=this.hierarchy.length;c>l;l++){for(var u=this.hierarchy[l],d=u.animationCache[this.data.name],h=0;h<this.keyTypes.length;h++){var p=this.keyTypes[h],f=d.prevKey[p],m=d.nextKey[p]
if(m.time<=this.currentTime||f.time>=this.currentTime){for(f=this.data.hierarchy[l].keys[0],m=this.getNextKeyWith(p,l,1);m.time<this.currentTime&&m.index>f.index;)f=m,m=this.getNextKeyWith(p,l,m.index+1)
d.prevKey[p]=f,d.nextKey[p]=m}var v=f[p],g=m[p]
if(m.time!==f.time&&void 0!==v&&void 0!==g){var E=(this.currentTime-f.time)/(m.time-f.time)
if(0>E&&(E=0),E>1&&(E=1),"pos"===p){if(this.interpolationType===i.LINEAR)o.x=v[0]+(g[0]-v[0])*E,o.y=v[1]+(g[1]-v[1])*E,o.z=v[2]+(g[2]-v[2])*E,u.position.copy(o)
else if(this.interpolationType===i.CATMULLROM||this.interpolationType===i.CATMULLROM_FORWARD){r[0]=this.getPrevKeyWith("pos",l,f.index-1).pos,r[1]=v,r[2]=g,r[3]=this.getNextKeyWith("pos",l,m.index+1).pos,E=.33*E+.33
var y=e(r,E)
if(o.x=y[0],o.y=y[1],o.z=y[2],u.position.copy(o),this.interpolationType===i.CATMULLROM_FORWARD){var A=e(r,1.01*E)
n.set(A[0],A[1],A[2]),n.sub(vector),n.y=0,n.normalize()
var T=Math.atan2(n.x,n.z)
u.rotation.set(0,T,0)}}}else if("text"===p){var b=Math.abs(this.currentTime-m.time)<this.epsilon?g:v
this.updateText(u.position,b)}else if("vis"===p){var s=document.getElementById(this.id)
if(s){var w=Math.abs(this.currentTime-m.time)<this.epsilon?g:v
s.style.visibility=w?"visible":"hidden"}}}}u.matrixAutoUpdate=!0,u.matrixWorldNeedsUpdate=!0}}}}()
var c=function(e,t,i){this.viewer=i.viewer,null===e&&(e=this.createPolyline([])),o.call(this,e,t,i),this.epsilon=.1}
c.prototype=Object.create(o.prototype),c.prototype.constructor=c,c.prototype.keyTypes=["points","vis"],c.prototype.defaultKey={points:[],vis:1},c.prototype.stop=function(){o.prototype.stop.call(this),this.viewer.removeOverlay("polyline",this.root),this.root=null},c.prototype.update=function(){function e(e){e.root&&(e.viewer.removeOverlay("polyline",e.root),e.root=null)}return function(t){if(this.isPlaying!==!1&&(this.currentTime+=t*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange())){if(this.isPaused&&this.currentTime<this.startKeyTime)return void e(this)
for(var i=0,n=this.hierarchy.length;n>i;i++)for(var o=this.hierarchy[i],r=o.animationCache[this.data.name],a=0;a<this.keyTypes.length;a++){var s=this.keyTypes[a],l=r.prevKey[s],c=r.nextKey[s]
if(c.time<=this.currentTime||l.time>=this.currentTime){for(l=this.data.hierarchy[i].keys[0],c=this.getNextKeyWith(s,i,1);c.time<this.currentTime&&c.index>l.index;)l=c,c=this.getNextKeyWith(s,i,c.index+1)
r.prevKey[s]=l,r.nextKey[s]=c}var u=l[s],d=c[s]
if(c.time!==l.time&&void 0!==u&&void 0!==d){var h=(this.currentTime-l.time)/(c.time-l.time)
if(0>h&&(h=0),h>1&&(h=1),"points"===s){var p=.5>h?u:d
this.viewer.removeOverlay("polyline",this.root),this.root=null
for(var f=[],m=0;m<p.length;m++){var v=p[m].slice()
if(0===m)v[0]=u[m][0]+(d[m][0]-u[m][0])*h,v[1]=u[m][1]+(d[m][1]-u[m][1])*h,v[2]=u[m][2]+(d[m][2]-u[m][2])*h
else if(m===p.length-1){var g=u.length-1,E=d.length-1
v[0]=u[g][0]+(d[E][0]-u[g][0])*h,v[1]=u[g][1]+(d[E][1]-u[g][1])*h,v[2]=u[g][2]+(d[E][2]-u[g][2])*h}var y=new THREE.Vector3(v[0],v[1],v[2])
f.push(y)}this.root=this.createPolyline(f)}else if("vis"===s){var A=Math.abs(this.currentTime-c.time)<this.epsilon?d:u
this.root.visible=A,A||e(this)}}}}}}(),c.prototype.createPolyline=function(e){for(var t=new THREE.Geometry,i=0;i<e.length;i++)t.vertices.push(e[i])
t.computeLineDistances()
var n=new THREE.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1}),o=new THREE.Line(t,n,THREE.LineStrip)
return void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline"),this.viewer.addOverlay("polyline",o),o},t.Animation=o,t.AnimationHandler=n,t.MeshAnimation=r,t.CameraAnimation=a,t.PolylineAnimation=c,t.VisibilityAnimation=s,t.AnnotationAnimation=l}(),function(){"use strict"
var e=Autodesk.Viewing.Private,t=function(e,t){this.animations=[],this.viewer=e,this.keys=[],this.isPlaying=!1,this.isPaused=!0,this.updateFlag=0,this.duration=t,this.currentTime=0,this.onPlayCallback=null,this.animationHandler=new Autodesk.Viewing.Private.AnimationHandler,this.areCameraAnimationsPaused=!1,this.UPDATE_SCENE=1,this.UPDATE_CAMERA=2}
t.prototype.add=function(t){function i(e){function t(e,t,i){for(t=e.length;i=--t;)for(;i--;)e[t]!==e[i]||e.splice(i,1)}e.sort(function(e,t){return e-t}),t(e)}if(!(!t.hierarchy||t.hierarchy.length<1||!t.hierarchy[0].keys||t.hierarchy[0].keys.length<2)){var n=null,o=this
if("camera"===t.type?(n=new e.CameraAnimation(o.viewer.camera,t,o),o.animations.push(n)):"annotation"===t.type?(n=new e.AnnotationAnimation(null,t,o),o.animations.push(n)):"polyline"===t.type?(n=new e.PolylineAnimation(null,t,o),o.animations.push(n)):("mesh"===t.type||"visibility"===t.type)&&o.viewer.model.getData().instanceTree.enumNodeFragments(t.id,function(i){var r=o.viewer.getFragmentProxy(o.viewer.model,i)
r&&(n="mesh"===t.type?new e.MeshAnimation(r,t,o):new e.VisibilityAnimation(r,t,t.id,o),o.animations.push(n))},!0),n){for(var r=0,a=t.hierarchy.length;a>r;r++)for(var s=t.hierarchy[r].keys,l=0;l<s.length;l++)void 0===s[l].xk&&o.keys.push(s[l].time)
i(o.keys)}this.updateFlag|=this.UPDATE_SCENE}},t.prototype.update=function(e){this.animationHandler.update(e)
var t=this.updateFlag
return this.isPlaying&&!this.isPaused&&(this.currentTime+=e,this.currentTime=Math.min(this.currentTime,this.duration),this.onPlayCallback&&this.onPlayCallback(this.duration>0?this.currentTime/this.duration*100:0),this.currentTime>=this.duration&&this.pause(),t|=this.UPDATE_SCENE),this.updateFlag=0,t},t.prototype.play=function(e,t){if(this.onPlayCallback=t,this.currentTime>=this.duration&&this["goto"](0),this.isPlaying)return void this.pause()
for(var i=0;i<this.animations.length;i++){var n=this.animations[i]
n.play(e)}this.isPlaying=!0,this.isPaused=!1},t.prototype.pause=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e]
t.isPaused===this.isPaused&&t.pause()}this.isPaused=!this.isPaused,this.areCameraAnimationsPaused=this.isPaused},t.prototype.pauseCameraAnimations=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e]
t instanceof Autodesk.Viewing.Private.CameraAnimation&&t.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused},t.prototype.stop=function(){for(var e=0;e<this.animations.length;e++){var t=this.animations[e]
t.stop()}this.isPlaying=!1,this.isPaused=!1},t.prototype["goto"]=function(e){if(void 0!==e){for(var t=0;t<this.animations.length;t++){var i=this.animations[t]
i["goto"](e)}this.isPlaying=!0,this.isPaused=!0,this.currentTime=e,this.updateFlag|=this.UPDATE_SCENE}},t.prototype.next=function(){function e(e,t){for(var i=-1,n=0;n<t.length;n++)if(t[n]>e){i=t[n]
break}return 0>i?t[t.length-1]:i}var t=e(this.currentTime,this.keys)
this["goto"](t)},t.prototype.prev=function(){function e(e,t){for(var i=-1,n=t.length-1;n>-1;n--)if(t[n]<e){i=t[n]
break}return 0>i?t[0]:i}var t=e(this.currentTime,this.keys)
this["goto"](t)},e.KeyFrameAnimator=t}(),void 0===ENABLE_DEBUG)var ENABLE_DEBUG=!0
if(void 0===ENABLE_TRACE)var ENABLE_TRACE=!0
var RENDER_NORMAL=0,RENDER_HIGHLIGHTED=1,RENDER_HIDDEN=2,RENDER_FINISHED=3
!function(){"use strict"
function e(e,n){function o(e){var t=window.devicePixelRatio
t||(t=1)
var i=Autodesk.Viewing.InitParametersSetting.getInstance().params
i.canvas=e,i.devicePixelRatio=t
var n=new FireflyWebGLRenderer(i)
return n.autoClear=!1,n.sortObjects=!1,n}function r(e){var t=P,i=!0,n=t==RENDER_NORMAL,o=b.settings.idbuffer&&t!=RENDER_HIDDEN
t==RENDER_HIDDEN?e.overrideMaterial=C.fadeMaterial:t==RENDER_HIGHLIGHTED&&(e.overrideMaterial=C.highlightMaterial),b.renderScenePart(e,i,n,o),e.overrideMaterial=null}function a(e){G>0&&(W=.8*W+.2*(e-G)),C.fpsCallback&&C.fpsCallback(C.fps())}function s(e){if(C.keyFrameAnimator){var t=G>0?(e-G)/1e3:0,i=C.keyFrameAnimator.update(t)
if(i&&(C.sceneUpdated(!0),i&C.keyFrameAnimator.UPDATE_CAMERA))return!0}return!1}function l(){g&&(C.camera.aspect=E/y,C.camera.clientWidth=E,C.camera.clientHeight=y,b.setSize(E,y),C.controls.handleResize(),x&&x.setSize(E,y),C.invalidate(!0,!0,!0),g=!1,C.api.fireEvent({type:Autodesk.Viewing.VIEWER_RESIZE_EVENT}))}function c(){if((_.enabled||x)&&!C.is2d){var e
if(e=C.model&&!C.model.isLoadDone()?C.model.getData().bbox:C.getVisibleBounds(!0,!1)){_.needClear=!0
var t=C.camera,i=e.clone(),n=new THREE.Vector3(1,0,0),o=i.center(),r=i.size()
if(t.worldUpTransform&&(n.applyMatrix4(t.worldUpTransform),i.applyMatrix4(t.worldUpTransform),r=i.size()),r.multiply(new THREE.Vector3(1.25,1.01,1.25)),r.x=r.z=Math.max(r.x,r.z),_.setTransform(o,r,t.worldup,n),x){var a=(new THREE.Vector3).subVectors(o,t.worldup.clone().multiplyScalar(r.y/2))
x.setTransform(a,t.worldup,r)}}}}function u(e){B&&(c(),B=!1)}function d(e){for(var t in C.selectionMeshes){var i=C.selectionMeshes[t]
i.model.getFragmentList().getWorldMatrix(i.fragId,i.matrix)}}function h(e){g&&l(),A.updateMaterials()
var t=C.keyFrameAnimator?s(e):!1,i=C.controls.update(e),n=i||t||w
D=D||n,O=O||n,O&&d(e),O=O||b.overlayUpdate(e)
var o=C.model&&(C.model.isLoadDone()||1==C.model.myData.partPacksLoadDone),c=C.progressiveRender?C.targetFrameTime:1e10,h=c,p=Y
if(B&&u(e),D||H){if(o&&C.signalProgress(0,null),U>0){var f=e-U
z=.75*z+.25*f}U=e,R>z&&S>c?C.targetFrameTime+=1:z>R&&c>M&&(C.targetFrameTime-=1),C.updateCameraMatrices(),b.beginScene(C.scene,C.camera,C.lights,D),n&&C.api.fireEvent(C.cameraChangedEvent),p&&(p.hasHighlighted()?(P=RENDER_HIGHLIGHTED,p.reset(C.camera,P,n|D)):(P=RENDER_NORMAL,p.reset(C.camera,P,n|D)))}else U=-1
var m=q(D)
O=O||m,K(D),p.isEmpty()||p.isDone()||(h=p.renderSome(r,h),p.isDone()&&P===RENDER_HIGHLIGHTED&&(P=RENDER_NORMAL,p.reset(C.camera,P),h=p.renderSome(r,h)),n||O||(a(e),b.composeFinalFrame()),p.isDone()?(P===RENDER_NORMAL&&!p.areAllVisible()&&C.showGhosting?(!x||x.finished)&&(P=RENDER_HIDDEN,p.reset(C.camera,P)):(P=RENDER_FINISHED,b.renderScenePart(C.sceneAfter,!0,!0,!0),b.composeFinalFrame(n&&C.skipAOWhenMoving,!0)),o&&C.signalProgress(100,null)):o&&C.signalProgress(100*p.getRenderProgress(),null)),O&&(!p.isEmpty()&&p.isDone()||C.showOverlaysWhileMoving?(C.renderOverlays(),p.isEmpty()||p.isDone()||(O=!0)):b.clearAllOverlays(),b.renderScenePart(C.sceneAfter,!0,!0,!0),b.composeFinalFrame((n||p.isEmpty()||!p.isDone())&&C.skipAOWhenMoving,p&&p.isDone()),a(e)),k&&!n&&C.skipAOWhenMoving&&b.composeFinalFrame(),k=n,G=e,p&&p.needsRender()?(H=!0,p.resetNeedsRender()):H=!1,D=!1,w=!1}function p(e,t){t.updateMatrixWorld(!0),t.traverse(function(t){var i=t.geometry
void 0!==i&&(i.boundingBox||i.computeBoundingBox(),Q.copy(i.boundingBox),Q.applyMatrix4(t.matrixWorld),e.union(Q))})}function f(){var e=new THREE.Box3,t=C.overlayScenes
for(var i in t)t.hasOwnProperty(i)&&p(e,t[i].scene)
return p(e,C.scene),e}function m(e){var t=";base64,"
if(-1==e.indexOf(t)){var i=e.split(","),n=i[0].split(":")[1],o=decodeURIComponent(i[1])
return new Blob([o],{type:n})}for(var i=e.split(t),n=i[0].split(":")[1],o=window.atob(i[1]),r=o.length,a=new Uint8Array(r),s=0;r>s;++s)a[s]=o.charCodeAt(s)
return new Blob([a],{type:n})}var v,g,E,y,A,T,b,w,_,x,C=this,S=1e3/15,R=1e3/30,M=1e3/120,P=RENDER_NORMAL,L=-1,I=-1,k=!1,V=new THREE.Vector3(0,1,0),N="y",D=!1,H=!1,O=!1,B=!1,F=0,U=0,z=0,G=0,W=1e3/60,j=!0,X=!1,Y=new i.RenderScene,q=function(){var e,t=10,i=10,n=0,o=0,r=0
return function(a){if(!_.enabled||C.is2d||Y.isEmpty()||j)return!1
if(a&&(_.rendered=!1),e!=Y.getGeomScenes()&&(_.needClear=!0),_.needClear&&(_.clear(),_.needClear=!1,e=Y.getGeomScenes(),n=e.length,o=0,r=Math.max(Math.ceil(n/t),i)),_.isValid())_.rendered||x&&x.progressive||(_.renderShadow(C.camera,b.getColorTarget()),_.rendered=!0)
else{for(var s=0;r>s&&n>o;){var l=e[o]
l&&(l.forceVisible=!0,_.renderIntoShadow(l),l.forceVisible=!1,s++),o++}if(o>=n)return _.postprocess(),_.rendered||x&&x.progressive||(_.renderShadow(C.camera,b.getColorTarget()),_.rendered=!0),!0}return!1}}(),K=function(){var e,t=20,i=1,n=0,o=0,r=0
return function(a){if(!(!x||x.finished&&!a||C.is2d||Y.isEmpty()||j)){if(a){if(x.clear(),x.updateCamera(C.camera),x.rendered=!1,x.finished=!1,x.isGroundCulled())return
e=Y.getGeomScenes(),n=e.length,o=0,r=Math.max(Math.ceil(n/t),i)}if(!x.isGroundCulled()){for(var s=0;r>s&&n>o;){var l=e[o]
l&&(l.forceVisible=!0,x.renderIntoReflection(l),l.forceVisible=!1,s++),o++}n>o?x.rendered=!1:x.finished=!0,x.rendered||x.isGroundCulled()||!(x.finished||x.progressive&&!Y.isDone())||(x.postprocess(C.camera,A),_.enabled&&_.isValid()&&(_.renderShadow(C.camera,x.outTarget),_.rendered=!0),x.renderReflection(C.camera,b.getColorTarget()),x.rendered=!0,Y.isDone()&&(C.showGhosting&&!Y.areAllVisible()?(P=RENDER_HIDDEN,Y.reset(C.camera,P)):b.presentBuffer()))}}}}()
this.run=function(){v=0,function e(t){v=window.requestAnimationFrame(e),h(t)}()},this.toggleProgressive=function(e){this.progressiveRender=e,D=!0},this.toggleGhosting=function(e){this.showGhosting=e,D=!0},this.toggleOverlaysWhileMoving=function(e){this.showOverlaysWhileMoving=e},this.togglePostProcess=function(e,t){b.initPostPipeline(e,t),this.fireRenderOptionChanged(),D=!0},this.toggleCelShading=function(e){b.toggleCelShading(e),this.fireRenderOptionChanged(),D=!0},this.toggleGroundShadow=function(e){_.enabled!==e&&(_.enabled=e,_.needClear=!0,c(),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundShadowColor=function(e){_.enabled&&(_.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundShadowAlpha=function(e){_.enabled&&(_.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleGroundReflection=function(e){e&&x||!e&&!x||(e?(x=new Autodesk.Viewing.Shaders.GroundReflection(T,this.canvas.clientWidth,this.canvas.clientHeight),x.setClearColors(this.clearColorTop,this.clearColorBottom),x.progressive=!0,x.toggleEnvMapBackground(X),c()):(x.cleanup(),x=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,!1))},this.setGroundReflectionColor=function(e){x&&(x.setColor(e),this.invalidate(!0,!1,!1))},this.setGroundReflectionAlpha=function(e){x&&(x.setAlpha(e),this.invalidate(!0,!1,!1))},this.toggleEnvMapBackground=function(e){X=e,b.toggleEnvMapBackground(e),x&&x.toggleEnvMapBackground(e),this.invalidate(!0,!0,!1)},this.toggleRenderPrism=function(e){A.setRenderPrism(e)},this.setOptimizeNavigation=function(e){this.skipAOWhenMoving=e},this.renderOverlays=function(){var e=this.lightsOn
e||this.toggleLights(!0,!0)
var t
this.dir_light1&&(t=this.dir_light1.intensity,this.dir_light1.intensity=1),b.renderOverlays(this.overlayScenes,this.lights),e||this.toggleLights(!1,!0),this.dir_light1&&(this.dir_light1.intensity=t),O=!1},this.setLayerVisible=function(e,t){this.matman().setLayerVisible(e,t)},this.isLayerVisible=function(e){return this.matman().isLayerVisible(e)},this.updateCameraMatrices=function(){var e=new THREE.Matrix4,t=new THREE.Matrix4,i=new THREE.Box3
return function(){var n=this.camera
if(e.compose(n.position,n.quaternion,n.scale),t.getInverse(e),n.worldup&&this.setWorldUp(n.worldup),this.model){var o=this.getVisibleBounds(!0,O)
i.copy(o),i.applyMatrix4(t)
var r=1e-5*(i.max.z-i.min.z),a=.5*(i.max.y-i.min.y),s=-(i.max.z+r)-a,l=-(i.min.z-r)+a
if(n.isPerspective&&(s=Math.max(s,Math.min(1,1e-4*Math.abs(l-s)))),l=Math.max(l,s),n.near=s,n.far=l,n.updateProjectionMatrix(),this.model.is2d()){var c,u=this.intersectGroundViewport(new THREE.Vector3(0,0,1))
c=u?n.position.distanceTo(u):n.position.distanceTo(o.center())
var d=b.settings.deviceHeight/(2*c*Math.tan(THREE.Math.degToRad(.5*n.fov)))
A.updatePixelScale(d)}else{var h,p=A.getCutPlanesRaw()
if(p&&p.length){var f=p[0],m=n.target.clone().sub(n.position).normalize(),v=m.dot(f)
if(0===v)h=o.center()
else{var g=-(n.position.clone().dot(f)+f.w)/v
h=m.multiplyScalar(g).add(n.position)}}else h=o.center()
var c=n.position.distanceTo(h),d=b.settings.deviceHeight/(2*c*Math.tan(THREE.Math.degToRad(.5*n.fov)))
A.updatePixelScale(d)}}}}(),this.initLights=function(e){var t=i.LightPresets[L].lightMultiplier
this.lightNode=new THREE.Object3D,this.dir_light1=new THREE.DirectionalLight((new THREE.Color).setRGB(1,1,1),t),this.dir_light1.position.set(-1,0,1),this.dir_light1.position.multiplyScalar(1e3*e),this.lightNode.add(this.dir_light1),this.amb_light=new THREE.AmbientLight((new THREE.Color).setRGB(1,1,1)),this.camera.add(this.lightNode),this.toggleLights(0!==t)},this.toggleLights=function(e,t){if(this.amb_light&&this.lightNode){e&&!this.lightsOn?(this.lights=[this.dir_light1,this.amb_light],this.lightsOn=!0):!e&&this.lightsOn&&(this.lightsOn=!1,this.lights=[])
var n=i.LightPresets[L],o=n.ambientLightColor,r=n.directLightColor
this.lightsOn?(t&&this.amb_light?this.amb_light.color.setRGB(.5*r[0],.5*r[1],.5*r[2]):o&&this.amb_light&&this.amb_light.color.setRGB(o[0],o[1],o[2]),r&&this.dir_light1&&this.dir_light1.color.setRGB(r[0],r[1],r[2])):o&&this.amb_light&&t&&this.amb_light.color.setRGB(o[0],o[1],o[2])}},this.syncCamera=function(e){this.camera.updateProjectionMatrix(),e&&this.setWorldUp(this.api.navigation.getWorldUpVector()),w=!0},this.setViewFromFile=function(e,t){var i,n=e.getDefaultCamera()
if(n)i=n
else{i={}
var o=e.getBoundingBox(),r=o.size()
if(i.target=o.center(),e.is2d()){i.isPerspective=!1
var a=r.x/r.y,s=this.camera.aspect
s>a?i.orthoScale=r.y:i.orthoScale=r.x/s,i.up=new THREE.Vector3(0,0,1),i.position=i.target.clone(),i.position.z+=i.orthoScale,i.target.y+=1e-6*r.y}else i.isPerspective=!0,i.fov=this.camera.fov,i.up=this.camera.up.clone(),i.position=i.target.clone(),i.position.z+=1.5*Math.max(r.x,r.y,r.z)}this.setViewFromCamera(i,t)},this.adjustOrthoCamera=function(e){if(!e.isPerspective&&this.model){var t=this.model.getBoundingBox(),i=t.size(),n=e.target.clone().sub(e.position)
if(n.length()>1e3*i.length()){var o=e.position.distanceTo(t.center())
e.target.copy(e.position).add(n.normalize().multiplyScalar(o))}else e.position.copy(e.target).add(n.normalize().multiplyScalar(-e.orthoScale))}},this.setViewFromCamera=function(e,t){this.adjustOrthoCamera(e)
var i=this.model?this.model.getUpVector():null
this.model&&-1!=this.model.getData().basePath.indexOf("SaRang")&&(i=[0,0,1])
var n
n=i?(new THREE.Vector3).fromArray(i):Autodesk.Viewing.Navigation.snapToAxis(e.up.clone()),e.up=n
var o=this.api.navigation
if(t){var r=this.camera
r.up.copy(e.up),r.position.copy(e.position),r.target.copy(e.target),e.isPerspective?r.fov=e.fov:(r.saveFov=e.fov,r.fov=Autodesk.Viewing.UnifiedCamera.ORTHO_FOV),r.isPerspective=e.isPerspective,r.orthoScale=e.orthoScale,r.dirty=!0,o.setWorldUpVector(r.up),o.setView(r.position,r.target),o.setPivotPoint(r.target),this.syncCamera(!0)}else this.camera.isPerspective=e.isPerspective,n=o.computeOrthogonalUp(e.position,e.target),o.setRequestTransitionWithUp(!0,e.position,e.target,e.fov,n,e.up)
w=!0},this.setViewFromViewBox=function(e,t,i,n){if(e.is2d()){var o={},r=e.getBoundingBox(),a={width:t[2]-t[0],height:t[3]-t[1]}
a.aspect=a.width/a.height,a.centerX=t[0]+a.width/2,a.centerY=t[1]+a.height/2
var s=this.camera.aspect
s>a.aspect?o.orthoScale=a.height:o.orthoScale=a.width/s,o.isPerspective=!1,o.position=new THREE.Vector3(a.centerX,a.centerY,r.center().z+o.orthoScale),o.target=new THREE.Vector3(a.centerX,a.centerY,r.center().z),o.target.y+=1e-6*a.height,o.up=new THREE.Vector3(0,0,1),this.setViewFromCamera(o,n)}},this.setWorldUp=function(e){if(!V.equals(e)){V.copy(e)
var t=Math.abs(e.x)
N="x",Math.abs(e.y)>t&&(N="y",t=Math.abs(e.y)),Math.abs(e.z)>t&&(N="z")
var i=function(e,t){var i=(new THREE.Vector3).crossVectors(t,e).normalize(),n=Math.acos(e.dot(t))
return(new THREE.Matrix4).makeRotationAxis(i,n)},n=new THREE.Vector3(0,1,0)
C.camera.worldUpTransform=i(n,e),this.sceneUpdated(!1)}},this.addModel=function(e){if(e){var t=!!this.model,n=e.is2d()
if(this.model||(this.model=e,b.setUnitScale(e.getUnitScale())),Y.addModel(e),this.selector.addModel(e),this.visibilityManager.addModel(e),n){A.initLayersTexture(e)
var o=A.create2DMaterial(e.getData(),{},!0),r=A.findMaterial(e.getData(),o)
if(b.enter2DMode(r),!t){this.is2d=!0,I=L,this.setLightPreset(i.DefaultLightPreset2d)
var a=e.getData()
if(a.hidePaper){var s=a.bgColor,l=s>>16&255,c=s>>8&255,u=255&s
this.setClearColors(l,c,u,l,c,u)}}}if(this.api.navigation.setIs2D(n&&!t),this.api.setActiveNavigationTool(),!t){this.setViewFromFile(e,!0),this.controls.recordHomeView()
var d=e.getBoundingBox(),h=.5*d.size().length()
this.initLights(h)}n||this.setLightPresetFromFile(e)||this.setLightPreset(L,!0),this.fireRenderOptionChanged(),this.invalidate(!0)}},this.getSvfMaterialId=function(e){return this.model.getFragmentList().getSvfMaterialId(e)},this.getMaterials=function(){return A},this.createThreeMesh=function(e,t,i,n){var o,r=e.getData()
if(t.isLines){var a=!!t.attributes.color,s=new THREE.LineBasicMaterial({vertexColors:a})
if(!a){var l=A.findMaterial(r,i)
s.color=l.color}A.addMaterialNonHDR(r.basePath+i+"_line_"+s.id,s),o=new THREE.Mesh(t,s,!r.animations),o.isLine=!0,r.hasLines=!0}else{var s=A.findMaterial(r,i)
s&&(s.svfMatId=i),A.applyGeometryFlagsToMaterial(s,t),o=new THREE.Mesh(t,s,!r.animations),o.materialId=parseInt(i),t.is2d&&(o.is2d=!0)}return n&&(o.matrix&&o.matrix.copy(n),o.matrixWorld.copy(n)),o.matrixAutoUpdate=!1,o.frustumCulled=!1,o},this.onLoadComplete=function(e){function t(){if(i.animations){n.keyFrameAnimator=new Autodesk.Viewing.Private.KeyFrameAnimator(n,i.animations.duration)
for(var e in i.animations.animations)n.keyFrameAnimator.add(i.animations.animations[e])
n.keyFrameAnimator["goto"](0),n.api.fireEvent({type:Autodesk.Viewing.ANIMATION_READY_EVENT})}n.api.removeEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,t)}j=!1,this.signalProgress(100,""),this.sceneUpdated(!1),this.is2d&&(this.selectionMaterial2d=A.init2DSelectionMaterial(e),this.createOverlayScene("selection2d",this.selectionMaterial2d))
var i=e.getData()
Y.getGeometryList().printStats(),i.hasLines&&A.togglePolygonOffset(!0)
var n=this
e.isObjectTreeCreated()?t():this.api.addEventListener(Autodesk.Viewing.OBJECT_TREE_CREATED_EVENT,t),this.api.fireEvent({type:Autodesk.Viewing.GEOMETRY_LOADED_EVENT,model:e})},this.signalProgress=function(e,t){this.api.fireEvent({type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,percent:e,message:t})},this.resize=function(e,t){g=!0,E=e,y=t},this.unloadCurrentModel=function(){this.is2d&&(this.is2d=void 0,this.selectionMaterial2d=null,this.removeOverlay("selection2d"),b.exit2DMode()),b.beginScene(this.scene,this.camera,this.lights,!0),b.composeFinalFrame(),this.model&&(Y.removeModel(this.model),this.model.dtor(this.glrenderer()),A.cleanup(this.model.getData()),this.model.getData().propWorker.dtor(),this.model.loader&&this.model.loader.dtor(),this.selector.removeModel(this.model),this.visibilityManager.removeModel(this.model),this.model=null),I>=0&&(L=I)}
var Z=function(e,t,i){t.depthWrite=!1,t.depthTest=!0,t.side=THREE.DoubleSide,i.depthWrite=!1,i.depthTest=!0,i.side=THREE.DoubleSide,C.createOverlayScene(e,t,i)}
this.createOverlayScene=function(e,t,i,n){t&&A.addMaterialNonHDR(e+"_pre",t),i&&A.addMaterialNonHDR(e+"_post",i)
var o=new THREE.Scene
o.__lights=this.scene.__lights,this.overlayScenes[e]={scene:o,camera:n,materialPre:t,materialPost:i}},this.removeOverlayScene=function(e){var t=this.overlayScenes[e]
t&&(delete this.overlayScenes[e],this.invalidate(!1,!1,!0))},this.addOverlay=function(e,t){this.overlayScenes[e].scene.add(t),this.invalidate(!1,!1,!0)},this.addMultipleOverlays=function(e,t){for(var i in t)t.hasOwnProperty(i)&&this.addOverlay(e,t[i])},this.removeOverlay=function(e,t){this.overlayScenes[e].scene.remove(t),this.invalidate(!1,!1,!0)},this.removeMultipleOverlays=function(e,t){for(var i in t)t.hasOwnProperty(i)&&this.removeOverlay(e,t[i])},this.clearOverlay=function(e){if(this.overlayScenes[e]){var t,i,n=this.overlayScenes[e].scene
for(i=n.children.length-1;i>=0;--i)t=n.children[i],t&&n.remove(t)
this.invalidate(!1,!1,!0)}},this.setClearColors=function(e,t,i,n,o,r){if(this.clearColorTop=new THREE.Vector3(e/255,t/255,i/255),this.clearColorBottom=new THREE.Vector3(n/255,o/255,r/255),!A.reflectionCube||A.reflectionCube.isBgColor){var a=A.setCubeMapFromColors(this.clearColorTop,this.clearColorBottom)
b.setCubeMap(a)}b.setClearColors(this.clearColorTop,this.clearColorBottom),x&&x.setClearColors(this.clearColorTop,this.clearColorBottom),D=!0,this.fireRenderOptionChanged()}
var Q=new THREE.Box3
this.getVisibleBounds=function(e,t){var i=new THREE.Box3
return Y.isEmpty()||(p(i,this.scene),i=Y.getVisibleBounds(e).union(i),t&&(i=f().union(i))),i},this.getFitBounds=function(e){var t
return this.is2d&&(e=!0),e||null===this.selector||(t=this.selector.getSelectionBounds()),(!t||t.empty())&&(t=this.getVisibleBounds()),t},this.getRenderProxy=function(e,t){return e.getFragmentList().getVizmesh(t)},this.getFragmentProxy=function(e,t){return new i.FragmentPointer(e.getFragmentList(),t)},this.getRenderProxyCount=function(e){return e.getFragmentList().getCount()},this.getRenderProxyDbIds=function(e,t){return e.getFragmentList().getDbIds(t)},this.isWholeModelVisible=function(e){return Y?Y.areAllVisible():!0},this.highlightObjectNode=function(e,t,i,n){e.is2d()&&A.highlightObject2D(t,i)
var o=this,r=e.getData().instanceTree
if(r&&!e.is2d())r.enumNodeFragments(t,function(t){o.highlightFragment(e,t,i,n)},!1)
else{var a=t
if(e.is2d()&&(a=e.getData().fragments.dbId2fragId[t]),Array.isArray(a))for(var s=0;s<a.length;s++)o.highlightFragment(e,a[s],i,n)
else o.highlightFragment(e,a,i,n)}},this.highlightFragment=function(e,t,i,n){var o=this.getRenderProxy(e,t)
if(o){var r=!n||o.is2d,a=e.id+":"+t
if(r){var s=e.is2d()?"selection2d":"selection"
if(i){var l=new THREE.Mesh(o.geometry,o.material)
l.matrix.copy(o.matrixWorld),l.matrixAutoUpdate=!1,l.matrixWorldNeedsUpdate=!0,l.frustumCulled=!1,l.model=e,l.fragId=t,this.addOverlay(s,l),this.selectionMeshes[a]=l}else this.selectionMeshes[a]&&(this.removeOverlay(s,this.selectionMeshes[a]),delete this.selectionMeshes[a])}r&&i||e.setHighlighted(t,i)&&this.invalidate(!0)}},this.explode=function(e){e!=F&&(F=e,Y.explode(e),this.sceneUpdated(!0),this.api.fireEvent({type:t.EXPLODE_CHANGE_EVENT}))},this.getExplodeScale=function(){return F},this.setGhostingBrightness=function(e){e?this.fadeMaterial.color=new THREE.Color(1052688):this.fadeMaterial.color=new THREE.Color(16777215),this.fadeMaterial.needsUpdate=!0},this.setLightPreset=function(e,t){if(L!=e||t){(0>e||i.LightPresets.length<=e)&&(e=i.DefaultLightPreset),L=e
var n=i.LightPresets[e]
if(n&&n.path){var o="res/environments/"+n.path,r=i.getResourceUrl(o+"_mipdrop."+(n.type||"")+".dds"),a=i.getResourceUrl(o+"_irr."+(n.type||"")+".dds")
A.setIrradianceMap(a,n.E_bias)
var s=A.setCubeMap(r,n.E_bias)
b.setCubeMap(s),A.setEnvExposure(-n.E_bias),this.setTonemapExposureBias(n.E_bias),this.setTonemapMethod(n.tonemap),this.setGhostingBrightness(n.darkerFade)}else{A.setIrradianceMap(null)
var s=A.setCubeMap(null)
b.setCubeMap(s),A.setEnvExposure(0),this.setTonemapExposureBias(0),this.setTonemapMethod(0),this.setGhostingBrightness(!1)}var l=Autodesk.Viewing.Shaders.SAOShader.uniforms.radius.value,c=Autodesk.Viewing.Shaders.SAOShader.uniforms.intensity.value
n.hasOwnProperty("saoRadius")&&(l=n.saoRadius),n.hasOwnProperty("saoIntensity")&&(c=n.saoIntensity),b.setAOOptions(l,c)
var u=n.bgColorGradient
u||(u=i.BackgroundPresets.Custom),this.setClearColors(u[0],u[1],u[2],u[3],u[4],u[5])
var d=1
null!==n.lightMultiplier&&void 0!==n.lightMultiplier&&(d=n.lightMultiplier),this.dir_light1&&(this.toggleLights(0!==d),this.dir_light1.intensity=d,n.lightDirection&&(this.dir_light1.position.set(-n.lightDirection[0],-n.lightDirection[1],-n.lightDirection[2]),this.dir_light1.position.multiplyScalar(1e3*this.model.getData().bbox.size().length()))),A.setEnvRotation(n.rotation||0),b.setEnvRotation(n.rotation||0),this.invalidate(!0,!1,!0),this.fireRenderOptionChanged()}},this.setLightPresetFromFile=function(e){var t=e.getMetadata("renderEnvironmentStyle","value",null)
if(null===t||""===t)return!1
for(var n=e.getMetadata("renderEnvironmentExposureBias","value",null),o=e.getMetadata("renderEnvironmentExposureBase","value",null),r=!1,a=0;a<i.LightPresets.length;a++)if(t===i.LightPresets[a].name){null!==n&&null!==o&&(i.LightPresets[a].E_bias=n+o),this.setLightPreset(a),r=!0
break}var s=e.getMetadata("renderEnvironmentRotation","value",null)
return s&&(A.setEnvRotation(s),b.setEnvRotation(s)),r},this.setTonemapMethod=function(e){e!=b.getToneMapMethod()&&(b.setTonemapMethod(e),A.setTonemapMethod(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.setTonemapExposureBias=function(e){e!=b.getExposureBias()&&(b.setTonemapExposureBias(e),A.setTonemapExposureBias(e),this.fireRenderOptionChanged(),this.invalidate(!0))},this.dtor=function(){window.cancelAnimationFrame(v),this.unloadCurrentModel(),this.controls=null,this.canvas=null,this.loader=null,this.selector.dtor(),this.selector=null,this.model=null,this.visibilityManager=null,Y=null,b=null,A.dtor(),A=null},this.hideLines=function(e){return Y&&!Y.isEmpty()?(Y.hideLines(e),this.sceneUpdated(!0),!0):!1},this.getCutPlanes=function(){return A.getCutPlanes()},this.setCutPlanes=function(e){A.setCutPlanes(e),this.sceneUpdated(),this.api.fireEvent({type:Autodesk.Viewing.CUTPLANES_CHANGE_EVENT})},this.setCutPlanesOutlineColor=function(e){A.setCutPlanesOutlineColor(e),this.invalidate(!0,!1,!1),this.api.fireEvent({type:Autodesk.Viewing.CUTPLANES_CHANGE_EVENT})},this.setCutPlanesOutlineThickness=function(e){A.setCutPlanesOutlineThickness(e),this.invalidate(!0,!1,!1),this.api.fireEvent({type:Autodesk.Viewing.CUTPLANES_CHANGE_EVENT})},this.fireRenderOptionChanged=function(){A.toggleMRTSetting(),this.api.fireEvent({type:Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT})},this.viewportToRay=function(e,t){var i=this.camera
e.z=-1
var n=new THREE.Vector3(e.x,e.y,1)
return e=e.unproject(i),n=n.unproject(i),n.sub(e).normalize(),t||(t=new THREE.Ray),t.set(i.isPerspective?i.position:e,n),t},this.rayIntersect=function(e,t,i){var n=Y.rayIntersect(e.origin,e.direction,t,i)
if(this.sceneAfter.children.length){var o=new THREE.Raycaster(e.origin,e.direction,this.camera.near,this.camera.far),r=[]
if(VBIntersector.intersectObject(this.sceneAfter,o,r,!0),r.length)for(var a=0;a<r.length&&!(r[a].distance>n.distance);a++){n=r[a]
break}}if(!n)return null
var s=n.fragId,l=n.point,c=n.face,u=n.model,d=n.dbId
if(void 0===d&&void 0!==s){d=u.getFragmentList().getDbIds(s)
var h=u.getData().instanceTree
h||(d=s)}return{dbId:d,fragId:s,intersectPoint:l,face:c,model:u}},this.castRayViewport=function(){var e=new THREE.Ray
return function(t,i,n){return Y?(this.viewportToRay(t,e),this.rayIntersect(e,i,n)):{}}}(),this.clientToViewport=function(e,t){var i=C.canvas.getBoundingClientRect()
return new THREE.Vector3((e+.5)/i.width*2-1,2*-((t+.5)/i.height)+1,1)},this.viewportToClient=function(e,t){var i=C.canvas.getBoundingClientRect()
return new THREE.Vector3(.5*(e+1)*i.width-.5,(t-1)*-.5*i.height-.5,0)},this.castRay=function(e,t,i){return this.castRayViewport(this.clientToViewport(e,t),i)},this.intersectGroundViewport=function(e){var t=this.camera,i="z"
this.is2d||(i=N)
var n=e
n.z=-1
var o=new THREE.Vector3(n.x,n.y,1)
n=n.unproject(t),o=o.unproject(t),o.sub(n).normalize()
var r=o
if(Math.abs(r[i])<1e-6)return null
var a
a=t.isPerspective?t.position:n
var s=this.model?this.model.getBoundingBox().min[i]:0,l=(s-a[i])/r[i]
return r.multiplyScalar(l),r.add(a),r},this.intersectGround=function(e,t){return this.intersectGroundViewport(this.clientToViewport(e,t))},this.hitTestViewport=function(e,t){var i
if(C.is2d){var n=b.idAtPixel(e.x,e.y)
if(0>=n)return null
var o=this.intersectGroundViewport(e)
i={intersectPoint:o,dbId:n,fragId:C.model.getData().fragments.dbId2fragId[n],model:C.model}}else i=this.castRayViewport(e,t)
return i},this.hitTest=function(e,t,i){return C.hitTestViewport(this.clientToViewport(e,t),i)},this.snappingHitTestViewport=function(e,t){var i
if(C.is2d){var n=b.idAtPixels(e.x,e.y,17)
if(0>n)return null
var o=this.intersectGroundViewport(e)
i={intersectPoint:o,dbId:n,fragId:C.model.getData().fragments.dbId2fragId[n]}}else{var r,n=b.idAtPixel(e.x,e.y)
n>=0&&(r=[],this.model.getData().instanceTree.enumNodeFragments(n,function(e){r.push(e)},!0)),i=this.castRayViewport(e,t,r)}return i},this.snappingHitTest=function(e,t,i){return this.snappingHitTestViewport(this.clientToViewport(e,t),i)},this.rolloverObjectViewport=function(e){b.rolloverObjectViewport(e.x,e.y)&&this.invalidate(!1,!1,!0)},this.rolloverObject=function(e,t){this.rolloverObjectViewport(this.clientToViewport(e,t))},this.getScreenShot=function(e,t,i){b.presentBuffer()
var n=window.URL.createObjectURL(m(C.canvas.toDataURL("image/png")))
if(!e||!t)return n
var o,r,a=0,s=0
e>t||e/t>E/y?(o=e,r=y/E*e,s=t/2-r/2):(r=t,o=E/y*t,a=e/2-o/2)
var l=new Image
l.src=n
var c=document.createElement("canvas"),u=c.getContext("2d")
c.width=e,c.height=t,l.onload=function(){u.drawImage(l,a,s,o,r)
var e=window.URL.createObjectURL(m(c.toDataURL("image/png")))
i?i(e):window.open(e)}},this.modelQueue=function(){return Y},this.glrenderer=function(){return T},this.renderer=function(){return b},this.worldUp=function(){return V},this.worldUpName=function(){return N},this.setUserRenderContext=function(e){b=e?e:new RenderContext,b.init(T,this.canvas.clientWidth,this.canvas.clientHeight),b.setClearColors(this.clearColorTop,this.clearColorBottom),this.invalidate(!0),this.sceneUpdated(!1)},this.invalidate=function(e,t,i){D=D||e,H=H||t,O=O||i},this.sceneUpdated=function(e){this.invalidate(!0,!1,!0),Y&&e&&Y.invalidateVisibleBounds(),B=!0},this.currentLightPreset=function(){return L},this.matman=function(){return A},this.fps=function(){return 1e3/W},this.api=n,this.canvas=e,this.loader=null,T=o(e),b=new RenderContext,b.init(T,e.clientWidth,e.clientHeight),A=new i.MaterialManager(this),init_UnifiedCamera(),this.camera=new Autodesk.Viewing.UnifiedCamera(e.clientWidth,e.clientHeight),this.lights=[],this.cameraChangedEvent=this.camera.getCameraChangedEvent(),this.scene=new THREE.Scene,this.sceneAfter=new THREE.Scene,this.sceneAfter.sortObjects=!1,this.overlayScenes={},this.selectionMaterial2d=null,this.selectionMaterialBase=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1}),this.selectionMaterialTop=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:.15,transparent:!0}),this.selectionMaterialTop.packedNormals=!0,this.selectionMaterialBase.packedNormals=!0,Z("selection",this.selectionMaterialBase,this.selectionMaterialTop),this.selectionMeshes={},this.fadeMaterial=new THREE.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1}),this.fadeMaterial.packedNormals=!0,A.addMaterial("__fadeMaterial__",this.fadeMaterial,!0),this.highlightMaterial=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1}),this.highlightMaterial.packedNormals=!0,A.addMaterial("__highlightMaterial__",this.highlightMaterial,!0),this.progressiveRender=!0,(isAndroidDevice()||isIOSDevice())&&(S*=2,M*=2,R*=2),this.targetFrameTime=R,this.controls={update:function(e){},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){}},this.selector=new i.MultiModelSelector(this),this.visibilityManager=new i.MultiModelVisibilityManager(this),this.showGhosting=!0,this.showOverlaysWhileMoving=!0,this.skipAOWhenMoving=!1,this.keyFrameAnimator=null
var J=i.LightPresets[i.DefaultLightPreset].bgColorGradient
this.setClearColors(J[0],J[1],J[2],J[3],J[4],J[5]),_=new Autodesk.Viewing.Shaders.GroundShadow(T),_.enabled=!0,A.addMaterialNonHDR("groundShadowDepthMaterial",_.getDepthMaterial()),A.addMaterialNonHDR("normalsMaterial",b.getDepthMaterial()),b.beginScene(this.scene,this.camera,this.lights,!0),b.composeFinalFrame(),this.messageClient=null,this.presenceChannelId=null,this.p2p=null,this.viewtx=null,this.interceptor=null,this.joinLiveReviewSession=function(e){!function(){var e=Autodesk.Viewing,t=e.Private
t.InteractionInterceptor=function(e){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(e){},this.deactivate=function(e){},this.update=function(e){return!1},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e,t){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(t){return e.takeControl(),!1},this.handleButtonDown=function(t,i){return e.takeControl(),!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(t){return e.updatePointer(t),!1},this.handleGesture=function(t){return e.takeControl(),!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}},t.ViewTransceiver=function(i){function n(e){m=!0
var t=JSON.parse(e.data.msg)
b.restoreState(t),f.impl.invalidate(!0,!1,!0),m=!1}function o(e){return Math.round(1e3*e)/1e3}function r(e){for(var t=0;t<e.length;t++)e[t]=o(e[t])}function a(e){var t=e.data.msg
t[1]===!0||g||(t[0]!=h&&(h=t[0],e.data.lastInControl=t[0],p.dispatchEvent({type:"controlChange",channelId:p.channelId,data:e.data})),v=!1,f.navigation.setView((new THREE.Vector3).set(t[2],t[3],t[4]),(new THREE.Vector3).set(t[5],t[6],t[7])),f.navigation.setCameraUpVector((new THREE.Vector3).set(t[8],t[9],t[10])))}function s(e){if(v||g){var t=e.camera,n=[t.position.x,t.position.y,t.position.z,t.target.x,t.target.y,t.target.z,t.up.x,t.up.y,t.up.z]
r(n),n.unshift(g),n.unshift(i.getLocalId()),E.sendMessage("camera",n,p.channelId),h!=n[0]&&(h=n[0],p.dispatchEvent({type:"controlChange",channelId:p.channelId,data:{lastInControl:h}}))}}function l(e,t,i){e&&!A&&(A=document.createElement("div"),A.classList.add("collabPointer")),e&&!T?(f.container.appendChild(A),T=!0):!e&&T&&(f.container.removeChild(A),T=!1),e&&(A.style.left=t-6+"px",A.style.top=i-6+"px")}function c(e){if(!v&&!g){var t=e.data.msg
y.origin.set(t[1],t[2],t[3]),y.direction.set(t[4],t[5],t[6])
var i=y.at(f.getCamera().near)
i.project(f.getCamera()),i=f.impl.viewportToClient(i.x,i.y),l(!0,i.x,i.y)}}function u(e){if(v){var t=f.impl.clientToViewport(e.canvasX,e.canvasY)
f.impl.viewportToRay(t,y)
var n=[y.origin.x,y.origin.y,y.origin.z,y.direction.x,y.direction.y,y.direction.z]
r(n),n.unshift(i.getLocalId()),E.sendMessage("pointer",n,p.channelId)}}function d(e){if(!m){var t=b.getState(w)
i.sendMessage("state",JSON.stringify(t),p.channelId)}}var h,p=this,f=this.viewer=null,m=!1,v=!1,g=!1,E=this.client=i,y=new THREE.Ray,A=null,T=!1
this.channelId=null
var b,w={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}}
this.takeControl=function(){v=!0,l(!1)},this.updatePointer=function(e){u(e)},this.connectCamera=function(e){g=!e},this.attach=function(i){f&&this.detach(),this.viewer=f=i,b=new t.ViewerState(f),E.addEventListener("cameraChange",a),E.addEventListener("pointerMove",c),E.addEventListener("viewerState",n),f.hasEventListener(e.CAMERA_CHANGE_EVENT,s)||f.addEventListener(e.CAMERA_CHANGE_EVENT,s),f.hasEventListener(e.SELECTION_CHANGED_EVENT,d)||(f.addEventListener(e.SELECTION_CHANGED_EVENT,d),f.addEventListener(e.ISOLATE_EVENT,d),f.addEventListener(e.HIDE_EVENT,d),f.addEventListener(e.SHOW_EVENT,d),f.addEventListener(e.HIGHLIGHT_EVENT,d),f.addEventListener(e.EXPLODE_CHANGE_EVENT,d),f.addEventListener(e.LAYER_VISIBILITY_CHANGED_EVENT,d),f.addEventListener(e.CUTPLANES_CHANGE_EVENT,d))},this.detach=function(){E&&(E.removeEventListener("cameraChange",a),E.removeEventListener("viewerState",n)),f&&(f.removeEventListener(e.CAMERA_CHANGE_EVENT,s),f.removeEventListener(e.SELECTION_CHANGED_EVENT,d),f.removeEventListener(e.ISOLATE_EVENT,d),f.removeEventListener(e.HIDE_EVENT,d),f.removeEventListener(e.SHOW_EVENT,d),f.removeEventListener(e.HIGHLIGHT_EVENT,d),f.removeEventListener(e.EXPLODE_CHANGE_EVENT,d),f.removeEventListener(e.LAYER_VISIBILITY_CHANGED_EVENT,d),f.removeEventListener(e.CUTPLANES_CHANGE_EVENT,d),this.viewer=f=null,b=null)}},t.ViewTransceiver.prototype.constructor=t.ViewTransceiver,Autodesk.Viewing.EventDispatcher.prototype.apply(t.ViewTransceiver.prototype)}(),this.messageClient||(this.messageClient=i.MessageClient.GetInstance()),this.presenceChannelId||(this.presenceChannelId=window.location.host),this.messageClient.isConnected()||this.messageClient.connect(e),this.viewtx||(this.viewtx=new i.ViewTransceiver(this.messageClient)),this.viewtx.channelId=e,this.viewtx.attach(global_viewer_instance),this.p2p||(this.p2p=new i.P2PClient(this.messageClient)),this.messageClient.join(this.viewtx.channelId),this.interceptor||(this.interceptor=new i.InteractionInterceptor(this.viewtx)),n.toolController.registerTool(this.interceptor),n.toolController.activateTool(this.interceptor.getName())},this.leaveLiveReviewSession=function(){this.p2p.hangup(),this.viewtx.detach(n),this.messageClient.disconnect()}}var t=Autodesk.Viewing,i=t.Private
e.prototype.constructor=e,Autodesk.Viewing.Private.Viewer3DImpl=e}(),Autodesk.Viewing.Private.ViewerState=function(e){function t(){var e=Math.round(4294967295*Math.random()),t=Date.now()
return e.toString(16)+t.toString(16)}var i=!0
this.getState=function(n){var o=e.navigation,r=Autodesk.Viewing.Private,a={}
a.guid=t(),a.seedURN=this.getSeedUrn(),a.overrides=this.getTransformsOverrides()
var s=a.objectSet
Array.isArray(s)||(a.objectSet=s=[]),e.model&&!e.model.is2d()&&(s[0]={id:this.getSelectedNodes(),isolated:e.getIsolatedNodes(),hidden:e.getHiddenNodes(),explodeScale:e.getExplodeScale(),idType:"lmv"}),e.model&&e.model.is2d()&&(s[0]={id:this.getSelectedNodes(),isolated:this.getVisibleLayers2d(),hidden:[],idType:"lmv"})
var l=a.viewport
l||(l=a.viewport={})
var c=o.getCamera().isPerspective
l.name="",l.eye=o.getPosition().toArray(),l.target=o.getTarget().toArray(),l.up=o.getCamera().up.toArray(),l.worldUpVector=o.getWorldUpVector().toArray(),l.pivotPoint=o.getPivotPoint().toArray(),l.distanceToOrbit=o.getPivotPlaneDistance(),l.aspectRatio=this.getAspectRatio(),l.projection=c?"perspective":"orthographic",l.isOrthographic=!c,c?l.fieldOfView=o.getVerticalFov():l.orthographicHeight=this.getOrthographicHeight()
var u=a.renderOptions
if(u||(u=a.renderOptions={}),u.environment=r.LightPresets[e.impl.currentLightPreset()].name,u.ambientOcclusion={enabled:e.impl.renderer().settings.sao,radius:e.impl.renderer().getAORadius(),intensity:e.impl.renderer().getAOIntensity()},u.toneMap={method:e.impl.renderer().getToneMapMethod(),exposure:e.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()},u.appearance={ghostHidden:e.impl.showGhosting,ambientShadow:e.prefs.ambientShadows,antiAliasing:e.impl.renderer().settings.antialias,progressiveDisplay:e.prefs.progressiveRendering,displayLines:e.prefs.lineRendering},e.model&&!e.model.is2d())for(var d=a.cutplanes=[],h=e.getCutPlanes(),p=0;p<h.length;p++)d.push(h[p].toArray())
for(var f in e.loadedExtensions)e.loadedExtensions[f].getState(a)
return n&&n!==i&&this.applyFilter(a,n),a},this.restoreState=function(t,n,o){if(!t)return stderr("restoreState has no viewer state to restore from."),!1
if(!e||!e.model)return stderr("restoreState has no viewer or model to restore."),!1
n&&n!==i&&(t=JSON.parse(JSON.stringify(t)),this.applyFilter(t,n))
var r=e.navigation
if(r.getTransitionActive())return stderr("Abort restoreState, animation in progress..."),!1
if(e.model&&Array.isArray(t.objectSet)&&t.objectSet.length>0){var a=t.objectSet[0],s=e.impl?e.impl.selector:null,l=a.id
l&&s&&(l=this.toIntArray(l),s.setSelection(l))
var c=a.isolated||[]
if(c=this.toIntArray(c),e.isolate(c),0===c.length){var u=a.hidden||null
u&&u.length>0&&(u=this.toIntArray(u),e.hide(u))}if("explodeScale"in a){var d=parseFloat(a.explodeScale)
e.explode&&(e.explode(d),e.explodeSlider&&(e.explodeSlider.value=d))}if(e.model.is2d()){var h=a.id||[]
if(h){if(s){var p=h.map(function(e){return{dbId:e,fragIds:0}})
s.setSelection(p)}}else s.clearSelection(!0)
var f=a.isolated
Array.isArray(f)&&f.length>0?(e.setLayerVisible(null,!1),e.impl.setLayerVisible(f,!0)):e.setLayerVisible(null,!0)}}var m=t.viewport
if(m){var v=this.getVector3FromArray(m.eye,r.getPosition()),g=this.getVector3FromArray(m.up,r.getCamera().up),E=this.getVector3FromArray(m.target,r.getTarget()),y="fieldOfView"in m?parseFloat(m.fieldOfView):r.getVerticalFov(),A=this.getVector3FromArray(m.worldUpVector,null)
if(!A){var T=e.model?e.model.getUpVector():null
A=T?(new THREE.Vector3).fromArray(T):new THREE.Vector3(0,1,0)}var b=r.getCamera().isPerspective
"isOrthographic"in m&&(b=!m.isOrthographic)
var w=this.getOrthographicHeight()
"orthographicHeight"in m&&(w=Number(m.orthographicHeight))
var _={position:v,target:E,up:g,worldup:A,aspect:e.impl.camera.aspect,fov:y,orthoScale:w,isPerspective:b}
this.restoreCameraState(_,o)}var x=t.renderOptions
if(x){var C=e.prefs.ambientShadows,S=e.prefs.antialiasing,R=x.ambientOcclusion
if(R){"enabled"in R&&(C=R.enabled)
var M="radius"in R?R.radius:null,P="intensity"in R?R.intensity:null
null!==M&&null!==P&&(e.impl.renderer().setAOOptions(M,P),e.impl.renderer().composeFinalFrame(!1))}if("environment"in x){var L=this.getLightPresetIndex(x.environment);-1!==L&&e.setLightPreset(L)}var I=x.toneMap
if(I){var k="lightMultiplier"in I?I.lightMultiplier:null,V="exposure"in I?I.exposure:null
null!==k&&null!==V&&(e.impl.dir_light1&&(e.impl.dir_light1.intensity=Math.pow(2,k)),e.impl.renderer().setTonemapExposureBias(V,k),e.impl.invalidate(!0))}var N=x.appearance
N&&("antiAliasing"in N&&(S=N.antiAliasing),"progressiveDisplay"in N&&e.setProgressiveRendering(N.progressiveDisplay),"ghostHidden"in N&&e.setGhosting(N.ghostHidden),"displayLines"in N&&e.hideLines(!N.displayLines)),e.setQualityLevel(C,S)}if(Array.isArray(t.cutplanes)&&e.model&&!e.model.is2d()){for(var D=[],H=0;H<t.cutplanes.length;H++){var O=t.cutplanes[H]
Array.isArray(O)&&O.length>=4&&D.push(new THREE.Vector4(O[0],O[1],O[2],O[3]))}e.setCutPlanes(D)}for(var B in e.loadedExtensions)e.loadedExtensions[B].restoreState(t,o)
return!0},this.restoreCameraState=function(t,i){e.impl.adjustOrthoCamera(t)
var n=e.navigation
i?(t.isPerspective?n.toPerspective():n.toOrthographic(),n.setCameraUpVector(t.up),n.setWorldUpVector(t.worldup),n.setView(t.position,t.target),n.setPivotPoint(t.target),n.setVerticalFov(t.fov,!1),e.impl.syncCamera(!0)):(e.impl.camera.isPerspective=t.isPerspective,n.setRequestTransitionWithUp(!0,t.position,t.target,t.fov,t.up,t.worldup))},this.toIntArray=function(e){var t=[]
if(Array.isArray(e))for(var i=0,n=e.length;n>i;++i)t.push(parseInt(e[i]))
return t},this.extractSelectedNodeIds=function(e){if(e&&Array.isArray(e.objectSet)&&e.objectSet.length>0){var t=e.objectSet[0]
return this.toIntArray(t.id)}return[]},this.extractIsolatedNodeIds=function(e){if(e&&Array.isArray(e.objectSet)&&e.objectSet.length>0){var t=e.objectSet[0]
return this.toIntArray(t.isolated)}return[]},this.getVector3FromArray=function(e,t){return e instanceof Array&&e.length>2?(e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e[2]=parseFloat(e[2]),(new THREE.Vector3).fromArray(e)):t},this.getSelectedNodes=function(){return e.impl&&e.impl.selector?e.impl.selector.getSelection():[]},this.getVisibleLayers2d=function(){var t=[],i=e.impl.matman(),n=i.layersMap
for(var o in n)n.hasOwnProperty(o)&&i.isLayerVisible(o)&&t.push(o)
return t},this.getAspectRatio=function(){var t=e.navigation.getScreenViewport(),i=t.width/t.height
return i},this.getOrthographicHeight=function(){var t=e.navigation.getCamera()
return t.isPerspective?0:Math.abs(2*t.orthographicCamera.top)},this.getSeedUrn=function(){return e.model&&e.model.loader?e.model.loader.svfUrn||"":""},this.getTransformsOverrides=function(){return{transformations:[]}},this.getToneMapIntensity=function(){var t=0
return e.impl.dir_light1&&(t=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),t},this.getLightPresetIndex=function(e){for(var t=Autodesk.Viewing.Private,i=0;i<t.LightPresets.length;i++)if(t.LightPresets[i].name===e)return i
return-1},this.applyFilter=function(e,t){if(t!==!0)for(var i in e)if(e.hasOwnProperty(i)){var n=t[i]
void 0===n?(delete e[i],stderr("[applyFilter] C - skipping key ["+i+"] from viewerState; unspecified in filter.")):"boolean"==typeof n?n===!1&&(delete e[i],stderr("[applyFilter] D - skipping key ["+i+"] from viewerState; explicit filtering.")):n instanceof Object?e[i]instanceof Object?this.applyFilter(e[i],t[i]):stderr("[applyFilter] A - Invalid filter Object for key ["+i+"]"):stderr("[applyFilter] B - Invalid filter value for key ["+i+"]")}}},Autodesk.Viewing.Private.ViewerState.prototype.constructor=Autodesk.Viewing.Private.ViewerState,AutodeskNamespace("Autodesk.Viewing.i18n"),function(){function e(e,t){if(!t||"function"==typeof t)return e
for(var i in t)e[i]=t[i]
return e}function t(e,t,i){var n,o=0,r=e.length,a=void 0===r||"[object Array]"!==Object.prototype.toString.apply(e)||"function"==typeof e
if(i)if(a){for(n in e)if(t.apply(e[n],i)===!1)break}else for(;r>o&&t.apply(e[o++],i)!==!1;);else if(a){for(n in e)if(t.call(e[n],n,e[n])===!1)break}else for(;r>o&&t.call(e[o],o,e[o++])!==!1;);return e}function i(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return k[e]}):e}function n(e){var t=function(e){if(window.XMLHttpRequest)return e(null,new XMLHttpRequest)
if(window.ActiveXObject)try{return e(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(t){return e(null,new ActiveXObject("Microsoft.XMLHTTP"))}return e(new Error)},i=function(e){if("string"==typeof e)return e
var t=[]
for(var i in e)e.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]))
return t.join("&")},n=function(e){e=e.replace(/\r\n/g,"\n")
for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i)
128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},o=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
e=n(e)
var i,o,r,a,s,l,c,u="",d=0
do i=e.charCodeAt(d++),o=e.charCodeAt(d++),r=e.charCodeAt(d++),a=i>>2,s=(3&i)<<4|o>>4,l=(15&o)<<2|r>>6,c=63&r,isNaN(o)?l=c=64:isNaN(r)&&(c=64),u+=t.charAt(a)+t.charAt(s)+t.charAt(l)+t.charAt(c),i=o=r="",a=s=l=c=""
while(d<e.length)
return u},r=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var i=arguments[t]
for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}return e},a=function(e,n,o,s){"function"==typeof o&&(s=o,o={}),o.doNotCache=o.doNotCache||!1,o.data=o.data||{},o.headers=o.headers||{},o.jsonp=o.jsonp||!1,o.async=void 0===o.async?!0:o.async
var l,c=r({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},a.headers,o.headers)
if(l="application/json"===c["content-type"]?JSON.stringify(o.data):i(o.data),"GET"===e){var u=[]
if(l&&(u.push(l),l=null),o.doNotCache&&u.push("_="+(new Date).getTime()),o.jsonp&&(u.push("callback="+o.jsonp),u.push("jsonp="+o.jsonp)),u=u.join("&"),u.length>1&&(n+=n.indexOf("?")>-1?"&"+u:"?"+u),o.jsonp){var d=document.getElementsByTagName("head")[0],h=document.createElement("script")
return h.type="text/javascript",h.src=n,void d.appendChild(h)}}t(function(t,i){if(t)return s(t)
i.open(e,n,o.async)
for(var r in c)c.hasOwnProperty(r)&&i.setRequestHeader(r,c[r])
i.onreadystatechange=function(){if(4===i.readyState){var e=i.responseText||""
if(!s)return
s(i.status,e)}},i.send(l)})},s={authBasic:function(e,t){a.headers.Authorization="Basic "+o(e+":"+t)},connect:function(e,t,i){return a("CONNECT",e,t,i)},del:function(e,t,i){return a("DELETE",e,t,i)},get:function(e,t,i){return a("GET",e,t,i)},head:function(e,t,i){return a("HEAD",e,t,i)},headers:function(e){a.headers=e||{}},isAllowed:function(e,t,i){this.options(e,function(e,n){i(-1!==n.text().indexOf(t))})},options:function(e,t,i){return a("OPTIONS",e,t,i)},patch:function(e,t,i){return a("PATCH",e,t,i)},post:function(e,t,i){return a("POST",e,t,i)},put:function(e,t,i){return a("PUT",e,t,i)},trace:function(e,t,i){return a("TRACE",e,t,i)}},l=e.type?e.type.toLowerCase():"get"
s[l](e.url,e,function(t,i){200===t?e.success(i,t,null):e.error(i,t,null)})}function o(e,t){"function"==typeof e&&(t=e,e={}),e=e||{},H.extend(I,e),delete I.fixLng,"string"==typeof I.ns&&(I.ns={namespaces:[I.ns],defaultNs:I.ns}),"string"==typeof I.fallbackNS&&(I.fallbackNS=[I.fallbackNS]),("string"==typeof I.fallbackLng||"boolean"==typeof I.fallbackLng)&&(I.fallbackLng=[I.fallbackLng]),I.interpolationPrefixEscaped=H.regexEscape(I.interpolationPrefix),I.interpolationSuffixEscaped=H.regexEscape(I.interpolationSuffix),I.lng||(I.lng=H.detectLanguage()),I.lng?I.useCookie&&H.cookie.create(I.cookieName,I.lng,I.cookieExpirationTime,I.cookieDomain):(I.lng=I.fallbackLng[0],I.useCookie&&H.cookie.remove(I.cookieName)),P=H.toLanguages(I.lng),_=P[0],H.log("currentLng set to: "+_)
var i=E
if(e.fixLng&&(i=function(e,t){return t=t||{},t.lng=t.lng||i.lng,E(e,t)},i.lng=_),B.setCurrentLng(_),I.resStore)return R=I.resStore,L=!0,void(t&&t(i))
var n=H.toLanguages(I.lng)
"string"==typeof I.preload&&(I.preload=[I.preload])
for(var o=0,r=I.preload.length;r>o;o++)for(var a=H.toLanguages(I.preload[o]),s=0,l=a.length;l>s;s++)n.indexOf(a[s])<0&&n.push(a[s])
Autodesk.Viewing.i18n.sync.load(n,I,function(e,n){R=n,L=!0,t&&t(i)})}function r(e,t){"string"==typeof e&&(e=[e])
for(var i=0,n=e.length;n>i;i++)I.preload.indexOf(e[i])<0&&I.preload.push(e[i])
return o(t)}function a(e,t,i){"string"!=typeof t?(i=t,t=I.ns.defaultNs):I.ns.namespaces.indexOf(t)<0&&I.ns.namespaces.push(t),R[e]=R[e]||{},R[e][t]=R[e][t]||{},H.extend(R[e][t],i)}function s(e,t){"string"!=typeof t&&(t=I.ns.defaultNs),R[e]=R[e]||{},R[e][t]={}}function l(e){I.ns.defaultNs=e}function c(e,t){u([e],t)}function u(e,t){var i={dynamicLoad:I.dynamicLoad,resGetPath:I.resGetPath,getAsync:I.getAsync,customLoad:I.customLoad,ns:{namespaces:e,defaultNs:""}},n=H.toLanguages(I.lng)
"string"==typeof I.preload&&(I.preload=[I.preload])
for(var o=0,r=I.preload.length;r>o;o++)for(var a=H.toLanguages(I.preload[o]),s=0,l=a.length;l>s;s++)n.indexOf(a[s])<0&&n.push(a[s])
for(var c=[],u=0,d=n.length;d>u;u++){var h=!1,p=R[n[u]]
if(p)for(var f=0,m=e.length;m>f;f++)p[e[f]]||(h=!0)
else h=!0
h&&c.push(n[u])}c.length?S.sync._fetch(c,i,function(i,n){var o=e.length*c.length
H.each(e,function(e,i){I.ns.namespaces.indexOf(i)<0&&I.ns.namespaces.push(i),H.each(c,function(e,r){R[r]=R[r]||{},R[r][i]=n[r][i],o--,0===o&&t&&(I.useLocalStorage&&S.sync._storeLocal(R),t())})})}):t&&t()}function d(e,t,i){return"function"==typeof t?(i=t,t={}):t||(t={}),t.lng=e,o(t,i)}function h(){return _}function p(e,t,i,n){if(!e)return e
if(n=n||t,e.indexOf(n.interpolationPrefix||I.interpolationPrefix)<0)return e
var o=n.interpolationPrefix?H.regexEscape(n.interpolationPrefix):I.interpolationPrefixEscaped,r=n.interpolationSuffix?H.regexEscape(n.interpolationSuffix):I.interpolationSuffixEscaped,a="HTML"+r
return H.each(t,function(t,s){var l=i?i+I.keyseparator+t:t
"object"==typeof s&&null!==s?e=p(e,s,l,n):n.escapeInterpolation||I.escapeInterpolation?(e=e.replace(new RegExp([o,l,a].join(""),"g"),s),e=e.replace(new RegExp([o,l,r].join(""),"g"),H.escape(s))):e=e.replace(new RegExp([o,l,r].join(""),"g"),s)}),e}function f(e,t){var i=",",n="{",o="}",r=H.extend({},t)
for(delete r.postProcess;-1!=e.indexOf(I.reusePrefix)&&(M++,!(M>I.maxRecursion));){var a=e.lastIndexOf(I.reusePrefix),s=e.indexOf(I.reuseSuffix,a)+I.reuseSuffix.length,l=e.substring(a,s),c=l.replace(I.reusePrefix,"").replace(I.reuseSuffix,"")
if(-1!=c.indexOf(i)){var u=c.indexOf(i)
if(-1!=c.indexOf(n,u)&&-1!=c.indexOf(o,u)){var d=c.indexOf(n,u),h=c.indexOf(o,d)+o.length
try{r=H.extend(r,JSON.parse(c.substring(d,h))),c=c.substring(0,u)}catch(p){}}}var f=T(c,r)
e=e.replace(l,f)}return e}function m(e){return e.context&&("string"==typeof e.context||"number"==typeof e.context)}function v(e){return void 0!==e.count&&"string"!=typeof e.count&&1!==e.count}function g(e,t){t=t||{}
var i=y(e,t),n=b(e,t)
return void 0!==n||n===i}function E(e,t){if(t=t||{},!L){H.log("i18next not finished initialization. you might have called t function before loading resources finished.")
var i=e.indexOf(":")
0>i?i=0:i++
var n=t.defaultValue||e.substr(i)
return n&&(n=p(n,t)),n}return M=0,T.apply(null,arguments)}function y(e,t){return void 0!==t.defaultValue?t.defaultValue:e}function A(){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t])
return{postProcess:"sprintf",sprintf:e}}function T(e,t){if(t&&"object"!=typeof t?"sprintf"===I.shortcutFunction?t=A.apply(null,arguments):"defaultValue"===I.shortcutFunction&&(t={defaultValue:t}):t=t||{},void 0===e||null===e)return""
"string"==typeof e&&(e=[e])
var i=e[0]
if(e.length>1)for(var n=0;n<e.length&&(i=e[n],!g(i,t));n++);var o,r=y(i,t),a=b(i,t),s=t.lng?H.toLanguages(t.lng):P,l=t.ns||I.ns.defaultNs
i.indexOf(I.nsseparator)>-1&&(o=i.split(I.nsseparator),l=o[0],i=o[1]),void 0===a&&I.sendMissing&&(t.lng?O.postMissing(s[0],l,i,r,s):O.postMissing(I.lng,l,i,r,s))
var c=t.postProcess||I.postProcess
void 0!==a&&c&&F[c]&&(a=F[c](a,i,t))
var u=r
if(r.indexOf(I.nsseparator)>-1&&(o=r.split(I.nsseparator),u=o[1]),u===i&&I.parseMissingKey&&(r=I.parseMissingKey(r)),void 0===a&&(r=p(r,t),r=f(r,t),c&&F[c])){var d=y(i,t)
a=F[c](d,i,t)}return void 0!==a?a:r}function b(e,t){t=t||{}
var i,n,o=y(e,t),r=P
if(!R)return o
if("cimode"===r[0].toLowerCase())return o
if(t.lng&&(r=H.toLanguages(t.lng),!R[r[0]])){var a=I.getAsync
I.getAsync=!1,Autodesk.Viewing.i18n.sync.load(r,I,function(e,t){H.extend(R,t),I.getAsync=a})}var s=t.ns||I.ns.defaultNs
if(e.indexOf(I.nsseparator)>-1){var l=e.split(I.nsseparator)
s=l[0],e=l[1]}if(m(t)){i=H.extend({},t),delete i.context,i.defaultValue=I.contextNotFound
var c=s+I.nsseparator+e+"_"+t.context
if(n=E(c,i),n!=I.contextNotFound)return p(n,{context:t.context})}if(v(t)){i=H.extend({},t),delete i.count,i.defaultValue=I.pluralNotFound
var u=s+I.nsseparator+e+I.pluralSuffix,d=B.get(r[0],t.count)
if(d>=0?u=u+"_"+d:1===d&&(u=s+I.nsseparator+e),n=E(u,i),n!=I.pluralNotFound)return p(n,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix})}for(var h,g=e.split(I.keyseparator),A=0,w=r.length;w>A&&void 0===h;A++){for(var _=r[A],x=0,C=R[_]&&R[_][s];g[x];)C=C&&C[g[x]],x++
if(void 0!==C){var S=Object.prototype.toString.apply(C)
if("string"==typeof C)C=p(C,t),C=f(C,t)
else if("[object Array]"!==S||I.returnObjectTrees||t.returnObjectTrees){if(null===C&&I.fallbackOnNull===!0)C=void 0
else if(null!==C)if(I.returnObjectTrees||t.returnObjectTrees){if("[object Number]"!==S&&"[object Function]"!==S&&"[object RegExp]"!==S){var M="[object Array]"===S?[]:{}
H.each(C,function(i){M[i]=T(s+I.nsseparator+e+I.keyseparator+i,t)}),C=M}}else I.objectTreeKeyHandler&&"function"==typeof I.objectTreeKeyHandler?C=I.objectTreeKeyHandler(e,C,_,s,t):(C="key '"+s+":"+e+" ("+_+")' returned an object instead of string.",H.log(C))}else C=C.join("\n"),C=p(C,t),C=f(C,t)
"string"==typeof C&&""===C.trim()&&I.fallbackOnEmpty===!0&&(C=void 0),h=C}}if(void 0===h&&!t.isFallbackLookup&&(I.fallbackToDefaultNS===!0||I.fallbackNS&&I.fallbackNS.length>0))if(t.isFallbackLookup=!0,I.fallbackNS.length){for(var L=0,k=I.fallbackNS.length;k>L;L++)if(h=b(I.fallbackNS[L]+I.nsseparator+e,t)){var V=h.indexOf(I.nsseparator)>-1?h.split(I.nsseparator)[1]:h,N=o.indexOf(I.nsseparator)>-1?o.split(I.nsseparator)[1]:o
if(V!==N)break}}else h=b(e,t)
return h}function w(){var e,t=[]
if("undefined"!=typeof window&&(!function(){for(var e=window.location.search.substring(1),i=e.split("&"),n=0;n<i.length;n++){var o=i[n].indexOf("=")
if(o>0){var r=i[n].substring(0,o),a=i[n].substring(o+1)
t[r]=a}}}(),t[I.detectLngQS]&&(e=t[I.detectLngQS])),!e&&"undefined"!=typeof document&&I.useCookie){var i=H.cookie.read(I.cookieName)
i&&(e=i)}return e||"undefined"==typeof navigator||(e=navigator.language?navigator.language:navigator.userLanguage),e}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict"
if(null==this)throw new TypeError
var t=Object(this),i=t.length>>>0
if(0===i)return-1
var n=0
if(arguments.length>0&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&n!=1/0&&n!=-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=i)return-1
for(var o=n>=0?n:Math.max(i-Math.abs(n),0);i>o;o++)if(o in t&&t[o]===e)return o
return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){"use strict"
if(null==this)throw new TypeError
var t=Object(this),i=t.length>>>0
if(0===i)return-1
var n=i
arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:0!=n&&n!=1/0&&n!=-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))))
for(var o=n>=0?Math.min(n,i-1):i-Math.abs(n);o>=0;o--)if(o in t&&t[o]===e)return o
return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})
var _,x=this,C=x.jQuery||x.Zepto,S={},R={},M=0,P=[],L=!1
"undefined"!=typeof module&&module.exports?module.exports=S:(C&&(C.i18n=C.i18n||S),x.i18n=x.i18n||S)
var I={lng:void 0,load:"current",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},V=function(e){for(var t,i,n=!1,o=!1,r="",a=0;a<e.length;a++)if(t=e[a],i=e[a+1],o||"\\"===e[a-1]||'"'!==t||(n=!n),n)r+=t
else{if(o||t+i!=="//")if("single"===o&&t+i==="\r\n")o=!1,a++
else if("single"===o&&"\n"===t)o=!1
else{if(!o&&t+i==="/*"){o="multi",a++
continue}if("multi"===o&&t+i==="*/"){o=!1,a++
continue}}else o="single",a++
o||(r+=t)}return r},N={create:function(e,t,i,n){var o
if(i){var r=new Date
r.setTime(r.getTime()+60*i*1e3),o="; expires="+r.toGMTString()}else o=""
n=n?"domain="+n+";":"",document.cookie=e+"="+t+o+";"+n+"path=/"},read:function(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "==o.charAt(0);)o=o.substring(1,o.length)
if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},remove:function(e){this.create(e,"",-1)}},D={create:function(e,t,i,n){},read:function(e){return null},remove:function(e){}},H={extend:C?C.extend:e,each:C?C.each:t,ajax:C?C.ajax:"undefined"!=typeof document?n:function(){},cookie:"undefined"!=typeof document?N:D,detectLanguage:w,escape:i,log:function(e){I.debug&&"undefined"!=typeof console&&console.log(e)},toLanguages:function(e){var t=[]
if("string"==typeof e&&e.indexOf("-")>-1){var i=e.split("-")
e=I.lowerCaseLng?i[0].toLowerCase()+"-"+i[1].toLowerCase():i[0].toLowerCase()+"-"+i[1].toUpperCase(),"unspecific"!==I.load&&t.push(e),"current"!==I.load&&t.push(i[0])}else t.push(e)
for(var n=0;n<I.fallbackLng.length;n++)-1===t.indexOf(I.fallbackLng[n])&&I.fallbackLng[n]&&t.push(I.fallbackLng[n])
return t},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}
H.applyReplacement=p
var O={load:function(e,t,i){t.useLocalStorage?O._loadLocal(e,t,function(n,o){for(var r=[],a=0,s=e.length;s>a;a++)o[e[a]]||r.push(e[a])
r.length>0?O._fetch(r,t,function(e,t){H.extend(o,t),O._storeLocal(t),i(null,o)}):i(null,o)}):O._fetch(e,t,function(e,t){i(null,t)})},_loadLocal:function(e,t,i){var n={},o=(new Date).getTime()
if(window.localStorage){var r=e.length
H.each(e,function(e,a){var s=window.localStorage.getItem("res_"+a)
s&&(s=JSON.parse(s),s.i18nStamp&&s.i18nStamp+t.localStorageExpirationTime>o&&(n[a]=s)),r--,0===r&&i(null,n)})}},_storeLocal:function(e){if(window.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),window.localStorage.setItem("res_"+t,JSON.stringify(e[t]))},_fetch:function(e,t,i){var n=t.ns,o={}
if(t.dynamicLoad){var r=function(e,t){i(null,t)}
if("function"==typeof t.customLoad)t.customLoad(e,n.namespaces,t,r)
else{var a=p(t.resGetPath,{lng:e.join("+"),ns:n.namespaces.join("+")})
a=Autodesk.Viewing.Private.getResourceUrl(a),H.ajax({url:a,success:function(e,t,i){H.log("loaded: "+a),r(null,e.json())},error:function(e,t,i){H.log("failed loading: "+a),r("failed loading resource.json error: "+i)},dataType:"text",async:t.getAsync})}}else{var s,l=n.namespaces.length*e.length
H.each(n.namespaces,function(n,r){H.each(e,function(e,n){var a=function(e,t){e&&(s=s||[],s.push(e)),o[n]=o[n]||{},o[n][r]=t,l--,0===l&&i(s,o)}
"function"==typeof t.customLoad?t.customLoad(n,r,t,a):O._fetchOne(n,r,t,a)})})}},_fetchOne:function(e,t,i,n){var o=p(i.resGetPath,{lng:e,ns:t})
o=Autodesk.Viewing.Private.getResourceUrl(o),H.ajax({url:o,success:function(e,t,i){H.log("loaded: "+o)
var r=V(e)
n(null,JSON.parse(r))},error:function(e,t,i){if(t&&200==t||e&&e.status&&200==e.status)H.log("There is a typo in: "+o)
else if(t&&404==t||e&&e.status&&404==e.status)H.log("Does not exist: "+o)
else{var r=t?t:e&&e.status?e.status:null
H.log(r+" when loading "+o)}n(i,{})},dataType:"text",async:i.getAsync})},postMissing:function(e,t,i,n,o){var r={}
r[i]=n
var a=[]
if("fallback"===I.sendMissingTo&&I.fallbackLng[0]!==!1)for(var s=0;s<I.fallbackLng.length;s++)a.push({lng:I.fallbackLng[s],url:p(I.resPostPath,{lng:I.fallbackLng[s],ns:t})})
else if("current"===I.sendMissingTo||"fallback"===I.sendMissingTo&&I.fallbackLng[0]===!1)a.push({lng:e,url:p(I.resPostPath,{lng:e,ns:t})})
else if("all"===I.sendMissingTo)for(var s=0,l=o.length;l>s;s++)a.push({lng:o[s],url:p(I.resPostPath,{lng:o[s],ns:t})})
for(var c=0,u=a.length;u>c;c++){var d=a[c]
H.ajax({url:d.url,type:I.sendType,data:r,success:function(e,o,r){H.log("posted missing key '"+i+"' to: "+d.url)
for(var a=i.split("."),s=0,l=R[d.lng][t];a[s];)l=s===a.length-1?l[a[s]]=n:l[a[s]]=l[a[s]]||{},s++},error:function(e,t,n){H.log("failed posting missing key '"+i+"' to: "+d.url)},dataType:"json",async:I.postAsync})}}},B={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(e){return Number(e>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ak:{name:"Akan",numbers:[1,2],plurals:function(e){return Number(e>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(e){return Number(e>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ay:{name:"Aymará",numbers:[1],plurals:function(e){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(e){return Number(1!=e)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bo:{name:"Tibetan",numbers:[1],plurals:function(e){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(e){return Number(e>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},cgg:{name:"Chiga",numbers:[1],plurals:function(e){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},de:{name:"German",numbers:[1,2],plurals:function(e){return Number(1!=e)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(e){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(e){return Number(1!=e)}},en:{name:"English",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es:{name:"Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},et:{name:"Estonian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eu:{name:"Basque",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fa:{name:"Persian",numbers:[1],plurals:function(e){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(e){return Number(e>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fr:{name:"French",numbers:[1,2],plurals:function(e){return Number(e>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(e){return Number(1==e?0:2==e?1:7>e?2:11>e?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gun:{name:"Gun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(e){return Number(1!=e)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(e){return Number(1!=e)}},id:{name:"Indonesian",numbers:[1],plurals:function(e){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(e){return Number(e%10!=1||e%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ja:{name:"Japanese",numbers:[1],plurals:function(e){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(e){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(e){return Number(0!==e)}},ka:{name:"Georgian",numbers:[1],plurals:function(e){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(e){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(e){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ko:{name:"Korean",numbers:[1],plurals:function(e){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(e){return Number(1==e?0:2==e?1:3==e?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(e){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(e){return Number(e>1)}},lo:{name:"Lao",numbers:[1],plurals:function(e){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(10>e%100||e%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(e){return Number(e>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(e){return Number(e>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(e){return Number(e>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(e){return Number(1==e||e%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(e){return Number(1==e?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ms:{name:"Malay",numbers:[1],plurals:function(e){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(e){return Number(1==e?0:0===e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(e){return Number(1!=e)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(e){return Number(1!=e)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(e){return Number(e>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(e){return Number(1!=e)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(e){return Number(1==e?0:0===e||e%100>0&&20>e%100?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(e){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(e){return Number(1!=e)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(e){return Number(1!=e)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},son:{name:"Songhay",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(e){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(e){return Number(1!=e)}},te:{name:"Telugu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(e){return Number(e>1)}},th:{name:"Thai",numbers:[1],plurals:function(e){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(e){return Number(e>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(e){return Number(e>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(e){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(e){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(e){return Number(e>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(e){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(e){return Number(e>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(e){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(e){return Number(1!=e)}},zh:{name:"Chinese",numbers:[1],plurals:function(e){return 0}}},addRule:function(e,t){B.rules[e]=t},setCurrentLng:function(e){if(!B.currentRule||B.currentRule.lng!==e){var t=e.split("-")
B.currentRule={lng:e,rule:B.rules[t[0]]}}},get:function(e,t){function i(t,i){var n
if(n=B.currentRule&&B.currentRule.lng===e?B.currentRule.rule:B.rules[t]){var o=n.plurals(i),r=n.numbers[o]
return 2===n.numbers.length&&1===n.numbers[0]&&(2===r?r=-1:1===r&&(r=1)),r}return 1===i?"1":"-1"}var n=e.split("-")
return i(n[0],t)}},F={},U=function(e,t){F[e]=t},z=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var i=[];t>0;i[--t]=e);return i.join("")}var i=function(){return i.cache.hasOwnProperty(arguments[0])||(i.cache[arguments[0]]=i.parse(arguments[0])),i.format.call(null,i.cache[arguments[0]],arguments)}
return i.format=function(i,n){var o,r,a,s,l,c,u,d=1,h=i.length,p="",f=[]
for(r=0;h>r;r++)if(p=e(i[r]),"string"===p)f.push(i[r])
else if("array"===p){if(s=i[r],s[2])for(o=n[d],a=0;a<s[2].length;a++){if(!o.hasOwnProperty(s[2][a]))throw z('[sprintf] property "%s" does not exist',s[2][a])
o=o[s[2][a]]}else o=s[1]?n[s[1]]:n[d++]
if(/[^s]/.test(s[8])&&"number"!=e(o))throw z("[sprintf] expecting number but found %s",e(o))
switch(s[8]){case"b":o=o.toString(2)
break
case"c":o=String.fromCharCode(o)
break
case"d":o=parseInt(o,10)
break
case"e":o=s[7]?o.toExponential(s[7]):o.toExponential()
break
case"f":o=s[7]?parseFloat(o).toFixed(s[7]):parseFloat(o)
break
case"o":o=o.toString(8)
break
case"s":o=(o=String(o))&&s[7]?o.substring(0,s[7]):o
break
case"u":o=Math.abs(o)
break
case"x":o=o.toString(16)
break
case"X":o=o.toString(16).toUpperCase()}o=/[def]/.test(s[8])&&s[3]&&o>=0?"+"+o:o,c=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",u=s[6]-String(o).length,l=s[6]?t(c,u):"",f.push(s[5]?o+l:l+o)}return f.join("")},i.cache={},i.parse=function(e){for(var t=e,i=[],n=[],o=0;t;){if(null!==(i=/^[^\x25]+/.exec(t)))n.push(i[0])
else if(null!==(i=/^\x25{2}/.exec(t)))n.push("%")
else{if(null===(i=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?"
if(i[2]){o|=1
var r=[],a=i[2],s=[]
if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw"[sprintf] huh?"
for(r.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))r.push(s[1])
else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw"[sprintf] huh?"
r.push(s[1])}i[2]=r}else o|=2
if(3===o)throw"[sprintf] mixing positional and named placeholders is not (yet) supported"
n.push(i)}t=t.substring(i[0].length)}return n},i}(),G=function(e,t){return t.unshift(e),z.apply(null,t)}
U("sprintf",function(e,t,i){return i.sprintf?"[object Array]"===Object.prototype.toString.apply(i.sprintf)?G(e,i.sprintf):"object"==typeof i.sprintf?z(e,i.sprintf):e:e})
var W=function(){function e(e){var t,i,n=e.split(/\[|\]/)
return 1===n.length?(t=null,i=n[0]):3===n.length&&(t=n[1],i=n[2]),[t,i]}Array.prototype.forEach.call(document.querySelectorAll("[data-i18n]"),function(t){var i=t.getAttribute("data-i18n"),n=e(i),o=n[0],r=n[1],a=Autodesk.Viewing.i18n.translate(r)
a?o?t.setAttribute(o,a):t.textContent=a:o?t.setAttribute(o,r):t.textContent=r})}
Autodesk.Viewing.i18n.init=o,Autodesk.Viewing.i18n.setLng=d,Autodesk.Viewing.i18n.preload=r,Autodesk.Viewing.i18n.addResourceBundle=a,Autodesk.Viewing.i18n.removeResourceBundle=s,Autodesk.Viewing.i18n.loadNamespace=c,Autodesk.Viewing.i18n.loadNamespaces=u,Autodesk.Viewing.i18n.localize=W,Autodesk.Viewing.i18n.setDefaultNamespace=l,Autodesk.Viewing.i18n.t=E,Autodesk.Viewing.i18n.translate=E,Autodesk.Viewing.i18n.exists=g,Autodesk.Viewing.i18n.detectLanguage=H.detectLanguage,Autodesk.Viewing.i18n.pluralExtensions=B,Autodesk.Viewing.i18n.sync=O,Autodesk.Viewing.i18n.functions=H,Autodesk.Viewing.i18n.lng=h,Autodesk.Viewing.i18n.addPostProcessor=U,Autodesk.Viewing.i18n.options=I}(),function(){"use strict"
var e=(Autodesk.Viewing.UI,function(e,t,i,n){this.kMinWdth=100,this.kMinHeight=100,this.visibilityCallbacks=[],this.movedSinceLastClick=!1,this.parentContainer=e,this.container=document.createElement("div"),this.container.id=t,this.container.lastWidth="",this.container.dockRight=!1,this.container.dockBottom=!1,this.titleLabel=i,n=n||{},n.hasOwnProperty("localizeTitle")||(n.localizeTitle=!0),this.options=n,this.container.classList.add("dockingPanel"),e.appendChild(this.container),this.listeners=[],this.initialize(),this.setVisible(!1)})
e.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id),this.container.appendChild(this.title),this.initializeMoveHandlers(this.title),this.setTitle(this.titleLabel||this.container.id,this.options),this.closer=this.createCloseButton(),this.container.appendChild(this.closer)},e.prototype.uninitialize=function(){for(var e=0;e<this.listeners.length;++e){var t=this.listeners[e]
t.target.removeEventListener(t.eventId,t.callback)}this.listeners=[],this.visibilityCallbacks=[],this.parentContainer.removeChild(this.container),this.parentContainer=null,this.container=null,this.title=null,this.closer=null},e.prototype.addVisibilityListener=function(e){this.visibilityCallbacks.push(e)},e.prototype.setVisible=function(e){if(e){var t=this.getContainerBoundingRect()
if(this.container.dockRight){var i=t.width,n=300,o=this.container.lastWidth||this.container.style.width
o||(o=this.container.getBoundingClientRect().width),o&&(n=parseInt(o)),this.container.style.left=i-n+"px"}if(this.container.dockBottom){var r=t.height,a=300,s=this.container.lastHeight||this.container.style.height
s||(s=this.container.getBoundingClientRect().height),s&&(a=parseInt(s)),this.container.style.top=r-a+"px"}this.container.style.maxHeight=t.height+"px",this.container.style.maxWidth=t.width+"px",this.container.style.display="block"}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none"
for(var l=0;l<this.visibilityCallbacks.length;l++)this.visibilityCallbacks[l](e)},e.prototype.isVisible=function(){return"block"===this.container.style.display},e.prototype.visibilityChanged=function(){},e.prototype.initializeMoveHandlers=function(e){function t(e){var t=h.style.minWidth?parseInt(h.style.minWidth):p.kMinWdth,i=h.style.minHeight?parseInt(h.style.minHeight):p.kMinHeight,n=p.getContainerBoundingRect()
h.style.maxWidth&&parseInt(h.style.width)>parseInt(h.style.maxWidth)&&(h.style.width=h.style.maxWidth),h.style.maxHeight&&parseInt(h.style.height)>parseInt(h.style.maxHeight)&&(h.style.height=h.style.maxHeight),parseInt(h.style.width)<t&&(h.style.width=t+"px"),parseInt(h.style.height)<i&&(h.style.height=i+"px"),"touchmove"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),u+=e.screenX-a,d+=e.screenY-s,o=l+u,r=c+d
var f=parseInt(h.style.width),m=parseInt(h.style.height)
isNaN(f)&&(f=p.container.getBoundingClientRect().width),isNaN(m)&&(m=p.container.getBoundingClientRect().height),5>o&&(o=0),5>r&&(r=0),h.dockRight=!1,h.dockBottom=!1,n.width-5<o+f&&(o=n.width-f,h.dockRight=!0),n.height-5<r+m&&(r=n.height-m,h.dockBottom=!0),h.style.left=o+"px",h.style.top=r+"px",h.style.maxWidth=n.width-o+"px",h.style.maxHeight=n.height-r+"px",a=e.screenX,s=e.screenY,p.onMove(e,o,r)}function i(e){window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",i),window.removeEventListener("touchmove",t),window.removeEventListener("touchend",i),p.onEndMove(e,o,r)}function n(e){"touchstart"===e.type&&(e.screenX=e.touches[0].screenX,e.screenY=e.touches[0].screenY),a=e.screenX,s=e.screenY,u=0,d=0,l=p.container.offsetLeft,c=p.container.offsetTop,window.addEventListener("mousemove",t,!1),window.addEventListener("mouseup",i,!1),window.addEventListener("touchmove",t,!1),window.addEventListener("touchend",i,!1),p.onStartMove(e,l,c)}var o,r,a,s,l,c,u,d,h=this.container,p=this
p.addEventListener(e,"mousedown",n),p.addEventListener(e,"touchstart",n)},e.prototype.initializeCloseHandler=function(e){var t=this
t.addEventListener(e,"click",function(e){t.setVisible(!1)},!1)},e.prototype.createScrollContainer=function(e){var t=document.createElement("div"),i=t.classList
return i.add("dockingPanelScroll"),i.add(e&&e.left?"left":"right"),e&&e.heightAdjustment&&(t.style.height="calc(100% - "+e.heightAdjustment+"px)"),e.marginTop&&(t.style.marginTop=e.marginTop+"px"),t.id=this.container.id+"-scroll-container",this.container.appendChild(t),this.scrollContainer=t,t},e.prototype.createTitleBar=function(e){var t=document.createElement("div")
t.className="dockingPanelTitle",t.textContent=e
var i=this
return i.addEventListener(t,"click",function(e){i.movedSinceLastClick||i.onTitleClick(e),i.movedSinceLastClick=!1}),i.addEventListener(t,"dblclick",function(e){i.onTitleDoubleClick(e)}),t},e.prototype.setTitle=function(e,t){t&&t.localizeTitle?(this.title.setAttribute("data-i18n",e),e=Autodesk.Viewing.i18n.translate(e)):this.title.removeAttribute("data-i18n"),this.title.textContent=e},e.prototype.createCloseButton=function(){var e=document.createElement("div")
return e.className="dockingPanelClose",e.innerHTML="&times;",this.initializeCloseHandler(e),e},e.prototype.onStartMove=function(e,t,i){},e.prototype.onEndMove=function(e,t,i){},e.prototype.onMove=function(e,t,i){this.movedSinceLastClick=!0},e.prototype.onTitleClick=function(e){},e.prototype.onTitleDoubleClick=function(e){},e.prototype.addEventListener=function(e,t,i){e.addEventListener(t,i),this.listeners.push({target:e,eventId:t,callback:i})},e.prototype.removeEventListener=function(e,t,i){for(var n=0;n<this.listeners.length;++n){var o=this.listeners[n]
if(o.target===e&&o.eventId===t&&o.callback===i)return e.removeEventListener(t,i),this.listeners.splice(n,1),!0}return!1},e.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}},e.prototype.resizeToContent=function(e){if(this.isVisible()){var t=this.getContentSize(),i=t.height,n=this.container.getBoundingClientRect(),o=this.getContainerBoundingRect(),r=75,a=e&&e.maxHeight?e.maxHeight-n.top:o.height-n.top
a-=r,i>a&&(i=a),this.container.style.height=i.toString()+"px"}},e.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()},Autodesk.Viewing.UI.DockingPanel=e}(),function(){"use strict"
var e=Autodesk.Viewing.UI,t=function(t,i,n,o){e.DockingPanel.call(this,t,i,n,o),this.container.classList.add("modelStructurePanel"),o=o||{},o.heightAdjustment||(o.heightAdjustment=40),o.marginTop||(o.marginTop=0),o.left=!0,this.createScrollContainer(o),this.options=o,this.instanceTree=null,this.tree=null,this.selectedNodes=[],this.uiCreated=!1
var r=this
this.addVisibilityListener(function(e){e&&(r.uiCreated||r.createUI(),r.resizeToContent())})}
t.prototype=Object.create(e.DockingPanel.prototype),t.prototype.constructor=t,t.prototype.setModel=function(e,t){this.instanceTree=e,this.modelTitle=t,this.isVisible()?this.createUI():this.uiCreated=!1},t.prototype.createUI=function(){var t=this,i=t.instanceTree
if(i){var n=function(){var i=new e.TreeDelegate
return i.getTreeNodeId=function(e){return"object"==typeof e?(stderr("Object used instead of dbId. Fix it."),e.dbId):e},i.getTreeNodeLabel=function(e){var i=this.getTreeNodeId(e),n=t.instanceTree.getNodeName(i)
return n||"Object "+i},i.getTreeNodeClass=function(e){return t.getNodeClass(e)},i.isTreeNodeGroup=function(e){return t.isGroupNode(e)},i.shouldCreateTreeNode=function(e){return t.shouldInclude(e)},i.onTreeNodeClick=function(e,i,n){t.onClick(i,n)},i.onTreeNodeRightClick=function(e,i,n){t.onRightClick(i,n)},i.onTreeNodeDoubleClick=function(e,i,n){t.onDoubleClick(i,n)},i.onTreeNodeIconClick=function(e,i,n){t.onIconClick(i,n)},i.forEachChild=function(e,i){var n=this.getTreeNodeId(e)
t.instanceTree.enumNodeChildren(n,i)},i}
t.selectedNodes=[]
var o=t.modelTitle
o||t.options&&t.options.defaultTitle&&(o=t.options.defaultTitle)
var r={}
if(o||(o="Browser",r.localizeTitle=!0),t.setTitle(o,r),t.tree){for(;t.scrollContainer.hasChildNodes();)t.scrollContainer.removeChild(t.scrollContainer.lastChild)
t.title.removeEventListener("click",t.onTitleClick),t.title.removeEventListener("dblclick",t.onTitleDoubleClick)}var a,s=this.rootId=i.getRootId(),l=i.getNodeName(s),c=0,u=0
i.enumNodeChildren(s,function(e){u||(a=i.getNodeName(e),c=e),u++})
var d=n()
this.myDelegate=d
var h=1===u&&l===a,p={excludeRoot:h,localize:!0}
t.tree=new e.Tree(d,s,t.scrollContainer,p),t.options&&t.options.hasOwnProperty("startCollapsed")&&!t.options.startCollapsed||(t.tree.setAllCollapsed(!0),t.tree.setCollapsed(s,!1),h&&t.tree.setCollapsed(c,!1)),this.uiCreated=!0}},t.prototype.getNodeLabel=function(e){return this.myDelegate.getNodeLabel(e)},t.prototype.getNodeClass=function(e){return""},t.prototype.isGroupNode=function(e){var t=this.myDelegate.getTreeNodeId(e)
return this.instanceTree.getChildCount(t)},t.prototype.shouldInclude=function(e){return!0},t.prototype.onClick=function(e,t){this.setSelection([e])},t.prototype.onDoubleClick=function(e,t){},t.prototype.onIconClick=function(e,t){this.setGroupCollapsed(e,!this.isGroupCollapsed(e))},t.prototype.setGroupCollapsed=function(e,t){var i=this.tree.delegate()
i.isTreeNodeGroup(e)&&(this.tree.setCollapsed(e,t),this.resizeToContent())},t.prototype.isGroupCollapsed=function(e){var t=this.tree.delegate()
return t.isTreeNodeGroup(e)?this.tree.isCollapsed(e):!1},t.prototype.onRightClick=function(e,t){},t.prototype.onTitleClick=function(e){},t.prototype.onTitleDoubleClick=function(e){},t.prototype.setSelection=function(e){if(this.tree){var t,i
for(t=0;t<this.selectedNodes.length;++t)for(i=this.instanceTree.getNodeParentId(this.selectedNodes[t]);i;)this.tree.removeClass(i,"ancestor-selected"),i=this.instanceTree.getNodeParentId(i)
var n=[]
for(t=0;t<e.length;++t)for(n.push(e[t]),i=this.instanceTree.getNodeParentId(e[t]);i;)this.tree.addClass(i,"ancestor-selected"),i=this.instanceTree.getNodeParentId(i)
this.selectedNodes=e,this.tree.setSelection(n)}},t.prototype.getContentSize=function(){var e=this.tree
if(e){var t=e.getRootContainer()
if(t)return{height:t.clientHeight+this.options.heightAdjustment+35,width:t.clientWidth}}return{height:0,width:0}},t.prototype.addClass=function(e,t){return null!==this.tree&&this.tree.addClass(e,t)},t.prototype.removeClass=function(e,t){return null!==this.tree&&this.tree.removeClass(e,t)},Autodesk.Viewing.UI.ModelStructurePanel=t}(),function(){"use strict"
var e=Autodesk.Viewing.UI,t=function(t,i,n,o){function r(){function t(e){return"category"===e.type}var i=new e.TreeDelegate
return i.getTreeNodeId=function(e){return e.name+(e.hasOwnProperty("value")?e.value:"")+(e.hasOwnProperty("category")?e.category:"")},i.getTreeNodeClass=function(e){return t(e)?a.getCategoryClass(e):a.getPropertyClass(e)},i.isTreeNodeGroup=function(e){return t(e)},i.onTreeNodeClick=function(e,i,n){t(i)?a.onCategoryClick(i,n):a.onPropertyClick(i,n)},i.onTreeNodeRightClick=function(e,i,n){t(i)?a.onCategoryRightClick(i,n):a.onPropertyRightClick(i,n)},i.onTreeNodeDoubleClick=function(e,i,n){t(i)?a.onCategoryDoubleClick(i,n):a.onPropertyDoubleClick(i,n)},i.onTreeNodeIconClick=function(e,i,n){t(i)?a.onCategoryIconClick(i,n):a.onPropertyIconClick(i,n)},i.createTreeNode=function(e,i,n){var o=null
o=t(e)?a.displayCategory(e,i,n):a.displayProperty(e,i,n),o&&(a.highlightableElements[this.getTreeNodeId(e)]=o)},i}e.DockingPanel.call(this,t,i,n,o),this.container.classList.add("propertyPanel"),this.container.dockRight=!0,this.createScrollContainer({left:!1,heightAdjustment:45,marginTop:0}),this.highlightableElements={}
var a=this,s=r()
this.tree=new e.Tree(s,null,this.scrollContainer,{})}
t.prototype=Object.create(e.DockingPanel.prototype),t.prototype.constructor=t,t.prototype.setProperties=function(e,t){this.removeAllProperties()
for(var i=[],n=[],o=0;o<e.length;o++){var r=e[o]
if(!r.hidden){var a=e[o].displayCategory
a&&"string"==typeof a&&""!==a?i.push(r):n.push(r)}}if(i.length+n.length===0)return void this.showNoProperties()
for(var o=0;o<i.length;o++){var r=i[o],s=Autodesk.Viewing.Private.formatValueWithUnits(r.displayValue,r.units,r.type)
this.addProperty(r.displayName,s,r.displayCategory)}for(var l=i.length>0,o=0;o<n.length;o++){var r=n[o],s=Autodesk.Viewing.Private.formatValueWithUnits(r.displayValue,r.units,r.type)
this.addProperty(r.displayName,s,l?"Other":"",l?{localizeCategory:!0}:{})}},t.prototype.showNoProperties=function(){this.removeAllProperties()
var e=this.tree.myRootContainer,t=document.createElement("div")
t.className="noProperties"
var i="No properties to display"
t.setAttribute("data-i18n",i),t.textContent=Autodesk.Viewing.i18n.translate(i),e.appendChild(t)},t.prototype.showDefaultProperties=function(){this.showNoProperties(),this.resizeToContent()},t.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()},t.prototype.addProperty=function(e,t,i,n){var o=this.tree.getElementForNode({name:e,value:t,category:i})
if(o)return!1
var r=null,a={name:e,value:t,type:"property"}
return i?(r=this.tree.getElementForNode({name:i}),r||(r=this.tree.createElement_({name:i,type:"category"},this.tree.myRootContainer,n&&n.localizeCategory?{localize:!0}:null)),a.category=i):r=this.tree.myRootContainer,this.tree.createElement_(a,r,n&&n.localizeProperty?{localize:!0}:null),!0},t.prototype.hasProperties=function(){for(var e in this.highlightableElements)return!0
return!1},t.prototype.removeProperty=function(e,t,i,n){var o={name:e,value:t,category:i},r=this.tree.getElementForNode(o)
return r?(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(o)],r.parentNode.removeChild(r),!0):!1},t.prototype.removeAllProperties=function(){this.highlightableElements={},this.tree.clear()},t.prototype.setCategoryCollapsed=function(e,t){var i=this.tree.delegate().getTreeNodeId(e)
this.tree.setCollapsed(i,t)},t.prototype.isCategoryCollapsed=function(e){var t=this.tree.delegate().getTreeNodeId(e)
return this.tree.isCollapsed(t)},t.prototype.getContentSize=function(){var e=this.tree.myRootContainer
return{height:e.clientHeight+55,width:e.clientWidth}},t.prototype.highlight=function(e,t){function i(t){var i=t.innerHTML,n=i.replace(/(<highlight>|<\/highlight>)/gim,"")
if(i!==n&&(t.innerHTML=n),e&&""!==e){var o=new RegExp("(\\b"+e+"\\b)","gim"),r=n.replace(o,"<highlight>$1</highlight>")
t.innerHTML=r}}for(var n in this.highlightableElements)for(var o=this.highlightableElements[n],r=0;r<o.length;++r)i(o[r])},t.prototype.displayCategory=function(e,t,i){var n=document.createElement("div"),o=e.name
return i&&i.localize&&(n.setAttribute("data-i18n",o),o=Autodesk.Viewing.i18n.translate(o)),n.textContent=o,n.title=o,n.className="categoryName",t.appendChild(n),[n]},t.prototype.displayProperty=function(e,t,i){var n=document.createElement("div"),o=e.name
i&&i.localize&&(n.setAttribute("data-i18n",o),o=Autodesk.Viewing.i18n.translate(o)),n.textContent=o,n.title=o,n.className="propertyName"
var r=document.createElement("div")
r.className="separator"
var a=document.createElement("div")
return a.textContent=e.value,a.title=e.value,a.className="propertyValue",t.appendChild(n),t.appendChild(r),t.appendChild(a),[n,a]},t.prototype.getCategoryClass=function(e){return"category"},t.prototype.getPropertyClass=function(e){return"property"},t.prototype.onCategoryClick=function(e,t){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},t.prototype.onPropertyClick=function(e,t){},t.prototype.onCategoryIconClick=function(e,t){this.setCategoryCollapsed(e,!this.isCategoryCollapsed(e))},t.prototype.onPropertyIconClick=function(e,t){},t.prototype.onCategoryDoubleClick=function(e,t){},t.prototype.onPropertyDoubleClick=function(e,t){},t.prototype.onCategoryRightClick=function(e,t){},t.prototype.onPropertyRightClick=function(e,t){},Autodesk.Viewing.UI.PropertyPanel=t}(),function(){var e=function(e){this.viewer=e,this.menus=[],this.open=!1}
e.prototype.constructor=e,e.prototype.show=function(e,t){var i=this.viewer.container.getBoundingClientRect(),n=e.clientX-i.left,o=e.clientY-i.top
if(!this.open){var r=this
this.showMenu(t,n,o),this.open=!0,this.hideEventListener=function(e){"menuItem"!==e.target.className&&r.hide(e)},this.isTouch="press"===e.type,document.body.addEventListener(this.isTouch?"touchstart":"mousedown",this.hideEventListener,!0)}},e.prototype.showMenu=function(e,t,i){var n,o=document.createElement("div"),r=[]
o.className="menu",this.viewer.container.appendChild(o),this.menus.push(o)
for(var a=0;a<e.length;++a){var s=e[a],l=s.title,c=s.target
n=this.createMenuItem(o,l),"function"==typeof c?this.addCallbackToMenuItem(n,c):Array.isArray(c)?r.push({menuItem:n,target:c}):console.warn("Invalid context menu option:",l,c)}var u=o.getBoundingClientRect(),d=u.width,h=u.height,p=this.viewer.container.getBoundingClientRect(),f=p.width,m=p.height,v=isTouchDevice()&&!this.viewer.navigation.getUseLeftHandedInput()
for(v&&(t-=d),0>t&&(t=0),t+d>f&&(t=f-d,0>t&&(t=0)),0>i&&(i=0),i+h>m&&(i=m-h,0>i&&(i=0)),o.style.top=Math.round(i)+"px",o.style.left=Math.round(t)+"px",a=0;a<r.length;++a){var g=r[a]
n=g.menuItem,u=n.getBoundingClientRect(),t=Math.round((v?u.left:u.right)-p.left),i=Math.round(u.top-p.top),this.addSubmenuCallbackToMenuItem(n,g.target,t,i)}},e.prototype.createMenuItem=function(e,t){var i=document.createElement("div")
return i.className="menuItem",i.setAttribute("data-i18n",t),i.textContent=Autodesk.Viewing.i18n.translate(t),e.appendChild(i),i},e.prototype.addCallbackToMenuItem=function(e,t){var i=this
e.addEventListener("click",function(e){return i.hide(),t(),e.preventDefault(),!1},!1)},e.prototype.addSubmenuCallbackToMenuItem=function(e,t,i,n){var o=this
e.addEventListener("click",function(){o.showMenu(t,i,n)},!1)},e.prototype.hide=function(){if(this.open){for(var e=0;e<this.menus.length;++e)this.menus[e]&&this.menus[e].parentNode.removeChild(this.menus[e])
return this.menus=[],this.open=!1,document.body.removeEventListener(this.isTouch?"touchstart":"mousedown",this.hideEventListener),this.isTouch=!1,!0}return!1},Autodesk.Viewing.Private.ContextMenu=e}(),function(){"use strict"
var e=(Autodesk.Viewing.UI,Autodesk.Viewing.Private),t=function(t){this.viewer=t,this.contextMenu=new e.ContextMenu(t)}
t.prototype.constructor=t,t.prototype.show=function(e){var t=this.viewer.getSelectionCount(),i=this.viewer.getSelectionVisibility(),n={numSelected:t,hasSelected:t>0,hasVisible:i.hasVisible,hasHidden:i.hasHidden},o=this.buildMenu(e,n)
this.viewer.runContextMenuCallbacks(o,n),o&&0<o.length&&this.contextMenu.show(e,o)},t.prototype.hide=function(){return this.contextMenu.hide()},t.prototype.buildMenu=function(e,t){return null},Autodesk.Viewing.UI.ObjectContextMenu=t}(),Autodesk.Viewing.Private.Preferences=function(e,t){function i(){var e=t+"test",i=window.localStorage
try{return i.setItem(e,"1"),i.removeItem(e),!0}catch(n){return!1}}function n(e,i){return u?(e=t+e,"undefined"!=typeof i?localStorage[e]=i:i=localStorage[e],i):void 0}function o(e,t){if("string"!=typeof e||"function"==typeof d[e])return void stderr("Preferences: invalid name="+e)
var i=n(e)
if(ok=!1,void 0!==i)try{i=JSON.parse(i),ok=!0}catch(o){}d[e]=ok?i:t,s[e]={}}t||(t="Autodesk.Viewing.Preferences.")
var r={},a={},s={},l="PrefChanged",c="PrefReset",u=i(),d=this
e.addEventListener(l,function(e){var t=a[e.name]
if(t){var i=t.changed
i&&i(e.value)}}),e.addEventListener(c,function(e){for(var t in a)if(a.hasOwnProperty(t)){var i=a[t].reset
i&&i(d[t])}}),this.load=function(e){r=e
for(var t in r)r.hasOwnProperty(t)&&o(t,r[t])},this.tag=function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(r)
for(var i=0;i<t.length;++i)s[t[i]][e]=!0}},this.untag=function(e,t){if(e){t?Array.isArray(t)||(t=[t]):t=Object.keys(r)
for(var i=0;i<t.length;++i)s[t[i]][e]=!1}},this.add=function(e,t,i){if(!r.hasOwnProperty(e)){if(r[e]=t,o(e,t),i){Array.isArray(i)||(i=[i])
for(var n=0;n<i.length;++n)this.tag(i[n],e)}return!0}return stderr("Preferences: "+e+" already exists"),!1},this.remove=function(e,i){return r.hasOwnProperty(e)?(delete r[e],delete s[e],delete this[e],i&&u&&(e=t+e,delete localStorage[e]),!0):!1},this.reset=function(t,i){t&&void 0===i&&(i=!0)
for(var n in r)if(r.hasOwnProperty(n)){if(t){var o=!!s[n][t]
if(i&&!o||!i&&o)continue}this.set(n,r[n],!1)&&e.fireEvent({type:c,name:n,value:this[n]})}},this.get=function(e){return this[e]},this.set=function(t,i,o){if(this[t]!==i){this[t]=i,n(t,i),(void 0===o||o)&&e.fireEvent({type:l,name:t,value:i})
var r=Autodesk.Viewing.Private.logger
return r&&r.log({category:"pref_changed",name:t,value:i}),!0}return!1},this.addListeners=function(e,t,i){a[e]={changed:t,reset:i}},this.removeListeners=function(e){void 0!==a[e]&&delete a[e]}},AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.formatValueWithUnits=function(e,t,i,n){function o(e){var t=e>=0?Math.floor(e):Math.ceil(e),i=e-t
return{intPart:t,fracPart:i}}function r(e,t,i){var n=""
if(i&&0===e&&(n+="-"),0===o(e).fracPart)n+=e
else if(t>0){var r=e.toFixed(t),a=/^\-?([0-9]+)\.0+$/,s=a.exec(r)
n+=null!==s?s[1]:r}else n+=e.toFixed(0)
return n}function a(e,t,i){for(var n="",a=12,s=1,l=0>e,c=0;t>c;++c)s*=2
e>0?e+=.5/s:e-=.5/s
var u,d
i?d=e:(u=o(e/a).intPart,n+=r(u,0,l)+"' ",d=e-u*a,0>d&&(d=-d))
var h=o(d).intPart,p=o((d-h)*s).intPart
if((0===p||0!==h)&&(n+=r(h,0)),0!==p){for(0>h&&0>p&&(p=-p);p%2===0;)p/=2,s/=2
0!==h&&(n+="-"),n+=r(p,0)+"/"+r(s,0)}return n+='"'}function s(e,t){var i=""
0>e&&(i="-",e=Math.abs(e))
var n=o(e),a=n.intPart,s=100*n.fracPart
return i+r(a,0)+" m "+r(s,t)+" cm"}var l
return void 0===n&&(n=3),1===i?l=Autodesk.Viewing.i18n.translate(e?"Yes":"No"):2!==i&&3!==i||!isNaN(e)?"ft"===t||"feet"===t||"foot"===t?l=a(12*e,n):"ft^2"===t||"feet^2"===t||"foot^2"===t?l=a(12*e,n)+" "+String.fromCharCode(178):"in"===t||"inch"===t?l=a(e,n):"in^2"===t||"inch^2"===t?l=a(e,n)+" "+String.fromCharCode(178):"decimal-in"===t?l=r(e,n)+'"':"decimal-in^2"===t?l=r(e,n)+'" '+String.fromCharCode(178):"decimal-ft"===t?l=r(e,n)+"'":"decimal-ft^2"===t?l=r(e,n)+"' "+String.fromCharCode(178):"fractional-in"===t?l=a(e,n,!0):"fractional-in^2"===t?l=a(e,n,!0)+" "+String.fromCharCode(178):"m-and-cm"===t?l=s(e,n):"m-and-cm^2"===t?l=s(e,n)+" "+String.fromCharCode(178):3===i&&t?(t=t.replace("^2",String.fromCharCode(178)),t=t.replace("^3",String.fromCharCode(179)),l=r(e,n)+" "+t):l=t?e+" "+t:3===i?r(e,n):e:l="NaN",l},Autodesk.Viewing.Private.convertUnits=function(e,t,i,n){if(e===t)return i
var o=1
switch(t){case"mm":o=1e3
break
case"cm":o=100
break
case"m":o=1
break
case"in":o=39.37007874
break
case"ft":o=3.280839895
break
case"decimal-in":o=39.37007874
break
case"decimal-ft":o=3.280839895
break
case"fractional-in":o=39.37007874
break
case"m-and-cm":o=1}var r=1
switch(e){case"mm":r=.001
break
case"cm":r=.01
break
case"m":r=1
break
case"in":r=.0254
break
case"ft":r=.3048
break
case"decimal-in":r=.0254
break
case"decimal-ft":r=.3048
break
case"fractional-in":r=.0254
break
case"m-and-cm":r=1}return"square"===n?i*Math.pow(o*r,2):i*o*r},AutodeskNamespace("Autodesk.Viewing.Private"),function(){var e=Autodesk.Viewing,t=Autodesk.Viewing.Private
t.OptionSlider=function(t,i,n,o,r){function a(e){e.target!=s.stepperElement&&(s.stepperElement.value=s.sliderElement.value),s.fireChangeEvent()}var s=this
this.tbody=o
var l=r&&r.insertAtIndex?r.insertAtIndex:-1
this.sliderRow=this.tbody.insertRow(l)
var c=this.sliderRow.insertCell(0)
this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",t),this.caption.textContent=e.i18n.translate(t),this.sliderElement=document.createElement("input"),this.sliderElement.type="range",this.sliderElement.id=t+"_slider",this.sliderElement.min=i,this.sliderElement.max=n,c.appendChild(this.caption),c.appendChild(this.sliderElement),c=this.sliderRow.insertCell(1),this.stepperElement=document.createElement("input"),this.stepperElement.type="number",this.stepperElement.id=t+"_stepper",this.stepperElement.min=i,this.stepperElement.max=n,this.stepperElement.step=1,this.stepperElement.style.width="64px",c.appendChild(this.stepperElement),this.blockEvent=!1,this.stepperElement.addEventListener("change",function(e){e.target!=s.sliderElement&&(s.sliderElement.value=s.stepperElement.value),s.fireChangeEvent()},!1),this.sliderElement.addEventListener("change",a,!1),this.sliderElement.addEventListener("input",a,!1)},t.OptionSlider.prototype.constructor=t.OptionSlider,e.EventDispatcher.prototype.apply(t.OptionSlider.prototype),t.OptionSlider.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value
var e=new CustomEvent("change",{detail:{target:this,value:this.sliderElement.value}})
this.dispatchEvent(e)}},t.OptionSlider.prototype.setValue=function(e){this.blockEvent=!0,this.value=e,this.sliderElement.value=e,this.stepperElement.value=e,this.blockEvent=!1},t.OptionSlider.prototype.setDisabled=function(e){this.sliderElement.disabled=e,this.stepperElement.disabled=e,this.caption.disabled=e},t.OptionCheckbox=function(t,i,n,o){var r=this
this.tbody=i
var a=o&&o.insertAtIndex?o.insertAtIndex:-1
this.sliderRow=this.tbody.insertRow(a)
var s=this.sliderRow.insertCell(0)
this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",t),this.caption.textContent=e.i18n.translate(t),s.appendChild(this.caption),s=this.sliderRow.insertCell(1),this.checkElement=document.createElement("input"),this.checkElement.type="checkbox",this.checkElement.id=t+"_check",this.checkElement.checked=n,s.appendChild(this.checkElement),this.blockEvent=!1,this.checked=n,this.checkElement.addEventListener("change",function(e){r.fireChangeEvent()},!1),isTouchDevice()&&(this.sliderRowHammer=new Hammer.Manager(this.sliderRow,{recognizers:[[Hammer.Tap]],inputClass:Hammer.TouchInput}),this.sliderRowHammer.on("tap",function(e){e.preventDefault(),e.target.click()})),this.checkElement.addEventListener("click",function(e){e.stopPropagation()},!1),this.sliderRow.addEventListener("click",function(e){r.checkElement.disabled||(r.checkElement.checked=!r.checkElement.checked,r.fireChangeEvent())},!1)},t.OptionCheckbox.prototype.constructor=t.OptionCheckbox,e.EventDispatcher.prototype.apply(t.OptionCheckbox.prototype),t.OptionCheckbox.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked
var e=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}})
this.dispatchEvent(e)}},t.OptionCheckbox.prototype.setValue=function(e){this.blockEvent=!0,this.checked=e,this.checkElement.checked=e,this.blockEvent=!1},t.OptionCheckbox.prototype.setDisabled=function(e){this.checkElement.disabled=e,this.caption.disabled=e},t.OptionCheckbox.prototype.setVisibility=function(e){e?this.sliderRow.style.display="table-row":this.sliderRow.style.display="none"},t.OptionDropDown=function(t,i,n,o,r){var a=this
this.tbody=i
var s=r&&r.insertAtIndex?r.insertAtIndex:-1
this.sliderRow=this.tbody.insertRow(s)
var l=this.sliderRow.insertCell(0)
this.caption=document.createElement("div"),this.caption.setAttribute("data-i18n",t),this.caption.textContent=e.i18n.translate(t),l.appendChild(this.caption),l=this.sliderRow.insertCell(1),this.dropdownElement=document.createElement("select"),this.dropdownElement.id=t+"_dropdown",this.dropdownElement.className="optionDropDown"
for(var c=0;c<n.length;c++){var u=document.createElement("option")
u.value=c,u.setAttribute("data-i18n",n[c]),u.textContent=e.i18n.translate(n[c]),this.dropdownElement.add(u)}this.selectedIndex=this.dropdownElement.selectedIndex=o,l.appendChild(this.dropdownElement),l.style.paddingLeft="5px",l.style.paddingRight="5px",this.blockEvent=!1,this.dropdownElement.addEventListener("change",function(e){a.fireChangeEvent()},!1)},t.OptionDropDown.prototype.constructor=t.OptionDropDown,e.EventDispatcher.prototype.apply(t.OptionDropDown.prototype),t.OptionDropDown.prototype.setSelectedIndex=function(e){this.blockEvent=!0,this.selectedIndex=this.dropdownElement.selectedIndex=e,this.blockEvent=!1},t.OptionDropDown.prototype.setSelectedValue=function(e){this.blockEvent=!0,this.dropdownElement.selectedValue=e,this.selectedIndex=this.dropdownElement.selectedIndex,this.blockEvent=!1},t.OptionDropDown.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=this.dropdownElement.selectedIndex
var e=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}})
this.dispatchEvent(e)}},t.OptionDropDown.prototype.setDisabled=function(e){this.dropdownElement.disabled=e,this.caption.disabled=e}}(),function(){"use strict"
var e=function(e){this.bg=document.createElement("div"),this.bg.className="progressbg",this.fg=document.createElement("div"),this.fg.className="progressfg",this.bg.appendChild(this.fg),this.lastValue=-1,e.appendChild(this.bg),this.widthScale=this.fg.clientWidth}
e.prototype.setPercent=function(e){e!=this.lastValue&&(this.lastValue=e,e>=99?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=this.widthScale*e*.01+"px"))},Autodesk.Viewing.Private.ProgressBar=e}(),AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.RenderOptionsPanel=function(e){var t=this,i=Autodesk.Viewing.Private
this.viewer=e,Autodesk.Viewing.UI.DockingPanel.call(this,e.container,"RenderOptionsPanel","Rendering Options"),this.table=document.createElement("table"),this.table.className="tftable",this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.createScrollContainer({heightAdjustment:70,marginTop:20}),this.scrollContainer.appendChild(this.table),this.container.style.width="320px",this.container.style.top="260px",this.container.style.left="220px",this.container.style.height="460px",this.container.dockRight=!0
var n=[]
for(var o in e.impl.BackgroundPresets)n.push(o)
this.bgSelect=new i.OptionDropDown("Background Color",this.tbody,n,-1),this.updateBgColorIndex(),this.addEventListener(this.bgSelect,"change",function(i){var n=t.bgSelect.value,o=e.BackgroundPresets[n]
e.prefs.set("backgroundColorPreset",JSON.stringify(o)),e.impl.setClearColors(o[0],o[1],o[2],o[3],o[4],o[5])}),this.celToggle=new i.OptionCheckbox("Cel Shaded",this.tbody,!0),this.addEventListener(this.celToggle,"change",function(i){var n=t.celToggle.checked
e.prefs.set("celShaded",n),e.impl.toggleCelShading(n)}),this.saoToggle=new i.OptionCheckbox("AO Enabled",this.tbody,!0),this.addEventListener(this.saoToggle,"change",function(i){var n=t.saoToggle.checked
e.prefs.set("ambientShadows",n),e.setQualityLevel(n,e.impl.renderer().settings.antialias)}),this.saoRadius=new i.OptionSlider("AO Radius",0,100,this.tbody),this.saoRadius.setValue(10),this.saoRadius.sliderElement.step=this.saoRadius.stepperElement.step=1,this.addEventListener(this.saoRadius,"change",function(i){e.impl.renderer().setAOOptions(parseInt(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame(!1)}),this.saoIntensity=new i.OptionSlider("AO Intensity",0,3,this.tbody),this.saoIntensity.setValue(.75),this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=.1,this.addEventListener(this.saoIntensity,"change",function(i){e.impl.renderer().setAOOptions(parseInt(t.saoRadius.value),parseFloat(t.saoIntensity.value)),e.impl.renderer().composeFinalFrame(!1)}),this.groundShadowAlpha=new i.OptionSlider("Shadow Alpha",0,2,this.tbody),this.groundShadowAlpha.setValue(1),this.groundShadowAlpha.sliderElement.step=this.groundShadowAlpha.stepperElement.step=.1,this.addEventListener(this.groundShadowAlpha,"change",function(i){e.setGroundShadowAlpha(parseFloat(t.groundShadowAlpha.value))}),this.groundShadowColor=new i.OptionCheckbox("Shadow Color",this.tbody),_isIE11||(this.groundShadowColor.checkElement.type="color"),this.addEventListener(this.groundShadowColor,"change",function(i){var n=t.groundShadowColor.checkElement.value
e.setGroundShadowColor(new THREE.Color(parseInt(n.substr(1,7),16)))}),this.groundReflectionAlpha=new i.OptionSlider("Reflection Alpha",0,2,this.tbody),this.groundReflectionAlpha.setValue(1),this.groundReflectionAlpha.sliderElement.step=this.groundReflectionAlpha.stepperElement.step=.1,this.addEventListener(this.groundReflectionAlpha,"change",function(i){e.setGroundReflectionAlpha(parseFloat(t.groundReflectionAlpha.value))}),this.groundReflectionColor=new i.OptionCheckbox("Reflection Color",this.tbody),_isIE11||(this.groundReflectionColor.checkElement.type="color"),this.addEventListener(this.groundReflectionColor,"change",function(i){var n=t.groundReflectionColor.checkElement.value
e.setGroundReflectionColor(new THREE.Color(parseInt(n.substr(1,7),16)))})
for(var r=[],a=0;a<i.LightPresets.length;a++)r.push(i.LightPresets[a].name)
this.envSelect=new i.OptionDropDown("Environment",this.tbody,r,e.impl.currentLightPreset()),this.addEventListener(this.envSelect,"change",function(i){var n=t.envSelect.selectedIndex
e.setLightPreset(n)})
var s=e.impl.renderer().getToneMapMethod()
this.toneMapMethod=new i.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-Lum","Canon-RGB"],s),this.addEventListener(this.toneMapMethod,"change",function(){var i=t.toneMapMethod.selectedIndex
e.impl.setTonemapMethod(i)}),this.exposureBias=new i.OptionSlider("Exposure Bias",-30,30,this.tbody),this.exposureBias.setValue(e.impl.renderer().getExposureBias()),this.exposureBias.sliderElement.step=this.exposureBias.stepperElement.step=.1,this.addEventListener(this.exposureBias,"change",function(i){e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)}),this.exposureBias.setDisabled(0==s),this.whiteScale=new i.OptionSlider("Light Intensity",-5,20,this.tbody)
var l=0
e.impl.dir_light1&&(l=0!=e.impl.dir_light1.intensity?Math.log(e.impl.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(l),this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=.1,this.addEventListener(this.whiteScale,"change",function(i){e.impl.dir_light1.intensity=Math.pow(2,t.whiteScale.value),e.impl.setTonemapExposureBias(t.exposureBias.value,t.whiteScale.value)}),this.fovAngle=new i.OptionSlider("FOV-degrees",6.88,100,this.tbody),this.fovAngle.setValue(e.getFOV()),this.addEventListener(this.fovAngle,"change",function(i){e.setFOV(parseFloat(t.fovAngle.value))}),this.addEventListener(this.viewer,Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(i){var n=parseFloat(t.fovAngle.value),o=e.getFOV()
n!=o&&t.fovAngle.setValue(o)}),this.addEventListener(this.viewer,Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(e){t.syncUI()}),this.addVisibilityListener(function(){t.resizeToContent()})},Autodesk.Viewing.Private.RenderOptionsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype),Autodesk.Viewing.Private.RenderOptionsPanel.prototype.constructor=Autodesk.Viewing.Private.RenderOptionsPanel,Autodesk.Viewing.Private.RenderOptionsPanel.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}},Autodesk.Viewing.Private.RenderOptionsPanel.prototype.updateBgColorIndex=function(){var e,t=this.viewer.impl,i=t.clearColorTop,n=t.clearColorBottom,o=[255*i.x|0,255*i.y|0,255*i.z|0,255*n.x|0,255*n.y|0,255*n.z|0]
for(var r in Autodesk.Viewing.Private.BackgroundPresets){var a,s=Autodesk.Viewing.Private.BackgroundPresets[r]
for(a=0;6>a&&s[a]==o[a];a++);if(6==a){e=r
break}}if(!e){e="Custom"
for(var l=Autodesk.Viewing.Private.BackgroundPresets[e],c=0;6>c;c++)l[c]=o[c]}this.bgSelect.setSelectedValue(e)},Autodesk.Viewing.Private.RenderOptionsPanel.prototype.syncUI=function(){var e=this.viewer.impl,t=0
e.dir_light1&&(t=0!=e.dir_light1.intensity?Math.log(e.dir_light1.intensity)/Math.log(2):-1e-20),this.whiteScale.setValue(t),this.exposureBias.setValue(e.renderer().getExposureBias()),this.updateBgColorIndex()
var i=e.renderer().getToneMapMethod()
this.toneMapMethod.setSelectedIndex(i),this.envSelect.setSelectedIndex(e.currentLightPreset()),this.exposureBias.setDisabled(0==i),this.saoToggle.setValue(e.renderer().settings.sao),this.saoRadius.setDisabled(!e.renderer().settings.sao),this.saoIntensity.setDisabled(!e.renderer().settings.sao),this.saoRadius.setValue(e.renderer().getAORadius()),this.saoIntensity.setValue(e.renderer().getAOIntensity()),this.groundShadowAlpha.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundShadowColor.setDisabled(!this.viewer.prefs.get("groundShadow")),this.groundReflectionAlpha.setDisabled(!this.viewer.prefs.get("groundReflection")),this.groundReflectionColor.setDisabled(!this.viewer.prefs.get("groundReflection")),this.fovAngle.setValue(this.viewer.getFOV()),this.celToggle.setValue(e.renderer().settings.toonShaded)},Autodesk.Viewing.Private.RenderOptionsPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this),this.table=null,this.tbody=null,this.bgSelect=null,this.saoToggle=null,this.saoRadius=null,this.saoIntensity=null,this.groundShadowAlpha=null,this.envSelect=null,this.toneMapMethod=null,this.exposureBias=null,this.whiteScale=null,this.fovAngle=null,this.viewer=null},function(){"use strict"
var e=Autodesk.Viewing,t=Autodesk.Viewing.UI,i=function(i,n,o){this.viewer=i,this.tree=null,this.layersRoot=null,this.visibilityImages={},this.isMac=-1!==navigator.userAgent.search("Mac OS")
var r="Layer Manager",a=i.config.viewableName,s=!0
a&&"W2D"!==a&&(r=e.i18n.translate(r)+": "+a,s=!1),this.filterImageId=o+"-layerFilterImageId",t.DockingPanel.call(this,i.container,o,r,{localizeTitle:s}),this.container.classList.add("layersPanel"),this.filterContainer=document.createElement("div"),this.filterContainer.className="filterBox",this.filterContainer.id=this.container.id+"-search-container",this.container.appendChild(this.filterContainer),this.createScrollContainer({heightAdjustment:105,marginTop:5})
var l=this
i.model?l.build():l.addEventListener(i,e.GEOMETRY_LOADED_EVENT,function(){l.build()}),this.addVisibilityListener(function(){l.resizeToContent()})}
i.prototype=Object.create(t.DockingPanel.prototype),i.prototype.constructor=i,i.prototype.uninitialize=function(){t.DockingPanel.prototype.uninitialize.call(this),this.viewer=null,this.tree=null,this.layersRoot=null,this.visibilityImages=null,this.scrollContainer=null,this.filterContainer=null},i.prototype.build=function(){function i(){var e=new t.TreeDelegate
return e.getTreeNodeId=function(e){return e.id},e.getTreeNodeLabel=function(e){return r.getNodeLabel(e)},e.getTreeNodeClass=function(e){return r.getNodeClass(e)},e.isTreeNodeGroup=function(e){return r.isGroupNode(e)},e.shouldCreateTreeNode=function(e){return r.shouldInclude(e)},e.onTreeNodeClick=function(e,t,i){r.onClick(t,i)},e.onTreeNodeRightClick=function(e,t,i){r.onRightClick(t,i)},e.onTreeNodeDoubleClick=function(e,t,i){r.onDoubleClick(t,i)},e.onTreeNodeIconClick=function(e,t,i){r.onIconClick(t,i)},e.createTreeNode=function(e,t){r.createNode(e,t)},e}function n(){c&&clearTimeout(c),c=setTimeout(o,500)}function o(){function e(i){var n=[]
if(-1!==i.name.toLowerCase().indexOf(t))n.push(i)
else if(!i.isLayer)for(var o=i.children,r=0;r<o.length;++r)n=n.concat(e(o[r]))
return n}if(l.value){var t=l.value.toLowerCase()
h&&0<h.childCount&&u.setLayerVisible(e(h),!0,!0)}else u.setLayerVisible(null,!0)
c=null}var r=this,a=document.createElement("div")
a.className="filterSearch",r.filterContainer.appendChild(a)
var s=document.createElement("div")
s.className="filterImage",s.id=r.filterImageId,s.title=e.i18n.translate("Show/hide all layers"),a.appendChild(s),r.visibilityImages[r.filterImageId]=s,r.addEventListener(s,"click",function(e){r.onImageClick(null,e),e.stopPropagation()})
var l=this.filterField=document.createElement("input")
l.className="filterInput",l.placeholder=e.i18n.translate("Enter filter term"),l.setAttribute("data-i18n","[placeholder]Enter filter term"),l.type="search",l.incremental="incremental",a.appendChild(l)
var c=null,u=r.viewer
l.addEventListener("keyup",function(e){n()}),l.addEventListener("click",function(e){return""===l.value?void u.setLayerVisible(null,!0):void setTimeout(function(){""===l.value&&(u.setLayerVisible(null,!0),e.preventDefault())},1)})
var d=i(),h=r.layersRoot=r.viewer.model.getLayersRoot()
h&&(r.tree=new t.Tree(d,h,r.scrollContainer,{excludeRoot:!0}),r.resizeToContent(),r.update(),r.addEventListener(r.viewer,e.LAYER_VISIBILITY_CHANGED_EVENT,function(){r.update()}))},i.prototype.update=function(){function e(e,t){var i
i=1===t?"layerVisible":0===t?"layerHidden":"layerMixed",e.classList.remove("layerVisible","layerHidden","layerMixed"),e.classList.add(i)}function t(e,t){0===t?o.tree.addClass(e.id,"dim"):o.tree.removeClass(e.id,"dim")}function i(e){var t
if(0<e.length)for(var i=0;i<e.length;++i){var n=e[i]
if(void 0===t?t=n:0===n&&1===t?t=-1:1===n&&0===t&&(t=-1),-1===t)break}else t=0
return t}function n(r){var a=r.id,s=o.visibilityImages[a]
if(!r.isLayer){for(var l=r.children,c=[],u=0;u<l.length;++u)c=c.concat(n(l[u]))
var d=i(c)
return e(s,d),t(r,d),c}var h=o.viewer.isLayerVisible(r)?1:0
return e(s,h),t(r,h),[h]}var o=this,r=this.layersRoot&&0<this.layersRoot.childCount?n(o.layersRoot):[],a=o.visibilityImages[o.filterImageId]
e(a,i(r))},i.prototype.setLayerVisible=function(e,t){var i=e?e.id:this.filterImageId,n=this.visibilityImages[i].className,o="layerVisible"!==n
this.viewer.setLayerVisible(e,o,t),this.filterField.value=""},i.prototype.getNodeLabel=function(e){return e.isLayer||0===e.childCount?e.name:e.name+" ("+e.childCount+")"},i.prototype.getNodeClass=function(e){return""},i.prototype.isGroupNode=function(e){return!e.isLayer},i.prototype.shouldInclude=function(e){return!0},i.prototype.onIconClick=function(e,t){this.setGroupCollapsed(e,!this.isGroupCollapsed(e))},i.prototype.setGroupCollapsed=function(e,t){var i=this.tree.delegate()
if(i.isTreeNodeGroup(e)){var n=i.getTreeNodeId(e)
this.tree.setCollapsed(n,t),this.resizeToContent()}},i.prototype.isGroupCollapsed=function(e){var t=this.tree.delegate()
if(t.isTreeNodeGroup(e)){var i=t.getTreeNodeId(e)
return this.tree.isCollapsed(i)}return!1},i.prototype.onClick=function(e,t){},i.prototype.onDoubleClick=function(e,t){},i.prototype.onRightClick=function(e,t){},i.prototype.onImageClick=function(e,t){},i.prototype.getContentSize=function(){var e=this.filterContainer,t=e.clientHeight+80,i=e.clientWidth,n=this.tree
if(n){var o=n.getRootContainer()
if(o)return{height:o.clientHeight+t,width:Math.max(o.clientWidth,i)}}return{height:t,width:i}},i.prototype.createNode=function(t,i){var n=document.createElement("div")
i.children&&i.children.length>0?i.insertBefore(n,i.children[0]):i.appendChild(n),n.title=e.i18n.translate("Show/hide this layer"),this.visibilityImages[t.id]=n
var o=document.createElement("label")
o.textContent=this.getNodeLabel(t),i.appendChild(o)
var r=this
this.addEventListener(n,"click",function(e){r.onImageClick(t,e),e.stopPropagation()})},Autodesk.Viewing.UI.LayersPanel=i}(),AutodeskNamespace("Autodesk.Viewing.UI"),Autodesk.Viewing.UI.SettingsPanel=function(e,t,i,n){Autodesk.Viewing.UI.DockingPanel.call(this,e,t,i,n),this.panelTabs=[],this.tabIdToIndex={},this.controls={},this.controlIdCount=0
var o=this,r=n&&void 0!==n.width?n.width:340
this.container.style.maxWidth="800px",this.container.style.minWidth=r+"px",this.container.style.top="100px",this.container.style.left=e.offsetWidth/2-170+"px",this.container.style.position="absolute",this.tabContainer=document.createElement("div"),this.tabContainer.className="settings-tabs",this.container.appendChild(this.tabContainer),this.tabs=document.createElement("ul"),this.tabContainer.appendChild(this.tabs),this.heightAdjustment=n&&n.heightAdjustment?n.heightAdjustment:110,this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0}),this.mouseOver=!1,this.addEventListener(this.container,"mouseover",function(e){var t=e.toElement||e.relatedTarget
if(o.mouseOver)return!0
for(var i=0;t&&t.parentNode&&t.parentNode!=window;){if(t.parentNode==this||t==this){t.preventDefault&&t.preventDefault(),o.mouseOver=!0
for(var i=0;i<o.panelTabs.length;i++)o.panelTabs[i].classList.remove("selectedmouseout")
return!0}t=t.parentNode}}),this.addEventListener(this.container,"mouseout",function(e){var t=e.toElement||e.relatedTarget
if(o.mouseOver){for(;t&&t.parentNode&&t.parentNode!=window;){if(t.parentNode==this||t==this)return t.preventDefault&&t.preventDefault(),!1
t=t.parentNode}o.mouseOver=!1
for(var i=0;i<o.panelTabs.length;i++)o.panelTabs[i].classList.contains("tabselected")&&o.panelTabs[i].classList.add("selectedmouseout")}})},Autodesk.Viewing.UI.SettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype),Autodesk.Viewing.UI.SettingsPanel.prototype.constructor=Autodesk.Viewing.UI.SettingsPanel,Autodesk.Viewing.UI.SettingsPanel.prototype.setVisible=function(e){e&&(this.container.style.display="block"),Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,e)},Autodesk.Viewing.UI.SettingsPanel.prototype.addTab=function(e,t,i){function n(t){o.selectTab(e)}var o=this
if(void 0!==this.tabIdToIndex[e])return!1
var r=i&&void 0!==i.className?i.className:null,a=i&&void 0!==i.width?i.width:200,s=i&&void 0!==i.index?i.index:this.panelTabs.length,l=document.createElement("li")
l.id=e
var c=document.createElement("a"),u=document.createElement("span")
u.setAttribute("data-i18n",t),u.textContent=Autodesk.Viewing.i18n.translate(t),c.appendChild(u),l.appendChild(c),this.tabs.appendChild(l)
var d=document.createElement("table")
d.id=e+"-table",d.className="settings-table tftable "+r
var h=document.createElement("tbody")
d.appendChild(h),this.scrollContainer.appendChild(d),this.addEventListener(l,"touchstart",touchStartToClick),this.addEventListener(l,"click",n),this.panelTabs.push(l),this.tabIdToIndex[e]=s
var p=this.container.style.minWidth?parseInt(this.container.style.minWidth):0
return a>p&&(this.container.style.minWidth=a+"px"),!0},Autodesk.Viewing.UI.SettingsPanel.prototype.removeTab=function(e){var t=this.tabIdToIndex[e]
if(!t)return!1
this.panelTabs.splice(t,1),this.tabs.removeChild(tabDom),this.tabIdToIndex={}
for(var i=this.panelTabs.length,n=0;i>n;n++){var o=this.panelTabs[n]
this.tabIdToIndex[o.id]=n}return!0},Autodesk.Viewing.UI.SettingsPanel.prototype.hasTab=function(e){var t=this.tabIdToIndex[e],i=this.panelTabs[t]
return void 0!==i},Autodesk.Viewing.UI.SettingsPanel.prototype.selectTab=function(e){if(this.isTabSelected(e))return!1
for(var t=this.panelTabs.length,i=0;t>i;i++){var n=this.panelTabs[i],o=document.getElementById(n.id+"-table")
e===n.id?(n.classList.add("tabselected"),o.style.display="table",this.mouseOver||n.classList.add("selectedmouseout")):(n.classList.remove("tabselected"),o.style.display="none",this.mouseOver||this.panelTabs[i].classList.remove("selectedmouseout"))}return this.resizeToContent(),!0},Autodesk.Viewing.UI.SettingsPanel.prototype.isTabSelected=function(e){var t=this.tabIdToIndex[e],i=this.panelTabs[t]
return i&&i.classList.contains("tabselected")},Autodesk.Viewing.UI.SettingsPanel.prototype.addCheckbox=function(e,t,i,n,o){var r=this.tabIdToIndex[e]
if(void 0===r)return null
var a=document.getElementById(e+"-table"),s=new Autodesk.Viewing.Private.OptionCheckbox(t,a.tBodies[0],i,o)
return s.changeListener=function(e){var t=e.detail.target.checked
n(t)},this.addEventListener(s,"change",s.changeListener),this.addControl(e,s)},Autodesk.Viewing.UI.SettingsPanel.prototype.addSlider=function(e,t,i,n,o,r,a){var s=this.tabIdToIndex[e]
if(void 0===s)return null
var l=document.getElementById(e+"-table"),c=new Autodesk.Viewing.Private.OptionSlider(t,i,n,l.tBodies[0],a)
return c.setValue(o),c.sliderElement.step=c.stepperElement.step=1,this.addEventListener(c,"change",function(e){r(e)}),this.addControl(e,c)},Autodesk.Viewing.UI.SettingsPanel.prototype.addDropDownMenu=function(e,t,i,n,o,r){var a=this.tabIdToIndex[e]
if(void 0===a)return null
var s=document.getElementById(e+"-table"),l=new Autodesk.Viewing.Private.OptionDropDown(t,s.tBodies[0],i,n,r)
return this.addEventListener(l,"change",function(e){o(e)}),this.addControl(e,l)},Autodesk.Viewing.UI.SettingsPanel.prototype.addControl=function(e,t,i){var n=this.tabIdToIndex[e]
if(void 0===n)return null
if(!t.hasOwnProperty("sliderRow")){var o=i&&i.insertAtIndex?i.insertAtIndex:-1,r=i&&i.caption?i.caption:null,a=document.getElementById(e+"-table")
o>a.length&&(o=-1)
var s=a.tBodies[0].insertRow(o),l=s.insertCell(0)
if(r){var c=document.createElement("div")
c.setAttribute("data-i18n",r),c.textContent=Autodesk.Viewing.i18n.translate(r),l.appendChild(c),l=s.insertCell(1)}else l.colSpan=2
l.appendChild(t),t.sliderRow=s,t.tbody=a.tBodies[0]}var u="adsk_settings_control_id_"+this.controlIdCount.toString()
return this.controlIdCount=this.controlIdCount+1,this.controls[u]=t,this.resizeToContent(),u},Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(e){return this.removeControl(e)},Autodesk.Viewing.UI.SettingsPanel.prototype.removeSlider=function(e){return this.removeControl(e)},Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(e){return this.removeControl(e)},Autodesk.Viewing.UI.SettingsPanel.prototype.removeControl=function(e){var t
if(t="object"==typeof e&&e.tbody?e:this.controls[e],void 0===t)return!1
var i=t.tbody,n=t.sliderRow,o=n.rowIndex
return i.deleteRow(o),delete this.controls[e],this.resizeToContent(),!0},Autodesk.Viewing.UI.SettingsPanel.prototype.getControl=function(e){return void 0!==this.controls[e]?this.controls[e]:null},Autodesk.Viewing.UI.SettingsPanel.prototype.getContentSize=function(){for(var e=this.heightAdjustment,t=this.panelTabs.length>this.panelTabs[0]?0:null,i=0;i<this.panelTabs.length;i++){var n=this.panelTabs[i]
if(this.isTabSelected(n.id)){t=n
break}}if(t){var o=document.getElementById(n.id+"-table")
e+=o.clientHeight}return{height:e,width:this.container.clientWidth}},function(){"use strict"
var e=function(){}
e.instances=[],e.displayError=function(t,i,n,o,r){var a=document.createElement("div")
a.className="alertBox error",t.appendChild(a)
var s=o
s||(s="img-item-not-found")
var l=document.createElement("div")
l.className="alertBoxImage "+s,a.appendChild(l)
var c=document.createElement("div")
c.className="alertBoxMsg",a.appendChild(c)
var u=n
u||(u=Autodesk.Viewing.i18n.translate("Error Occurred",{defaultValue:"Error Occurred"}))
var d=document.createElement("div")
d.className="alertBoxTitle",d.textContent=u,c.appendChild(d)
var h=document.createElement("div")
if(h.className="alertBoxText",h.textContent=i,c.appendChild(h),r){var p=document.createElement("div")
p.className="alertBoxContent",c.appendChild(p)
var f=document.createElement("ul")
f.className="alertBoxContent"
for(var m=0;m<r.length;m++){var v=r[m]
if(v){var g=document.createElement("li")
f.appendChild(g)
var E=this.extractList(v)
if(E.list.length){var y=this.generateListElement(list)
f.appendChild(y)}g.innerHTML=E.msg}}p.appendChild(f)}var A=document.createElement("div")
A.className="alertBoxOK",A.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"})
var T={alertBox:a,container:t}
A.addEventListener("click",function(i){a.style.visibility="hidden",t.removeChild(a),e.instances.splice(e.instances.indexOf(T),1)}),a.appendChild(A),a.style.visibility="visible",e.instances.push(T)},e.displayErrors=function(t,i,n){var o=document.createElement("div")
o.className="alertBox errors",t.appendChild(o)
var r=i
r||(r="img-item-not-found")
var a=document.createElement("div")
a.className="alertBoxImage "+r,o.appendChild(a)
var s=document.createElement("div")
s.className="alertBoxMsg errors",o.appendChild(s)
for(var l=0;l<n.length;l++){var c=n[l].header
c||(c=Autodesk.Viewing.i18n.translate("Error",{defaultValue:"Error"}))
var u=document.createElement("div")
u.className="alertBoxTitle errors",u.textContent=c,s.appendChild(u)
var d=document.createElement("div")
d.className="alertBoxText errors"
var h=n[l].msg,p=this.extractList(h)
if(p.list.length){var f=document.createElement("div"),m=this.generateListElement(p.list)
f.appendChild(m),d.textContent=p.msg,d.appendChild(f)}else d.textContent=h
if(s.appendChild(d),n[l].hints){var v=document.createElement("ul")
v.className="alertBoxContent"
for(var g=n[l].hints,E=0;E<g.length;E++){var y=g[E]
if(y){var A=document.createElement("li")
v.appendChild(A)
var p=this.extractList(y)
if(p.list.length){var m=this.generateListElement(p.list)
v.appendChild(m)}A.innerHTML=p.msg}}s.appendChild(v)}}var T=document.createElement("div")
T.className="alertBoxOK",T.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"})
var b={alertBox:o,container:t}
T.addEventListener("click",function(i){o.style.visibility="hidden",t.removeChild(o),e.instances.splice(e.instances.indexOf(b),1)}),o.appendChild(T),o.style.visibility="visible",e.instances.push(b)},e.extractList=function(e){var t={msg:e,list:[]}
if(e&&-1!=e.indexOf("<ul>")){var i=e.split("<ul>")
t.msg=i[0],i=i[1].split("</ul>"),t.list=i[0].split(", "),1===t.list.length&&(t.list=i[0].split(","))}return t},e.generateListElement=function(e){for(var t=document.createElement("ul"),i=0;i<e.length;i++){var n=document.createElement("li")
n.textContent=e[i],t.appendChild(n)}return t},e.dismiss=function(){if(e.instances.length>0){var t=e.instances.pop()
return t.alertBox.style.visibility="hidden",t.container.removeChild(t.alertBox),!0}return!1},Autodesk.Viewing.Private.AlertBox=e}(),function(){"use strict"
var e=Autodesk.Viewing,t=function(){}
t.instances=[],t.displayMessage=function(i,n,o,r,a){if(!(t.instances.length>0)){var s=n.msgTitleKey,l=n.msgTitleDefaultValue||s,c=n.messageKey,u=n.messageDefaultValue||c,d=n.buttonText,h=n.checkboxChecked||!1,p=document.createElement("div")
p.className="hud",i.appendChild(p)
var f=document.createElement("div")
if(f.className="hudTitle",f.textContent=e.i18n.translate(s,{defaultValue:l}),f.setAttribute("data-i18n",s),p.appendChild(f),o){var m=document.createElement("div")
m.className="hudClose",m.innerHTML="&times;",m.addEventListener("click",function(e){t.dismiss(),o&&o(e)}),p.appendChild(m)}var v=document.createElement("div")
if(v.className="hudMessage",v.textContent=e.i18n.translate(c,{defaultValue:u}),v.setAttribute("data-i18n",c),p.appendChild(v),r){var g=document.createElement("div")
g.className="hudButton",g.textContent=e.i18n.translate(d,{defaultValue:d}),g.setAttribute("data-i18n",d),g.addEventListener("click",r),p.appendChild(g)}if(a){var E=document.createElement("div"),y=document.createElement("input")
y.className="hudCheckbox",y.type="checkbox",y.checked=h,E.appendChild(y)
var A="Do not show this message again",T=document.createElement("label")
T.setAttribute("for",A),T.setAttribute("data-i18n",A),T.textContent=e.i18n.translate(A,{defaultValue:A}),E.appendChild(T),y.addEventListener("change",a),p.appendChild(E)}var b={hudMessage:p,container:i}
t.instances.push(b)}},t.dismiss=function(){if(t.instances.length>0){var e=t.instances.pop()
return e.hudMessage.style.visibility="hidden",e.container.removeChild(e.hudMessage),!0}return!1},Autodesk.Viewing.Private.HudMessage=t}(),function(){"use strict"
var e=Autodesk.Viewing.UI,t=Autodesk.Viewing.Private,i=function(){}
i.prototype.constructor=i,i.prototype.isTreeNodeGroup=function(e){throw"isTreeNodeGroup is not implemented."},i.prototype.getTreeNodeId=function(e){throw"getTreeNodeId is not implemented."},i.prototype.getTreeNodeLabel=function(e){return e.name},i.prototype.shouldCreateTreeNode=function(e){return!0},i.prototype.forEachChild=function(e,t){for(var i=e.children?e.children.length:0,n=0;i>n;++n){var o=e.children[n]
t(o)}},i.prototype.createTreeNode=function(e,t,i){var n=document.createElement("label")
t.appendChild(n)
var o=this.getTreeNodeLabel(e)
i&&i.localize&&(n.setAttribute("data-i18n",o),o=Autodesk.Viewing.i18n.translate(o)),n.textContent=o},i.prototype.onTreeNodeClick=function(e,t,i){},i.prototype.onTreeNodeIconClick=function(e,t,i){e.delegate().isTreeNodeGroup(t)&&e.setCollapsed(t,!e.isCollapsed(t))},i.prototype.onTreeNodeDoubleClick=function(e,t,i){},i.prototype.onTreeNodeRightClick=function(e,t,i){},i.prototype.getTreeNodeClass=function(e){return""}
var n=function(e,t,i,n){this.myDelegate=e,this.mySelectedNodes=[],this.myOptions=n||{}
var o="treeview"
this.myGroupNodes=[],this.nodeToElement=[]
var r=this.myRootContainer=this.createHtmlElement_(i,"div",o),a=this.rootElem=this.createElement_(t,r,n,0)
n&&n.excludeRoot&&a.classList.add("exclude")}
n.prototype.constructor=n,n.prototype.show=function(e){var t=this.myRootContainer
e?t.style.display="block":t.style.display="none"},n.prototype.getRootContainer=function(){return this.myRootContainer},n.prototype.getElementForNode=function(e){return"number"!=typeof e&&"string"!=typeof e&&(e=this.myDelegate.getTreeNodeId(e)),this.nodeToElement[e]},n.prototype.delegate=function(){return this.myDelegate},n.prototype.isCollapsed=function(e){return this.hasClass(e,"collapsed")},n.prototype.setCollapsed=function(e,t,i){t?(this.addClass(e,"collapsed",i),this.removeClass(e,"expanded",i)):(this.addClass(e,"expanded",i),this.removeClass(e,"collapsed",i))},n.prototype.setAllCollapsed=function(e){var t,i
e?(t=function(e){return e.classList.contains("expanded")},i=function(e){e.classList.add("collapsed"),e.classList.remove("expanded")}):(t=function(e){return e.classList.contains("collapsed")},i=function(e){e.classList.add("expanded"),e.classList.remove("collapsed")})
for(var n=0;n<this.myGroupNodes.length;++n){var o=this.myGroupNodes[n]
t(o)&&i(o)}},n.prototype.addToSelection=function(e){function t(e){var t=i.mySelectedNodes.indexOf(e)
return-1===t?(i.mySelectedNodes.push(e),!0):!1}for(var i=this,n=e.length,o=0;n>o;++o){var r=e[o]
t(r)&&this.addClass(r,"selected")}},n.prototype.removeFromSelection=function(e){function t(e){var t=i.mySelectedNodes.indexOf(e)
return-1!==t?(i.mySelectedNodes.splice(t,1),!0):!1}for(var i=this,n=e.length-1;n>=0;--n){var o=e[n]
t(o)&&this.removeClass(o,"selected")}},n.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedNodes),this.addToSelection(e),this.mySelectedNodes},n.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedNodes)},n.prototype.isSelected=function(e){return this.hasClass(e,"selected")},n.prototype.scrollTo=function(e){var t=this.getElementForNode(e)
if(t){var i=t.offsetTop
for(t=t.parentNode;t&&t!=this.myRootContainer;)i+=t.offsetTop,t=t.parentNode
this.myRootContainer.parentNode.scrollTop=i}},n.prototype.addClass=function(e,t,i){var n=this.getElementForNode(e)
if(n){if(i){n=n.parentNode
for(var o=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;n&&n!==o;)n.classList.add(t),n=n.parentNode}else n.classList.add(t)
return!0}return!1},n.prototype.removeClass=function(e,t,i){var n=this.getElementForNode(e)
if(n){if(i){n=n.parentNode
for(var o=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;n&&n!==o;)n.classList.remove(t),n=n.parentNode}else n.classList.remove(t)
return!0}return!1},n.prototype.hasClass=function(e,t){return this.getElementForNode(e).classList.contains(t)},n.prototype.clear=function(){for(var e=this.myRootContainer;e.hasChildNodes();)e.removeChild(e.lastChild)
this.nodeToElement={}},n.prototype.createElement_=function(e,t,i,n){function o(t,n,o){var r=a.createHtmlElement_(t,n,o),s=a.createHtmlElement_(r,"header"),l=a.createHtmlElement_(s,"icon")
return l.addEventListener("click",function(t){a.myDelegate.onTreeNodeIconClick(a,e,t),t.stopPropagation(),t.preventDefault()},!1),a.myDelegate.createTreeNode(e,s,i),r}if(!e)return null
if(!this.myDelegate.shouldCreateTreeNode(e))return null
var r,a=this
if(a.myDelegate.isTreeNodeGroup(e)){r=o(t,"group","expanded"),a.nodeToElement[this.myDelegate.getTreeNodeId(e)]=r
var s=a.myOptions.excludeRoot?1:0
n==s&&(r.style.left="0px"),a.myGroupNodes.push(r),a.myDelegate.forEachChild(e,function(e){a.createElement_(e,r,i,n+1)})}else{r=o(t,"leaf","expanded"),a.nodeToElement[this.myDelegate.getTreeNodeId(e)]=r
var s=a.myOptions.excludeRoot?1:0
n==s&&(r.style.marginLeft="0px")}isTouchDevice()&&(r.hammer=new Hammer.Manager(r,{recognizers:[[Hammer.Tap,{event:"doubletap",taps:2,interval:400,threshold:6,posThreshold:30}],[Hammer.Tap],[Hammer.Press,{event:"press",time:500}]],inputClass:Hammer.TouchInput}),r.hammer.on("doubletap",function(t){a.myDelegate.onTreeNodeDoubleClick(a,e,t),t.srcEvent.stopPropagation(),t.preventDefault()}),r.hammer.on("tap",function(t){a.myDelegate.onTreeNodeClick(a,e,t),t.srcEvent.stopPropagation(),t.preventDefault()}),r.hammer.on("press",function(t){a.myDelegate.onTreeNodeRightClick(a,e,t),t.srcEvent.stopPropagation(),t.preventDefault()})),r.addEventListener("click",function(t){a.myDelegate.onTreeNodeClick(a,e,t),t.stopPropagation(),t.preventDefault()},!1),r.addEventListener("dblclick",function(t){a.myDelegate.onTreeNodeDoubleClick(a,e,t),t.stopPropagation(),t.preventDefault()},!1),r.addEventListener("contextmenu",function(t){a.myDelegate.onTreeNodeRightClick(a,e,t),t.stopPropagation(),t.preventDefault()},!1)
var l=a.myDelegate.getTreeNodeClass(e)
return l&&r.classList.add(l),r},n.prototype.createHtmlElement_=function(e,t,i){var n=document.createElement(t)
return e.appendChild(n),i&&(n.className=i),n},n.prototype.iterate=function(e,t){if(e&&this.myDelegate.shouldCreateTreeNode(e)){var i=this.getElementForNode(e)
if(i){t(e,i)
var n=this
this.myDelegate.forEachChild(e,function(e){n.iterate(e,t)})}}},t.TreeDelegate=e.TreeDelegate=i,t.Tree=e.Tree=n}(),function(){"use strict"
var e=function(){}
e.prototype.constructor=e,e.prototype.getNodeId=function(e){throw"getId is not implemented."},e.prototype.getNodeLabel=function(e){return e.name},e.prototype.getNodeClass=function(e){return""},e.prototype.hasThumbnail=function(e){return!1},e.prototype.getThumbnail=function(e){return null},e.prototype.onNodeClick=function(e,t,i){},e.prototype.onNodeHover=function(e,t,i){},e.prototype.selectItem=function(e){},e.prototype.deselectItem=function(e){},e.prototype.hasContent=function(e){return!1},e.prototype.addContent=function(e,t){}
var t=function(e,t,i){this.myDelegate=e,this.mySelectedIds=[]
var n="browserview"
this.myRootContainerId=i+"-"+n,this.idToElement={},this.myRootContainer=document.createElement("div"),this.myRootContainer.id=this.myRootContainerId,this.myRootContainer.classList.add(n)
var o=document.getElementById(i)
o.appendChild(this.myRootContainer),this.createElements(t,this.myRootContainer)}
t.prototype.constructor=t,t.prototype.show=function(e){e?(this.myRootContainer.classList.remove("browserHidden"),this.myRootContainer.classList.add("browserVisible"),this.myRootContainer.style.display="block"):(this.myRootContainer.classList.remove("browserVisible"),this.myRootContainer.classList.add("browserHidden"),this.myRootContainer.style.display="none")},t.prototype.getRootContainer=function(){return this.myRootContainer},t.prototype.delegate=function(){return this.myDelegate},t.prototype.addToSelection=function(e){function t(e){var t=i.mySelectedIds.indexOf(e)
return-1==t?(i.mySelectedIds.push(e),!0):!1}for(var i=this,n=0,o=e.length;o>n;++n){var r=e[n]
if(t(r)){var a=i.idToElement[r]
void 0===a?i.myDelegate.selectItem(r):a.classList.add("selected")}}},t.prototype.removeFromSelection=function(e){function t(e){var t=i.mySelectedIds.indexOf(e)
return-1!=t?(i.mySelectedIds.splice(t,1),!0):!1}for(var i=this,n=e.length-1;n>=0;--n){var o=e[n]
if(t(o)){var r=this.idToElement[o]
void 0===r?i.myDelegate.deselectItem(o):r.classList.remove("selected")}}},t.prototype.setSelection=function(e){return this.removeFromSelection(this.mySelectedIds),this.addToSelection(e),this.mySelectedIds},t.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)},t.prototype.createElements=function(e,t){if(e)for(var i=this,n=0;n<e.length;n++){var o=e[n]
i.createElement(o,t)}},t.prototype.createElement=function(e,t){var i=this,n=i.myDelegate.getNodeId(e),o=document.createElement("item")
t.appendChild(o),this.idToElement[n]=o,o.onmouseover=function(){i.myDelegate.onNodeHover(i,e)},o.onclick=function(t){i.myRootContainer.querySelector(".flipped").removeClass("flipped"),i.myDelegate.onNodeClick(i,e,t)}
var r=document.createElement("div")
r.classList.add("card"),o.appendChild(r)
var a=document.createElement("div")
a.classList.add("browserElement"),r.appendChild(a)
var s=i.myDelegate.getNodeLabel(e),l=document.createElement("label")
l.innerHTML=s,a.appendChild(l),l.onclick=function(t){i.myDelegate.onNodeClick(i,e,t)}
var c=i.myDelegate.getThumbnail(e)
if(c){var u=document.createElement("img")
u.classList.add("thumb"),u.src=c,a.appendChild(u),u.onclick=function(t){i.myDelegate.onNodeClick(i,e,t)}}i.myDelegate.hasContent(e)&&i.myDelegate.addContent(e,r),o.classList.add(i.myDelegate.getNodeClass(e))},Autodesk.Viewing.Private.BrowserDelegate=e,Autodesk.Viewing.Private.Browser=t}(),AutodeskNamespace("Autodesk.Viewing.Private"),function(){var e=Autodesk.Viewing.Private
e.WEBGL_HELP_LINK=null,e.ErrorInfoData={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message> <hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unloack","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You don’t have the required privileges to access this item.</message><hint> Please contact the author</hint>"},5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We can’t display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title>Sorry</title><message>We can\'t show this item because this browser doesn\'t support WebGL.</message><hint>Try Google Chrome, Mozilla Firefox, or another browser that supports WebGL 3D graphics.</hint><hint>For more information, see the <a href="WEBGL_HELP" target="_blank">A360 browser reqirements.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>There’s nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title>Sorry</title><message>We can\'t show this item because WebGL is disabled on this device.</message><hint> For more information see the <a href="WEBGL_HELP" target="_blank">A360 Help.</a></hint>'},11:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldn’t connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"}},e.currentError=null,e.currentErrors=null,e.ErrorHandler=function(){},e.ErrorHandler.prototype.constructor=e.ErrorHandler,e.ErrorHandler.getErrorCode=function(e){return 403===e||401===e?Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED:404===e?Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND:e>=500?Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR:Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE},e.ErrorHandler.reportError=function(t,i,n,o,r,a){if(e.ErrorHandler.currentError=null,e.ErrorHandler.currentErrors=null,i){if(e.logger){var s={category:"error",code:i,message:n,httpStatusCode:o,httpStatusText:r}
e.logger.log(s,!0)}e.ErrorHandler.currentError=[t,i,n,a]
var l=e.ErrorInfoData[i]
if(l){var c={defaultValue:""}
c.defaultValue=l["default-msg"]
var u=l.img,d=l["globalized-msg"],h=this.parseErrorString(d,c)
if(i===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||i===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(var p=e.WEBGL_HELP_LINK||"http://www.autodesk.com/a360-browsers",f=0;f<h.hints.length;f++){var m=h.hints[f].indexOf('href="WEBGL_HELP"');-1!==m&&(h.hints[f]=h.hints[f].replace('href="WEBGL_HELP"','href="'+p+'"'))}e.AlertBox.displayError(t,h.msg,h.header,u,h.hints)}else{var u="img-unsupported",c={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"}
this.parseArguments(n,c)
var h=this.parseErrorString(i,c)
h.header||(h.header="warning"===a?Autodesk.Viewing.i18n.translate("header-warning"):""),e.AlertBox.displayError(t,h.msg,h.header,u,h.hints)}}},e.ErrorHandler.reportErrors=function(t,i){if(e.ErrorHandler.currentError=null,e.ErrorHandler.currentErrors=null,i){e.ErrorHandler.currentErrors=[t,i]
for(var n={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},o=[],r=0;r<i.length;r++)if(i[r].code){this.parseArguments(i[r].message,n)
var a=this.parseErrorString(i[r].code,n)
if(a.header||(a.header="warning"===i[0].type?Autodesk.Viewing.i18n.translate("header-warning",{defaultValue:"Warning"}):""),o.push(a),e.logger){var s={category:"error",code:i[r].code,message:i[r].message}
e.logger.log(s,!0)}}if(o.length){var l="img-unsupported"
e.AlertBox.displayErrors(t,l,o)}}},e.ErrorHandler.parseArguments=function(e,t){if(e)if("string"==typeof e)t.defaultValue=e
else{t.defaultValue=e[0]
for(var i=1;i<e.length;i++){var n=i-1,o=n.toString()
t[o]=e[i]}}},e.ErrorHandler.parseErrorString=function(e,t){var i={msg:null,msgList:null,header:null,hints:null}
if(!e)return i
var n=Autodesk.Viewing.i18n.translate(e,t)
if(!n)return i
if(-1!=n.indexOf("<title>")){var o=n.split("<title>")[1].split("</title>")
i.header=o[0],n=o[1]}if(n&&-1!=n.indexOf("<message>")){var o=n.split("<message>")[1].split("</message>")
i.msg=o[0],n=o[1]}else i.msg=n
if(n&&-1!=n.indexOf("<hint>")){i.hints=[]
for(var r=n.split("<hint>"),a=0;a<r.length;a++){var s=r[a].split("</hint")[0]
i.hints.push(s)}}return i},e.ErrorHandler.localize=function(){if(e.AlertBox.instances.length>0)if(e.AlertBox.dismiss(),e.ErrorHandler.currentError){var t=e.ErrorHandler.currentError.shift(),i=e.ErrorHandler.currentError
e.ErrorHandler.reportError(t,i[0],i[1],i[2])}else{var t=e.ErrorHandler.currentErrors.shift(),n=e.ErrorHandler.currentErrors[0]
e.ErrorHandler.reportErrors(t,n)}}}(),function(){"use strict"
var e=function(e,t){this.viewer=e,this.options=t}
e.prototype.load=function(){return!0},e.prototype.unload=function(){return!0},e.prototype.getState=function(e){},e.prototype.restoreState=function(e,t){return!0},Autodesk.Viewing.Extension=e}(),function(){"use strict"
var e=function(){function e(e,t){return n.hasOwnProperty(e)?!1:(n[e]=t,!0)}function t(e){return n.hasOwnProperty(e)?n[e]:null}function i(e){return n.hasOwnProperty(e)?(delete n[e],!0):!1}var n={}
return{registerExtension:e,getExtension:t,unregisterExtension:i}},t=new e,i=function(){}
i.prototype={loadExtension:function(e,i){this.loadedExtensions||(this.loadedExtensions={})
var n=!1
if(this.getExtension(e))stderr("Extension already loaded: "+e)
else{var o=t.getExtension(e)
if(o){var r=new o(this,i)
n=r.load(),n&&(this.loadedExtensions[e]=r,stderr("Extension loaded: "+e))}else stderr("Extension not found: "+e)}return n},getExtension:function(e){return this.loadedExtensions&&e in this.loadedExtensions?this.loadedExtensions[e]:null},unloadExtension:function(e){var t=!1,i=this.getExtension(e)
return i?(t=i.unload(),stderr("Extension unloaded: "+e),delete this.loadedExtensions[e]):stderr("Extension not found: "+e),t},apply:function(e){var t=i.prototype
e.loadExtension=t.loadExtension,e.getExtension=t.getExtension,e.unloadExtension=t.unloadExtension}},Autodesk.Viewing.theExtensionManager=t,Autodesk.Viewing.ExtensionMixin=i}(),function(){"use strict"
var e=Autodesk.Viewing,t=Autodesk.Viewing.Private
e.ESCAPE_EVENT="escape",e.PROGRESS_UPDATE_EVENT="progress",e.FULLSCREEN_MODE_EVENT="fullScreenMode",e.NAVIGATION_MODE_CHANGED_EVENT="navmode",e.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored",e.VIEWER_RESIZE_EVENT="viewerResize",e.VIEWER_UNINITIALIZED="viewerUninitialized",e.MODEL_ROOT_LOADED_EVENT="svfLoaded",e.GEOMETRY_LOADED_EVENT="geometryLoaded",e.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded",e.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable",e.SELECTION_CHANGED_EVENT="selection",e.ISOLATE_EVENT="isolate",e.HIDE_EVENT="hide",e.SHOW_EVENT="show",e.HIGHLIGHT_EVENT="highlight",e.CAMERA_CHANGE_EVENT="cameraChanged",e.EXPLODE_CHANGE_EVENT="explodeChanged",e.CUTPLANES_CHANGE_EVENT="cutplanesChanged",e.TOOL_CHANGE_EVENT="toolChanged",e.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged",e.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility",e.RESET_EVENT="reset",e.ANIMATION_READY_EVENT="animationReady",e.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7}
var i=isIOSDevice()||isAndroidDevice()
e.DefaultSettings={ambientShadows:!0,antialiasing:!i,groundShadow:!0,groundReflection:!1,progressiveRendering:!0,environmentMap:!1,openPropertiesOnSelect:!1,ghosting:!0,viewCube:!i,lineRendering:!0,lightPreset:t.DefaultLightPreset,backgroundColorPreset:null,reverseMouseZoomDir:!1,reverseHorizontalLookDirection:!1,reverseVerticalLookDirection:!1,alwaysUsePivot:!1,zoomTowardsPivot:!1,orbitPastWorldPoles:!0,leftHandedMouseSetup:!1,clickToSetCOI:!1,optimizeNavigation:i,fusionOrbit:!0,fusionOrbitConstrained:!0,useFirstPersonNav:!1,envMapBackground:!1,renderPrism:!0}
var n=function(e,i){if(this.clientContainer=e,this.container=document.createElement("div"),this.container.className="adsk-viewing-viewer",this.container.style.height="100%",this.container.style.width="100%",this.container.style.overflow="hidden",this.container.classList.add(isTouchDevice()?"touch":"notouch"),this.clientContainer.appendChild(this.container),this.config=i,this.contextMenu=null,this.contextMenuCallbacks={},this.__firefoxLMBfix=!1,this.started=!1,"CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]"
this.canvasWrap=document.createElement("div"),this.canvasWrap.classList.add("canvas-wrap"),this.canvas=document.createElement("canvas"),this.canvas.tabIndex=0,this.canvasWrap.appendChild(this.canvas),this.container.appendChild(this.canvasWrap),this.canvas.viewer=this,this.running=!1,this._pushedTool="",this._defaultNavigationTool="",this.stats={category:"misc_stats",explode_count:0,get_props_count:0,isolate_count:0},this.prefs=new t.Preferences(this,"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.")}
n.prototype.constructor=n,e.EventDispatcher.prototype.apply(n.prototype),e.ScreenModeMixin.prototype.apply(n.prototype),e.ExtensionMixin.prototype.apply(n.prototype),n.ScreenMode=e.ScreenMode,n.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"],offObject:["deselectAll"]},clickShift:{onObject:["selectToggle"],offObject:["deselectAll"]},disableSpinner:!1,disableMouseWheel:!1,disableTwoFingerSwipe:!1},n.prototype.start=function(){if(this.started)return 0
var e=this.initialize()
if(0===e&&(this.started=!0,this.config&&this.config.hasOwnProperty("extensions")))for(var t=this.config.extensions,i=0;i<t.length;++i)this.loadExtension(t[i],this.config)
return e},n.prototype.registerUniversalHotkeys=function(){var t,i,n,o=this,r=e.theHotkeyManager.KEYCODES
t=function(){return o.navigation.setRequestFitToView(!0),!0},e.theHotkeyManager.pushHotkeys("Autodesk.FitToView",[{keycodes:[r.f],onPress:t}]),t=function(){return o.navigation.setRequestHomeView(!0),!0},e.theHotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[r.h],onPress:t},{keycodes:[r.HOME],onPress:t}]),i=function(){return o.objectContextMenu&&o.objectContextMenu.hide()?!0:(o.fireEvent({type:e.ESCAPE_EVENT}),!0)},e.theHotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[r.ESCAPE],onRelease:i}]),t=function(){return n=o.getActiveNavigationTool(),o.setActiveNavigationTool("pan")},i=function(){return o.setActiveNavigationTool(n)}
var a=[{keycodes:[r.SHIFT],onPress:t,onRelease:i},{keycodes:[r.SPACE],onPress:t,onRelease:i}]
e.theHotkeyManager.pushHotkeys("Autodesk.Pan",a,{tryUntilSuccess:!0})},n.prototype.createControls=function(){var t=this,i=t.impl
return t.navigation=new e.Navigation(i.camera),t.__initAutoCam(i),t.utilities=new e.ViewingUtilities(i,t.autocam,t.navigation),t.clickHandler=new e.DefaultHandler(i,t.navigation,t.utilities),t.toolController=new e.ToolController(i,t,t.autocam,t.utilities,t.clickHandler),t.toolController.registerTool(new e.GestureHandler(t)),t.toolController.registerTool(e.theHotkeyManager),t.toolController.activateTool(e.theHotkeyManager.getName()),t.registerUniversalHotkeys(),t.toolController.registerTool(new e.OrbitDollyPanTool(i,t)),t.toolController.activateTool("gestures"),t.toolController},n.prototype.initialize=function(){var i=detectWebGL()
if(0>=i)return-1===i?e.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:e.ErrorCodes.BROWSER_WEBGL_DISABLED
var o=this
this.onResizeCallback=function(e){o.resize()},window.addEventListener("resize",this.onResizeCallback,!1),this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0),this.initContextMenu(),this.localize()
var r=this.getDimensions()
this.canvas.width=r.width,this.canvas.height=r.height,isIOSDevice()&&window.devicePixelRatio&&(this.canvas.width/=window.devicePixelRatio,this.canvas.height/=window.devicePixelRatio),this.impl=new t.Viewer3DImpl(this.canvas,this),this.impl.controls=this.createControls(),this.setDefaultNavigationTool("orbit"),this.model=null,this.impl.controls&&this.impl.controls.setAutocam(this.autocam)
var a=this.config&&this.config.canvasConfig?this.config.canvasConfig:n.kDefaultCanvasConfig
if(this.setCanvasClickBehavior(a),this.loader=document.createElement("div"),this.loader.id="loader",this.loader.className="spinner",this.container.appendChild(this.loader),!a.disableSpinner)for(var s=1;3>=s;s++){var l=document.createElement("div")
l.className="bounce"+s,this.loader.appendChild(l)}return this.initSettings(),this.viewerState=new t.ViewerState(this),this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run(),window.NOP_VIEWER=this,0},n.prototype.setUp=function(e){if(this.config=e,this.config&&this.config.hasOwnProperty("extensions"))for(var t=this.config.extensions,i=0;i<t.length;++i)this.loadExtension(t[i],this.config)
var o=this.config&&this.config.canvasConfig?this.config.canvasConfig:n.kDefaultCanvasConfig
this.setCanvasClickBehavior(o)},n.prototype.tearDown=function(){if(this.clearSelection(),this.loadedExtensions){for(var e in this.loadedExtensions)try{this.unloadExtension(e)}catch(i){stderr("Failed to unload extension: "+e),console.log("  error: "+i.message),console.error("  stack:\n"+i.stack)
var n=t.logger
n&&n.log({category:"error_unload_extension",extensionId:e,error_message:i.message,call_stack:i.stack})}this.loadedExtensions=null}this.__logStats(),this.loader.style.display="block",this.model=null,this.impl.unloadCurrentModel()},n.prototype.run=function(){this.running||(this.resize(),this.running=!0,this.impl.run())},n.prototype.localize=function(){e.i18n.localize()},n.prototype.__logStats=function(e){var i=t.logger
i&&(this.stats.explode_count||this.stats.get_props_count||this.stats.isolate_count)&&(i.log(this.stats,e),this.stats.explode_count=0,this.stats.get_props_count=0,this.stats.isolate_count=0)},n.prototype.__initAutoCam=function(e){function t(e){n.autocamCamera.isPerspective!==o.isPerspective&&(n.autocamCamera.isPerspective?n.navigation.toPerspective():n.navigation.toOrthographic()),n.navigation.setVerticalFov(n.autocamCamera.fov,!1),n.navigation.setView(n.autocamCamera.position,n.autocamCamera.target),n.navigation.setPivotPoint(n.autocamCamera.pivot),n.navigation.setCameraUpVector(n.autocamCamera.up),e&&n.navigation.setWorldUpVector(n.autocamCamera.worldup),n.impl.syncCamera(e)}function i(e){n.utilities?n.utilities.pivotActive(e,!1):n.impl.controls.pivotActive(e,!1)}var n=this,o=e.camera
o.pivot||(o.pivot=new THREE.Vector3(0,0,0)),o.target||(o.target=new THREE.Vector3(0,0,0)),o.worldup||(o.worldup=o.up.clone()),n.autocamCamera=o.clone(),n.autocamCamera.target=o.target.clone(),n.autocamCamera.pivot=o.pivot.clone(),n.autocamCamera.worldup=o.worldup.clone(),n.autocam=new Autocam(n.autocamCamera,n.navigation),n.autocam.cameraChangedCallback=t,n.autocam.pivotDisplayCallback=i,n.autocam.canvas=n.canvas,n.addEventListener("cameraChanged",function(e){var t=e.camera
n.autocam.sync(t)}),n.autocam.sync(o)},n.prototype.uninitialize=function(i){window.removeEventListener("resize",this.onResizeCallback,!1),this.onResizeCallback=null,this.canvas.parentNode.removeChild(this.canvas),this.canvas.viewer=null,this.canvas=null,this.canvasWrap=null,this.viewerState=null,this.__logStats()
var n=t.logger
n&&n.log({category:"viewer_destroy"},!0),this.toolController&&(this.toolController.uninitialize(),this.toolController=null,this.clickHandler=null,this.utilities=null),this.navigation&&(this.navigation.uninitialize(),this.navigation=null),this.impl&&(this.impl.dtor(),this.impl=null),this.loader=null,this.model=null,this.prefs=null,this.autocam.dtor(),this.autocam=null,this.autocamCamera=null,e.theHotkeyManager.popHotkeys("Autodesk.FitToView"),e.theHotkeyManager.popHotkeys("Autodesk.Home"),e.theHotkeyManager.popHotkeys("Autodesk.Escape"),e.theHotkeyManager.popHotkeys("Autodesk.Pan"),e.theHotkeyManager.popHotkeys("Autodesk.Orbit"),this.onDefaultContextMenu&&(this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1),this.onDefaultContextMenu=null),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null),this.clientContainer=null,this.config=null,this.listeners={},this.contextMenu=null,this.contextMenuCallbacks=null,this.fireEvent(e.VIEWER_UNINITIALIZED),this.listeners={},stderr("viewer destroy")},n.prototype.finish=function(){this.tearDown(),this.uninitialize()},n.prototype.load=function(e,t,i,n){var o={ids:null,sharedPropertyDbPath:t}
return this.loadModel(e,o,i,n)},n.prototype.loadModel=function(t,i,n,o){function r(){if(c.model.is2d())e.theHotkeyManager.popHotkeys("Autodesk.Orbit")
else{var t,i=function(){return t=c.getActiveNavigationTool(),c.setActiveNavigationTool("orbit")},n=function(){return c.setActiveNavigationTool(t)},o=[{keycodes:[e.theHotkeyManager.KEYCODES.ALT],onPress:i,onRelease:n}]
e.theHotkeyManager.pushHotkeys("Autodesk.Orbit",o,{tryUntilSuccess:!0})}}function a(e){c.model=e,c.impl.addModel(c.model),c.loader.style.display="None",c.model.is2d()&&c.activateLayerState("Initial"),r(),n&&n()}function s(e,t,i,n){c.loader.style.display="None",o&&o(e,t,i,n)}function l(){c.impl.needsRender=!0,c.removeEventListener(e.GEOMETRY_LOADED_EVENT,l)}var c=this
i=i||{},this.addEventListener(e.GEOMETRY_LOADED_EVENT,l)
var u,d=t.toLowerCase().match(/\.([a-z0-9]+$)/),h=d?d[1]:null
return u=i&&i.fileLoader?i.fileLoader:e.FileLoaderManager.getFileLoaderForExtension(h),new u(this.impl).loadFile(t,i,a,s)},n.prototype.getDimensions=function(){if(this.container){var t={}
return this.getScreenMode()===e.ScreenMode.kFullScreen?(t.width=screen.width,t.height=screen.height):t=this.container.getBoundingClientRect(),{width:t.width,height:t.height}}return null},n.prototype.resize=function(){return this.impl.resize(this.container.clientWidth,this.container.clientHeight)},n.prototype.getCamera=function(){return this.impl.camera},n.prototype.getState=function(e){return this.viewerState.getState(e)},n.prototype.restoreState=function(t,i,n){var o=this.viewerState.restoreState(t,i,n)
return o&&this.fireEvent({type:e.VIEWER_STATE_RESTORED_EVENT,value:o}),o},n.prototype.setViewFromArray=function(e,t){this.setActiveNavigationTool("orbit")
var i=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0},n={position:new THREE.Vector3(e[0]-i.x,e[1]-i.y,e[2]-i.z),target:new THREE.Vector3(e[3]-i.x,e[4]-i.y,e[5]-i.z),up:new THREE.Vector3(e[6],e[7],e[8]),aspect:e[9],fov:THREE.Math.radToDeg(e[10]),orthoScale:e[11],isPerspective:!e[12]}
this.impl.setViewFromCamera(n)},n.prototype.setViewFromViewBox=function(e,t){var i=this.model
if(i&&!i.is2d())return void console.warn("Viewer3D.setViewFromViewBox is not applicable to 3D")
if(t&&t.length){var n,o=i.getData().metadata,r=o.views
for(n=0;n<r.length&&r[n].name!=t;n++);if(n<r.length){var a=r[n].layer_state
a&&this.activateLayerState(a)}}this.impl.setViewFromViewBox(this.model,e,t,!1)},n.prototype.activateLayerState=function(t){if(t&&t.length){var i=this.model.getData().metadata,n=i.layer_states
if(!n)return
var o
for(o=0;o<n.length&&n[o].name!=t;o++);if(o<n.length){var r=n[o],a=r.visible_layers,s={}
if(a&&0<a.length)for(var l=0;l<a.length;l++)s[a[l]]=1
var c=[],u=[]
for(var d in i.layers){var h=i.layers[d].name
1===s[h]?c.push(d):u.push(d)}this.impl.setLayerVisible(c,!0),this.impl.setLayerVisible(u,!1),this.fireEvent({type:e.LAYER_VISIBILITY_CHANGED_EVENT})}}},n.prototype.getLayerStates=function(){function e(e,t){var i=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t)
if(i.length!==n.length)return!1
for(var o=0;o<i.length;++o){var r=i[o]
if(e[r]!==t[r])return!1}return!0}var t=this.model,i=t?t.getData().metadata:null,n=i?i.layers:null,o=i?i.layer_states:null
if(!n||!o)return null
var r,a={},s={}
for(var l in n)if(n.hasOwnProperty(l)){var c=parseInt(l),u=n[l]
r="string"==typeof u?u:u.name,a[r]=!0,this.impl.isLayerVisible(c)&&(s[r]=!0)}var d,h,p=[]
for(d=0;d<o.length;++d){var f=o[d],m=f.visible_layers,v={}
if(!f.hidden){if(m&&0<m.length)for(h=0;h<m.length;++h)r=m[h],a.hasOwnProperty(r)&&(v[r]=!0)
p.push({name:f.name,description:f.description,active:e(s,v)})}}return 0<p.length?p:null},n.prototype.setViewFromFile=function(){this.setActiveNavigationTool(),this.impl.setViewFromFile(this.model)},n.prototype.getProperties=function(t,i,n){this.stats.get_props_count++,this.model?this.model.getProperties(t,i,n):n&&n(e.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist")},n.prototype.getObjectTree=function(t,i){this.model?this.model.getObjectTree(t,i):i&&i(e.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist")},n.prototype.setCanvasClickBehavior=function(e){if(this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(e),this.clickHandler&&this.clickHandler.setClickBehavior(e),e&&e.disableMouseWheel&&this.toolController.setMouseWheelInputEnabled(!1),e&&e.disableTwoFingerSwipe){var t=this.toolController.getTool("gestures")
t&&t.disableTwoFingerSwipe()}},n.prototype.search=function(t,i,n,o){this.searchText=t,this.model?this.model.search(t,i,n,o):n&&n(e.ErrorCodes.BAD_DATA,"Search failed since model does not exist")},n.prototype.getHiddenNodes=function(){return this.impl.visibilityManager.getHiddenNodes()},n.prototype.getIsolatedNodes=function(){return this.model&&this.model.is2d()?(console.warn("Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes()},n.prototype.isolate=function(e){if(this.model&&this.model.is2d())return void console.warn("Viewer3D.isolate is not yet implemented for 2D")
var t=this
this.model.getObjectTree(function(){t.stats.isolate_count++,t.impl.visibilityManager.isolate(e)})},n.prototype.isolateById=function(e){return console.warn("isolateById() is deprecated. Use isolate() instead."),this.isolate(e)},n.prototype.setBackgroundColor=function(e,t,i,n,o,r){this.impl.setClearColors(e,t,i,n,o,r)},n.prototype.toggleSelect=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.toggleSelect is not yet implemented for 2D"):void this.impl.selector.toggleSelection(e)},n.prototype.select=function(e){"number"==typeof e&&(e=[e]),this.impl.selector.setSelection(e)},n.prototype.clearSelection=function(){this.impl.selector.clearSelection()},n.prototype.getSelectionVisibility=function(){return this.impl.selector.getSelectionVisibility()},n.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()},n.prototype.setSelectionMode=function(e){this.impl.selector.setSelectionMode(e)},n.prototype.getSelection=function(){return this.impl.selector.getSelection()},n.prototype.hide=function(e){if(this.model&&this.model.is2d())return void console.warn("Viewer3D.hide is not yet implemented for 2D")
var i=t.logger
i&&i.log({category:"hide"}),this.impl.visibilityManager.hide(e)},n.prototype.hideById=function(e){this.hide(e)},n.prototype.show=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.show is not yet implemented for 2D"):void this.impl.visibilityManager.show(e)},n.prototype.showAll=function(){this.impl.visibilityManager.isolate(),this.model.is2d()&&this.setLayerVisible(null,!0)},n.prototype.toggleVisibility=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.toggleVisibility is not yet implemented for 2D"):void this.impl.visibilityManager.toggleVisibility(e)},n.prototype.areAllVisible=function(){return this.impl.isWholeModelVisible(this.model)},n.prototype.explode=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.explode is not applicable to 2D"):(this.stats.explode_count++,void this.impl.explode(e))},n.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(console.warn("Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()},n.prototype.setQualityLevel=function(e,t){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set("ambientShadows",e),this.prefs.set("antialiasing",t),void this.impl.togglePostProcess(e,t))},n.prototype.setGhosting=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGhosting is not applicable to 2D"):(this.prefs.set("ghosting",e),void this.impl.toggleGhosting(e))},n.prototype.setGroundShadow=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGroundShadow is not applicable to 2D"):(this.prefs.set("groundShadow",e),void this.impl.toggleGroundShadow(e))},n.prototype.setGroundReflection=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGroundReflection is not applicable to 2D"):(this.prefs.set("groundReflection",e),void this.impl.toggleGroundReflection(e))},n.prototype.setEnvMapBackground=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setEnvMapBackground is not applicable to 2D"):(this.prefs.set("envMapBackground",e),void this.impl.toggleEnvMapBackground(e))},n.prototype.setRenderPrism=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setRenderPrism is not applicable to 2D"):(this.prefs.set("renderPrism",e),void this.impl.toggleRenderPrism(e))},n.prototype.setProgressiveRendering=function(e){this.prefs.set("progressiveRendering",e),this.impl.toggleProgressive(e)},n.prototype.setOptimizeNavigation=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setOptimizeNaviation is not applicable to 2D"):(this.prefs.set("optimizeNavigation",e),void this.impl.setOptimizeNavigation(e))},n.prototype.setActiveNavigationTool=function(i){if(i===this._pushedTool||!i&&!this._pushedTool)return!0
if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1
this._pushedTool=null
var n=t.logger
n&&n.log({category:"tool_changed",name:i})}var o=!i||i===this.getDefaultNavigationToolName()
return o&&null===this._pushedTool?(this.fireEvent({type:e.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),!0):this.impl.controls.activateTool(i)?(this._pushedTool=i,this.fireEvent({type:e.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0):!1},n.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool},n.prototype.setDefaultNavigationTool=function(e){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool),this._pushedTool&&this.impl.controls.deactivateTool(this._pushedTool),this.impl.controls.activateTool(e),this._defaultNavigationTool=e,this._pushedTool&&this.impl.controls.activateTool(this._pushedTool)},n.prototype.getDefaultNavigationToolName=function(){return this._defaultNavigationTool},n.prototype.getFOV=function(){return this.navigation.getVerticalFov()},n.prototype.setFOV=function(e){this.navigation.setVerticalFov(e,!0)},n.prototype.getFocalLength=function(){return this.navigation.getFocalLength()},n.prototype.setFocalLength=function(e){this.navigation.setFocalLength(e,!0)},n.prototype.hideLines=function(t){function i(){n.impl.hideLines(t),n.removeEventListener(e.GEOMETRY_LOADED_EVENT,i)}this.prefs.set("lineRendering",!t)
var n=this
this.impl.hideLines(t)||this.addEventListener(e.GEOMETRY_LOADED_EVENT,i)},n.prototype.applyCamera=function(e,t){this.impl.setViewFromCamera(e,!0),t&&this.fitToView()},n.prototype.fitToView=function(t){var i=this,n=!0,o=i.model,r=function(){var s=null
if(Array.isArray(t)&&t.length>0){for(var l=new THREE.Box3,c=new THREE.Box3,u=o.getData().instanceTree,d=o.getFragmentList(),h=0;h<t.length;h++)u.enumNodeFragments(t[h],function(e){d.getWorldBounds(e,c),l.union(c)},!0)
l.empty()||(s=l)}return(!s||s.empty())&&(s=i.impl.getFitBounds()),i.navigation.fitBounds(!1,s),i.removeEventListener(e.OBJECT_TREE_CREATED_EVENT,a),i.removeEventListener(e.GEOMETRY_LOADED_EVENT,r),n},a=function(){o&&o.isLoadDone()?r():(n=!1,i.addEventListener(e.GEOMETRY_LOADED_EVENT,r))},s=o.getData().propertydb,l=s&&s.attrs.length>0
!o.is2d()&&l&&null!==t&&void 0!==t?o&&o.isObjectTreeCreated()?a():(n=!1,this.addEventListener(e.OBJECT_TREE_CREATED_EVENT,a)):this.navigation.fitBounds(!1,this.impl.getFitBounds(!0))},n.prototype.setClickConfig=function(e,t,i){var n=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior()
if(e in n){var o=n[e]
if(t in o)return o[t]=i,!0}return!1},n.prototype.getClickConfig=function(e,t){var i=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior()
if(e in i){var n=i[e]
if(t in n)return n[t]}return null},n.prototype.setClickToSetCOI=function(e,t){t!==!1&&this.prefs.set("clickToSetCOI",e)
var i=this.getClickConfig("click","onObject")
e?-1===i.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):i.indexOf("setCOI")>=0&&this.setClickConfig("click","onObject",["selectOnly"])},n.prototype.initSettings=function(){this.prefs.load(e.DefaultSettings),this.prefs.tag("3d"),this.prefs.tag("2d"),this.prefs.untag("2d",["viewCube","alwaysUsePivot","zoomTowardsPivot","reverseHorizontalLookDirection","reverseVerticalLookDirection","orbitPastWorldPoles","clickToSetCOI","ghosting","optimizeNavigation","ambientShadows","antialiasing","groundShadow","groundReflection","lineRendering","lightPreset","envMapBackground","renderPrism"]),this.setQualityLevel(this.prefs.ambientShadows,this.prefs.antialiasing),this.setGroundShadow(this.prefs.groundShadow),this.setGroundReflection(this.prefs.groundReflection),this.setGhosting(this.prefs.ghosting),this.setProgressiveRendering(this.prefs.progressiveRendering),this.setClickToSetCOI(this.prefs.clickToSetCOI),this.setOptimizeNavigation(this.prefs.optimizeNavigation),this.hideLines(!this.prefs.lineRendering),this.setEnvMapBackground(this.prefs.envMapBackground),this.setRenderPrism(this.prefs.renderPrism),this.navigation.setUsePivotAlways(this.prefs.alwaysUsePivot),this.navigation.setReverseZoomDirection(this.prefs.reverseMouseZoomDir),this.navigation.setReverseHorizontalLookDirection(this.prefs.reverseHorizontalLookDirection),this.navigation.setReverseVerticalLookDirection(this.prefs.reverseVerticalLookDirection),this.navigation.setZoomTowardsPivot(this.prefs.zoomTowardsPivot),this.navigation.setOrbitPastWorldPoles(this.prefs.orbitPastWorldPoles),this.navigation.setUseLeftHandedInput(this.prefs.leftHandedMouseSetup)
var t=this.prefs.backgroundColorPreset
if(t)try{var i=JSON.parse(t)
this.impl.setClearColors(i[0],i[1],i[2],i[3],i[4],i[5])}catch(n){this.prefs.set("backgroundColorPreset",null)}var o=this.prefs.lightPreset
this.impl.setLightPreset(o)},n.prototype.setLightPreset=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setLightPreset is not applicable to 2D"):(this.prefs.set("lightPreset",e),void this.impl.setLightPreset(e))},n.prototype.setUsePivotAlways=function(e){this.prefs.set("alwaysUsePivot",e),this.navigation.setUsePivotAlways(e)},n.prototype.setReverseZoomDirection=function(e){this.prefs.set("reverseMouseZoomDir",e),this.navigation.setReverseZoomDirection(e)},n.prototype.setReverseHorizontalLookDirection=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):(this.prefs.set("reverseHorizontalLookDirection",e),void this.navigation.setReverseHorizontalLookDirection(e))},n.prototype.setReverseVerticalLookDirection=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):(this.prefs.set("reverseVerticalLookDirection",e),void this.navigation.setReverseVerticalLookDirection(e))},n.prototype.setZoomTowardsPivot=function(e){this.prefs.set("zoomTowardsPivot",e),this.navigation.setZoomTowardsPivot(e)},n.prototype.setOrbitPastWorldPoles=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):(this.prefs.set("orbitPastWorldPoles",e),void this.navigation.setOrbitPastWorldPoles(e))},n.prototype.setUseLeftHandedInput=function(e){this.prefs.set("leftHandedMouseSetup",e),this.navigation.setUseLeftHandedInput(e)},n.prototype.setLayerVisible=function(t,i,n){function o(e,t){var i=[]
if(e.isLayer)i.push(e.index)
else for(var n=e.children,r=0;r<n.length;++r)i=i.concat(o(n[r]))
return i}if(this.model&&!this.model.is2d())return void console.warn("Viewer3D.setLayerVisible is not yet implemented for 3D")
var r=this,a=r.model.getLayersRoot()
if(a&&0!==a.childCount){null===t&&(t=[a]),Array.isArray(t)||(t=[t]),n&&(r.impl.setLayerVisible(o(a),!1),i=!0)
for(var s=[],l=0;l<t.length;++l)s=s.concat(o(t[l]))
r.impl.setLayerVisible(s,i),r.fireEvent({type:e.LAYER_VISIBILITY_CHANGED_EVENT})}},n.prototype.isLayerVisible=function(e){return this.model&&!this.model.is2d()?(console.warn("Viewer3D.isLayerVisible is not yet implemented for 3D"),!1):!!(e&&e.isLayer&&this.impl.isLayerVisible(e.index))},n.prototype.anyLayerHidden=function(){function e(i){if(i.isLayer)return!t.impl.isLayerVisible(i.index)
for(var n=i.children,o=0;o<n.length;++o)if(e(n[o]))return!0
return!1}if(this.model&&!this.model.is2d())return console.warn("Viewer3D.anyLayerHidden is not yet implemented for 3D"),!1
var t=this,i=t.model.getLayersRoot()
return!(!i||!e(i))},n.prototype.setGroundShadowColor=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGroundShadowColor is not applicable to 2D"):void this.impl.setGroundShadowColor(e)},n.prototype.setGroundShadowAlpha=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGroundShadowAlpha is not applicable to 2D"):void this.impl.setGroundShadowAlpha(e)},n.prototype.setGroundReflectionColor=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGroundReflectionColor is not applicable to 2D"):void this.impl.setGroundReflectionColor(e)},n.prototype.setGroundReflectionAlpha=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):void this.impl.setGroundReflectionAlpha(e)},n.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(console.warn("Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()},n.prototype.setCutPlanes=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.getCutPlanes is not applicable to 2D"):void this.impl.setCutPlanes(e)},n.prototype.setCutPlanesOutlineColor=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setCutPlanesOutlineColor is not applicable to 2D"):void this.impl.setCutPlanesOutlineColor(e)},n.prototype.setCutPlanesOutlineThickness=function(e){return this.model&&this.model.is2d()?void console.warn("Viewer3D.setCutPlanesOutlineThickness is not applicable to 2D"):void this.impl.setCutPlanesOutlineThickness(e)},n.prototype.getScreenShot=function(e,t,i){return this.impl.getScreenShot(e,t,i)},n.prototype.setContextMenu=function(e){this.contextMenu&&this.contextMenu.hide(),this.contextMenu=e},n.prototype.triggerContextMenu=function(e){return this.config&&this.config.onTriggerContextMenuCallback&&this.config.onTriggerContextMenuCallback(e),this.contextMenu?(this.contextMenu.show(e),!0):!1},n.prototype.triggerSelectionChanged=function(e){this.config&&this.config.onTriggerSelectionChangedCallback&&this.config.onTriggerSelectionChangedCallback(e)},n.prototype.triggerDoubleTapCallback=function(e){this.config&&this.config.onTriggerDoubleTapCallback&&this.config.onTriggerDoubleTapCallback(e)},n.prototype.triggerSingleTapCallback=function(e){this.config&&this.config.onTriggerSingleTapCallback&&this.config.onTriggerSingleTapCallback(e)},n.prototype.initContextMenu=function(){function e(e){var t=e.button
"buttons"in e&&(!i.__firefoxLMBfix||1&e.buttons?2===t&&1&e.buttons&&(t=0,i.__firefoxLMBfix=!0):(i.__firefoxLMBfix=!1,t=0))
var n=i.navigation?i.navigation.getUseLeftHandedInput():!1,o=n?0:2
return t===o?!0:!1}var t=!this.config||(this.config.hasOwnProperty("disableBrowserContextMenu")?this.config.disableBrowserContextMenu:!0)
t&&(this.onDefaultContextMenu=function(e){e.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1))
var i=this,n=this.canvas||this.container
n.addEventListener("mousedown",function(t){e(t)&&(i.startX=t.clientX,i.startY=t.clientY)}),n.addEventListener("mouseup",function(t){return e(t)&&t.clientX===i.startX&&t.clientY===i.startY&&i.triggerContextMenu(t),!0},!1)},n.prototype.registerContextMenuCallback=function(e,t){this.contextMenuCallbacks[e]=t},n.prototype.unregisterContextMenuCallback=function(e){return e in this.contextMenuCallbacks?(delete this.contextMenuCallbacks[e],!0):!1},n.prototype.runContextMenuCallbacks=function(e,t){for(var i in this.contextMenuCallbacks)this.contextMenuCallbacks.hasOwnProperty(i)&&this.contextMenuCallbacks[i](e,t)},n.prototype.playAnimation=function(e){var t=this.impl.keyFrameAnimator
t&&t.play(0,e)},n.prototype.joinLiveReview=function(e){this.impl.joinLiveReviewSession(e)},n.prototype.leaveLiveReview=function(){this.impl.leaveLiveReviewSession()},n.prototype.getAttributeToIdMap=function(t,i){this.model?this.model.getAttributeToIdMap(t,i):i&&i(e.ErrorCodes.UNKNOWN_FAILURE,"Function getAttributeToIdMap failed")},Autodesk.Viewing.Viewer3D=n}(),Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,RTC_ERROR:11},AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.InitParametersSetting=function(){function e(e){var e=e||{}
this.params={canvas:null,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1,depth:!1,devicePixelRatio:null}
for(var t in e)this.params.hasOwnProperty(t)&&(this.params[t]=e[t])}var t,i={name:"InitParameters",getInstance:function(i){return void 0===t&&(t=new e(i)),t}}
return i}(),function(){"use strict"
function e(e,t,i,o){e.application="autodesk"
var r=new XMLHttpRequest
r.open("POST",ACM_SESSION_URL,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Bearer "+t),r.onload=function(){200===r.status&&(n.ACM_SESSION_ID=JSON.parse(r.responseText).acmsession),o()},r.onerror=i,r.ontimeout=i,r.send(JSON.stringify(e)),delete e.application}function t(e){var t={}
for(var i in e)-1!=i.indexOf("x-ads-acm")&&(t[i]=e[i])
return t}function i(e){for(var t in e)if("oauth2AccessToken"===t)return e[t]
return null}var n=Autodesk.Viewing
n.HTTP_REQUEST_HEADERS={},n.ACM_SESSION_ID=void 0
var o=function(e,t){function i(e){if(e){var t=e.children?e.children.length:0
if("geometry"===e.type&&t){for(var n=0,o=0;t>o;o++){var a=e.children[o]
a&&"view"===a.type&&(r.myViewGeometry[a.guid]=e,n++)}r.myNumViews[e.guid]=n}else if("application/autodesk-db"==e.mime&&e.urn)0===e.urn.indexOf("urn:adsk.objects:os.object")?r.myPropertyDb=e.urn.substr(0,e.urn.lastIndexOf("%2F")+3):r.myPropertyDb=e.urn.substr(0,e.urn.lastIndexOf("/")+1)
else if(t>0)for(var o=0;t>o;o++)i(e.children[o])}}function n(e,t){r.parents[e]=t}function o(e,t,i){if(e){var n=e.guid
if(n){i.apply(this,[n,t])
for(var r=e.children?e.children.length:0,a=0;r>a;a++)o(e.children[a],n,i)}}}this.myPath=t,this.myData=e,this.myViewGeometry={},this.myNumViews={},this.myPropertyDb=null
var r=this
i(e),this.parents={},o(this.myData,null,n)}
o.prototype.constructor=o,o.load=function(r,a,s,l){function c(e){if(-1===e.indexOf("urn:")){if(-1!==e.indexOf("://"))return e
var t=e
return 0!==t.indexOf("/")&&(t="/"+t),window.location.protocol+"//"+window.location.host+t}return e}function u(e){var t=o.getSubItemsWithProperties(e.getRootItem(),{type:"folder",role:"viewable"},!0),i=t[0],n=o.getSubItemsWithProperties(i,{type:"geometry"},!0)
return n.length}function d(e,t){var i=[],n=0,o=0
t=t||"children"
var r=function(e){var a=e[t]||[],s=e.messages||[],l=s.filter(function(e){return"error"===e.type})
l.length>0&&(n+=1),"inprogress"===e.status&&(o+=1),Array.prototype.push.apply(i,s.slice(0))
for(var c=a.length;c--;r(a[c]));}
r(e)
var a="translated"
a=n>0?"failed":a,a=o>0?"processing":a
for(var s=i.length;s--;i[s].$translation=a);return i}function h(){function e(e){var t=/<[^>]*script/
if(t.test(e))return void(s&&s(n.ErrorCodes.BAD_DATA,"Malicious document content detected Abort loading"))
var r="string"==typeof e?JSON.parse(e):e,l=new o(r,i)
if(u(l)>0){var c=d(l.getRootItem())
a&&a(l,c)}else if(s){var c=d(l.getRootItem()),h=n.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT,p="No viewable content"
s(h,p,c)}}function t(e,t,i){var o=d(i)
if(s){var r="Error: "+e+" ("+t+")",a=n.Private.ErrorHandler.getErrorCode(e)
s(a,r,e,t,o)}}var i=c(r),l={headers:n.HTTP_REQUEST_HEADERS,withCredentials:!!auth}
try{n.Private.ViewingService.get(VIEWING_URL,"bubbles",i,e,t,l)}catch(h){if(s){var p="An exception occurred while loading the document",f=n.ErrorCodes.UNKNOWN_FAILURE
s(f,p,null)}}}if("function"!=typeof arguments[1]&&(console.log("Document.load called with deprecated (auth) parameter"),"function"==typeof arguments[2]&&(a=arguments[2]),"function"==typeof arguments[3]&&(s=arguments[3])),l){var p=t(l),f=i(l)
n.HTTP_REQUEST_HEADERS=p,e(p,f,s,h)}else h()},o.prototype.getFullPath=function(e){if(!e)return e
var t=e
return n.Private.offline?t=decodeURIComponent(n.Private.offlineResourcePrefix)+t.substr(t.indexOf("/")):0===e.indexOf("urn")?t=VIEWING_URL+"/items/"+e:0===e.indexOf("$file$")&&-1!==this.myPath.indexOf("/bubble.json")&&(t=this.myPath.replace("/bubble.json","")+e.replace("$file$","")),t},o.prototype.getThumbnailPath=function(e,t,i){var o=t?t:200,r=i?i:200,a=VIEWING_URL+"/thumbnails/"+this.myData.urn+"?guid="+encodeURIComponent(e.guid)+"&width="+o+"&height="+r
return n.ACM_SESSION_ID&&(a+="&acmsession="+n.ACM_SESSION_ID),a},o.prototype.getViewablePath=function(e){if("geometry"===e.type){var t=[]
if("3d"===e.role?t=o.getSubItemsWithProperties(e,{mime:"application/autodesk-svf"},!1):"2d"===e.role&&(t=o.getSubItemsWithProperties(e,{mime:"application/autodesk-f2d"},!1),0==t.length&&(t=o.getSubItemsWithProperties(e,{role:"tileRoot"},!0))),t.length>0)return this.getFullPath(t[0].urn)}else if("view"===e.type){var i=this.getViewGeometry(e)
if(i)return this.getViewablePath(i)}return""},o.prototype.getPropertyDbPath=function(){return this.myPropertyDb},o.prototype.getRootItem=function(){return this.myData},o.prototype.getPath=function(){return this.myPath},o.prototype.getItemById=function(e){function t(i){if(!i)return null
for(var n in i){var o=i[n]
if("guid"===n&&o===e)return i
if(null!==o&&"object"==typeof o){var r=t(o)
if(r)return r}}return null}return t(this.myData)},o.getSubItemsWithProperties=function(e,t,i){function n(e,t){for(var i in t)if(!(i in e)||t[i]!==e[i])return!1
return!0}var r=[]
if(!e)return[]
for(var a=e.children?e.children.length:0,s=0;a>s;s++){var l=e.children[s]
n(l,t)&&r.push(l),i&&r.push.apply(r,o.getSubItemsWithProperties(l,t,i))}return r},o.prototype.getViewGeometry=function(e){return this.myViewGeometry[e.guid]},o.prototype.getNumViews=function(e){return this.myNumViews[e.guid]||0},o.prototype.getParentId=function(e){return this.parents[e]},o.prototype.getMessages=function(e,t){var i=[]
if(!e)return i
var n=null
t&&(n=this.getRootItem().guid)
for(var o=e,r=this.parents[o];o&&(!t||r!==n);){var a=this.getItemById(o)
if(a&&a.messages)for(var s=0;s<a.messages.length;s++)i.push(a.messages[s])
o=r,r=this.parents[o]}return i},n.Document=o}(),AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.Navigation=function(e){var t=6.88,i=100,n=1e-6
this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1},this.__pivotIsSetFlag=!1,this.__fitToViewRequested=!1,this.__homeViewRequested=!1,this.__transitionActive=!1,this.__destinationView=null,this.__is2D=!1,this.__isTouchDevice=!1,this.__kEpsilon=n
var o=null,r={left:0,top:0,width:1,height:1}
this.uninitialize=function(){this.setCamera(null)},this.setCamera=function(e){e!==o&&(o=e,e&&(e.hasOwnProperty("target")||(e.target=new THREE.Vector3(0,0,0)),e.hasOwnProperty("pivot")||(e.pivot=new THREE.Vector3(0,0,0)),e.worldup=e.up.clone(),e.dirty=!0))},this.getCamera=function(){return o},this.setScreenViewport=function(e){r=e},this.getScreenViewport=function(){return r},this.__setUp=function(e){if(e&&o){var t=e.clone().normalize(),i=t.sub(o.worldup)
if(0!==i.lengthSq())return o.worldup.copy(e).normalize(),o.dirty=!0,!0}return!1},this.__getUp=function(){return o?o.worldup:new THREE.Vector3(0,1,0)},this.setView=function(e,t){o&&e&&t&&!this.__options.lockNavigation&&(o.position.copy(e),o.target.copy(t),o.dirty=!0)},this.orientCameraUp=function(){o&&!this.__options.lockNavigation&&(o.up.copy(this.getAlignedUpVector()),o.dirty=!0)},this.getPivotPoint=function(){return o?o.pivot.clone():new THREE.Vector3(0,0,0)},this.setPivotPoint=function(e){o&&e&&!this.__options.lockNavigation&&(o.pivot.copy(e),o.dirty=!0)},this.getPosition=function(){return o?o.position.clone():new THREE.Vector3(0,0,1)},this.setPosition=function(e){o&&e&&!this.__options.lockNavigation&&(o.position.copy(e),o.dirty=!0)},this.setTarget=function(e){o&&e&&!this.__options.lockNavigation&&(o.target.copy(e),o.dirty=!0)},this.getTarget=function(){return o?o.target.clone():new THREE.Vector3(0,0,0)},this.getEyeVector=function(){return o?o.target.clone().sub(o.position):new THREE.Vector3(0,0,-1)},this.getFovMin=function(){return t},this.getFovMax=function(){return i},this.isPointVisible=function(e){var t=(new THREE.Frustum).setFromMatrix(o.projectionMatrix.clone().multiply(o.matrixWorldInverse))
return t.containsPoint(e)},this.setVerticalFov=function(e,r){if((!o||o.isPerspective)&&(t>e?e=t:e>i&&(e=i),o&&!this.__options.lockNavigation)){if(Math.abs(o.fov-e)<=n)return
if(r){var a=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),s=this.getPosition(),l=this.getEyeVector(),c=THREE.Math.degToRad(o.fov),u=THREE.Math.degToRad(e),d=a?this.getPivotPlaneDistance():l.length(),h=d*Math.tan(.5*c)/Math.tan(.5*u),p=l.normalize().multiplyScalar(d-h)
this.setPosition(s.add(p)),a&&this.setTarget(this.getTarget().add(p))}o.setFov(e),o.dirty=!0}},this.computeFit=function(e,t,n,o){if(!o||o.empty())return{position:e,target:t}
var r=o.center(),a=o.size(),s=.5*Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)
if(0===s&&(s=1),!this.getIs2D()){var l=Math.max(1,.9+n/i*.5)
s*=l}var c=e.clone().sub(t).normalize(),u=s/Math.tan(THREE.Math.degToRad(.5*n))
c.multiplyScalar(u)
var d=r.clone().add(c)
return{position:d,target:r}},this.computeOrthogonalUp=function(e,t){var i=this.__getUp(),n=t.clone().sub(e)
if(0===n.lengthSq())return n.copy(i)
var o=n.clone().cross(i)
return 0===o.lengthSq()&&(i.z>i.y?n.y-=1e-4:n.z-=1e-4,o.crossVectors(n,i)),o.cross(n).normalize()},this.fitBounds=function(e,t,i){var n=this.getTarget(),r=this.getPosition()
if(this.__options.lockNavigation||!t||t.empty())return{position:r,target:n}
var a=this.getVerticalFov(),s=this.computeFit(r,n,a,t),l=i?this.computeOrthogonalUp(r,n):o.up
return e?(o.up.copy(l),this.setView(s.position,s.target)):this.setRequestTransitionWithUp(!0,s.position,s.target,a,l),this.setPivotPoint(s.target),this.setPivotSetFlag(!0),s},this.updateCamera=function(){o&&(o.updateProjectionMatrix(),this.orient(o,o.target,o.position,o.up),o.dirty=!1)},this.setCamera(e)},Autodesk.Viewing.Navigation.prototype.constructor=Autodesk.Viewing.Navigation,Autodesk.Viewing.Navigation.prototype.setIs2D=function(e){this.__is2D=!!e},Autodesk.Viewing.Navigation.prototype.getIs2D=function(){return this.__is2D},Autodesk.Viewing.Navigation.prototype.setIsTouchDevice=function(e){this.__isTouchDevice=!!e},Autodesk.Viewing.Navigation.prototype.getIsTouchDevice=function(){return this.__isTouchDevice},Autodesk.Viewing.Navigation.prototype.orient=function(){function e(){t||(t=new THREE.Matrix4,i=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3)}var t,i,n,o
return function(r,a,s,l){e()
var c=t.elements
o.subVectors(s,a).normalize(),0===o.lengthSq()&&(o.z=1),i.crossVectors(l,o).normalize(),0===i.lengthSq()&&(l.z>l.y?o.y-=1e-4:o.z+=1e-4,i.crossVectors(l,o).normalize()),n.crossVectors(o,i),c[0]=i.x,c[4]=n.x,c[8]=o.x,c[1]=i.y,c[5]=n.y,c[9]=o.y,c[2]=i.z,c[6]=n.z,c[10]=o.z,r.setRotationFromMatrix(t)}}(),Autodesk.Viewing.Navigation.prototype.fov2fl=function(e){var t=12,i=THREE.Math.degToRad(e)
return 0>=i&&(i=1e-4),Math.round(t/Math.tan(.5*i))},Autodesk.Viewing.Navigation.prototype.fl2fov=function(e){var t=12
0>=e&&(e=1e-4)
var i=2*Math.atan(t/e)
return THREE.Math.radToDeg(i)},Autodesk.Viewing.Navigation.prototype.setCameraUpVector=function(e){if(!this.__options.lockNavigation){var t=this.getCamera()
t.up.copy(e),t.dirty=!0}},Autodesk.Viewing.Navigation.prototype.getCameraUpVector=function(){var e=this.getCameraRightVector(!1),t=this.getEyeVector()
return e.cross(t).normalize()},Autodesk.Viewing.Navigation.prototype.getAlignedUpVector=function(){var e=this.getCameraRightVector(!0),t=this.getEyeVector()
return e.cross(t).normalize()},Autodesk.Viewing.Navigation.prototype.getCameraRightVector=function(e){var t=new THREE.Vector3,i=e?this.getWorldUpVector():this.getCamera().up,n=this.getEyeVector()
return t.crossVectors(n,i),0===t.lengthSq()&&(i.z>i.y?n.y-=1e-4:n.z+=1e-4,t.crossVectors(n,i)),t.normalize()},Autodesk.Viewing.Navigation.prototype.setWorldUpVector=function(e,t){this.__options.lockNavigation||(this.__setUp(e),t&&this.orientCameraUp())},Autodesk.Viewing.Navigation.prototype.getWorldUpVector=function(){return this.__getUp().clone()},Autodesk.Viewing.Navigation.prototype.getWorldRightVector=function(){var e=new THREE.Vector3
return e.copy(this.__getUp()),Math.abs(e.z)<=Math.abs(e.y)?e.set(e.y,-e.x,0):e.z>=0?e.set(e.z,0,-e.x):e.set(-e.z,0,e.x),e.normalize()},Autodesk.Viewing.Navigation.prototype.getVerticalFov=function(){return this.getCamera().fov},Autodesk.Viewing.Navigation.prototype.getHorizontalFov=function(){var e=this.getScreenViewport()
return this.getCamera().fov*(e.width/e.height)},Autodesk.Viewing.Navigation.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())},Autodesk.Viewing.Navigation.prototype.setFocalLength=function(e,t){this.setVerticalFov(this.fl2fov(e),t)},Autodesk.Viewing.Navigation.prototype.setReverseZoomDirection=function(e){this.__options.reverseDolly=!!e},Autodesk.Viewing.Navigation.prototype.setReverseHorizontalLookDirection=function(e){return this.getIs2D()?void console.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):void(this.__options.reverseHorizontalLookDirection=!!e)},Autodesk.Viewing.Navigation.prototype.setReverseVerticalLookDirection=function(e){return this.getIs2D()?void console.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):void(this.__options.reverseVerticalLookDirection=!!e)},Autodesk.Viewing.Navigation.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly},Autodesk.Viewing.Navigation.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection},Autodesk.Viewing.Navigation.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection},Autodesk.Viewing.Navigation.prototype.setZoomTowardsPivot=function(e){this.__options.dollyToPivot=!!e},Autodesk.Viewing.Navigation.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot},Autodesk.Viewing.Navigation.prototype.setOrbitPastWorldPoles=function(e){return this.getIs2D()?void console.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):void(this.__options.orbitPastPoles=!!e)},Autodesk.Viewing.Navigation.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles},Autodesk.Viewing.Navigation.prototype.setUsePivotAlways=function(e){this.__options.usePivotAlways=!!e},Autodesk.Viewing.Navigation.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways},Autodesk.Viewing.Navigation.prototype.setUseLeftHandedInput=function(e){this.__options.useLeftHandedInput=!!e},Autodesk.Viewing.Navigation.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput},Autodesk.Viewing.Navigation.prototype.setIsLocked=function(e){this.__options.lockNavigation=!!e},Autodesk.Viewing.Navigation.prototype.getIsLocked=function(){return this.__options.lockNavigation},Autodesk.Viewing.Navigation.prototype.setPivotSetFlag=function(e){this.__options.lockNavigation||(this.__pivotIsSetFlag=!!e)},Autodesk.Viewing.Navigation.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag},Autodesk.Viewing.Navigation.prototype.setRequestFitToView=function(e){this.__options.lockNavigation||(this.__fitToViewRequested=!!e)},Autodesk.Viewing.Navigation.prototype.getRequestFitToView=function(){return this.__fitToViewRequested},Autodesk.Viewing.Navigation.prototype.setRequestHomeView=function(e){this.__options.lockNavigation||(this.__homeViewRequested=!!e)},Autodesk.Viewing.Navigation.prototype.getRequestHomeView=function(){return this.__homeViewRequested},Autodesk.Viewing.Navigation.prototype.setRequestTransition=function(e,t,i,n,o){e?this.__destinationView={position:t.clone(),coi:i.clone(),fov:n,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:o}:this.__destinationView=null},Autodesk.Viewing.Navigation.prototype.setRequestTransitionWithUp=function(e,t,i,n,o,r){e?this.__destinationView={position:t.clone(),coi:i.clone(),fov:n,up:o.clone(),worldUp:r?r:this.getWorldUpVector(),reorient:!1}:this.__destinationView=null},Autodesk.Viewing.Navigation.prototype.getRequestTransition=function(){return this.__destinationView},Autodesk.Viewing.Navigation.prototype.setTransitionActive=function(e){this.__transitionActive=!!e},Autodesk.Viewing.Navigation.prototype.getTransitionActive=function(){return this.__transitionActive},Autodesk.Viewing.Navigation.prototype.getWorldSize=function(e){var t=this.getScreenViewport(),i=t.width/t.height,n=2*e*Math.tan(THREE.Math.degToRad(.5*this.getCamera().fov)),o=n*i
return new THREE.Vector2(o,n)},Autodesk.Viewing.Navigation.prototype.getWorldPoint=function(e,t){t=1-t,e=2*e-1,t=2*t-1
var i,n=this.getCamera()
n.isPerspective&&(i=new THREE.Vector3(e,t,1),i=i.unproject(n))
var o,r,a=this.getEyeVector(),s=this.getPosition()
if(!n.isPerspective||isNaN(i.x)){var l=this.getWorldSize(a.length()),c=this.getCameraRightVector(!1).multiplyScalar(.5*e*l.x),u=this.getCameraUpVector().multiplyScalar(.5*t*l.y)
o=a.clone().add(c).add(u).normalize()}else o=i.sub(s).normalize()
var d=this.getPivotPoint(),h=this.__pivotIsSetFlag&&(this.getIs2D()||n.isPerspective&&this.isPointVisible(d))
if(h){var p=o.dot(a)
r=0!==p?Math.abs(d.sub(s).dot(a))/p:d.sub(s).length()}else r=n.isPerspective?.5*(n.near+n.far):n.orthoScale
return o.multiplyScalar(r).add(s)},Autodesk.Viewing.Navigation.prototype.getPivotPlaneDistance=function(){var e=this.getPivotPoint(),t=this.getEyeVector(),i=this.getPosition()
return e.sub(i).dot(t.normalize())},Autodesk.Viewing.Navigation.prototype.panRelative=function(e,t,i){var n=this.getWorldSize(i),o=e*n.x,r=t*n.y,a=this.getCameraRightVector(!1).multiplyScalar(o),s=this.getCameraUpVector().multiplyScalar(r),l=a.add(s)
this.setView(this.getPosition().add(l),this.getTarget().add(l))},Autodesk.Viewing.Navigation.prototype.dollyFromPoint=function(e,t){if(!(Math.abs(e)<=this.__kEpsilon)){var i=this.getPosition(),n=t.clone().sub(i),o=n.length(),r=o+e,a=10*this.__kEpsilon
a>r&&(r=a)
var s=r/o
if(Math.abs(s-1)>this.__kEpsilon){n.multiplyScalar(s),n.set(-n.x,-n.y,-n.z)
var l=n.add(t),c=this.getEyeVector()
this.getCamera().isPerspective||c.multiplyScalar(s),this.setView(l,c.add(l))}}},Autodesk.Viewing.Navigation.prototype.toPerspective=function(){if(this.getIs2D())return void console.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D")
var e=this.getCamera()
this.__options.lockNavigation||e.isPerspective||(e.toPerspective(),e.dirty=!0)},Autodesk.Viewing.Navigation.prototype.toOrthographic=function(){var e=this.getCamera()
!this.__options.lockNavigation&&e.isPerspective&&(e.toOrthographic(),e.dirty=!0)},Autodesk.Viewing.Navigation.snapToAxis=function(e){var t=new THREE.Vector3(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z))
return t.x>t.y&&t.x>t.z?e.set(e.x>0?1:-1,0,0):t.y>t.x&&t.y>t.z?e.set(0,e.y>0?1:-1,0):e.set(0,0,e.z>0?1:-1),e},function(){"use strict"
var e=Autodesk.Viewing,t=Autodesk.Viewing.Private,i=function(e,t){this.appContainerId=e,this.container=document.getElementById(e),this.options=t,this.myRegisteredViewers={},this.myDocument=null,this.myCurrentViewer=null,this.urn=null,this.selectedItem=null}
i.prototype.k3D="3D",i.prototype.k2D="2D",i.prototype.finish=function(){this.myCurrentViewer&&(this.myCurrentViewer.finish(),this.myCurrentViewer=null)},i.prototype.registerViewer=function(e,t,i){i=i||{},this.options&&this.options.hasOwnProperty("disableBrowserContextMenu")&&(i.hasOwnProperty("disableBrowserContextMenu")||(i.disableBrowserContextMenu=this.options.disableBrowserContextMenu)),this.myRegisteredViewers[e]={},this.myRegisteredViewers[e]["class"]=t,this.myRegisteredViewers[e].config=i},i.prototype.getViewerClass=function(e){return this.myRegisteredViewers.hasOwnProperty(e)?this.myRegisteredViewers[e]["class"]:null},i.prototype.getViewerContainer=function(){return document.getElementById(this.appContainerId)},i.prototype.getViewer=function(e,t,i){if(e in this.myRegisteredViewers){var n,o={},r=this.myRegisteredViewers[e].config
for(n in r)r.hasOwnProperty(n)&&(o[n]=r[n])
for(n in t)if(t.hasOwnProperty(n)){var a=t[n],s=Array.isArray(a),l=o[n],c=Array.isArray(l)
s&&c?(a?s||(a=[a]):a=[],l?c||(l=[l]):l=[],o[n]=l.concat(a)):o[n]=a}var u=this.myRegisteredViewers[e]["class"]
if(this.myCurrentViewer&&this.myCurrentViewer.__proto__.constructor===u)return this.myCurrentViewer.tearDown(),this.myCurrentViewer.setUp(o),this.myCurrentViewer
this.setCurrentViewer(null)
for(var d=this.getViewerContainer();d.hasChildNodes();)d.removeChild(d.lastChild)
var h=new u(d,o),p=h.start()
if(0===p)return this.setCurrentViewer(h),h
i&&i(p,"Viewer failed to initialize")}return null},i.prototype.setCurrentViewer=function(e){this.myCurrentViewer&&this.myCurrentViewer.finish(),this.myCurrentViewer=e},i.prototype.getCurrentViewer=function(){return this.myCurrentViewer},i.prototype.loadDocument=function(i,n,o,r){var a=this
t.logger&&t.logger.log({category:"load_document",urn:0==i.indexOf("urn:")?i.substring(4):i}),e.Document.load(i,function(e,t){a.myDocument=e,a.onDocumentLoaded(e,t),n&&n(e,t)},function(e,t,i,n,r){a.onDocumentFailedToLoad(t,e,r),o&&o(e,t,i,n,r)},r)},i.prototype.onDocumentLoaded=function(e,t){console.log(e,t)},i.prototype.onDocumentFailedToLoad=function(e,t,i){console.log(e,t,i)},i.prototype.getDefaultGeometry=function(e){for(var t=0,i=e.length;i>t;++t){var n=e[t].useAsDefault
if(n===!0||"true"===n)return e[t]}return e[0]},i.prototype.selectItem=function(e,i,n){var o=this.myDocument.getViewablePath(e)
if(o){var r,a,s,l
if("geometry"===e.type&&"3d"===e.role)r=this.k3D,s=e.name,l=e
else if("view"===e.type&&"3d"===e.role)a=e,r=this.k3D,l=this.myDocument.getViewGeometry(e),l&&(s=l.name)
else if("geometry"===e.type&&"2d"===e.role){var c=Autodesk.Viewing.Document.getSubItemsWithProperties(e,{mime:"application/autodesk-f2d"},!1)
r=c.length>0?this.k3D:this.k2D,s=e.name,l=e}else"view"===e.type&&"2d"===e.role&&(a=e,r=this.k3D,l=this.myDocument.getViewGeometry(e),l&&(s=l.name))
var u=t.logger
if(u){var d=o.indexOf("urn:")
u.log({category:"load_viewable",role:e.role,type:e.type,urn:-1!==d?o.substring(d+4):o})}var h=this.myDocument.getMessages(e.guid,!0)
if(r){var p=this,f=this.myCurrentViewer&&this.urn===o,m=null
m=a&&a.camera?function(){p.myCurrentViewer.setViewFromArray(a.camera,a.name),i&&i(p.myCurrentViewer,e,h)}:a&&a.viewbox?function(){p.myCurrentViewer.setViewFromViewBox(a.viewbox,a.name),i&&i(p.myCurrentViewer,e,h)}:f?function(){p.myCurrentViewer.setViewFromFile(),i&&i(p.myCurrentViewer,e,h)}:function(){i&&i(p.myCurrentViewer,e,h)}
var v=function(e,t,i,o){n&&n(e,t,i,o,h)},g=!1
if(f)m&&m(),g=!0
else{this.urn=null
var E={defaultModelStructureTitle:s,viewableName:s}
e.hasOwnProperty("extensions")&&(E.extensions=Array.isArray(e.extensions)?e.extensions:[e.extensions])
var y=this.getViewer(r,E,n)
y&&y.load(this.myDocument.getFullPath(o),this.myDocument.getPropertyDbPath(),m,v)&&(this.urn=o,g=!0)}if(g)return this.selectedItem=e,this.onItemSelected(e,l),!0}}return!1},i.prototype.onItemSelected=function(e,t){if(stderr("Selected URL: http://"+location.host+location.pathname+"?document=urn:"+this.myDocument.getRootItem().guid+"&item="+encodeURIComponent(e.guid)),this.itemSelectedObservers)for(var i=this.getCurrentViewer(),n=0;n<this.itemSelectedObservers.length;++n){var o=this.itemSelectedObservers[n]
o.onItemSelected&&o.onItemSelected(i,e,t)}},i.prototype.addItemSelectedObserver=function(e){this.itemSelectedObservers||(this.itemSelectedObservers=[]),this.itemSelectedObservers.push(e)},i.prototype.selectItemById=function(e,t,i){var n=this.myDocument.getItemById(e)
return n?this.selectItem(n,t,i):!1},i.prototype.getSelectedItem=function(){return this.selectedItem},e.ViewingApplication=i}(),AutodeskNamespace("Autodesk.Viewing.Private"),Autodesk.Viewing.Private.ViewCubeUi=function(e){this.viewer=e,this.cube=null,this.viewcube=null,this.infoButton=null,this.homeViewContainer=null},Autodesk.Viewing.Private.ViewCubeUi.prototype={constructor:Autodesk.Viewing.UI.ViewCube,create:function(){var e=this.viewer.config,t=e&&void 0!==e.wantInfoButton?e.wantInfoButton:!0
t&&this.initInfoButton(),this.initHomeButton()},initInfoButton:function(){if(!(0<document.getElementsByClassName("infoButton").length)){this.infoButton=document.createElement("div"),this.infoButton.className="infoButton",this.infoButton.style.cursor="pointer",this.viewer.container.appendChild(this.infoButton)
var e=this
this.infoButton.addEventListener("click",function(t){var i=e.viewer.getPropertyPanel(!0),n=!i.areDefaultPropertiesShown()||!i.isVisible()
n&&i.showDefaultProperties(),n!==i.isVisible()&&i.setVisible(n)})}},initHomeButton:function(){if(!(0<document.getElementsByClassName("homeViewWrapper").length)){var e=document.createElement("div")
e.className="homeViewWrapper",e.style.cursor="pointer",this.viewer.container.appendChild(e),this.homeViewContainer=e
var t=this
e.addEventListener("click",function(e){t.viewer.navigation.setRequestHomeView(!0)}),this._initHomeMenu(e)}},_initHomeMenu:function(e){var t=this.viewer,i=t.autocam,n=this
this.hideHomeViewMenu=function(e){s.style.display="none",document.removeEventListener("click",n.hideHomeViewMenu)}
var o=document.createElement("div")
o.className="homeViewMenuHandle"
var r=document.createElement("img"),a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEBSURBVHja7JcxCsIwFIb/V3oFx04v4iB4A3ev4Ak9iOABOhQcageHDh7iuVSwpW1eYmIFEwiFQvN9SZP/ERIRLNkyLNySQBLIhy+I6AhgE5F5FZHTpACAbV3X61h0Zs5nVwBAJiL0rd+eNuHvnQIArTEmplhrE7gAWEUUePSO/Vg1jJgFvQyYWoFoWTDMgLlNWDFzIyIUqjNzA6DSCpwBlMaYW4iZd+OU3bh2ARG5h5J4h3fj6nIghIQNbg2iTyQ0cFUS+kho4eoodpFwgTvVAo2EK9y5GM1J+MC9quGYhC98shaoPiQqAOwB7Hzhrxn1umMrABy6pxeT0t3w7wWeAwD5qe4YizvzugAAAABJRU5ErkJggg=="
r.src=a,r.width=r.height=18,o.appendChild(r),o.addEventListener("mouseover",function(e){r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEVSURBVHja7JcxDoJAEEX/rvY2HMEb6AEsaTDxBngKIzfgDBR6AxJtiI0egN7Ght6GWBIYGzVKQHaQDYU7yYSwxb5HMvs3CCJCnyXRcxkBIzAsLwyWpx0ARyNzn29m81oBAE60mmqj237smBkwAl9PAfIssv3Y1kbMs+j9VZQvIyHEGMBI40enRHSpFdCcBR8ZUJcD2rKgnAH1Q5gmnu3HXcOBNPGUBIrQDbqUeMKL0A2UBIjo2pXEO5yIrso50IVEE7wxiH6RUIErJWEbCVW4chRzJDhw1l2gIsGFPzdmNQBLLrZr6R7pcL69WrpHkovtGoDF2o8rUCXRFt5aoCzRFl4pwCwLwOTxBGOeXi3Mv+HfC9wHAAIQ03ZDDGqmAAAAAElFTkSuQmCC"}),o.addEventListener("mouseleave",function(e){r.src=a}),e.appendChild(o)
var s=document.createElement("div")
s.className="homeViewMenu",this.viewer.container.appendChild(s)
var l=document.createElement("div")
l.className="homeViewMenuItem",l.textContent=Autodesk.Viewing.i18n.translate("Set current view as Home"),s.appendChild(l),l.addEventListener("click",function(e){i.setCurrentViewAsHome(!1),n.hideHomeViewMenu(e)})
var c=document.createElement("div")
c.className="homeViewMenuItem",c.textContent=Autodesk.Viewing.i18n.translate("Focus and set as Home"),s.appendChild(c),c.addEventListener("click",function(e){i.setCurrentViewAsHome(!0),n.hideHomeViewMenu(e)})
var u=document.createElement("div")
u.className="homeViewMenuItem",u.textContent=Autodesk.Viewing.i18n.translate("Reset Home"),s.appendChild(u),u.addEventListener("click",function(e){i.resetHome(),n.hideHomeViewMenu(e)}),e.addEventListener("mouseover",function(e){(t.model&&t.model.is2d()||t.prefs&&!t.prefs.viewCube)&&(o.style.display="block")}),e.addEventListener("mouseleave",function(e){o.style.display="none"}),o.addEventListener("click",function(e){(t.model&&t.model.is2d()||t.prefs&&!t.prefs.viewCube)&&(s.style.display="block",document.addEventListener("click",n.hideHomeViewMenu)),e.stopPropagation()}),e.addEventListener("contextmenu",function(e){(t.model&&t.model.is2d()||t.prefs&&!t.prefs.viewCube)&&(s.style.display="block",document.addEventListener("click",n.hideHomeViewMenu))})},displayViewCube:function(e,t){if(t!==!1&&this.viewer.prefs.set("viewCube",e),e&&!this.cube)this.viewcube=document.createElement("div"),this.viewcube.className="viewcube",this.viewer.container.appendChild(this.viewcube),this.cube=new Autocam.ViewCube("cube",this.viewer.autocam,this.viewcube,LOCALIZATION_REL_PATH)
else if(!this.cube)return void this._positionHomeButton()
this.viewcube.style.display=e?"block":"none",this._positionHomeButton(),e&&this.viewer.autocam.refresh()},_positionHomeButton:function(){if(this.homeViewContainer){var e,t=this.cube&&this.viewcube&&"block"===this.viewcube.style.display,i=this.viewer.container.getBoundingClientRect(),n=this.homeViewContainer.getBoundingClientRect()
if(t){var o=this.viewcube.getBoundingClientRect()
e=i.left+i.width-o.left-n.width}else if(this.infoButton){var r=this.infoButton.getBoundingClientRect()
e=i.left+i.width-r.left+r.width-n.width}else e=10
this.homeViewContainer.style.right=e+"px"}},uninitialize:function(){this.viewcube&&(this.viewer.container.removeChild(this.viewcube),this.viewcube=null),this.infoButton=null,this.cube&&(this.cube.dtor(),this.cube=null),this.homeViewContainer=null,this.hideHomeViewMenu=null,this.viewer=null}},function(){"use strict"
var e=Autodesk.Viewing,t=Autodesk.Viewing.Private,i=Autodesk.Viewing.UI,n=Autodesk.Viewing.Extensions
e.TOOLBAR_CREATED_EVENT="toolbarCreated",e.TOOLBAR={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools"}
var o=function(t,i){i||(i={}),i.startOnInitialize=!1,e.Viewer3D.call(this,t,i),this.toolbar=null,this.dockingPanels=[],this.modelstructure=null,this.layersPanel=null}
o.prototype=Object.create(e.Viewer3D.prototype),o.prototype.constructor=o,o.prototype.resize=function(){e.Viewer3D.prototype.resize.call(this),this.resizePanels(),this.viewCubeUi&&this.viewCubeUi.cube&&this.viewCubeUi.cube.refreshCube(),this.centerToolBar&&this.centerToolBar()},o.prototype.initialize=function(){var i=e.Viewer3D.prototype.initialize.call(this)
if(i>0)return i
var o=this
if(this.toolController){var r=new e.HotGestureTool(this)
this.toolController.registerTool(r),this.toolController.activateTool(r.getName())}return this.getToolbar(!0),this.addEventListener(e.FULLSCREEN_MODE_EVENT,function(e){o.resizePanels({viewer:o}),o.updateFullscreenButton(e.mode)}),this.contextMenu||this.setContextMenu(new n.ViewerObjectContextMenu(this)),this.progressbar=new t.ProgressBar(this.container),this.addEventListener(e.PROGRESS_UPDATE_EVENT,function(e){void 0!==e.percent&&o.progressbar.setPercent(e.percent)},!1),this.selectionActive=!1,this.addEventListener(e.SELECTION_CHANGED_EVENT,function(e){if(o.selectionActive=e.dbIdArray.length>0,o.prefs.openPropertiesOnSelect){var t=o.getPropertyPanel(!0)
t.setVisible(o.selectionActive)}}),this.addEventListener(e.ISOLATE_EVENT,function(e){(o.prefs.openPropertiesOnSelect||e.nodeIdArray[0]===o.model.getRootId())&&o.propertygrid&&o.propertygrid.setVisible(e.nodeIdArray.length>0||o.selectionActive)}),this.addEventListener(e.VIEWER_STATE_RESTORED_EVENT,function(e){o.renderoptions&&o.renderoptions.syncUI()
var t=o.getSettingsPanel(!0)
t&&t.syncUI()}),this.initEscapeHandlers(),this.localize(),this.run(),0},o.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null),this.modelstructure&&(this.modelstructure.uninitialize(),this.modelstructure=null),this.layersPanel&&(this.layersPanel.uninitialize(),this.layersPanel=null),this.propertygrid&&(this.propertygrid.uninitialize(),this.propertygrid=null),this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null),this.viewerOptionButton&&(this.show3dOptionsNavigationTab=null,this.show3dOptionsPerformanceTab=null,this.viewerOptionButton=null),e.theHotkeyManager.popHotkeys("Autodesk.ROLL"),e.theHotkeyManager.popHotkeys("Autodesk.FOV"),this.removeEventListener(e.RENDER_OPTION_CHANGED_EVENT,this.selectLightPreset),this.selectLightPreset=null,this.progressbar=null,this.modelTools=null,this.navTools=null,this.settingsTools=null,this.debugMenu=null,this.modelStats=null,this.explodeSlider=null,this.explodeSubmenu=null,this.centerToolBar=null,this.viewCubeUi.uninitialize(),this.viewCubeUi=null,this.toolbar=null,e.Viewer3D.prototype.uninitialize.call(this)},o.prototype.setUp=function(t){t||(t={}),t.startOnInitialize=!1,this.getToolbar(!0),e.Viewer3D.prototype.setUp.call(this,t)},o.prototype.tearDown=function(){e.Viewer3D.prototype.tearDown.call(this),this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null),this.modelstructure&&this.setModelStructurePanel(null),this.propertygrid&&this.setPropertyPanel(null),this.viewerSettingsPanel&&this.setSettingsPanel(null),this.layersPanel&&this.setLayersPanel(null),this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null)},o.prototype.loadModel=function(t,i,n,o){var r=this,a=function(){r.displayViewCube(r.prefs.viewCube),r.removeEventListener(e.GEOMETRY_LOADED_EVENT,a)},s=this.config.disabledExtensions;-1==t.indexOf(".f2d")||this.impl.model?(this.createUI("3d"),-1===this.getDefaultNavigationToolName().indexOf("orbit")&&this.setDefaultNavigationTool("orbit"),r.prefs.useFirstPersonNav?this.loadExtension("Autodesk.FirstPerson",null):this.loadExtension("Autodesk.Beeline",null),this.loadExtension("Autodesk.Viewing.Oculus",null),this.prefs.fusionOrbit&&this.loadExtension("Autodesk.Viewing.FusionOrbit",null),(!s||s&&!s.section)&&this.loadExtension("Autodesk.Section",null),this.loadExtension("Autodesk.GamepadModule",null),this.addEventListener(e.GEOMETRY_LOADED_EVENT,a)):(this.createUI("2d"),r.prefs.useFirstPersonNav?this.unloadExtension("Autodesk.FirstPerson"):this.unloadExtension("Autodesk.Beeline"),this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),this.displayViewCube(!1,!1),(!s||s&&!s.measure)&&this.loadExtension("Autodesk.Measure",null))
var l=function(){if(r.modelstructure){var t=function(e){var t=r.config.defaultModelStructureTitle?r.config.defaultModelStructureTitle:""
r.modelstructure.setModel(e,t)},i=function(e){}
r.model.getObjectTree(t,i)}r.removeEventListener(e.OBJECT_TREE_CREATED_EVENT,l)}
return this.addEventListener(e.OBJECT_TREE_CREATED_EVENT,l),e.Viewer3D.prototype.loadModel.call(this,t,i,n,o)},o.prototype.createUI=function(n){var o=this
this.initHotkeys(n),this.loadExtension("Autodesk.DefaultTools.NavTools",{mode:n}),this.initModelTools(n),ENABLE_DEBUG&&this.initDebugTools(),this.fireEvent({type:e.TOOLBAR_CREATED_EVENT}),this.viewCubeUi||(this.viewCubeUi=new t.ViewCubeUi(this)),this.viewCubeUi.create(),this.centerToolBar=function(){o.toolbar.container.style.left="calc(50% - "+o.toolbar.getDimensions().width/2+"px)"},this.toolbar.addEventListener(i.ToolBar.Event.SIZE_CHANGED,this.centerToolBar),this.initModality(),this.resize()},o.prototype.addOptionToggle=function(t,i,n,o,r){var a=r?this.prefs[r]:null
n="boolean"==typeof a?a:n
var s=document.createElement("li")
s.className="toolbar-submenu-listitem"
var l=document.createElement("input")
l.className="toolbar-submenu-checkbox",l.type="checkbox",l.id=i,s.appendChild(l)
var c=document.createElement("label")
return c.setAttribute("for",i),c.setAttribute("data-i18n",i),c.textContent=e.i18n.translate(i),s.appendChild(c),t.appendChild(s),l.checked=n,l.addEventListener("touchstart",touchStartToClick),c.addEventListener("touchstart",touchStartToClick),s.addEventListener("touchstart",touchStartToClick),l.addEventListener("click",function(e){o(l.checked),e.stopPropagation()}),c.addEventListener("click",function(e){e.stopPropagation()}),s.addEventListener("click",function(e){o(!l.checked),e.stopPropagation()}),r&&this.prefs.addListeners(r,function(e){l.checked=e},function(e){l.checked=e,o(e)}),l},o.prototype.addOptionList=function(t,i,n,o,r,a){var s=this.prefs[a]
o="number"==typeof s?s:o
var l=function(e){var t=e.target.selectedIndex
r(t),e.stopPropagation()},c=document.createElement("select")
c.className="optionDropDown",c.id="selectMenu_"+i
for(var u=0;u<n.length;u++){var d=document.createElement("option")
d.value=u,d.setAttribute("data-i18n",n[u]),d.textContent=Autodesk.Viewing.i18n.translate(n[u]),c.add(d)}var h=document.createElement("li")
h.className="toolbar-submenu-select"
var p=document.createElement("div")
return p.className="toolbar-submenu-selectlabel",p.setAttribute("for",i),p.setAttribute("data-i18n",i),p.textContent=e.i18n.translate(i),h.appendChild(p),h.appendChild(c),t.appendChild(h),c.selectedIndex=o,c.onchange=l,c.addEventListener("touchstart",function(e){e.stopPropagation()}),c.addEventListener("click",function(e){e.stopPropagation()}),a&&this.prefs.addListeners(a,function(e){c.selectedIndex=e},function(e){c.selectedIndex=e,r(e)}),c},o.prototype.showViewer3dOptions=function(e){var t=this.getSettingsPanel(!0)
e&&t.isVisible()&&t.setVisible(!1),t.setVisible(e)},o.prototype.showRenderingOptions=function(e){this.renderoptions.setVisible(e)},o.prototype.showLayerManager=function(e){this.layersPanel.setVisible(e)},o.prototype.initHotkeys=function(t){var i,n,o=this,r=e.theHotkeyManager.KEYCODES
if("3d"===t){var a
i=function(){return o.toolController.getIsLocked()?!1:(a=o.getActiveNavigationTool(),o.setActiveNavigationTool("fov"),!0)},n=function(){return o.toolController.getIsLocked()?!1:(o.setActiveNavigationTool(a),!0)},e.theHotkeyManager.pushHotkeys("Autodesk.FOV",[{keycodes:[r.CONTROL,r.SHIFT],onPress:i,onRelease:n}],{tryUntilSuccess:!0})}var s
i=function(){return o.toolController.getIsLocked()?!1:(s=o.getActiveNavigationTool(),o.setActiveNavigationTool("worldup"),!0)},n=function(){return o.toolController.getIsLocked()?!1:(o.setActiveNavigationTool(s),!0)},e.theHotkeyManager.pushHotkeys("Autodesk.ROLL",[{keycodes:[r.ALT,r.SHIFT],onPress:i,onRelease:n}],{tryUntilSuccess:!0})},o.prototype.setModelStructurePanel=function(t){var n=this
return t instanceof e.UI.ModelStructurePanel||null===t?(this.modelstructure&&(this.modelstructure.setVisible(!1),this.removePanel(this.modelstructure),this.modelstructure.uninitialize()),this.modelstructure=t,t&&(this.addPanel(this.modelstructure),t.addVisibilityListener(function(e){e&&n.onPanelVisible(t,n),n.settingsTools.structurebutton.setState(e?i.Button.State.ACTIVE:i.Button.State.INACTIVE)}),n.model&&n.model.getObjectTree(function(e){n.modelstructure.setModel(e)})),!0):!1},o.prototype.setLayersPanel=function(t){var n=this
return this.model&&!this.model.is2d()?(console.warn("av.Viewer3D.setLayersPanel is not yet implemented for 3D"),!1):t instanceof e.UI.LayersPanel||!t?(this.layersPanel&&(this.layersPanel.setVisible(!1),this.removePanel(this.layersPanel),this.layersPanel.uninitialize()),this.layersPanel=t,t&&(this.addPanel(t),t.addVisibilityListener(function(e){e&&n.onPanelVisible(t,n),n.settingsTools.layerButton.setState(e?i.Button.State.ACTIVE:i.Button.State.INACTIVE)})),!0):!1},o.prototype.setPropertyPanel=function(t){var n=this
return t instanceof e.UI.PropertyPanel||!t?(this.propertygrid&&(this.propertygrid.setVisible(!1),this.removePanel(this.propertygrid),this.propertygrid.uninitialize()),this.propertygrid=t,t&&(this.addPanel(t),t.addVisibilityListener(function(e){e&&n.onPanelVisible(t,n),n.settingsTools.propertiesbutton.setState(e?i.Button.State.ACTIVE:i.Button.State.INACTIVE)})),!0):!1},o.prototype.getPropertyPanel=function(e){return!this.propertygrid&&e&&this.setPropertyPanel(new n.ViewerPropertyPanel(this)),this.propertygrid},o.prototype.setSettingsPanel=function(t){return t instanceof e.UI.SettingsPanel||!t?(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),this.viewerSettingsPanel=t,t&&this.addPanel(t),!0):!1},o.prototype.getSettingsPanel=function(e){return!this.viewerSettingsPanel&&e&&this.setSettingsPanel(new n.ViewerSettingsPanel(this,this.model.is2d()?"2d":"3d")),this.viewerSettingsPanel},o.prototype.initModelTools=function(o){var r=this
if("3d"===o){if(!r.modelstructure){var a={docStructureConfig:r.config.docStructureConfig}
r.setModelStructurePanel(new n.ViewerModelStructurePanel(r,"Browser",a))}var s=new i.Button("toolbar-modelStructureTool")
s.setToolTip("Model browser"),s.setIcon("adsk-icon-structure"),s.onClick=function(e){r.showModelStructurePanel(!r.modelstructure.isVisible())},this.settingsTools.addControl(s),this.settingsTools.structurebutton=s,this.initExplodeSlider()}else{var l=new n.ViewerLayersPanel(this)
this.setLayersPanel(l)
var c=new i.Button("toolbar-layersTool")
c.setToolTip("Layer Manager"),c.setIcon("adsk-icon-layers"),c.onClick=function(e){r.layersPanel||r.setLayersPanel(new n.ViewerLayersPanel(r)),r.showLayerManager(!r.layersPanel.isVisible())},this.settingsTools.addControl(c),this.settingsTools.layerButton=c}r.addEventListener(e.RESET_EVENT,function(){r.model&&!r.model.is2d()&&(r.explode(0),r.explodeSlider.value=0),r.showAll()})
var u=new i.Button("toolbar-propertiesTool")
u.setToolTip("Properties"),u.setIcon("adsk-icon-properties"),u.onClick=function(e){var t=r.getPropertyPanel(!0)
t.setVisible(!t.isVisible())},u.setVisible(!r.prefs.openPropertiesOnSelect),this.settingsTools.addControl(u),this.settingsTools.propertiesbutton=u
var d=new n.ViewerSettingsPanel(this,o)
this.setSettingsPanel(d)
var h=new i.Button("toolbar-settingsTool")
if(this.viewerOptionButton=h,h.setIcon("adsk-icon-settings"),h.setToolTip("Settings"),this.settingsTools.addControl(h),this.createViewerOptionsMenu(o),ENABLE_DEBUG&&"3d"===o){this.renderoptions=new t.RenderOptionsPanel(this),this.addPanel(this.renderoptions)
var p=new i.Button("toolbar-renderOptionsTool")
p.setToolTip("Rendering options"),p.setIcon("adsk-icon-settings-render"),p.onClick=function(e){r.showRenderingOptions(!r.renderoptions.isVisible())},this.settingsTools.addControl(p)}if(this.canChangeScreenMode()){var f=new i.Button("toolbar-fullscreenTool",{collapsible:!1})
f.setToolTip("Full screen"),f.setIcon("adsk-icon-fullscreen"),f.onClick=function(e){r.nextScreenMode()},this.settingsTools.addControl(f),this.settingsTools.fullscreenbutton=f,this.updateFullscreenButton(this.getScreenMode())}},o.prototype.setPropertiesOnSelect=function(e){this.settingsTools.propertiesbutton.setVisible(!e)},o.prototype.addDivider=function(e){var t=document.createElement("li")
return t.className="toolbar-submenu-horizontal-divider",e.appendChild(t),t},o.prototype.createViewerOptionsMenu=function(o){function r(e){var t=a.getSettingsPanel(!0)
t.isVisible()&&t.isTabSelected(e)?a.showViewer3dOptions(!1):(a.showViewer3dOptions(!0),t.selectTab(e))}var a=this,s=document.createElement("div")
if(s.id="toolbar-settingsToolSubmenu",s.classList.add("toolbar-submenu"),s.classList.add("toolbar-settings-sub-menu"),s.classList.add("adsk-hidden"),s.mode=o,this.container.appendChild(s),"3d"===o){for(var l=[],c=0;c<t.LightPresets.length;c++)l.push(t.LightPresets[c].name)
this.viewerOptionButton.envList=this.addOptionList(s,"Background and lighting",l,4,function(e){a.blockEvent||a.setLightPreset(e)},"lightPreset"),this.selectLightPreset=function(e){a.blockEvent=!0,a.viewerOptionButton.envList&&(a.viewerOptionButton.envList.selectedIndex=a.impl.currentLightPreset()),a.blockEvent=!1},a.addEventListener(e.RENDER_OPTION_CHANGED_EVENT,this.selectLightPreset),this.viewerOptionButton.displayLines=this.addOptionToggle(s,"Display Lines",!0,function(e){a.hideLines(!e)},"lineRendering"),this.addDivider(s)}var u=document.createElement("li")
u.className="toolbar-submenu-listitem"
var d=document.createElement("label")
d.setAttribute("data-i18n","Performance and appearance settings"),d.textContent=e.i18n.translate("Performance and appearance settings"),u.appendChild(d),this.show3dOptionsPerformanceTab=function(){r(n.ViewerSettingTab.Performance)},this.viewerOptionButton.performanceOption=u,this.viewerOptionButton.performanceOption.addEventListener("touchstart",touchStartToClick),this.viewerOptionButton.performanceOption.addEventListener("click",this.show3dOptionsPerformanceTab),s.appendChild(this.viewerOptionButton.performanceOption),this.addDivider(s)
var h=document.createElement("li")
h.className="toolbar-submenu-listitem"
var p=document.createElement("label")
p.setAttribute("data-i18n","Navigation and selection settings"),p.textContent=e.i18n.translate("Navigation and selection settings"),h.appendChild(p),this.show3dOptionsNavigationTab=function(){r(n.ViewerSettingTab.Navigation)},this.viewerOptionButton.navigationOption=h,this.viewerOptionButton.navigationOption.addEventListener("touchstart",touchStartToClick),this.viewerOptionButton.navigationOption.addEventListener("click",this.show3dOptionsNavigationTab),s.appendChild(h),s.style.width=s.getBoundingClientRect().width+"px",this.container.removeChild(s),this.viewerOptionButton.onClick=function(e){s.classList.toggle("adsk-hidden"),this.setState(this.getState()===i.Button.State.ACTIVE?i.Button.State.INACTIVE:i.Button.State.ACTIVE)},this.viewerOptionButton.container.appendChild(s),this.viewerOptionButton.subMenu=s},o.prototype.removeViewerOptionsMenu=function(e){var t=this.viewerOptionButton
t.container.removeChild(t.subMenu),"3d"===e&&(this.removeEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,this.selectLightPreset),t.envList=null),t.navigationOption.removeEventListener("touchstart",touchStartToClick),t.navigationOption.removeEventListener("click",this.show3dOptionsNavigationTab),t.navigationOption=null,t.performanceOption.removeEventListener("touchstart",touchStartToClick),t.performanceOption.removeEventListener("click",this.show3dOptionsPerformanceTab),t.performanceOption=null},o.prototype.initDebugTools=function(){var e=new i.ControlGroup("debugTools")
this.debugMenu=e
var t=new i.Button("toolbar-debugTool")
t.setIcon("adsk-icon-bug"),e.addControl(t),this.debugMenu.debugSubMenuButton=t,this.createDebugSubmenu(this.debugMenu.debugSubMenuButton),this.toolbar.addControl(e)},o.prototype.createDebugSubmenu=function(e){function i(){n.localize()}var n=this,o=document.createElement("div")
o.id="toolbar-debugToolSubmenu",o.classList.add("toolbar-submenu"),o.classList.add("toolbar-settings-sub-menu"),o.classList.add("adsk-hidden"),this.debugMenu.subMenu=o,this.debugMenu.subMenu.style.minWidth="180px",this.container.appendChild(o),this.initModelStats(),this.addDivider(o),this.addDivider(o)
var r=["English","Chinese Simplified","Chinese Traditional","Japanese","Czech","Korean","Polish","Russian","French","German","Italian","Spanish","Portuguese Brazil","Turkish"],a=["en","zh-Hans","zh-Hant","ja","cs","ko","pl","ru","fr","de","it","es","pt-br","tr"],s=n.selectedLanguage?n.selectedLanguage:0,l=this.addOptionList(o,"Language",r,s,function(e){var o=a[e]
n.selectedLanguage=e,t.setLanguage(o,i)},null)
l.parentNode.style.paddingBottom="15px",this.addDivider(this.debugMenu.subMenu)
var c=["UNKNOWN FAILURE","BAD DATA","NETWORK ERROR","NETWORK ACCESS DENIED","NETWORK FILE NOT FOUND","NETWORK SERVER ERROR","NETWORK UNHANDLED RESPONSE CODE","BROWSER WEBGL NOT SUPPORTED","BAD DATA NO VIEWABLE CONTENT"],u=this.addOptionList(o,"Error",c,0,function(e){var i=e+1
t.ErrorHandler.reportError(n.container,i,"")},null)
u.parentNode.style.paddingBottom="15px"
var d=o.getBoundingClientRect()
this.debugMenu.subMenu.style.width=d.width+"px",this.container.removeChild(o),e.container.appendChild(o)
var h=d.left+d.width,p=this.container.getBoundingClientRect().right
if(h>p){var f=-(h-p+10)+"px"
this.debugMenu.subMenu.style.left=f}e.onMouseOver=function(e){o.classList.remove("adsk-hidden")},e.onMouseOut=function(e){o.classList.add("adsk-hidden")},isTouchDevice()&&(e.onClick=function(e){o.classList.toggle("adsk-hidden")})},o.prototype.initModelStats=function(){function t(e){var t=n.impl,i="",o=n.model
o&&(i+="Geom&nbsp;polys:&nbsp;"+t.modelQueue().getGeometryList().geomPolyCount+"<br>",i+="Instance&nbsp;polys:&nbsp;"+t.modelQueue().getGeometryList().instancePolyCount+"<br>",i+="Fragments:&nbsp;"+t.modelQueue().getFragmentList().getCount()+"<br>",i+="Geoms:&nbsp;"+t.modelQueue().getGeometryList().geoms.length+"<br>",i+="Loading&nbsp;time:&nbsp;"+(t.model.loader.loadTime/1e3).toFixed(2)+" s<br>"),i+="# "+(e||""),n.modelStats.innerHTML=i}function i(){n.modelStats=document.createElement("div"),n.modelStats.className="statspanel",n.container.appendChild(n.modelStats),n.addEventListener(e.PROGRESS_UPDATE_EVENT,function(e){e.message&&t(e.message)}),n.fpsDisplay=document.createElement("div"),n.fpsDisplay.className="fps",n.container.appendChild(n.fpsDisplay)}var n=this
this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,function(e){e&&!n.modelStats&&(i(),t("")),n.modelStats.style.visibility=e?"visible":"hidden",n.fpsDisplay.style.visibility=e?"visible":"hidden",e?n.impl.fpsCallback=function(e){n.fpsDisplay.textContent=""+(0|e)}:n.impl.fpsCallback=null})},o.prototype.initEscapeHandlers=function(){var i=this
this.addEventListener(e.ESCAPE_EVENT,function(e){if(!i.contextMenu||!i.contextMenu.hide()){if(i.renderoptions&&i.renderoptions.isVisible())return void i.renderoptions.setVisible(!1)
if(i.getActiveNavigationTool()!==i.getDefaultNavigationToolName())return i.toolController&&i.toolController.setIsLocked(!1),i.setActiveNavigationTool(),void t.HudMessage.dismiss()
if(i.selectionActive)return void i.clearSelection()
if(!i.areAllVisible())return void i.showAll()
if(!t.AlertBox.dismiss()){for(var n=0;n<i.dockingPanels.length;++n){var o=i.dockingPanels[n]
if("none"!==o.container.style.display&&""!==o.container.style.display)return void(o.container===i.modelstructure?i.showModelStructurePanel(!1):o.setVisible(!1))}i.escapeScreenMode()}}})},o.prototype.displayViewCube=function(e,t){this.viewCubeUi.displayViewCube(e,t)},o.prototype.getToolbar=function(t){if(!this.toolbar&&t){var i=e.UI
this.toolbar=new i.ToolBar("guiviewer3d-toolbar"),this.navTools=new i.RadioButtonGroup(e.TOOLBAR.NAVTOOLSID),this.modelTools=new i.ControlGroup(e.TOOLBAR.MODELTOOLSID),this.settingsTools=new i.ControlGroup(e.TOOLBAR.SETTINGSTOOLSID),this.toolbar.addControl(this.navTools),this.toolbar.addControl(this.modelTools),this.toolbar.addControl(this.settingsTools),this.container.appendChild(this.toolbar.container)}return this.toolbar},o.prototype.showModelStructurePanel=function(e){this.modelstructure.setVisible(e)},o.prototype.onPanelVisible=function(e){this.dockingPanels.splice(this.dockingPanels.indexOf(e),1),this.dockingPanels.splice(0,0,e)},o.prototype.updateFullscreenButton=function(t){var i="adsk-icon-fullscreen"
switch(t){case e.ScreenMode.kNormal:this.isScreenModeSupported(e.ScreenMode.kFullBrowser)||(i="adsk-icon-fullscreen")
break
case e.ScreenMode.kFullBrowser:i=this.isScreenModeSupported(e.ScreenMode.kFullScreen)?"adsk-icon-fullscreen":"adsk-icon-fullscreen-exit"
break
case e.ScreenMode.kFullScreen:i="adsk-icon-fullscreen-exit"}this.settingsTools.fullscreenbutton.setIcon(i)},o.prototype.localize=function(){if(e.i18n.localize(),this.viewerOptionButton&&this.viewerOptionButton.subMenu){var i=this.viewerOptionButton.subMenu.mode
this.removeViewerOptionsMenu(i),this.createViewerOptionsMenu(i)}this.debugMenu&&this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.container.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton)),t.ErrorHandler.localize()},o.prototype.addPanel=function(e){var t=this.dockingPanels.indexOf(e)
return-1===t?(this.dockingPanels.push(e),!0):!1},o.prototype.removePanel=function(e){var t=this.dockingPanels.indexOf(e)
return t>-1?(this.dockingPanels.splice(t,1),!0):!1},o.prototype.resizePanels=function(e){e=e||{}
var t=this.toolbar.getDimensions().height,i=this.getDimensions(),n=i.height
e.dimensions&&e.dimensions.height?n=e.dimensions.height:e.dimensions={height:i.height,width:i.width},e.dimensions.height=n-t
var o=e?e.viewer:null
o||(o=this)
var r=e?e.dockingPanels:null
r||(r=o.dockingPanels)
var a,s,l=o.container.getBoundingClientRect(),c=l.top,u=l.bottom,d=l.left,h=l.right
e&&e.dimensions?(a=e.dimensions.width,s=e.dimensions.height,u=e.dimensions.height):(a=l.width,s=l.height)
for(var p=0;p<r.length;++p){var f=r[p].container,m=f.getBoundingClientRect(),v=m.top,g=m.bottom,E=m.left,y=m.right,A=m.width,T=m.height
A&&T&&(A>a&&(A=Math.round(a),f.style.width=A+"px"),T>s&&(T=Math.round(s),f.style.height=T+"px"),(y>h||f.dockRight)&&(E=Math.round(h-A-d),f.style.left=E+"px"),(g>u||f.dockBottom)&&(v=Math.round(u-T-c),0>v&&(v=0),f.style.top=v+"px"),f.style.maxWidth=Math.round(a)+"px",f.style.maxHeight=Math.round(s)+"px")}},o.prototype.initExplodeSlider=function(){var e=this,t=new i.Button("toolbar-explodeTool")
t.setIcon("adsk-icon-explode"),t.setToolTip("Explode model"),e.modelTools.addControl(t,{index:0})
var n='<div class="explode-submenu" style="display:none"><input class="explode-slider" type="range" min="0" max="1" step="0.01" value="0"/></div>'
this.explodeSubmenu=stringToDOM(n)
var o
o=document.querySelector("#toolbar-explodeTool").parentNode,this.explodeSubmenu.classList.add("ios"),o.appendChild(this.explodeSubmenu)
var r=this.explodeSubmenu.querySelector(".explode-slider")
e.explodeSlider=r,r.oninput=function(t){e.explode(r.value)},r.onchange=function(t){e.explode(r.value)},this.explodeSubmenu.onclick=function(e){e.stopPropagation()}
var a=t.container.querySelector(".adsk-control-tooltip")
t.onClick=function(n){var o=t.getState()
o===i.Button.State.INACTIVE?(t.setState(i.Button.State.ACTIVE),a.style.display="none",e.explodeSubmenu.style.display=""):o===i.Button.State.ACTIVE&&(t.setState(i.Button.State.INACTIVE),a.style.display="",r.parentNode.style.display="none",e.explode(0),e.explodeSlider.value=0)}},o.prototype.initInspectTools=function(){var e=new i.Button("toolbar-inspectTools")
e.setToolTip("Inspect"),e.setIcon("measure"),e.setVisible(!1),this.modelTools.addControl(e)
var t=new i.RadioButtonGroup("toolbar-inspectSubMenu")
t.addClass("toolbar-vertical-group"),t.setVisible(!1),this.modelTools.addControl(t),e.container.insertBefore(t.container,e.container.firstChild),e.onMouseOver=function(){t.setVisible(!0)},e.onMouseOut=function(){t.setVisible(!1)},isTouchDevice()&&(e.onClick=function(e){t.setVisible(!t.isVisible())})},o.prototype.initModality=function(){function e(t){for(var i=2,n=0;i>n&&t.parentElement;){var o=t.id
if(0===o.indexOf("toolbar-")){if(o.indexOf("arrow")===o.length-5)return void 0
var r=e(t.parentElement)
return r||t}t=t.parentElement,n++}}function t(e){return e.id.substring(8,e.id.length)}function i(e){return e.classList.contains("active")}function n(e){e.dispatchEvent(new Event("click"))}function o(e,t,i){s[e]=i?t:void 0}function r(r){if(!r.target.classList.contains("clickoff")){var l=e(r.target)
if(l){var c=t(l)
if(a[c]&&!("sectionTool"===c&&(r.target.classList.contains("adsk-icon-section-analysis")||r.target.querySelector(".adsk-icon-section-analysis"))||s[c]&&(o(c,l,!1),i(l)))){for(var u in s){var d=s[u]
if(d){var h=t(d)
i(d)?a[c][h]||n(d):o(h,d,!1)}}o(c,l,!0)}}}}var a={orbitTools:{explodeTool:1},panTool:{explodeTool:1},zoomTool:{explodeTool:1},beelineTool:{},sectionTool:{},measureTool:{},explodeTool:{}},s={}
this.toolbar.container.addEventListener("click",r,!0)},t.GuiViewer3D=o}(),function(){"use strict"
function e(e,t){this._id=e,this._isCollapsible=!t||t.collapsible,this._toolTipElement=null,this._listeners={},this.container=document.createElement("div"),this.container.id=e,this.addClass("adsk-control")}var t=Autodesk.Viewing
Autodesk.Viewing.UI
e.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"},t.EventDispatcher.prototype.apply(e.prototype),e.prototype.constructor=e,e.prototype.container=null,e.prototype.getId=function(){return this._id},e.prototype.setVisible=function(t){var i=!this.container.classList.contains("adsk-hidden")
if(i===t)return!1
t?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden")
var n={type:e.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:t}
return this.fireEvent(n),!0},e.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")},e.prototype.setToolTip=function(e){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")===e?!1:(this._toolTipElement||(this._toolTipElement=document.createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement)),this._toolTipElement.setAttribute("data-i18n",e),this._toolTipElement.setAttribute("tooltipText",e),this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(e,{defaultValue:e}),!0)},e.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")},e.prototype.setCollapsed=function(t){if(!this._isCollapsible||this.isCollapsed()===t)return!1
t?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed")
var i={type:e.Event.COLLAPSED_CHANGED,isCollapsed:t}
return this.fireEvent(i),!0},e.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")},e.prototype.isCollapsible=function(){return this._isCollapsible},e.prototype.addClass=function(e){this.container.classList.add(e)},e.prototype.removeClass=function(e){this.container.classList.remove(e)},e.prototype.getPosition=function(){var e=this.container.getBoundingClientRect()
return{top:e.top,left:e.left}},e.prototype.getDimensions=function(){var e=this.container.getBoundingClientRect()
return{width:e.width,height:e.height}},Autodesk.Viewing.UI.Control=e}(),function(){"use strict"
function e(i,n){t.Control.call(this,i,n)
var o=this
this._controls=[],this.addClass("adsk-control-group"),this.handleChildSizeChanged=function(t){var i={type:e.Event.SIZE_CHANGED,childEvent:t}
o.fireEvent(i)}}var t=Autodesk.Viewing.UI
e.Event={VISIBILITY_CHANGED:t.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:t.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"},e.prototype=Object.create(t.Control.prototype),e.prototype.constructor=e,e.prototype.addControl=function(i,n){var o=n&&void 0!==n.index?n.index:this._controls.length
if(null!==this.getControl(i.getId()))return!1
var r={type:e.Event.CONTROL_ADDED,control:i,index:o}
return o<this._controls.length?(this.container.insertBefore(i.container,this._controls[o].container),this._controls.splice(o,0,i)):(this.container.appendChild(i.container),this._controls.push(i)),i.addEventListener(t.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),i.addEventListener(t.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),i instanceof e&&i.addEventListener(e.Event.SIZE_CHANGED,this.handleChildSizeChanged),this.fireEvent(r),this.fireEvent(e.Event.SIZE_CHANGED),!0},e.prototype.indexOf=function(e){for(var t=0;t<this._controls.length;t++){var i=this._controls[t]
if(i===e||"string"==typeof e&&e===i.getId())return t}return-1},e.prototype.removeControl=function(i){var n="string"==typeof i?this.getControl(i):i
if(!n)return!1
var o=this._controls.indexOf(n)
this._controls.splice(o,1),this.container.removeChild(n.container)
var r={type:e.Event.CONTROL_REMOVED,control:n,index:o}
return n.removeEventListener(t.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged),n.removeEventListener(t.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged),n instanceof e&&n.removeEventListener(e.Event.SIZE_CHANGED,this.handleChildSizeChanged),this.fireEvent(r),this.fireEvent(e.Event.SIZE_CHANGED),!0},e.prototype.getControl=function(e){for(var t=0;t<this._controls.length;t++)if(e===this._controls[t].getId())return this._controls[t]
return null},e.prototype.getNumberOfControls=function(){return this._controls.length},e.prototype.setCollapsed=function(t){if(!this._isCollapsible)return!1
var i=!1
return this._controls.forEach(function(e){e.isCollapsible()&&e.setCollapsed(t)&&(i=!0)}),i&&(t?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.fireEvent({type:e.Event.COLLAPSED_CHANGED,isCollapsed:t})),i},Autodesk.Viewing.UI.ControlGroup=e}(),function(){"use strict"
function e(e,i){t.ControlGroup.call(this,e,i),this.removeClass("adsk-control-group"),this.addClass("adsk-toolbar")}var t=Autodesk.Viewing.UI
e.Event={VISIBILITY_CHANGED:t.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:t.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:t.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:t.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:t.ControlGroup.Event.SIZE_CHANGED},e.prototype=Object.create(t.ControlGroup.prototype),e.prototype.constructor=e,Autodesk.Viewing.UI.ToolBar=e}(),function(){"use strict"
function e(i,n){t.Control.call(this,i,n)
var o=this
this._state=e.State.INACTIVE,this.icon=document.createElement("div"),this.icon.classList.add("adsk-button-icon"),this.container.appendChild(this.icon),this.container.addEventListener("click",function(t){o.fireEvent(e.Event.CLICK),o.onClick&&o.onClick(t),t.stopPropagation()}),isTouchDevice()?this.container.addEventListener("touchstart",touchStartToClick):(this.container.addEventListener("mouseover",function(e){o.onMouseOver(e)}),this.container.addEventListener("mouseout",function(e){o.onMouseOut(e)})),this.addClass("adsk-button"),this.addClass(e.StateToClassMap[this._state])}var t=Autodesk.Viewing.UI
e.Event={VISIBILITY_CHANGED:t.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:t.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"},e.State={ACTIVE:0,INACTIVE:1,DISABLED:2},e.StateToClassMap=function(){var t=e.State,i={}
return i[t.ACTIVE]="active",i[t.INACTIVE]="inactive",i[t.DISABLED]="disabled",i}(),e.prototype=Object.create(t.Control.prototype),e.prototype.constructor=e,e.prototype.setState=function(t){if(t===this._state)return!1
this.removeClass(e.StateToClassMap[this._state]),this.addClass(e.StateToClassMap[t]),this._state=t
var i={type:e.Event.STATE_CHANGED,state:t}
return this.fireEvent(i),!0},e.prototype.setIcon=function(e){this.iconClass&&this.icon.classList.remove(this.iconClass),this.iconClass=e,this.icon.classList.add(e)},e.prototype.getState=function(){return this._state},e.prototype.onClick=function(e){},e.prototype.onMouseOver=function(e){},e.prototype.onMouseOut=function(e){},Autodesk.Viewing.UI.Button=e}(),function(){"use strict"
function e(e,i){t.Button.call(this,e,i),this.arrowButton=new t.Button(e+"arrow"),this.arrowButton.addClass("adsk-button-arrow"),this.arrowButton.removeClass("adsk-button"),this.subMenu=new t.RadioButtonGroup(e+"SubMenu"),this.subMenu.addClass("toolbar-vertical-group"),this.subMenu.setVisible(!1),this.container.insertBefore(this.subMenu.container,this.container.firstChild),this.container.insertBefore(this.arrowButton.container,this.container.firstChild)
var n=this
this.arrowButton.onClick=function(e){n.subMenu.setVisible(!n.subMenu.isVisible())},this.toggleFlyoutVisible=function(){n.subMenu.setVisible(!n.subMenu.isVisible())},this.onClick=function(e){n.subMenu.setVisible(!n.subMenu.isVisible())},this.subMenuActiveButtonChangedHandler=function(e){e.isActiveButton?(n.setIcon(e.target.getActiveButton().iconClass),n.setToolTip(e.target.getActiveButton().getToolTip()),n.setState(t.Button.State.ACTIVE),n.onClick=e.button.onClick):n.setState(t.Button.State.INACTIVE)},this.subMenu.addEventListener(t.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,this.subMenuActiveButtonChangedHandler)
var o=stringToDOM('<div class="clickoff" style="position:fixed; top:0; left:0; width:100vw; height:100vh;"></div>')
this.subMenu.container.insertBefore(o,this.subMenu.container.firstChild),o.addEventListener("click",function(e){n.subMenu.setVisible(!1),e.stopPropagation()})}var t=Autodesk.Viewing.UI
e.prototype=Object.create(t.Button.prototype),e.prototype.constructor=e,e.prototype.addControl=function(e){this.subMenu.addControl(e),e.addEventListener(t.Button.Event.CLICK,this.toggleFlyoutVisible)},e.prototype.removeControl=function(e){e.removeEventListener(t.Button.Event.CLICK,this.toggleFlyoutVisible)},e.prototype.setState=function(e){if(e===t.Button.State.INACTIVE){var i=this.subMenu.getActiveButton()
i&&i.setState(t.Button.State.INACTIVE)}t.Button.prototype.setState.call(this,e)},e.prototype.saveAsDefault=function(){this.defaultState={},this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")&&(this.defaultState.tooltip=this._toolTipElement.getAttribute("tooltipText")),this.defaultState.icon=this.iconClass,this.defaultState.onClick=this.onClick},e.prototype.restoreDefault=function(){this.defaultState&&(this.defaultState.tooltip&&this.setToolTip(this.defaultState.tooltip),this.defaultState.icon&&this.setIcon(this.defaultState.icon),this.onClick=this.defaultState.onClick,this.setState(t.Button.State.INACTIVE))},Autodesk.Viewing.UI.ComboButton=e}(),function(){"use strict"
function e(i,n){t.ControlGroup.call(this,i,n)
var o=this
this._activeButton=null,this._handleButtonStateChange=function(i){var n=t.Button.State
return i.state!==n.ACTIVE?void(i.target===o._activeButton&&(o._activeButton=null,o.fireEvent({type:e.Event.ACTIVE_BUTTON_CHANGED,button:i.target,isActiveButton:!1}))):(o._activeButton=i.target,o.fireEvent({type:e.Event.ACTIVE_BUTTON_CHANGED,button:i.target,isActiveButton:!0}),void o._controls.forEach(function(e){e!==i.target&&e.getState()!==n.DISABLED&&e.setState(n.INACTIVE)}))}}var t=Autodesk.Viewing.UI
e.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:t.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:t.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:t.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:t.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:t.ControlGroup.Event.SIZE_CHANGED},e.prototype=Object.create(t.ControlGroup.prototype),e.prototype.constructor=e,e.prototype.addControl=function(e,i){return e instanceof t.Button&&t.ControlGroup.prototype.addControl.call(this,e,i)?(e.addEventListener(t.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0):!1},e.prototype.removeControl=function(e){var i="string"==typeof e?this.getControl(e):e
return null!==i&&t.ControlGroup.prototype.removeControl.call(this,i)?(i.removeEventListener(t.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0):!1},e.prototype.getActiveButton=function(){return this._activeButton},Autodesk.Viewing.UI.RadioButtonGroup=e}(),AutodeskNamespace("Autodesk.Viewing")
var proto=MobileCallbacks.prototype
proto.animationReady=function(){this.ios?this.iosSend("animationReady"):this.android&&this.androidSend.animationReady()},proto.onSelectionChanged=function(e){this.ios?this.iosSend("selectionChanged",e):this.android&&this.androidSend.onSelectionChanged(e)},proto.onLongTap=function(e,t){this.ios?this.iosSend("onLongTap",[e,t]):this.android&&this.androidSend.onLongTap(e,t)},proto.onSingleTap=function(e,t){this.ios?this.iosSend("onSingleTap",[e,t]):this.android&&this.androidSend.onSingleTap(e,t)},proto.onDoubleTap=function(e,t){this.ios?this.iosSend("onDoubleTap",[e,t]):this.android&&this.androidSend.onDoubleTap(e,t)},proto.setRTCSession=function(e){this.ios?this.iosSend("setRTCSession",{id:e}):this.android&&this.androidSend.setRTCSessionID(e)},proto.putProperties=function(e,t){this.ios?this.iosSend("putProperties",{name:e,value:t}):this.android&&this.androidSend.putProperties(e,t)},proto.onPropertyRetrievedSuccess=function(){this.ios?this.iosSend("onPropertyRetrievedSuccess"):this.android&&this.androidSend.onPropertyRetrievedSuccess()},proto.onPropertyRetrievedFailOrEmptyProperties=function(){this.ios?this.iosSend("onPropertyRetrievedFailOrEmptyProperties"):this.android&&this.androidSend.onPropertyRetrievedFailOrEmptyProperties()},proto.resetAnimationStatus=function(){this.ios?this.iosSend("resetAnimationStatus"):this.android&&this.androidSend.resetAnimationStatus()},proto.updateAnimationTime=function(e){this.ios?this.iosSend("updateAnimationTime",e):this.android&&this.androidSend.updateAnimationTime(e)},proto.setLoadingProgress=function(e){this.ios?this.iosSend("setLoadingProgress",e):this.android&&this.androidSend.setLoadingProgress(e)},proto.objectTreeCreated=function(){this.ios?this.iosSend("objectTreeCreated"):this.android&&this.androidSend.objectTreeCreated()},proto.geometryLoaded=function(){this.ios?this.iosSend("geometryLoaded"):this.android&&this.androidSend.geometryLoaded()},proto.putSheets=function(e,t){this.ios?this.iosSend("putSheets",[e,t]):this.android&&this.androidSend.putSheets(e,t)},proto.hideLoadingView=function(){this.android&&this.androidSend.hideLoadingView()},Autodesk.Viewing.Extensions.ViewerPanelMixin=function(){this.getContainerBoundingRect=function(){var e=this.parentContainer.getBoundingClientRect(),t={height:0,width:0,left:0,bottom:0,right:0,top:0},i=document.getElementsByClassName("toolbar-menu")
return i&&i.length>0&&(t=i[0].getBoundingClientRect()),{height:e.height-t.height,width:e.width,left:e.left,bottom:e.bottom-t.height,right:e.right,top:e.top}}},function(){"use strict"
var e=Autodesk.Viewing,t=(Autodesk.Viewing.Private,Autodesk.Viewing.UI),i=Autodesk.Viewing.Extensions,n={click:{onObject:["isolate"]},clickCtrl:{onObject:["toggleVisibility"]}}
i.ViewerModelStructurePanel=function(e,i,o){this.viewer=e,o=o||{},o.heightAdjustment=75,t.ModelStructurePanel.call(this,e.container,e.container.id+"ViewerModelStructurePanel",i,o),this.clickConfig=o&&o.docStructureConfig?o.docStructureConfig:n,this.isMac=-1!==navigator.userAgent.search("Mac OS"),this.initSearchBox(),this.prevSearchResults=[],this.prevSearchString=""},i.ViewerModelStructurePanel.prototype=Object.create(t.ModelStructurePanel.prototype),i.ViewerModelStructurePanel.prototype.constructor=i.ViewerModelStructurePanel,i.ViewerPanelMixin.call(i.ViewerModelStructurePanel.prototype),i.ViewerModelStructurePanel.prototype.initialize=function(){t.ModelStructurePanel.prototype.initialize.call(this)
var i=this
i.addEventListener(i.viewer,e.SELECTION_CHANGED_EVENT,function(e){i.setSelection(e.nodeArray.slice())}),i.addEventListener(i.viewer,e.ISOLATE_EVENT,function(e){i.setIsolation(e.nodeIdArray.slice())}),i.addEventListener(i.viewer,e.HIDE_EVENT,function(e){i.setHidden(e.nodeIdArray.slice(),!0)}),i.addEventListener(i.viewer,e.SHOW_EVENT,function(e){i.setHidden(e.nodeIdArray.slice(),!1)})},i.ViewerModelStructurePanel.prototype.uninitialize=function(){this.viewer=null,t.ModelStructurePanel.prototype.uninitialize.call(this)},i.ViewerModelStructurePanel.prototype.handleAction=function(e,t){for(var i in e)switch(e[i]){case"selectOnly":this.viewer.select(t)
break
case"deselectAll":this.viewer.select([])
break
case"selectToggle":this.viewer.toggleSelect(t)
break
case"isolate":this.viewer.isolate(t)
break
case"showAll":this.viewer.isolate(null)
break
case"focus":this.viewer.fitToView()
break
case"hide":this.viewer.hide(t)
break
case"show":this.viewer.show(t)
break
case"toggleVisibility":this.viewer.toggleVisibility(t)}},i.ViewerModelStructurePanel.prototype.ctrlDown=function(e){return this.isMac&&e.metaKey||!this.isMac&&e.ctrlKey},i.ViewerModelStructurePanel.prototype.onClick=function(e,t){if(!this.isMac||!t.ctrlKey){var i=this,n="click"
i.ctrlDown(t)&&(n+="Ctrl"),t.shiftKey&&(n+="Shift"),t.altKey&&(n+="Alt"),this.clickConfig&&this.clickConfig[n]?i.handleAction(this.clickConfig[n].onObject,e):this.viewer.select(e)}},i.ViewerModelStructurePanel.prototype.onDoubleClick=function(e,t){this.handleAction(["focus"],e)},i.ViewerModelStructurePanel.prototype.onRightClick=function(e,t){if(this.isMac&&t.ctrlKey&&0===t.button)return this.clickConfig&&this.clickConfig.clickCtrl?this.handleAction(this.clickConfig.clickCtrl.onObject,e):this.viewer.select(e),null
var i=[],n=!0
if(t.shiftKey||this.isMac&&t.metaKey||t.ctrlKey&&(this.isMac||2===t.button))for(var o=this.viewer.impl.selector.getSelection(),r=0;r<o.length;++r)o[r]!==e?i.push(o[r]):n=!1
return n&&i.push(e),this.viewer.select(i),this.viewer.contextMenu.show(t)},i.ViewerModelStructurePanel.prototype.setHidden=function(e,t){this.uiCreated||this.createUI()
for(var i=0;i<e.length;++i)this.tree.iterate(e[i],function(e,i){i.classList.toggle("dim",t),i.classList.toggle("visible",!t)})},i.ViewerModelStructurePanel.prototype.setIsolation=function(e){if(this.rootId){if(this.tree&&this.tree.iterate(this.rootId,function(e,t){t.classList.remove("dim"),t.classList.remove("visible")}),e.length>0){if(1===e.length&&e[0]===this.rootId)return
this.setHidden([this.rootId],!0),this.setHidden(e,!1)}this.searchbox&&!this.inSearchIsolate&&(this.searchbox.value="")}},i.ViewerModelStructurePanel.prototype.initSearchBox=function(){function t(){if(!r.isSearching){for(var e=0;e<r.prevSearchResults.length;e++)r.tree.setCollapsed(r.prevSearchResults[e],!0,!0)
if(0===i.value.length)r.isSearching=!1,r.prevSearchString="",o.isolate()
else{if(r.prevSearchString==i.value)return
r.isSearching=!0,o.search(i.value,function(e){if(r.inSearchIsolate=!0,o.isolate(e),r.inSearchIsolate=!1,e.length){for(var t=0;t<e.length;t++)r.tree.setCollapsed(e[t],!1,!0)
r.resizeToContent(),r.tree.scrollTo(e[0])}r.prevSearchResults=e,r.isSearching=!1},null,["name"])}}}var i=document.createElement("input")
i.className="toolbar-search-box",i.type="search",i.results=5,i.placeholder=e.i18n.translate("Filter by name"),i.incremental="incremental",i.autosave=this.container.id+"search_autosave",i.setAttribute("data-i18n","[placeholder]Filter by name"),this.scrollContainer.parentNode.insertBefore(i,this.scrollContainer),this.searchbox=i
var n,o=this.viewer,r=this,a=500
i.addEventListener("input",function(e){clearTimeout(n),n=setTimeout(t,a)}),i.addEventListener("change",function(e){clearTimeout(n),t()})}}(),function(){"use strict"
var e=Autodesk.Viewing,t=e.UI,i=function(e){this.viewer=e,this.currentNodeIds=[],this.currentModel=null,this.isSelection=!1,this.isDirty=!0,this.propertyNodeId=null,t.PropertyPanel.call(this,e.container,"ViewerPropertyPanel","Object Properties Loading...")}
i.prototype=Object.create(t.PropertyPanel.prototype),i.prototype.constructor=i,e.Extensions.ViewerPanelMixin.call(i.prototype),i.prototype.initialize=function(){t.PropertyPanel.prototype.initialize.call(this)
var i=this
i.addEventListener(i.viewer,e.SELECTION_CHANGED_EVENT,function(e){i.currentNodeIds=e.dbIdArray,i.currentModel=e.model,i.isSelection=e.dbIdArray.length>0,i.isDirty=!0,i.requestProperties()}),i.addEventListener(i.viewer,e.ISOLATE_EVENT,function(e){0==e.nodeIdArray.length&&i.isSelection||(i.currentModel=e.model,i.currentNodeIds=e.nodeIdArray,i.isDirty=!0,i.requestProperties())}),i.addEventListener(i.viewer,e.HIDE_EVENT,function(e){i.isDirty=!0,i.requestProperties()}),i.addEventListener(i.viewer,e.SHOW_EVENT,function(e){i.isDirty=!0,i.requestProperties()}),this.currentModel=i.viewer.model,this.currentNodeIds=i.viewer.getSelection(),0===this.currentNodeIds.length?this.currentNodeIds=i.viewer.getIsolatedNodes():this.isSelection=!0},i.prototype.setTitle=function(e,i){e||(e="Object Properties",i=i||{},i.localizeTitle=!0),t.PropertyPanel.prototype.setTitle.call(this,e,i)},i.prototype.setVisible=function(e){t.DockingPanel.prototype.setVisible.call(this,e),this.requestProperties()},i.prototype.visibilityChanged=function(){t.DockingPanel.prototype.visibilityChanged.call(this),this.isVisible()&&this.requestProperties()},i.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(this.currentNodeIds.length>0?this.setNodeProperties(this.currentNodeIds[this.currentNodeIds.length-1]):this.showDefaultProperties(),this.isDirty=!1)},i.prototype.setNodeProperties=function(e){var t=this
this.propertyNodeId=e,t.currentModel.getProperties(e,function(e){if(t.setTitle(e.name),t.setProperties(e.properties),t.highlight(t.viewer.searchText),t.resizeToContent(),t.isVisible()){var i=t.viewer.toolController,n=i.lastClickX,o=i.lastClickY,r=t.container.getBoundingClientRect(),a=r.left,s=r.top,l=r.width,c=r.height,u=t.viewer.canvas.getBoundingClientRect(),d=u.left,h=u.top,p=u.width,f=u.height
n>=a&&a+l>n&&o>=s&&s+c>o&&(a+l/2>n&&d+p>n+l?(t.container.style.left=Math.round(n-d)+"px",t.container.dockRight=!1):n-l>=d?(t.container.style.left=Math.round(n-d-l)+"px",t.container.dockRight=!1):d+p>n+l?(t.container.style.left=Math.round(n-d)+"px",t.container.dockRight=!1):h+f>o+c?(t.container.style.top=Math.round(o-h)+"px",t.container.dockBottom=!1):o-c>=h&&(t.container.style.top=Math.round(o-h-c)+"px",t.container.dockBottom=!1))}})},i.prototype.showDefaultProperties=function(){var e=this.viewer.model.getRootId()
e?this.setNodeProperties(e):(this.propertyNodeId=null,this.setTitle("Model Properties",{localizeTitle:!0}),t.PropertyPanel.prototype.showDefaultProperties.call(this))},i.prototype.areDefaultPropertiesShown=function(){var e=this.viewer.model.getRootId()
return this.propertyNodeId===e},i.prototype.uninitialize=function(){t.PropertyPanel.prototype.uninitialize.call(this),this.viewer=null},i.prototype.onCategoryClick=function(e,i){t.PropertyPanel.prototype.onCategoryClick.call(this,e,i),this.resizeToContent()},i.prototype.onCategoryIconClick=function(e,i){t.PropertyPanel.prototype.onCategoryIconClick.call(this,e,i),this.resizeToContent()},Autodesk.Viewing.Extensions.ViewerPropertyPanel=i}(),function(){"use strict"
var e=function(e){var t=e.container
Autodesk.Viewing.UI.LayersPanel.call(this,e,t,t.id+"ViewerLayersPanel")}
e.prototype=Object.create(Autodesk.Viewing.UI.LayersPanel.prototype),e.prototype.constructor=e,Autodesk.Viewing.Extensions.ViewerPanelMixin.call(e.prototype),e.prototype.onClick=function(e,t){if(!this.isMac||!t.ctrlKey){var i=!(t.shiftKey||t.metaKey||t.ctrlKey)
this.setLayerVisible(e,i)}},e.prototype.onRightClick=function(e,t){var i=!(t.shiftKey||t.metaKey||t.ctrlKey)
this.setLayerVisible(e,i)},e.prototype.onImageClick=function(e,t){this.isMac&&t.ctrlKey||this.setLayerVisible(e)},e.prototype.onTitleClick=function(e){this.viewer.setLayerVisible(null,!0)},e.prototype.onTitleDoubleClick=function(e){this.viewer.fitToView()},Autodesk.Viewing.Extensions.ViewerLayersPanel=e}(),function(){"use strict"
var e=Autodesk.Viewing.Extensions,t=Autodesk.Viewing.UI
e.ViewerSettingTab={Navigation:"navigationtab",Performance:"performancetab"}
var i=function(e,i){this.viewer=e,this.is3dMode="3d"===i,t.SettingsPanel.call(this,e.container,"ViewerSettingsPanel","Settings",{width:360,heightAdjustment:155}),this.addTab("navigationtab","Navigation and selection",{className:"navigation"}),this.addTab("performancetab","Performance and appearance",{className:"performance"}),this.restoreDiv=document.createElement("div"),this.restoreDiv.className="viewer-restore-defaults",this.restoreDiv.setAttribute("data-i18n","Restore default settings"),this.restoreDiv.textContent=Autodesk.Viewing.i18n.translate("Restore default settings"),this.addEventListener(this.restoreDiv,"touchstart",touchStartToClick),this.addEventListener(this.restoreDiv,"click",function(){var t=e.model.is2d()?"2d":"3d"
e.prefs.reset(t)},!1),this.container.appendChild(this.restoreDiv),this.createNavigationPanel(),this.createPerformancePanel()}
i.prototype=Object.create(t.SettingsPanel.prototype),i.prototype.constructor=i,e.ViewerPanelMixin.call(i.prototype),i.prototype.uninitialize=function(){this.viewer=null,t.SettingsPanel.prototype.uninitialize.call(this)},i.prototype.addCheckbox=function(e,i,n,o,r){function a(e){s.prefs.set(r,e),o(e)}var s=this.viewer,l=s.prefs[r]
n="boolean"==typeof l?l:n
var c=t.SettingsPanel.prototype.addCheckbox.call(this,e,i,n,a),u=this.getControl(c)
return u.saveKey=r,s.prefs.addListeners(r,function(e){u.setValue(e)},function(e){u.setValue(e),o(e)}),c},i.prototype.removeCheckbox=function(e){return this.viewer.prefs.removeListeners(e.saveKey),this.removeEventListener(e,"change",e.changeListener),t.SettingsPanel.prototype.removeCheckbox.call(this,e)},i.prototype.createNavigationPanel=function(){var t=this.viewer,i=e.ViewerSettingTab.Navigation
this.is3dMode&&(this.addCheckbox(i,"Show ViewCube",!0,function(e){t.displayViewCube(e)},"viewCube"),this.addCheckbox(i,"ViewCube acts on pivot",!1,function(e){t.setUsePivotAlways(e)},"alwaysUsePivot"),this.addCheckbox(i,"Zoom towards pivot",!1,function(e){t.setZoomTowardsPivot(e)},"zoomTowardsPivot"),this.addCheckbox(i,"Set pivot with left mouse button",!1,function(e){t.setClickToSetCOI(e)},"clickToSetCOI"),this.addCheckbox(i,"Fusion style orbit",!1,function(e){e?t.loadExtension("Autodesk.Viewing.FusionOrbit",null):t.unloadExtension("Autodesk.Viewing.FusionOrbit",null)},"fusionOrbit"),this.addCheckbox(i,"First person walk",!1,function(e){e?(t.unloadExtension("Autodesk.Beeline",null),t.loadExtension("Autodesk.FirstPerson",null)):(t.unloadExtension("Autodesk.FirstPerson",null),t.loadExtension("Autodesk.Beeline",null))},"useFirstPersonNav")),this.addCheckbox(i,"Reverse mouse zoom direction",!1,function(e){t.setReverseZoomDirection(e)},"reverseMouseZoomDir"),this.is3dMode&&this.addCheckbox(i,"Orbit past world poles",!0,function(e){t.setOrbitPastWorldPoles(e)},"orbitPastWorldPoles"),this.addCheckbox(i,"Open properties on select",!0,function(e){t.setPropertiesOnSelect(e)},"openPropertiesOnSelect"),this.addCheckbox(i,"Left handed mouse setup",!1,function(e){t.setUseLeftHandedInput(e)},"leftHandedMouseSetup")},i.prototype.createPerformancePanel=function(){var t=this.viewer,i=e.ViewerSettingTab.Performance
this.is3dMode&&(this.ghosthiddenChkBoxId=this.addCheckbox(i,"Ghost hidden objects",!0,function(e){t.setGhosting(e)},"ghosting"),this.optimizeNavigationhkBoxId=this.addCheckbox(i,"Smooth navigation",isMobileDevice(),function(e){t.setOptimizeNavigation(e)},"optimizeNavigation"),this.antialiasingChkBoxId=this.addCheckbox(i,"Anti-aliasing",!0,function(e){t.setQualityLevel(t.prefs.ambientShadows,e)},"antialiasing"),this.ambientshadowsChkBoxId=this.addCheckbox(i,"Ambient shadows",!0,function(e){t.setQualityLevel(e,t.prefs.antialiasing)},"ambientShadows"),this.groundShadowChkBoxId=this.addCheckbox(i,"Ground shadow",!0,function(e){t.setGroundShadow(e)},"groundShadow"),this.groundReflectionChkBoxId=this.addCheckbox(i,"Ground reflection",!0,function(e){t.setGroundReflection(e)},"groundReflection"),this.envMapBackgroundChkBoxId=this.addCheckbox(i,"Environment map for background",!0,function(e){t.setEnvMapBackground(e)},"envMapBackground")),this.progressiveRenderChkBoxId=this.addCheckbox(i,"Progressive model display",!0,function(e){t.setProgressiveRendering(e)},"progressiveRendering")},i.prototype.syncUI=function(){var e=this.viewer,t=this.getControl(this.antialiasingChkBoxId)
t&&t.setValue(e.prefs.antialiasing)
var i=this.getControl(this.ambientshadowsChkBoxId)
i&&i.setValue(e.prefs.ambientShadows)
var n=this.getControl(this.groundShadowChkBoxId)
n&&n.setValue(e.prefs.groundShadow)
var o=this.getControl(this.groundReflectionChkBoxId)
o&&o.setValue(e.prefs.groundReflection)
var r=this.getControl(this.envMapBackgroundChkBoxId)
r&&r.setValue(e.prefs.envMapBackground)
var a=this.getControl(this.progressiveRenderChkBoxId)
a&&a.setValue(e.prefs.progressiveRendering)
var s=this.getControl(this.ghosthiddenChkBoxId)
s&&s.setValue(e.prefs.ghosting)},e.ViewerSettingsPanel=i}(),function(){"use strict"
function e(e){t.ObjectContextMenu.call(this,e)}var t=Autodesk.Viewing.UI
e.prototype=Object.create(t.ObjectContextMenu.prototype),e.prototype.constructor=e,e.prototype.buildMenu=function(e,t){var i=this,n=[],o=this.viewer.model.is2d()
if(!o){var r=this.viewer.navigation.getScreenViewport(),a=e.clientX-r.left,s=e.clientY-r.top,l=i.viewer.impl.hitTest(a,s,!1)
if(l&&l.dbId){var c=i.viewer.getSelection();-1==c.indexOf(l.dbId)&&i.viewer.select(l.dbId),t.hasSelected=!0,t.hasVisible=!0}}return!o&&t.hasSelected&&(n.push({title:"Isolate",target:function(){var e=i.viewer.getSelection()
i.viewer.clearSelection(),i.viewer.isolate(e)}}),t.hasVisible&&n.push({title:"Hide Selected",target:function(){var e=i.viewer.getSelection()
i.viewer.clearSelection(),i.viewer.hide(e)}}),t.hasHidden&&n.push({title:"Show Selected",target:function(){var e=i.viewer.getSelection()
i.viewer.clearSelection(),i.viewer.show(e)}})),o?n.push({title:"Show All Layers",target:function(){i.viewer.setLayerVisible(null,!0)}}):n.push({title:"Show All Objects",target:function(){i.viewer.showAll()}}),!o&&t.hasSelected&&n.push({title:"Focus",target:function(){var e=i.viewer.getSelection()
i.viewer.fitToView(e)}}),t.hasSelected&&n.push({title:"Clear Selection",target:function(){i.viewer.clearSelection()}}),n},Autodesk.Viewing.Extensions.ViewerObjectContextMenu=e}(),function(){"use strict"
function e(e,t){Autodesk.Viewing.Extension.call(this,e,t)}var t=AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360")
e.prototype=Object.create(Autodesk.Viewing.Extension.prototype),e.prototype.constructor=e,e.prototype.load=function(){function e(){i.impl.setLightPreset(0,!0),i.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,e)}var i=this.viewer,n=new t.CAMModelStructurePanel(this.viewer,"CAM Model Structure Loading",this.options)
return i.setModelStructurePanel(n),i.hideLines(!1),i.setGhosting(!1),i.setQualityLevel(!1,!0),i.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,e),!0},e.prototype.unload=function(){this.viewer.setModelStructurePanel(null)},t.CAM360Extension=e,Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.CAM360",t.CAM360Extension)}(),function(){"use strict"
function e(e,t,n){i.ViewerModelStructurePanel.call(this,e,t,n),this.viewer=e}var t=AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360"),i=Autodesk.Viewing.Extensions
e.prototype=Object.create(i.ViewerModelStructurePanel.prototype),e.prototype.constructor=e,e.prototype.sortCamNodes=function(e,t){function i(e,t){function i(e,t){for(var i=0;i<e.length;++i){var n=e[i]
if(n.displayName===t)return n.displayValue}return null}function n(n){var r=i(n.properties,"9429B915-D020-4CEB-971B-6ADD0A5D4BFA")
r?("CAM_Setup"==r?o.camSetupNodes.push(e):"CAM_Operation"==r?o.camOperationNodes.push(e):"CAM_Tool"===r?o.camToolNodes.push(e):"CAM_Stock"===r?o.camStockNodes.push(e):"CAM_Folder"==r&&o.camFolderNodes.push(e),o.camNodes.push(e)):o.camModelNodes.push(e),t()}function r(e,i,n){t()}o.viewer.getProperties(e,n,r)}function n(){r.length>0?i(r.shift(),n):t()}this.camNodes=[],this.camModelNodes=[],this.camSetupNodes=[],this.camStockNodes=[],this.camOperationNodes=[],this.camToolNodes=[],this.camFolderNodes=[]
var o=this,r=[]
e.enumNodeChildren(e.getRootId(),function(e){r.push(e)},!0),r.shift(),n()},e.prototype.setModel=function(e,n){var o=this
o.sortCamNodes(e,function(){i.ViewerModelStructurePanel.prototype.setModel.call(o,e,n),o.SetCAMNodeVisible(!1),t.showStructurePanel=void 0===t.showStructurePanel?!0:t.showStructurePanel,o.setVisible(t.showStructurePanel),o.ExpandSetupNodes(),o.resizeToContent()})},e.prototype.initialize=function(){function e(i){t.SetCAMNodeVisible(!1),t.removeEventListener(t.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,e)}i.ViewerModelStructurePanel.prototype.initialize.call(this)
var t=this
this.viewer.model&&this.viewer.model.isLoadDone()||t.addEventListener(t.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,e),t.addEventListener(t.viewer,Autodesk.Viewing.SHOW_EVENT,function(e){var i=e.nodeIdArray
if(i)for(var n=0;n<i.length;n++)t.setCamNodeVisibility(i[n])}),t.addEventListener(t.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(e){var i=e.nodeArray
if(i)for(var n=0;n<i.length;n++)t.HideHightlightCAMNode(i[n])}),t.addEventListener(t.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(e){var i=e.nodeIdArray
if(i)if(0==i.length)t.SetModelVisible(),t.SetCAMNodeVisible(!0)
else for(var n=0;n<i.length;n++)t.setCamNodeVisibility(i[n])})},e.prototype.IsCAMNode=function(e){return-1!==this.camNodes.indexOf(e)},e.prototype.IsCAMSetupNode=function(e){return-1!==this.camSetupNodes.indexOf(e)},e.prototype.IsCAMStockNode=function(e){return-1!==this.camStockNodes.indexOf(e)},e.prototype.IsCAMToolNode=function(e){return-1!==this.camToolNodes.indexOf(e)},e.prototype.IsCAMOperationNode=function(e){return-1!==this.camOperationNodes.indexOf(e)},e.prototype.IsCAMFolderNode=function(e){return-1!==this.camFolderNodes.indexOf(e)},e.prototype.shouldInclude=function(e){return!this.IsCAMStockNode(e)},e.prototype.isGroupNode=function(e){return this.IsCAMOperationNode(e)?!1:i.ViewerModelStructurePanel.prototype.isGroupNode.call(this,e)},e.prototype.setNodeVisibility=function(e,t){t?this.viewer.show(e):this.viewer.hide(e)},e.prototype.SetModelVisible=function(){if(this.camModelNodes)for(var e=0;e<this.camModelNodes.length;e++)this.setNodeVisibility(this.camModelNodes[e],!0)},e.prototype.SetCAMNodeVisible=function(e){if(this.camNodes){for(var t=0;t<this.camNodes.length;t++)this.setNodeVisibility(this.camNodes[t],e)
this.SetToolNodeVisible(!1)}},e.prototype.SetToolNodeVisible=function(e){if(this.camToolNodes)for(var t=0;t<this.camToolNodes.length;t++)this.setNodeVisibility(this.camToolNodes[t],e)},e.prototype.HideHightlightNode=function(e){var t=this.viewer.impl,i=this
i.instanceTree.enumNodeFragments(e,function(e){t.highlightFragment(i.model,e,!1,!0)},!0)},e.prototype.HideHightlightCAMNode=function(e){var t=this.IsCAMSetupNode(e),i=this.IsCAMOperationNode(e),n=this.IsCAMFolderNode(e),o=this
o.instanceTree.enumNodeChildren(e,function(e){t?o.IsCAMStockNode(e)||o.HideHightlightNode(e):i?o.IsCAMToolNode(e)&&o.HideHightlightNode(e):n&&o.HideHightlightNode(e)},!1)},e.prototype.setCamNodeVisibility=function(e){var t=this.IsCAMSetupNode(e),i=this.IsCAMOperationNode(e),n=this.IsCAMFolderNode(e),o=this
t?this.instanceTree.enumNodeChildren(e,function(e){var t=o.IsCAMStockNode(e)
o.setNodeVisibility(e,t)}):i?this.instanceTree.enumNodeChildren(e,function(e){o.IsCAMToolNode(e)&&o.setNodeVisibility(e,!1)}):n&&this.instanceTree.enumNodeChildren(e,function(e){o.setNodeVisibility(e,!1)})},e.prototype.onClick=function(e,t){i.ViewerModelStructurePanel.prototype.onClick.call(this,e,t),this.SetModelVisible(),this.setCamNodeVisibility(e),this.viewer.fitToView()},e.prototype.ExpandSetupNodes=function(){if(this.camSetupNodes)for(var e=0;e<this.camSetupNodes.length;e++)this.tree.setCollapsed(this.camSetupNodes[e],!1)},t.CAMModelStructurePanel=e}(),function(){"use strict"
var e=Autodesk.Viewing,t=e.UI,i=function(t,i){e.Extension.call(this,t,i),this.viewer=t,this.animTools=null,this.animToolsId="animationTools",this.playButton=null,this.prevExplodeValue=0,this.prevAnimationTime=-1}
i.prototype=Object.create(e.Extension.prototype),i.prototype.constructor=i,i.prototype.load=function(){function i(e,t){t?(e.setIcon("toolbar-animationPlayIcon"),e.setToolTip("Play")):(e.setIcon("toolbar-animationPauseIcon"),e.setToolTip("Pause"))}function n(){u.toolbar.removeClass("toolbar-animationMenuplacer"),c.animTools.setVisible(!1)}function o(e,t){u.model.is2d()||0===u.getExplodeScale()||(c.prevExplodeValue=u.explodeSlider.value,t&&(u.explodeSlider.value=e),u.explode(e))}function r(e){var t=e.value,i="#ffffff",n="#393939"
e.style.background="-webkit-linear-gradient(left,"+i+" "+t+"%, "+n+" "+t+"%)",e.style.background="-moz-linear-gradient(left,"+i+" "+t+"%, "+n+" "+t+"%)",e.style.background="-ms-linear-gradient(left,"+i+" "+t+"%, "+n+" "+t+"%)",e.style.background="-o-linear-gradient(left,"+i+" "+t+"%, "+n+" "+t+"%)",e.style.background="linear-gradient(to right,"+i+" "+t+"%, "+n+" "+t+"%)"}function a(e){var t=""
0>e&&(t="-",e=-e)
var i=~~(e/3600),n=~~(e%3600/60),o=e%60,r=t
return i>0&&(r+=i+":"+(10>n?"0":"")),r+=n+":"+(10>o?"0":""),r+=o.toFixed(2)}function s(d){u.removeEventListener(e.TOOLBAR_CREATED_EVENT,s),c.toolbar=new t.ToolBar("animation-toolbar"),c.toolbar.addClass("toolbar-animationSubtoolbar"),u.container.appendChild(c.toolbar.container),c.animTools=new t.ControlGroup(c.animToolsId),c.animTools.setVisible(!1),c.toolbar.addControl(c.animTools),c.playButton=new t.Button("toolbar-animationPlay"),c.playButton.setToolTip("Play"),c.playButton.onClick=function(e){o(0)
var t=u.impl.keyFrameAnimator
void 0!==t&&t&&(c.prevAnimationTime>0&&(t["goto"](c.prevAnimationTime),c.prevAnimationTime=-1),t.play(0,function(e){p.value=e,h.value=a(t.currentTime),m.value=a(t.currentTime-t.duration),e>=100&&i(c.playButton,!0),r(p)}),i(c.playButton,t.isPaused),u.toolbar.addClass("toolbar-animationMenuplacer"),c.animTools.setVisible(!0),c.animTools.isPositionAdjusted||(l(),c.animTools.isPositionAdjusted=!0))},c.playButton.setIcon("toolbar-animationPlayIcon"),u.modelTools.addControl(c.playButton),c.onExplodeChange=function(){var e=u.impl.keyFrameAnimator
void 0!==e&&e&&(0!==e.currentTime&&(c.prevAnimationTime=e.currentTime,e["goto"](0)),i(c.playButton,!0)),n()},u.addEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,c.onExplodeChange),u.modelTools.resetModelButton&&(u.modelTools.resetModelButton.onClick=function(e){u.showAll()
var t=u.impl.keyFrameAnimator
void 0!==t&&t&&(t["goto"](0),p.value=0,h.value=a(0),m.value=a(-t.duration),i(c.playButton,!0)),o(0,!0),r(p)}),c.animTools.backwardButton=new t.Button("toolbar-animationBackward"),c.animTools.backwardButton.setToolTip("Previous keyframe"),c.animTools.backwardButton.onClick=function(e){var t=u.impl.keyFrameAnimator
void 0!==t&&t&&(t.prev(),p.value=t.duration>0?t.currentTime/t.duration*100:0,h.value=a(t.currentTime),m.value=a(t.currentTime-t.duration),i(c.playButton,t.isPaused),r(p))},c.animTools.backwardButton.addClass("toolbar-animationButton"),c.animTools.backwardButton.setIcon("toolbar-animationBackwardIcon"),c.animTools.addControl(c.animTools.backwardButton),c.animTools.forwardButton=new t.Button("toolbar-animationForward"),c.animTools.forwardButton.setToolTip("Next keyframe"),c.animTools.forwardButton.onClick=function(e){var t=u.impl.keyFrameAnimator
void 0!==t&&t&&(t.next(),p.value=t.duration>0?t.currentTime/t.duration*100:0,h.value=a(t.currentTime),m.value=a(t.currentTime-t.duration),i(c.playButton,t.isPaused),r(p))},c.animTools.forwardButton.addClass("toolbar-animationButton"),c.animTools.forwardButton.setIcon("toolbar-animationForwardIcon"),c.animTools.addControl(c.animTools.forwardButton),c.animTools.timeText=new t.Control("toolbar-animationTimeLapse")
var h=document.createElement("input")
h.type="text",h.value="0",h.className="animationTimeLapse",h.disabled=!0,c.animTools.timeText.container.appendChild(h),c.animTools.timeText.addClass("toolbar-animationButton"),c.animTools.addControl(c.animTools.timeText),c.animTools.timeline=new t.Control("toolbar-animationTimeline")
var p=c.animTools.input=document.createElement("input")
p.type="range",p.value="0",p.className="animationTimeline",c.animTools.timeline.container.appendChild(p),p.addEventListener("input",function(e){var t=u.impl.keyFrameAnimator
if(void 0!==t&&t){var n=p.value*t.duration/100
h.value=a(n),m.value=a(n-t.duration),t["goto"](n),i(c.playButton,t.isPaused),r(p)}})
var f=document.createElement("div")
f.className="adsk-control-tooltip",f.textContent=Autodesk.Viewing.i18n.translate("Click-drag to scrub"),c.animTools.timeline.container.appendChild(f),p.addEventListener("mouseover",function(e){e.target===p&&(f.style.visibility="visible")}),p.addEventListener("mouseout",function(e){e.target===p&&(f.style.visibility="hidden")}),c.animTools.timeline.addClass("toolbar-animationButton"),c.animTools.timeline.addClass("toolbar-animationTimeline"),c.animTools.addControl(c.animTools.timeline),c.animTools.timeLeftText=new t.Control("toolbar-animationRemainingTime")
var m=document.createElement("input")
m.type="text",m.value="0",m.className="animationTimeLapse",m.disabled=!0,c.animTools.timeLeftText.container.appendChild(m),c.animTools.timeLeftText.addClass("toolbar-animationButton"),c.animTools.addControl(c.animTools.timeLeftText),c.animTools.closeButton=new t.Button("toolbar-animationClose"),c.animTools.closeButton.setToolTip("Close animation timeline"),c.animTools.closeButton.onClick=function(e){n()},c.animTools.closeButton.setIcon("toolbar-animationCloseIcon"),c.animTools.closeButton.addClass("toolbar-animationButton"),c.animTools.addControl(c.animTools.closeButton),c.onEscape=function(e){var t=u.impl.keyFrameAnimator
void 0!==t&&t&&(t.isPaused?n():t.pause(),i(c.playButton,t.isPaused))},u.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,c.onEscape),c.onCameraChange=function(){if(u.toolController.cameraUpdated){var e=u.impl.keyFrameAnimator
void 0!==e&&e&&e.isPlaying&&!e.isPaused&&(e.pause(),i(c.playButton,e.isPaused))}},u.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,c.onCameraChange),c.onResize=function(){u.container.clientWidth<(isTouchDevice()?560:600)?c.toolbar.setCollapsed(!0):(c.toolbar.setCollapsed(!1),l())},u.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,c.onResize)}function l(){var e=u.toolbar.getDimensions().width,t=u.container.getBoundingClientRect().width
e>t&&(e=u.modelTools.getDimensions().width)
var i=e-(2*c.animTools.backwardButton.getDimensions().width+3*c.animTools.timeText.getDimensions().width+c.animTools.closeButton.getDimensions().width)+12
c.animTools.input.style.width=i+"px",c.toolbar.container.style.left="calc(50% - "+e/2+"px)"}var c=this,u=this.viewer
u.impl
return this.viewer.toolbar&&this.viewer.toolbar.modelTools&&this.viewer.toolbar.modelTools.getNumberOfControls()>0?s():this.viewer.addEventListener(e.TOOLBAR_CREATED_EVENT,s),!0},i.prototype.unload=function(){var t=this.viewer,i=t.impl.keyFrameAnimator
i&&i.stop(),t.impl.keyFrameAnimator=null,this.animTools&&(this.animTools.removeControl(this.animTools.timeText.getId()),this.animTools.removeControl(this.animTools.timeline.getId()),this.animTools.removeControl(this.animTools.timeLeftText.getId()),this.animTools.removeControl(this.animTools.forwardButton.getId()),this.animTools.removeControl(this.animTools.backwardButton.getId()),this.animTools.removeControl(this.animTools.closeButton.getId())),this.toolbar&&(this.toolbar.removeControl(this.animTools),this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null)
var n=t.getToolbar(!1)
return n&&n.getControl(e.TOOLBAR.MODELTOOLSID).removeControl(this.playButton.getId()),t.removeEventListener(e.EXPLODE_CHANGE_EVENT,this.onExplodeChange),t.removeEventListener(e.ESCAPE_EVENT,this.onEscape),t.removeEventListener(e.CAMERA_CHANGE_EVENT,this.onCameraChange),t.removeEventListener(e.VIEWER_RESIZE_EVENT,this.onResize),!0},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360"),Autodesk.Viewing.Extensions.Fusion360.AnimationExtension=i,e.theExtensionManager.registerExtension("Autodesk.Fusion360.Animation",i)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Oculus"),Autodesk.Viewing.Extensions.Oculus.StereoRenderContext=function(e){function t(e){b=e.hResolution/(2*e.vResolution)
var t=-1-4*(e.hScreenSize/4-e.lensSeparationDistance/2)/e.hScreenSize
y=e.distortionK[0]+e.distortionK[1]*Math.pow(t,2)+e.distortionK[2]*Math.pow(t,4)+e.distortionK[3]*Math.pow(t,6),T=THREE.Math.radToDeg(2*Math.atan2(e.vScreenSize*y,2*e.eyeToScreenDistance)),A=4*(e.hScreenSize/4-e.interpupillaryDistance/2)/e.hScreenSize
var i=4*(e.hScreenSize/4-e.lensSeparationDistance/2)/e.hScreenSize
g.lensCenter=new THREE.Vector2(i,0),E.lensCenter=new THREE.Vector2(-i,0)}function i(e){n.aspect=o.aspect=b,n.fov=o.fov=T
var t=1/r.getUnitScale(),i=e.target.clone().sub(e.position).cross(e.up).normalize()
i.multiplyScalar(1*v.interpupillaryDistance*t),o.position.add(i),o.target.add(i),n.toPerspective(),o.toPerspective(),o.projectionMatrix.elements[12]-=2*A}var n,o,r,a,s,l,c,u,d,h,p,f,m=e?e.useWarp:!0,v=e&&e.HMD?e.HMD:{hResolution:1920,vResolution:1080,hScreenSize:.12576,vScreenSize:.07074,interpupillaryDistance:.0635,lensSeparationDistance:.0635,eyeToScreenDistance:.041,distortionK:[1,.22,.24,0],chromaAbParameter:[.996,-.004,1.014,0]},g={},E={},y=1,A=0,T=100,b=1
this.init=function(e,i,n){if(init_WarpShader(),s=e,l=i,c=n,u=s.getPixelRatio(),t(v),r=new RenderContext,a=new RenderContext,r.settings.sao=a.settings.sao=!1,r.settings.antialias=a.settings.antialias=!1,r.settings.customPresentPass=a.settings.customPresentPass=m,r.init(s,l/2*y/u,c*y/u),a.init(s,c/2*y/u,c*y/u),this.settings=r.settings,m){d=new Autodesk.Viewing.Shaders.LmvShaderPass(WarpShader),h=new Autodesk.Viewing.Shaders.LmvShaderPass(WarpShader)
for(var o=[d,h],p=0;2>p;p++)o[p].material.blending=THREE.NoBlending,o[p].material.depthWrite=!1,o[p].material.depthTest=!1,o[p].uniforms.hmdWarpParam.value.set(v.distortionK[0],v.distortionK[1],v.distortionK[2],v.distortionK[3]),o[p].uniforms.chromAbParam.value.set(v.chromaAbParameter[0],v.chromaAbParameter[1],v.chromaAbParameter[2],v.chromaAbParameter[3]),o[p].uniforms.scaleIn.value.set(1,1/b),o[p].uniforms.scale.value.set(1/y,1*b/y)
o[0].uniforms.lensCenter.value.copy(g.lensCenter),o[1].uniforms.lensCenter.value.copy(E.lensCenter)}},this.revertCameraChanges=function(e){return console.log("REVERT Camera to normal"),n.fov=p,n.aspect=f,n},this.saveCameraState=function(e){console.log(e),p=e.fov,f=e.aspect},this.update=function(e){var t=r.update(e),i=a.update(e)
return t||i},this.beginScene=function(e,t,s,l){n=t,o=t.clone(),i(t),r.beginScene(e,n,s,l),a.beginScene(e,o,s,l)},this.renderScenePart=function(e,t,i,n){r.renderScenePart(e,t,i,n),a.renderScenePart(e,t,i,n)},this.sceneDirty=function(e,t){r.sceneDirty(e,t),a.sceneDirty(e,t)},this.endScene=function(){r.endScene(),a.endScene()},this.clearAllOverlays=function(){r.clearAllOverlays(),a.clearAllOverlays()},this.renderOverlays=function(e){r.renderOverlays(e),a.renderOverlays(e)},this.composeFinalFrame=function(e,t){r.composeFinalFrame(e,t,!0),a.composeFinalFrame(e,t,!0),s.setViewport(0,0,l/2,c),r.presentBuffer(d),s.setViewport(l/2,0,l/2,c),a.presentBuffer(h),s.setViewport(0,0,l,c)},this.cleanup=function(){r.cleanup(),a.cleanup()},this.setSize=function(e,t,i){l=e,c=t,r.setSize(l/2*y/u,c*y/u,i),a.setSize(l/2*y/u,c*y/u,i),s.setSize(e,t)},this.getMaxAnisotropy=function(){return r.getMaxAnisotropy()},this.hasMRT=function(){return r.hasMRT()},this.initPostPipeline=function(e,t,i){e=!1,t=!1,i=!1,r.initPostPipeline(e,t,i),a.initPostPipeline(e,t,i)},this.setClearColors=function(e,t){r.setClearColors(e,t),a.setClearColors(e,t)},this.setAOOptions=function(e,t){r.setAOOptions(e,t),a.setAOOptions(e,t)},this.getAORadius=function(){return r.getAORadius()},this.getAOIntensity=function(){return r.getAOIntensity()},this.setTonemapExposureBias=function(e){r.setTonemapExposureBias(e),a.setTonemapExposureBias(e)},this.getExposureBias=function(){return r.getExposureBias()},this.setTonemapMethod=function(e){r.setTonemapMethod(e),a.setTonemapMethod(e)},this.getToneMapMethod=function(){return r.getToneMapMethod()},this.toggleTwoSided=function(e){r.toggleTwoSided(e),a.toggleTwoSided(e)},this.enter2DMode=function(e){r.enter2DMode(e),a.enter2DMode(e)},this.idAtPixel=function(e,t){return console.warn("idAtPixel not implemented in stereo context."),0},this.overlayUpdate=function(e){r.overlayUpdate(e),a.overlayUpdate(e)},this.rolloverObjectViewport=function(e,t){},this.screenCapture=function(){return console.warn("Screen capture not implemented by stereo render context"),null},this.setUnitScale=function(e){r.setUnitScale(e),a.setUnitScale(e)},this.getUnitScale=function(){return r.getUnitScale()}},AutodeskNamespace("Autodesk.Viewing.Extensions.Oculus"),function(){function e(e){function t(){p.copy(n.matrixWorld),p.elements[12]=0,p.elements[13]=0,p.elements[14]=0,o&&h.set(o[1],o[2],o[3])}function i(){var e=new WebSocket("ws://localhost:8888/ws")
e.onopen=function(){console.log("### Oculus Connected ####")},e.onmessage=function(e){var t=e.data
try{o=JSON.parse(t)}catch(i){console.log(t)}},e.onclose=function(){console.log("### Oculus Connection Closed ####")},r=e}var n,o,r,s=e,l=new THREE.Vector3(0,0,0),c=new THREE.Quaternion,u=new THREE.Quaternion,d=new THREE.Matrix4,h=new THREE.Vector3(0,0,0),p=new THREE.Matrix4,f=new THREE.Matrix4,m=0,v=1,g=10,E=.001,y=-1,A=0,T=0,b=0,w=0,_=0,x=0,C=0
a?o=[0,0,0,0,0,0,0,0]:i(),this.getNames=function(){return["headtracker"]},this.getName=function(){return"headtracker"}
var S
this.activate=function(e){if(n=s.navigation.getCamera(),t(),s.model){v=1/s.model.getUnitScale()
var i=s.model.getBoundingBox()
g=1e-4*i.size().length()}(navigator.getGamepads||navigator.webkitGetGamepads||navigator.webkitGamepads)&&(S=new Autodesk.Viewing.Extensions.GamepadModule(s),S.activate(this.getName()))},this.deactivate=function(e){n=null,S&&S.deactivate()},this.update=function(t){0>y&&(y=t)
var i=t-y
if(n.isPerspective||e.navigation.toPerspective(),a){var s=a.getState()
o[0]=m+1,s.orientation&&(o[4]=s.orientation.x,o[5]=s.orientation.y,o[6]=s.orientation.z,o[7]=s.orientation.w),s.position&&(o[1]=s.position.x,o[2]=s.position.y,o[3]=s.position.z)}if(o){var R=o[0]
if(R>m){n.position.sub(l),l.set(o[1],o[2],o[3]),l.sub(h),l.multiplyScalar(v),l.applyMatrix4(p),n.position.add(l),A+=(x-C)*i*E,u.setFromAxisAngle(n.worldup,A),c.set(o[4],o[5],o[6],o[7]),u.multiply(c),f.makeRotationFromQuaternion(u),d.multiplyMatrices(p,f)
var M=d.elements,P=new THREE.Vector3(-M[8],-M[9],-M[10]),L=n.target.clone().sub(n.position).length()
n.up.set(M[4],M[5],M[6])
var I=new THREE.Vector3(M[0],M[1],M[2]),k=P.clone().multiplyScalar((T-w)*i*g)
n.position.add(k)
var V=I.multiplyScalar((_-b)*i*g)
n.position.add(V),n.target.set(n.position.x,n.position.y,n.position.z),n.target.add(P.multiplyScalar(L))}m=R}return r&&1===r.readyState&&r.send("get\n"),S&&(n=S.update(n)),y=t,!0},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e,t){return!1},this.handleKeyDown=function(e,t){var i=!1
switch(t){case 38:case 87:T=1,i=!0
break
case 40:case 83:w=1,i=!0
break
case 37:case 65:b=1,i=!0
break
case 39:case 68:_=1,i=!0
break
case 81:x=1,i=!0
break
case 69:C=1,i=!0}return i},this.handleKeyUp=function(e,i){var n=!1
switch(i){case 38:case 87:T=0,n=!0
break
case 40:case 83:w=0,n=!0
break
case 37:case 65:b=0,n=!0
break
case 39:case 68:_=0,n=!0
break
case 81:x=0,n=!0
break
case 69:C=0,n=!0
break
case 32:t(),n=!0}return n},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){return!1},this.handleGesture=function(e,t){return!1},this.handleTouchChange=function(e,t){return!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}}var t=Autodesk.Viewing,i=t.Extensions,n=(t.Private,t.UI),o=i.Oculus,r=null,a=null
o.Oculus=function(e,i){t.Extension.call(this,e,i),this.viewer=e,this.context=null,this.initialized=!1},o.Oculus.prototype=Object.create(t.Extension.prototype),o.Oculus.prototype.constructor=i.Oculus,o.Oculus.prototype.toggleOculus=function(t){var i=this.viewer
t?this.context||(this.context=new o.StereoRenderContext({useWarp:!r}),this.context.saveCameraState(this.viewer.navigation.getCamera()),i.impl.setUserRenderContext(this.context),i.resize(i.canvas.clientWidth,i.canvas.clientHeight),i.displayViewCube(!1,!1),i.navigation.isPerspective||i.navigation.toPerspective(),r?launchFullscreen(i.impl.canvas,{vrDisplay:r}):launchFullscreen(i.impl.canvas),this.headTracker||(this.headTracker=new e(i),i.toolController.registerTool(this.headTracker)),i.toolController.activateTool("headtracker")):this.context&&(this.viewer.navigation.setCamera(this.context.revertCameraChanges()),this.context=null,i.impl.setUserRenderContext(null),i.displayViewCube(i.prefs.get("viewCube"),!1),i.toolController.deactivateTool("headtracker"),exitFullscreen())},o.Oculus.prototype.createUI=function(){var e=this,t=this.viewer
this.oculusButton=new n.Button("toolbar-oculusTool"),this.oculusButton.setToolTip("Oculus VR Mode"),this.oculusButton.setIcon("oculusIcon"),this.oculusButton.onClick=function(t){e.toggleOculus(!e.context)},t.modelTools.addControl(this.oculusButton)},o.Oculus.prototype.load=function(){function e(i){o.removeEventListener(t.TOOLBAR_CREATED_EVENT,e),s.createUI()}function i(){o.modelTools&&o.modelTools.getNumberOfControls()>0?s.createUI():o.addEventListener(t.TOOLBAR_CREATED_EVENT,e)}function n(e){for(var t=0;t<e.length;++t)if(e[t]instanceof HMDVRDevice){r=e[t]
break}if(r){for(var t=0;t<e.length;++t)if(e[t]instanceof PositionSensorVRDevice&&e[t].hardwareUnitId==r.hardwareUnitId){a=e[t]
break}r&&a?i():stderr("Didn't find a HMD and sensor!"),s.initialized=!0}}var o=this.viewer,s=this
return navigator.getVRDevices?navigator.getVRDevices().then(n):navigator.mozGetVRDevices?navigator.mozGetVRDevices(n):this.initialized=!0,!0},o.Oculus.prototype.unload=function(){return this.toggleOculus(!1),!0},t.theExtensionManager.registerExtension("Autodesk.Viewing.Oculus",o.Oculus)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration"),function(){var e=Autodesk.Viewing,t=e.Private,i=e.Extensions,n=i.Collaboration
n.InteractionInterceptor=function(e){this.getNames=function(){return["intercept"]},this.getName=function(){return"intercept"},this.activate=function(e){},this.deactivate=function(e){},this.update=function(e){return!1},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e,t){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(t){return e.takeControl(),!1},this.handleButtonDown=function(t,i){return e.takeControl(),!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(t){return e.updatePointer(t),!1},this.handleGesture=function(t){return e.takeControl(),!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}},n.ViewTransceiver=function(i){function n(e){m=!0
var t=JSON.parse(e.data.msg)
b.restoreState(t),f.impl.invalidate(!0,!1,!0),m=!1}function o(e){return Math.round(1e3*e)/1e3}function r(e){for(var t=0;t<e.length;t++)e[t]=o(e[t])}function a(e){var t=e.data.msg
t[1]===!0||g||(t[0]!=h&&(h=t[0],e.data.lastInControl=t[0],p.dispatchEvent({type:"controlChange",channelId:p.channelId,data:e.data})),v=!1,f.navigation.setView((new THREE.Vector3).set(t[2],t[3],t[4]),(new THREE.Vector3).set(t[5],t[6],t[7])),f.navigation.setCameraUpVector((new THREE.Vector3).set(t[8],t[9],t[10])))}function s(e){if(v||g){var t=e.camera,n=[t.position.x,t.position.y,t.position.z,t.target.x,t.target.y,t.target.z,t.up.x,t.up.y,t.up.z]
r(n),n.unshift(g),n.unshift(i.getLocalId()),E.sendMessage("camera",n,p.channelId),h!=n[0]&&(h=n[0],p.dispatchEvent({type:"controlChange",channelId:p.channelId,data:{lastInControl:h}}))}}function l(e,t,i){e&&!A&&(A=document.createElement("div"),A.classList.add("collabPointer")),e&&!T?(f.container.appendChild(A),T=!0):!e&&T&&(f.container.removeChild(A),T=!1),e&&(A.style.left=t-6+"px",A.style.top=i-6+"px")}function c(e){if(!v&&!g){var t=e.data.msg
y.origin.set(t[1],t[2],t[3]),y.direction.set(t[4],t[5],t[6])
var i=y.at(f.getCamera().near)
i.project(f.getCamera()),i=f.impl.viewportToClient(i.x,i.y),l(!0,i.x,i.y)}}function u(e){if(v){var t=f.impl.clientToViewport(e.canvasX,e.canvasY)
f.impl.viewportToRay(t,y)
var n=[y.origin.x,y.origin.y,y.origin.z,y.direction.x,y.direction.y,y.direction.z]
r(n),n.unshift(i.getLocalId()),E.sendMessage("pointer",n,p.channelId)}}function d(e){if(!m){var t=b.getState(w)
i.sendMessage("state",JSON.stringify(t),p.channelId)}}var h,p=this,f=this.viewer=null,m=!1,v=!1,g=!1,E=this.client=i,y=new THREE.Ray,A=null,T=!1
this.channelId=null
var b,w={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}}
this.takeControl=function(){v=!0,l(!1)},this.updatePointer=function(e){u(e)},this.connectCamera=function(e){g=!e},this.attach=function(i){f&&this.detach(),this.viewer=f=i,b=new t.ViewerState(f),E.addEventListener("cameraChange",a),E.addEventListener("pointerMove",c),E.addEventListener("viewerState",n),f.hasEventListener(e.CAMERA_CHANGE_EVENT,s)||f.addEventListener(e.CAMERA_CHANGE_EVENT,s),f.hasEventListener(e.SELECTION_CHANGED_EVENT,d)||(f.addEventListener(e.SELECTION_CHANGED_EVENT,d),f.addEventListener(e.ISOLATE_EVENT,d),f.addEventListener(e.HIDE_EVENT,d),f.addEventListener(e.SHOW_EVENT,d),f.addEventListener(e.HIGHLIGHT_EVENT,d),f.addEventListener(e.EXPLODE_CHANGE_EVENT,d),f.addEventListener(e.LAYER_VISIBILITY_CHANGED_EVENT,d),f.addEventListener(e.CUTPLANES_CHANGE_EVENT,d))},this.detach=function(){E&&(E.removeEventListener("cameraChange",a),E.removeEventListener("viewerState",n)),f&&(f.removeEventListener(e.CAMERA_CHANGE_EVENT,s),f.removeEventListener(e.SELECTION_CHANGED_EVENT,d),f.removeEventListener(e.ISOLATE_EVENT,d),f.removeEventListener(e.HIDE_EVENT,d),f.removeEventListener(e.SHOW_EVENT,d),f.removeEventListener(e.HIGHLIGHT_EVENT,d),f.removeEventListener(e.EXPLODE_CHANGE_EVENT,d),f.removeEventListener(e.LAYER_VISIBILITY_CHANGED_EVENT,d),f.removeEventListener(e.CUTPLANES_CHANGE_EVENT,d),this.viewer=f=null,b=null)}},n.ViewTransceiver.prototype.constructor=n.ViewTransceiver,Autodesk.Viewing.EventDispatcher.prototype.apply(n.ViewTransceiver.prototype)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration"),function(){var e=Autodesk.Viewing,t=e.Extensions,i=e.Private,n=e.UI,o=t.Collaboration
t.Collaboration.Collaboration=function(t,i){e.Extension.call(this,t,i),i&&i.rtc&&i.rtc.disableRTCToolbarButton&&(this.disableRTCToolbarButton=!0)},t.Collaboration.Collaboration.prototype=Object.create(e.Extension.prototype),t.Collaboration.Collaboration.prototype.constructor=t.Collaboration.Collaboration,t.Collaboration.Collaboration.prototype.initNetwork=function(e){(!this.p2p||e)&&(this.viewtx=new o.ViewTransceiver(this.client),this.interceptor=new o.InteractionInterceptor(this.viewtx),this.viewer.toolController.registerTool(this.interceptor),this.p2p=new i.P2PClient(this.client))},t.Collaboration.Collaboration.prototype.createUI=function(){var e=this,r=this.viewer
if(this.initNetwork(!1),this.panel=new o.DockingCollabPanel(this.viewer,this.client,this.p2p,this.viewtx),t.Collaboration.Collaboration.Panel=this.panel,this.collabButton=new n.Button("toolbar-collaborateTool"),this.collabButton.setToolTip("Live review"),this.collabButton.setIcon("adsk-icon-live-review"),this.collabButton.onClick=function(t){var i=e.panel.isVisible()
if(!document.getElementById("collabBox"))if(i||e.inviteDivInstantiated)e.panel.setVisible(!1,!0),e.panel.reset()
else{var n=new o.CollabPromptBox,a=r.container
n.start(a,function(){e.panel.setVisible(!0,!0)},"Start a Live Review","Start Review")}},this.disableRTCToolbarButton&&this.collabButton.setVisible(!1,!0),this.panel.addVisibilityListener(function(t){if(t){if(r.model){var o=r.model.getData()
e.viewtx.channelId=o.basePath,e.viewtx.attach(r),e.client.connect(e.viewtx.channelId),e.client.join(e.viewtx.channelId)}r.toolController.activateTool(e.interceptor.getName())
e.collabButton.setState(n.Button.State.ACTIVE),i.logger&&i.logger.log({category:"viewer_rtc_start"})}else i.logger&&e.client.isConnected()&&i.logger.log({category:"viewer_rtc_stop"}),e.p2p.hangup(),e.viewtx.detach(r),e.viewtx.channelId=null,e.client.disconnect(),e.panel.reset(),r.toolController.deactivateTool(e.interceptor.getName()),e.collabButton.setState(n.Button.State.INACTIVE)}),r.modelTools.addControl(this.collabButton),Autodesk.Viewing.Private.getParameterByName("invited")){var a=new CollabPromptBox,s=r.container
a.start(s,function(){e.panel.setVisible(!0,!0)},"Join a Live Review","Join Review")}},t.Collaboration.Collaboration.prototype.close=function(){this.panel.setVisible(!1,!0),this.panel.reset()},t.Collaboration.Collaboration.prototype.load=function(){function e(){function e(i){t.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e),n.createUI()}n.client=i.MessageClient.GetInstance(n.options?n.options.messageServerURL:void 0),n.socketErrorHandler=function(e){i.ErrorHandler.reportError(t.container,Autodesk.Viewing.ErrorCodes.RTC_ERROR,e.data),n.close()},n.client.addEventListener("socketError",n.socketErrorHandler),n.presenceChannelId=window.location.host,n.client.isConnected(),t.modelTools?n.createUI():t.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e)}var t=this.viewer,n=this
return i.loadDependency("lmv_io","socket.io-1.3.5.js",e),!0},t.Collaboration.Collaboration.prototype.unload=function(){var e=this.viewer
return this.client.removeEventListener("socketError",this.socketErrorHandler),this.socketErrorHandler=null,this.p2p.hangup(),this.viewtx.detach(e),this.client.disconnect(),this.panel&&(this.panel.reset(),this.panel.setVisible(!1),this.panel.uninitialize(),this.panel=null),e.toolController.deactivateTool(this.interceptor.getName()),this.interceptor=null,e.modelTools.removeControl(this.collabButton.getId()),this.collabButton=null,!0},e.theExtensionManager.registerExtension("Autodesk.Viewing.Collaboration",t.Collaboration.Collaboration)}(),function(){function e(e,i,n,o){this.viewer=e,this.client=i,this.p2p=n,this.viewtx=o
var r="CollabPanel"
t.UI.DockingPanel.call(this,e.container,r,"Live review"),this.container.classList.add("collabPanel"),this.container.style.height="auto",this.container.dockRight=!0,this.content=document.createElement("div"),this.container.appendChild(this.content),this.content.classList.add("collabPanelContent"),this.tableContainer=document.createElement("div"),this.tableContainer.classList.add("userListTable","dockingPanelScroll"),this.table=document.createElement("table"),this.table.classList.add("tftable"),this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.tableContainer.appendChild(this.table),this.content.appendChild(this.tableContainer),this.inviteDiv=document.createElement("div"),this.inviteDiv.className="collabBoxOK",this.inviteDiv.style["float"]="left",this.inviteDiv.style.width="232px",this.inviteDiv.setAttribute("data-i18n","Invite"),this.inviteDiv.textContent=Autodesk.Viewing.i18n.translate("Invite"),this.content.appendChild(this.inviteDiv),this.inviteDiv.addEventListener("click",function(t){var i=new CollabPromptBox,n=e.container
i.start(n,function(){var e=Autodesk.Viewing.i18n.translate("Please Join My Live Review")
document.location.href="mailto:?subject="+e},"Invite Others","Email Invite",!0)}),this.chatHistory=document.createElement("div"),this.chatHistory.classList.add("chatHistory"),this.chatHistory.classList.add("textEntry"),this.chatHistory.classList.add("dockingPanelScroll"),this.content.appendChild(this.chatHistory),this.chatPanel=document.createElement("div"),this.chatPanel.classList.add("chatPanel"),this.textInput=document.createElement("input"),this.textInput.type="text",this.textInput.classList.add("textEntry"),this.textInput.placeholder=Autodesk.Viewing.i18n.translate("Type a message"),this.chatPanel.appendChild(this.textInput),this.content.appendChild(this.chatPanel),this.isCameraConnected=!0
var a=this
this.addEventListener(i,"userListChange",function(e){if(!e.channelId||e.channelId===a.viewtx.channelId){var t=a.client.getChannelInfo(a.viewtx.channelId)
t&&a.updateUsers(t.users)}}),this.addEventListener(this.viewtx,"controlChange",function(e){e.channelId===a.viewtx.channelId&&a.updateUserInControl(e.data.lastInControl)}),this.addEventListener(i,"chatReceived",function(e){e.channelId===a.viewtx.channelId&&a.updateChatHistory(e)}),this.textInput.onkeyup=function(e){a.handleChatInput(e)},this.addEventListener(this.p2p,"remoteStreamAdded",function(e){a.videoPanel||a.createVideoPanel(),a.remoteVideo.src=window.URL.createObjectURL(e.data)}),this.addEventListener(this.p2p,"localStreamAdded",function(e){a.videoPanel||a.createVideoPanel(),a.localVideo.src=window.URL.createObjectURL(e.data)}),this.addEventListener(this.p2p,"remoteHangup",function(e){a.removeVideoPanel()})}var t=Autodesk.Viewing,i=t.Extensions,n=t.Private,o=(t.UI,i.Collaboration)
Autodesk.Viewing.startLiveReviewSession=function(){o.Panel&&o.Panel.startSession()},Autodesk.Viewing.endLiveReviewSession=function(){o.Panel&&o.Panel.endSession()}
e.prototype=Object.create(t.UI.DockingPanel.prototype),e.prototype.constructor=e,e.prototype.startSession=function(){var e=this,t=this.isVisible()
if(!t){var i=new CollabPromptBox,n=this.viewer.container
i.start(n,function(){e.setVisible(!0,!0)},"Start a Live Review","Start Review")}},e.prototype.endSession=function(){var e=this.isVisible()
e&&(this.setVisible(!1,!0),this.reset())},e.prototype.updateUsers=function(e){for(var t=document.createElement("tbody"),i=0;i<e.length;i++){var n=t.insertRow(-1)
n.id=e[i].id
var o=n.insertCell(0)
o.style.width="14px",o.style.cursor="default"
var r=document.createElement("div")
r.classList.add("statusBase"),r.classList.add("statusNormal"),r.innerHTML="&#9679",o.appendChild(r)
var a=n.insertCell(1)
a.textContent=e[i].name}this.table.replaceChild(t,this.tbody),this.tbody=t,this.fixComponentPlacement()},e.prototype.updateUserInControl=function(e){for(var t=0;t<this.tbody.rows.length;t++){var i=this.tbody.rows[t],n=i.cells[0].childNodes[0]
i.id==e?(n.classList.remove("statusNormal"),n.classList.add("statusInControl"),n.innerHTML="&#9784",i.cells[1].style.color="#4CBA36"):(n.classList.remove("statusInControl"),n.classList.add("statusNormal"),n.innerHTML="&#9679",i.cells[1].style.color="#ffffff")}},e.prototype.updateChatHistory=function(e){var t=this.client.getUserById(e.data.from,e.channelId)
if("/"!=e.data.msg.charAt(0)){if(this.chatHistory.lastUser!=t.name){var i=document.createElement("p"),n=document.createElement("div")
n.classList.add("heading"),n.style["float"]="left",n.style.fontStyle="normal",n.style.color="#857E7E",n.textContent=t.name,i.appendChild(n)
var o=document.createElement("div")
o.classList.add("heading"),o.style.textAlign="right",o.style.fontStyle="normal",o.style.color="#857E7E",o.textContent=(new Date).toLocaleTimeString(),i.appendChild(o),this.chatHistory.appendChild(i),this.chatHistory.lastUser=t.name}else{var r=document.createElement("br")
this.chatHistory.appendChild(r)}var a=document.createElement("span")
a.classList.add("messageText"),a.textContent=e.data.msg,this.chatHistory.appendChild(a),this.chatHistory.scrollTop=this.chatHistory.scrollHeight}},e.prototype.handleChatInput=function(e){13==e.which&&0!=this.textInput.value.length&&(this.client.sendChatMessage(this.textInput.value,this.viewtx.channelId),this.textInput.value="",this.textInput.placeholder="")},e.prototype.fixComponentPlacement=function(e){var t=this.tableContainer.offsetHeight+this.chatPanel.offsetHeight
this.videoPanel?(t+=this.videoPanel.offsetHeight,this.chatHistory.style.height="calc(100% - "+t+"px)"):this.chatHistory.style.height="calc(100% - "+t+"px)"},e.prototype.createVideoPanel=function(e){this.videoPanel=document.createElement("div"),this.videoPanel.classList.add("videoPanel"),this.localVideo=document.createElement("video"),this.localVideo.autoplay=!0,this.localVideo.muted=!0,this.localVideo.classList.add("videoInset"),this.videoPanel.appendChild(this.localVideo),this.remoteVideo=document.createElement("video"),this.remoteVideo.autoplay=!0,this.remoteVideo.classList.add("videoMain"),this.videoPanel.appendChild(this.remoteVideo)
var t=this,i=document.createElement("div")
i.classList.add("dockingPanelClose"),i.innerHTML="&times",i.title=Autodesk.Viewing.i18n.translate("End video call"),i.onclick=function(e){t.p2p.hangup(),t.removeVideoPanel()},this.videoPanel.appendChild(i),this.content.insertBefore(this.videoPanel,this.chatHistory),this.fixComponentPlacement()},e.prototype.removeCollabPrompt=function(){var e=document.getElementById("collabBox")
e&&(e.style.visibility="hidden",this.viewer.container.removeChild(e))},e.prototype.removeVideoPanel=function(){this.videoPanel&&this.content.removeChild(this.videoPanel),this.videoPanel=null},e.prototype.reset=function(e){if(this.tbody){var t=document.createElement("tbody")
this.table.replaceChild(t,this.tbody),this.tbody=t}this.chatHistory.textContent="",this.textInput.value="",this.removeVideoPanel(),this.removeCollabPrompt()},CollabPromptBox=function(){},CollabPromptBox.prototype.start=function(e,t,i,o,r){if(e&&!document.getElementById("collabBox")){var a=document.createElement("div")
a.id="collabBox",a.className="collabBox",e.appendChild(a)
var s=document.createElement("div")
s.className="collabBoxTitle",s.textContent=Autodesk.Viewing.i18n.translate(i,{defaultValue:i}),a.appendChild(s)
var l=document.createElement("span")
l.className="collabBoxText"
var c="Enter your name"
r&&(c="Review URL"),l.textContent=Autodesk.Viewing.i18n.translate(c,{defaultValue:c}),a.appendChild(l)
var u=document.createElement("span")
u.className="collabBoxInputContainer",a.appendChild(u)
var d=document.createElement("input")
if(d.type="text",d.className="collabBoxInputText",r){var h=window.location.toString()
h+=-1==h.indexOf("?")?"?invited=true":"&invited=true",Autodesk.Viewing.Private.docItemId&&(h+="&itemid="+Autodesk.Viewing.Private.docItemId),h+="&doNotRedirect=true",d.value=h}u.appendChild(d),d.onkeyup=function(i){13==i.keyCode&&(a.style.visibility="hidden",e.removeChild(a),n.setUserName(d.value),t())}
var p=document.createElement("div")
if(p.className="collabBoxClose",p.innerHTML="&times;",p.addEventListener("click",function(t){a.style.visibility="hidden",e.removeChild(a)}),a.appendChild(p),r){var l=document.createElement("span")
l.className="collabBoxText",l.style.marginTop="0px"
var c="Copy and send this URL to invite others"
l.textContent=Autodesk.Viewing.i18n.translate(c,{defaultValue:c}),a.appendChild(l)}else{var f=document.createElement("div")
f.className="collabBoxOK",f.textContent=Autodesk.Viewing.i18n.translate(o,{defaultValue:o}),f.addEventListener("click",function(i){a.style.visibility="hidden",e.removeChild(a),""!==d.value.trim()&&n.setUserName(d.value),t()}),a.appendChild(f)}a.style.visibility="visible",d.focus(),r&&d.select()}},o.DockingCollabPanel=e,o.CollabPromptBox=CollabPromptBox}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Beeline"),Autodesk.Viewing.Extensions.Beeline.BeelineExtension=function(e,t){Autodesk.Viewing.Extension.call(this,e,t)},Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype),Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.constructor=Autodesk.Viewing.Extensions.Beeline.BeelineExtension,Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.load=function(){function e(){return a=n.getActiveNavigationTool(),n.setActiveNavigationTool(i.tool.getName()),!0}function t(){return n.setActiveNavigationTool(a?a:n.defaultNavigationToolName),!0}var i=this,n=this.viewer,o=n.getToolbar(!0),r=Autodesk.Viewing.UI
this.tool=new Autodesk.Viewing.Extensions.Beeline.BeelineTool(n.impl,n),n.toolController.registerTool(this.tool),this.createUI(o)
var a
this.HOTKEYS_ID="Autodesk.Beeline.Hotkeys"
var s=[]
return s.push({keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.CONTROL,Autodesk.Viewing.theHotkeyManager.KEYCODES.ALT],onPress:e,onRelease:t}),Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.HOTKEYS_ID,s),this.onToolChanged=function(e){if(-1!==e.toolName.indexOf("beeline")){var t=e.active?r.Button.State.ACTIVE:r.Button.State.INACTIVE
i.beelineButton.setState(t)}},n.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged),!0},Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.createUI=function(e){var t=Autodesk.Viewing.UI,i=e.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID),n="toolbar-beelineTool",o=this.viewer,r=new t.Button(n)
r.setToolTip("Walk to"),r.setIcon("adsk-icon-walk"),r.onClick=function(e){var i=r.getState()
i===t.Button.State.INACTIVE?o.setActiveNavigationTool("beeline"):i===t.Button.State.ACTIVE&&o.setActiveNavigationTool()},this.beelineButton=r
var a=i.getControl("toolbar-cameraSubmenuTool")
a?i.addControl(this.beelineButton,{index:i.indexOf(a.getId())}):i.addControl(this.beelineButton)
var s=this,l=function(){o.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,l)
var e=Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation,t=o.getSettingsPanel(!0)
s.viewerOption_LookHorId=t.addCheckbox(e,"Reverse horizontal look direction",!1,function(e){o.setReverseHorizontalLookDirection(e)},"reverseHorizontalLookDirection"),s.viewerOption_LookVertId=t.addCheckbox(e,"Reverse vertical look direction",!1,function(e){o.setReverseVerticalLookDirection(e)},"reverseVerticalLookDirection")}
this.viewer.getSettingsPanel(!1)?l():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,l)},Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.unload=function(){var e=this.viewer
e.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged),this.onToolChanged=void 0,Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID)
var t=e.getToolbar(!1)
return t&&t.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID).removeControl(this.beelineButton.getId()),this.beelineButton=null,this.viewer.getSettingsPanel(!1).removeCheckbox(this.viewerOption_LookHorId),this.viewer.getSettingsPanel(!1).removeCheckbox(this.viewerOption_LookVertId),e.getActiveNavigationTool()==this.tool.getName()&&e.setActiveNavigationTool(),e.toolController.deregisterTool(this.tool),this.tool=null,!0},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Beeline",Autodesk.Viewing.Extensions.Beeline.BeelineExtension),AutodeskNamespace("Autodesk.Viewing.Extensions.Beeline"),Autodesk.Viewing.Extensions.Beeline.BeelineTool=function(e,t){function i(){f.revertToStartState()}function n(e){var t={}
t.target=e.target.clone(),t.worldup=e.worldup.clone(),t.position=e.position.clone(),t.up=e.up.clone()
for(var i=["isPerspective","fov","zoom","aspect","left","right","top","bottom"],n=0;n<i.length;n++)t[i[n]]=e[i[n]]
return t}function o(e,t){var i=e.target.equals(t.target)&&e.position.equals(t.position)&&e.worldup.equals(t.worldup)&&e.up.equals(t.up)
if(!i)return!1
for(var n=["isPerspective","fov","zoom","aspect","left","right","top","bottom"],o=0;o<n.length;o++)if(e[n[o]]!==t[n[o]])return!1
return!0}function r(i){var n=new THREE.Vector3(i.x,i.y,1),o=e.hitTestViewport(n.clone(),!1)
if(!o||!o.intersectPoint)return[]
var r=new THREE.Raycaster,a=n.clone(),s=e.camera,l=new THREE.Vector3(a.x,a.y,1)
a.z=-1,a=a.unproject(s),l=l.unproject(s),l.sub(a).normalize(),r.set(E.isPerspective?s.position:a,l)
for(var c=[],u=o.fragId instanceof Array?o.fragId:[o.fragId],d=0;d<u.length;d++){var h=e.getRenderProxy(t.model,u[d])
VBIntersector.meshRayCast(h,r,c)}return c.sort(function(e,t){return e.distance-t.distance}),c}function a(){E.isPerspective||(E.toPerspective(),y.activatePivot(!1)),E.getFocalLength()>u&&E.setFocalLength(u,!0)}var s={GO_TO:0,PASS_THROUGH:1,DEFAULT:0},l=1e3,c=.8,u=28,d=.7,h=0,p=1,f=this,m=t,v=t.container,g=t.autocam,E=t.navigation,y=t.utilities,A=["beeline"],T=h,b=!1,w=0,_=null,x=null,C=new THREE.Vector3,S=new THREE.Vector3,R=new THREE.Vector3,M=new THREE.Vector3,P=!1,L=new THREE.Vector3,I=new THREE.Vector3,k=null,V=null
this.getNames=function(){return A},this.getName=function(){return A[0]},this.activate=function(e){w=0,t.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,i),g.userLookSpeed=c,this.showHUDMessage(!0)},this.deactivate=function(){t.removeEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,i),this.revertToStartState(),this.showHUDMessage(!1)},this.getCursor=function(){return b?"url(data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAQAAADYBBcfAAAACXBIWXMAABYlAAAWJQFJUiTwAAADGGlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBFTAyMHy7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BSMDVQYqg4jIKAUICxE+CDEESC4tKoMHJQODAIMCgwGDA0MAQyJDPcMChqMMbxjFGV0YSxlXMN5jEmMKYprAdIFZmDmSeSHzGxZLlg6WW6x6rK2s99gs2aaxfWMPZ9/NocTRxfGFM5HzApcj1xZuTe4FPFI8U3mFeCfxCfNN45fhXyygI7BD0FXwilCq0A/hXhEVkb2i4aJfxCaJG4lfkaiQlJM8JpUvLS19QqZMVl32llyfvIv8H4WtioVKekpvldeqFKiaqP5UO6jepRGqqaT5QeuA9iSdVF0rPUG9V/pHDBYY1hrFGNuayJsym740u2C+02KJ5QSrOutcmzjbQDtXe2sHY0cdJzVnJRcFV3k3BXdlD3VPXS8Tbxsfd99gvwT//ID6wIlBS4N3hVwMfRnOFCEXaRUVEV0RMzN2T9yDBLZE3aSw5IaUNak30zkyLDIzs+ZmX8xlz7PPryjYVPiuWLskq3RV2ZsK/cqSql01jLVedVPrHzbqNdU0n22VaytsP9op3VXUfbpXta+x/+5Em0mzJ/+dGj/t8AyNmf2zvs9JmHt6vvmCpYtEFrcu+bYsc/m9lSGrTq9xWbtvveWGbZtMNm/ZarJt+w6rnft3u+45uy9s/4ODOYd+Hmk/Jn58xUnrU+fOJJ/9dX7SRe1LR68kXv13fc5Nm1t379TfU75/4mHeY7En+59lvhB5efB1/lv5dxc+NH0y/fzq64Lv4T8Ffp360/rP8f9/AA0ADzT6lvFdAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEtSURBVHja7JQxTkJBFEXPQ/xQEDG0ljRYSU1iLN2AtSWlC7Gw04QtGF2ApQVLIDY2hlgIDagJwWCOhf74JXxRYumbaib3ZO7c9zIhq1WBfzAfjJViDWPdYBq/w0pKITjhd7eGJwQkDu2I8rOFHYcmkqgDz4wfoeGZA01BHXtsbSla89ixZsH3an2LtpRUOQde28xFm17PgyPvVK1bl5yYEOtuq3rnyMQCXNJgiiTchuHCnhrGbYBMaXAJULGqlJz54O43bcFdH5xZUqpWJJWW7duza/tDmTWJbbv27Fs2PS2m1iZRNeGcI/aAEevOgCKnbAI7DNjjhUmk1ouf7xgHbLgF3MSzT7wCaxxSiW3hnsf4OngLotj3ILO74CoWTWzOIGcTXab4/6z+CnwbAGjXSZC++vLvAAAAAElFTkSuQmCC), auto":1>=w?"url(data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAQdJREFUeNq0k0GOgzAMRZ+jHI4VO4410qzam0aCjbsoaS1PUgfoWIqAEPnZ3z8AN0DNWoFfVeUbC0BtrOtaISNhC3tvGkC2P7ZtY1kWgHul90JEtCYTkVqo7O844LPyeZ51RJ5atQ3biZeolFJ0miYd1d4nd5A/gB+g7E++AFB7VqzWIkKkfdW/d27P8RpE4p8jRy7Z9ZBOpSEgRRb0MAv0lmxZNEXJj0IACTvwrfeksJBW9a0Z6NEh+vl4UI6qHzHBJ4nyFQv6YoaG3Ls80X7vTIqS1W+vdWvArfuSG/pplPzTBRy6ybaLkSSHAFcThoCe/c6C81n7jUY6a78rHQigftBnQY8BAEubfpuApyq2AAAAAElFTkSuQmCC), auto":null},this.update=function(){var e=E.getCamera()
b=!1
var i=!1
if(1===w){var o=L.clone().sub(I)
if(0!==o.x||0!==o.y){b=!0,I.x+=o.x*d,I.y+=o.y*d
var r=E.getWorldUpVector().dot(E.getCameraUpVector()),a=t.prefs.reverseHorizontalLookDirection?-1:1,s=t.prefs.reverseVerticalLookDirection?-1:1
o.x*=0>r?-a:a,o.y*=s,g.sync(E.getCamera()),g.look(o),i=!0,k=n(e)}}return i},this.revertToStartState=function(){y.pivotActive(!1),T=h,P=!0},this.attemptFlight=function(e,t){var i=r(e)
i.length>0&&(C=i[0].point,S=i[i.length-1].point,f.fly(l,t))},this.fly=function(e,t){switch(y.setPivotPoint(t===s.GO_TO?C:S,!0,!0),a(),R=E.getPosition(),x=e,t){case s.GO_TO:M=R.clone().lerp(C,.8)
break
case s.PASS_THROUGH:var i=2*g.camera.near,n=S.clone().sub(R).length(),o=i/n
y.setPivotPoint(R.clone().lerp(S,1+10*o),!0,!0),M=R.clone().lerp(S,1+o)
break
default:return}T=p,P=!1,_=null,requestAnimationFrame(f.step)},this.step=function(e){var t=E.getCamera()
if(!P){if(null===_)k=n(t),_=e
else if(!o(t,k))return void f.revertToStartState()
var i=e-_,r=x>i?i/x:1,a=R.clone().lerp(M,r),s=E.getEyeVector()
s.multiplyScalar(E.getPivotPoint().sub(E.getPosition()).length()/s.length()),E.setView(a,s.add(a)),k=n(t),y.activatePivot(!1),x>i?requestAnimationFrame(f.step):f.revertToStartState()}},this.handleGesture=function(e){switch(e.type){case"dragstart":return V="drag",this.handleButtonDown(e,0)
case"dragmove":return"drag"===V?this.handleMouseMove(e):!1
case"dragend":return"drag"===V?(this.handleButtonUp(e,0),V=null,!0):!1}return!1},this.handleButtonDown=function(e,t){return w+=1<<t,0===t?(I.x=L.x=e.canvasX,I.y=L.y=e.canvasY,!0):!1},this.handleButtonUp=function(e,t){return w-=1<<t,0===t?!0:!1},this.handleSingleClick=function(e,t){if(0!==t)return this.revertToStartState(),!1
var i={x:e.normalizedX,y:e.normalizedY}
switch(T){case h:f.attemptFlight(i,s.GO_TO)
break
case p:f.revertToStartState()}return!0},this.handleSingleTap=function(e){return this.handleSingleClick(e,0)},this.handleDoubleTap=function(e){return e.pointers&&1===e.pointers.length?(f.attemptFlight({x:e.normalizedX,y:e.normalizedY},s.PASS_THROUGH),!0):!1},this.handleDoubleClick=function(e,t){return 0===t?(f.attemptFlight({x:e.normalizedX,y:e.normalizedY},s.PASS_THROUGH),!0):!1},this.handleMouseMove=function(e){return L.x=e.canvasX,L.y=e.canvasY,1===w?(a(),!0):!1},this.handleBlur=function(e){return this.revertToStartState(),!1},this.showOrthoWarningMessage=function(){var e={msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic Beeline",messageDefaultValue:"The view is set to Orthographic. Using this tool will switch to Perspective."}
Autodesk.Viewing.Private.HudMessage.displayMessage(v,e)},this.showFocalWarningMessage=function(){var e={msgTitleKey:"Long Focal Length View Set",messageKey:"The view is set to a long focal length",messageDefaultValue:"This view has a long focal length. Using this tool will set a short focal length."}
Autodesk.Viewing.Private.HudMessage.displayMessage(v,e)},this.watchCamera=function(e){if(m.toolController.getActiveToolName()===A[0]||m.toolController.getActiveToolName()===A[1]){var t=E.getCamera(),i=t&&!t.isPerspective,n=E.getFocalLength()>u
i?f.showOrthoWarningMessage():n?f.showFocalWarningMessage():Autodesk.Viewing.Private.HudMessage.dismiss()}},this.showHUDMessage=function(e){var t=E.getCamera(),i=t&&!t.isPerspective,n=E.getFocalLength()>u
e&&i?f.showOrthoWarningMessage():e&&n?f.showFocalWarningMessage():Autodesk.Viewing.Private.HudMessage.dismiss(),e?m.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,f.watchCamera):m.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,f.watchCamera)}},function(){"use strict"
function e(e,t,i){return function(){var o=t.getState()
o===n.Button.State.INACTIVE?(e.setActiveNavigationTool(i),t.setState(n.Button.State.ACTIVE)):o===n.Button.State.ACTIVE&&(e.setActiveNavigationTool(),t.setState(n.Button.State.INACTIVE))}}var t=AutodeskNamespace("Autodesk.Viewing.Extensions.DefaultTools"),i=Autodesk.Viewing,n=i.UI,o=function(e,t){i.Extension.call(this,e,t)}
o.prototype=Object.create(i.Extension.prototype),o.prototype.constructor=o,o.prototype.load=function(){var e=this.viewer,t=new i.FovTool(e),n=new i.WorldUpTool(e.impl,e)
return e.toolController.registerTool(t),e.toolController.registerTool(n),this.createUI(),this.initCameraStateMachine(),this.initFocalLengthOverlay(),!0},o.prototype.createUI=function(){var t=this.viewer,o=t.getToolbar(!0),r=o.getControl(i.TOOLBAR.NAVTOOLSID)
if(r.returnToDefault=function(){},"3d"===this.options.mode){var a=new n.ComboButton("toolbar-orbitTools")
a.setToolTip("Orbit"),a.setIcon("adsk-icon-orbit-constrained"),this.createOrbitSubmenu(a),r.addControl(a),r.orbittoolsbutton=a,a.setState(n.Button.State.ACTIVE),r.returnToDefault=function(){a.setState(n.Button.State.ACTIVE)}}var s=new n.Button("toolbar-panTool")
s.setToolTip("Pan"),s.setIcon("adsk-icon-pan"),s.onClick=e(t,s,"pan"),r.addControl(s),r.panbutton=s
var l=new n.Button("toolbar-zoomTool")
l.setToolTip("Zoom"),l.setIcon("adsk-icon-zoom"),l.onClick=e(t,l,"dolly"),r.addControl(l),r.dollybutton=l
var c=new n.ComboButton("toolbar-cameraSubmenuTool")
c.setToolTip("Camera interactions"),c.setIcon("adsk-icon-camera"),c.saveAsDefault(),this.createCameraSubmenu(c),r.addControl(c),r.camerabutton=c},o.prototype.createOrbitSubmenu=function(t){var o=this.viewer,r=o.getToolbar(!0),a=r.getControl(i.TOOLBAR.NAVTOOLSID),s=new n.Button("toolbar-freeOrbitTool")
s.setToolTip("Free orbit"),s.setIcon("adsk-icon-orbit-free"),s.onClick=e(o,s,"freeorbit"),t.addControl(s),a.freeorbitbutton=s
var l=new n.Button("toolbar-orbitTool")
l.setToolTip("Orbit"),l.setIcon("adsk-icon-orbit-constrained"),l.onClick=e(o,l,"orbit"),t.addControl(l),a.orbitbutton=l,t.onClick=l.onClick},o.prototype.createCameraSubmenu=function(t){var o=this,r=this.viewer,a=r.getToolbar(!0),s=a.getControl(i.TOOLBAR.NAVTOOLSID)
if(isTouchDevice()){var l=new n.Button("toolbar-homeTool")
l.setToolTip("Home"),l.setIcon("adsk-icon-home"),l.onClick=function(){r.navigation.setRequestHomeView(!0)
var e=r.getDefaultNavigationToolName()
r.setActiveNavigationTool(e),t.restoreDefault()},t.addControl(l),s.homebutton=l}var c=new n.Button("toolbar-fitToViewTool")
if(c.setToolTip("Fit to view"),c.setIcon("adsk-icon-fit-to-view"),c.onClick=function(e){r.fitToView("3d"===o.options.mode?r.getSelection():void 0)
var i=r.getDefaultNavigationToolName()
r.setActiveNavigationTool(i),t.restoreDefault()},t.addControl(c),s.fovbutton=c,"3d"===this.options.mode){var u=new n.Button("toolbar-focalLengthTool")
u.setToolTip("Focal length"),u.setIcon("adsk-icon-fov"),u.onClick=e(r,u,"fov"),t.addControl(u),s.fovbutton=u}var d=new n.Button("toolbar-rollTool")
d.setToolTip("Roll"),d.setIcon("adsk-icon-roll"),d.onClick=e(r,d,"worldup"),t.addControl(d),s.rollbutton=d},o.prototype.initCameraStateMachine=function(e){var t=this,n=this.viewer,o=n.getToolbar(!0),r=o.getControl(i.TOOLBAR.NAVTOOLSID)
this.toolChangedHandler=function(e){"fov"===e.toolName&&t.showFocalLengthOverlay(e.active)},n.addEventListener(i.TOOL_CHANGE_EVENT,this.toolChangedHandler),this.navChangedHandler=function(e){n.getDefaultNavigationToolName()===e.id&&r.returnToDefault()},n.addEventListener(i.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler)},o.prototype.initFocalLengthOverlay=function(){var e=this.focallength=document.createElement("div")
e.className="focallength"
var t=document.createElement("table"),i=document.createElement("tbody")
t.appendChild(i),e.appendChild(t),this.viewer.container.appendChild(e)
var n=i.insertRow(-1),o=n.insertCell(0)
o.setAttribute("data-i18n","Focal Length"),o.textContent=Autodesk.Viewing.i18n.translate("Focal Length"),o=n.insertCell(1),o.textContent="",o.style.width="4em",o.style.textAlign="right",this.fovCell=o,e.style.visibility="hidden"},o.prototype.showFocalLengthOverlay=function(e){function t(e){if(e){var t={msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."}
i.Private.HudMessage.displayMessage(s.container,t)}else i.Private.HudMessage.dismiss()}function n(e){e&&o(),a.focallength&&(a.focallength.style.visibility=e?"visible":"hidden")}function o(){var e=s.getFocalLength()
l!==e&&(l=e,a.fovCell.textContent=e.toString()+" mm")}function r(e){if(o(),"fov"===s.toolController.getActiveToolName()){var i=s.navigation.getCamera(),r=i&&!i.isPerspective
n(!r),t(r)}}var a=this,s=this.viewer,l=0,c=s.navigation.getCamera(),u=c&&!c.isPerspective
n(e&&!u),t(e&&u),e?s.addEventListener(i.CAMERA_CHANGE_EVENT,r):s.removeEventListener(i.CAMERA_CHANGE_EVENT,r)},o.prototype.unload=function(){return this.destroyUI(),!0},o.prototype.destroyUI=function(){var e=this.viewer,t=e.getToolbar(!1)
if(!t)return!0
var o=t.getControl(i.TOOLBAR.NAVTOOLSID)
return o?("3d"===this.options.mode&&(o.orbittoolsbutton.subMenu.removeEventListener(n.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,o.orbittoolsbutton.subMenuActiveButtonChangedHandler(o)),o.removeControl(o.orbittoolsbutton.getId()),o.orbittoolsbutton=null,o.orbitbutton.onClick=null,o.orbitbutton=null,o.freeorbitbutton.onClick=null,o.freeorbitbutton=null),o.removeControl(o.panbutton.getId()),o.panbutton.onClick=null,o.panbutton=null,o.removeControl(o.dollybutton.getId()),o.dollybutton.onClick=null,o.dollybutton=null,o.camerabutton.subMenu.removeEventListener(n.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,o.camerabutton.subMenuActiveButtonChangedHandler(o)),o.removeControl(o.camerabutton.getId()),o.camerabutton.onClick=null,o.camerabutton=null,o.rollbutton.onClick=null,o.rollbutton=null,o.fovbutton.onClick=null,o.fovbutton=null,this.focallength=null,e.removeEventListener(i.TOOL_CHANGE_EVENT,this.toolChangedHandler),this.toolChangedHandler=null,e.removeEventListener(i.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler),this.navChangedHandler=null,!0):!0},t.NavToolsExtension=o,i.theExtensionManager.registerExtension("Autodesk.DefaultTools.NavTools",o)}(),function(){"use strict"
var e=AutodeskNamespace("Autodesk.Viewing.Extensions.Measure"),t=Autodesk.Viewing,i=t.UI,n=(t.Extensions,function(e,t){Autodesk.Viewing.Extension.call(this,e,t)})
n.prototype=Object.create(Autodesk.Viewing.Extension.prototype),n.prototype.constructor=n,n.prototype.onToolbarCreated=function(){this.viewer.removeEventListener(t.TOOLBAR_CREATED_EVENT,this.bindedOnToolbarCreated),this.bindedOnToolbarCreated=null,this.createUI()},n.prototype.load=function(){var i=this,n=this.viewer
return this.escapeHotkeyId="Autodesk.Measure.Hotkeys.Escape",n.toolController?(this.tool=new e.MeasureTool(n,{onCloseCallback:function(e){i.enableMeasureTool(!1)}}),n.toolController.registerTool(this.tool),this.viewer.toolbar?this.createUI():(this.bindedOnToolbarCreated=this.onToolbarCreated.bind(this),this.viewer.addEventListener(t.TOOLBAR_CREATED_EVENT,this.bindedOnToolbarCreated)),!0):!1},n.prototype.unload=function(){var e=this.viewer
return this.destroyUI(),this.bindedOnToolbarCreated&&(this.viewer.removeEventListener(t.TOOLBAR_CREATED_EVENT,this.bindedOnToolbarCreated),this.bindedOnToolbarCreated=null),e.toolController.deregisterTool(this.tool),this.tool=null,!0},n.prototype.enableMeasureTool=function(e){if(this.tool){var t=this.viewer.toolController,i=this.tool.isActive()
if(e&&!i)return t.activateTool("measure"),this.measureToolButton.setState(Autodesk.Viewing.UI.Button.State.ACTIVE),!0
if(!e&&i)return t.deactivateTool("measure"),this.measureToolButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),!0}return!1},n.prototype.createUI=function(){var e=this,n=this.viewer
this.measureToolButton=null
var o=n.getToolbar(!0),r=o.getControl(t.TOOLBAR.MODELTOOLSID)
this.measureToolButton=new i.Button("toolbar-measureTool"),this.measureToolButton.setToolTip("Measure"),this.measureToolButton.setIcon("adsk-icon-measure"),this.measureToolButton.onClick=function(t){e.enableMeasureTool(!e.tool.isActive())},this.onMeasureButtonStateChange=function(t){t.state===i.Button.State.ACTIVE?e.enableMeasureTool(!0):t.state===i.Button.State.INACTIVE&&e.enableMeasureTool(!1)},this.measureToolButton.addEventListener(i.Button.Event.STATE_CHANGED,this.onMeasureButtonStateChange),r.addControl(this.measureToolButton,{index:0})
var a=[{keycodes:[t.theHotkeyManager.KEYCODES.ESCAPE],onRelease:function(){return e.enableMeasureTool(!1)}}]
t.theHotkeyManager.pushHotkeys(this.escapeHotkeyId,a)},n.prototype.destroyUI=function(){var e=this.viewer
this.measureToolButton&&this.measureToolButton.removeEventListener(i.Button.Event.STATE_CHANGED,this.onMeasureButtonStateChange)
var n=e.getToolbar(!1)
if(n){var o=n.getControl(t.TOOLBAR.MODELTOOLSID)
if(o){if(this.measureToolButton){var r=o.getControl("toolbar-inspectSubMenu")
r?r.removeControl(this.measureToolButton.getId()):o.removeControl(this.measureToolButton.getId())}this.measureToolButton=null}}t.theHotkeyManager.popHotkeys(this.escapeHotkeyId)},e.MeasureExtension=n,t.theExtensionManager.registerExtension("Autodesk.Measure",n)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Measure"),Autodesk.Viewing.Extensions.Measure.MeasureTool=function(e,t){function i(){_.updateLabelPositions()}function n(){s.clearMeasurement()}function o(){_||(_=new a(l)),_.hide(),x&&(x.setVisible(!0),x.updatePanel(),l.model&&l.model.is2d()&&x.isolate.setVisibility(!1),y?x.disableUnitOption(0):x.disableUnitOption())}function r(){_&&(_.hide(),_.destroy()),T={},x&&(x.setVisible(!1),x.updatePanel())}function a(e){var t=this,i=!1,n=2002943,o=.7,r="MeasureTool-endPoint",a="MeasureTool-edge",c="MeasureTool-face",u="MeasureTool-angle",p="MeasureTool-angle-outline",f="MeasureTool-extensionLine",m="MeasureTool-extensionFace",T=null,b=null,_=null,x=null,C=null,R=null,M=null,P={first:{},second:{}},L={first:{},second:{}},I={first:{},second:{}},k={xyz:{axis:!1,color:"FF9900"},x:{axis:!0,color:"F12C2C"},y:{axis:!0,color:"0BB80B"},z:{axis:!0,color:"2C2CF1"}},V={},N=[]
this.showFirstVertex=function(e){var t=this.setScale(e)
this.showEndPoint("first",e,t)},this.showSecondVertex=function(e){var t=this.setScale(e)
this.showEndPoint("second",e,t)},this.showEndPoint=function(e,t,i){T||(T=new THREE.MeshPhongMaterial({color:n,ambient:n,opacity:o,transparent:!0,depthTest:!1,depthWrite:!1}),l.impl.createOverlayScene(r))
var a=P[e],s=a.mesh
if(s||(a.geometry=new THREE.SphereGeometry(1),s=a.mesh=new THREE.Mesh(a.geometry,T),l.impl.addOverlay(r,s)),s.scale.x=i,s.scale.y=i,s.scale.z=i,s.position.set(t.x,t.y,t.z),s.visible=!0,l.impl.invalidate(!1,!1,!0),v||w){var c=a.label
if(!c){c=a.label=document.createElement("div"),c.className="measure-label",l.container.appendChild(c)
var u=document.createElement("div")
u.className="adsk-icon-"+e+" measure-label-icon",c.appendChild(u)}c.classList.toggle("visible",!0),a.position=t.clone(),this.updateLabelPositions()}},this.setScale=function(e){var t=5,i=l.navigation,n=i.getCamera(),o=i.getEyeVector(),r=i.getPosition(),a=e.clone(),s=n.isPerspective?a.sub(r).dot(o.normalize()):i.getEyeVector().length(),c=i.getVerticalFov(),u=2*s*Math.tan(THREE.Math.degToRad(.5*c)),d=i.getScreenViewport(),h=window.devicePixelRatio||1,p=t*u/(d.height*h)
return p},this.updateScale=function(){var e=l.impl.overlayScenes[r]
if(e)for(var t=e.scene,i=0;i<t.children.length;i++){var n=t.children[i]
if(n){var o=this.setScale(n.position)
n.scale.x=o,n.scale.y=o,n.scale.z=o}}if(e=l.impl.overlayScenes[f])for(var t=e.scene,i=0;i<t.children.length;i++){var s=t.children[i]
if(s){var c=this.setScale(s.geometry.vertices[0])
s.material.dashSize=4*c,s.material.gapSize=2*c}}if(e=l.impl.overlayScenes[a])for(var t=e.scene,i=0;i<t.children.length;i++){var u=t.children[i]
u&&this.setCylinderScale(u)}if(e=l.impl.overlayScenes[p])for(var t=e.scene,i=0;i<t.children.length;i++){var u=t.children[i]
u&&this.setCylinderScale(u)}for(var d in k)if(k.hasOwnProperty(d)){var h=k[d]
h.line&&this.setCylinderScale(h.line)}},this.showFirstEdge=function(e,t){this.showEdge("first",e,t)},this.showSecondEdge=function(e,t){this.showEdge("second",e,t)},this.showEdge=function(e,t,i){b||(b=new THREE.MeshPhongMaterial({color:n,ambient:n,opacity:o,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),l.impl.createOverlayScene(a))
var r=L[e]
if(r.line&&l.impl.removeMultipleOverlays(a,r.line),r.line=this.drawEdgeAsCylinder(t,b,5,1),l.impl.addMultipleOverlays(a,r.line),v||w){var s=r.label
if(!s){s=r.label=document.createElement("div"),s.className="measure-label",l.container.appendChild(s)
var c=document.createElement("div")
c.className="adsk-icon-"+e+" measure-label-icon",s.appendChild(c)}s.classList.toggle("visible",!0),r.intersectPoint=i.clone(),this.updateLabelPositions()}},this.drawEdgeAsCylinder=function(e,t,i,n){var o=[]
if(1==n)for(var r=0;r<e.vertices.length;r+=2){var a=this.cylinderMesh(e.vertices[r],e.vertices[r+1],t,i)
this.setCylinderScale(a),o.push(a)}else for(var r=0;r<e.vertices.length-1;r++){var a=this.cylinderMesh(e.vertices[r],e.vertices[r+1],t,i)
this.setCylinderScale(a),o.push(a)}return o},this.drawLineAsCylinder=function(e,t,i){var n
return 2==e.vertices.length&&(n=this.cylinderMesh(e.vertices[0],e.vertices[1],t,i),this.setCylinderScale(n)),n},this.cylinderMesh=function(e,t,i,n){var o=(new THREE.Vector3).subVectors(t,e),r=new THREE.Matrix4
r.lookAt(e,t,(new THREE.Object3D).up),r.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1))
var a=new THREE.CylinderGeometry(.1*n,.1*n,o.length(),8,1,!0),s=new THREE.Mesh(a,i)
return s.applyMatrix(r),s.position.x=(t.x+e.x)/2,s.position.y=(t.y+e.y)/2,s.position.z=(t.z+e.z)/2,s},this.setCylinderScale=function(e){var t=this.setScale(e.position)
e.scale.x=t,e.scale.z=t},this.showFirstFace=function(e,t){this.showFace("first",e,t)},this.showSecondFace=function(e,t){this.showFace("second",e,t)},this.showFace=function(e,t,i){_||(_=new THREE.MeshPhongMaterial({color:n,ambient:n,opacity:o,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),l.impl.createOverlayScene(c))
var r=I[e]
if(r.mesh&&l.impl.removeOverlay(c,r.mesh),r.mesh=new THREE.Mesh(t,_),l.impl.addOverlay(c,r.mesh),v||w){var a=r.label
if(!a){a=r.label=document.createElement("div"),a.className="measure-label",l.container.appendChild(a)
var s=document.createElement("div")
s.className="adsk-icon-"+e+" measure-label-icon",a.appendChild(s)}a.classList.toggle("visible",!0),r.intersectPoint=i.clone(),this.updateLabelPositions()}},this.drawExtensionFace=function(e,t,i){M||(M=new THREE.MeshPhongMaterial({color:6737151,ambient:52479,opacity:.2,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),l.impl.createOverlayScene(m))
var n=new THREE.Mesh(e,M)
n.position.set(t.x,t.y,t.z)
var o=n.position.clone()
o.add(i),n.lookAt(o),n.updateMatrixWorld(),l.impl.addOverlay(m,n)},this.getEdgeLength=function(e){for(var t=0,i=e.clone(),n=i.vertices,o=0;o<n.length;o+=2)l.model.is2d()&&l.model.pageToModel(n[o],n[o+1],D),t+=n[o].distanceTo(n[o+1])
return t=Autodesk.Viewing.Private.convertUnits(l.model.getUnitString(),y,t),Autodesk.Viewing.Private.formatValueWithUnits(t,y,3,A)},this.getFaceArea=function(e){for(var t=0,i=e.vertices,n=new THREE.Vector3,o=new THREE.Vector3,r=0;r<i.length;r+=3)n.subVectors(i[r+1],i[r]),o.subVectors(i[r+2],i[r]),t+=n.length()*o.length()*Math.sin(n.angleTo(o))/2
return t=Autodesk.Viewing.Private.convertUnits(l.model.getUnitString(),y,t,"square"),y?Autodesk.Viewing.Private.formatValueWithUnits(t,y+"^2",3,A):Autodesk.Viewing.Private.formatValueWithUnits(t,null,3,A)},this.updateLabels=function(){g===SNAP_EDGE?L.first.label.children[0].textContent=this.getEdgeLength(d):g===SNAP_FACE&&(I.first.label.children[0].textContent=this.getFaceArea(d)),E===SNAP_EDGE?L.second.label.children[0].textContent=this.getEdgeLength(h):E===SNAP_FACE&&(I.second.label.children[0].textContent=this.getFaceArea(h))},this.updateLabelPositions=function(){function e(e,t,i){var n=l.navigation.getCamera(),o=l.navigation.getScreenViewport(),r=new THREE.Vector3(e,t,i)
return r=r.project(n),{x:Math.round((r.x+1)/2*o.width)+5,y:Math.round((-r.y+1)/2*o.height)+5}}for(var t in k)if(k.hasOwnProperty(t)){var i=k[t],n=i.label
if(n){var o=e((i.p1.x+i.p2.x)/2,(i.p1.y+i.p2.y)/2,(i.p1.z+i.p2.z)/2)
n.style.top=o.y+"px",n.style.left=o.x+"px",N.push(n)}}if(V&&(n=V.label)){var o=e((V.p1.x+V.p2.x)/2,(V.p1.y+V.p2.y)/2,(V.p1.z+V.p2.z)/2)
n.style.top=o.y+"px",n.style.left=o.x+"px",N.push(n)}for(var t in I)if(I.hasOwnProperty(t)){var r=I[t],n=r.label,a=r.intersectPoint
if(n&&a){var o=e(a.x,a.y,a.z)
n.style.top=o.y+"px",n.style.left=o.x+"px",N.push(n)}}for(var t in L)if(L.hasOwnProperty(t)){var s=L[t],n=s.label,a=s.intersectPoint
if(n&&a){var o=e(a.x,a.y,a.z)
n.style.top=o.y+"px",n.style.left=o.x+"px",N.push(n)}}for(var t in P)if(P.hasOwnProperty(t)){var c=P[t],n=c.label,a=c.position
if(n&&a){var o=e(a.x,a.y,a.z)
n.style.top=o.y+"px",n.style.left=o.x+"px",N.push(n)}}for(var u=0;u<N.length;u++)for(var d=0;u>d;d++)this.labelsOverlapDetection(N[d],N[u])
N=[]},this.labelsOverlapDetection=function(e,t){var i=e.getBoundingClientRect(),n=t.getBoundingClientRect()
n.top<=i.bottom&&n.bottom>=i.top&&(n.right>=i.left&&n.right<=i.right?t.style.left=parseInt(t.style.left,10)-(n.right-i.left)+"px":n.left>=i.left&&n.left<=i.right?t.style.left=parseInt(t.style.left,10)+(i.right-n.left)+"px":n.left<=i.left&&n.right>=i.right&&(t.style.left=parseInt(t.style.left,10)+(i.right-n.left)+"px"))},this.drawLine=function(e,n){function r(e,n,r,a,s,c,u,d){var h=k[e],p=h.line,f=h.label,m=new THREE.Vector3(n,r,a),g=new THREE.Vector3(s,c,u)
if(p&&(l.impl.removeOverlay("MeasureTool-"+e,p),h.line=null),f&&f.classList.remove("visible"),m.distanceTo(g)>=Math.pow(.1,A)&&d){var E="xyz"===e||!i&&v
p||(h.material=new THREE.MeshBasicMaterial({color:parseInt(h.color,16),depthTest:!1,depthWrite:!1}),h.overlayName="MeasureTool-"+e,l.impl.createOverlayScene(h.overlayName)),v?h.material.opacity=1:h.material.opacity=o,l.impl.clearOverlay(h.overlayName)
var y=h.geometry=new THREE.Geometry
y.vertices.push(m),y.vertices.push(g)
var T="xyz"===e?5:"z"===e?1:2
if(p=h.line=t.drawLineAsCylinder(y,h.material,T),l.impl.addOverlay(h.overlayName,p),p.visible=E,h.p1=m,h.p2=g,"xyz"!=e||v){if(!f){if(f=h.label=document.createElement("div"),f.className="measure-length","xyz"===e){var b=document.createElement("div")
b.className="measure-length-text",f.appendChild(b)}else f.style.pointerEvents="none"
h.axis&&(f.className="adsk-icon-axis-"+e+" measure-label-axis measure-label-axis-"+e),l.container.appendChild(f)}h.axis||t.updateDistance(),f.classList.toggle("visible",E)}}}function a(e,t){var i=Math.pow(.1,A)
return Math.abs(e.x-t.x)>=i&&Math.abs(e.y-t.y)<i&&Math.abs(e.z-t.z)<i||Math.abs(e.y-t.y)>=i&&Math.abs(e.x-t.x)<i&&Math.abs(e.z-t.z)<i||Math.abs(e.z-t.z)>=i&&Math.abs(e.x-t.x)<i&&Math.abs(e.y-t.y)<i?!1:!0}r("xyz",e.x,e.y,e.z,n.x,n.y,n.z,!0)
var s=l.navigation.getAlignedUpVector(),c=Math.abs(s.x),u=Math.abs(s.y),d=Math.abs(s.z),h=a(e,n)
d>c&&d>u?(r("x",e.x,e.y,e.z,n.x,e.y,e.z,h),r("y",n.x,e.y,e.z,n.x,n.y,e.z,h),r("z",n.x,n.y,e.z,n.x,n.y,n.z,h)):u>c&&u>d?(r("x",e.x,e.y,e.z,n.x,e.y,e.z,h),r("z",n.x,e.y,e.z,n.x,e.y,n.z,h),r("y",n.x,e.y,n.z,n.x,n.y,n.z,h)):(r("y",e.x,e.y,e.z,e.x,n.y,e.z,h),r("z",e.x,n.y,e.z,e.x,n.y,n.z,h),r("x",e.x,n.y,n.z,n.x,n.y,n.z,h)),this.updateLabelPositions()},this.updateDistance=function(){var e=k.xyz.label
e&&(e.children[0].textContent="~ "+s.getDistance("xyz"))},this.updateAngle=function(){var e=V.label
e&&(e.children[0].textContent="~ "+s.getAngle())},this.drawExtensionLine=function(e,t,i){var n,r,a,s,c=new THREE.Vector3,u=new THREE.Vector3
if(c.subVectors(t,e),u.subVectors(i,t),s=c.dot(u),c.subVectors(i,t),s=-s/c.dot(c),c.subVectors(i,t),c.multiplyScalar(s),a=c.add(t),0>s)n=t,r=a
else{if(!(s>1))return
n=i,r=a}R||(R=new THREE.LineDashedMaterial({color:13311,linewidth:1,dashSize:1,gapSize:.5,depthTest:!1,depthWrite:!1}),l.impl.createOverlayScene(f)),v?R.opacity=1:R.opacity=o
var d=this.setScale(n)
R.dashSize=4*d,R.gapSize=2*d
var h=new THREE.Geometry
h.vertices.push(n),h.vertices.push(r),h.computeLineDistances()
var p=new THREE.Line(h,R)
l.impl.addOverlay(f,p)},this.drawExtensionLinePointToPoint=function(e,t){var i=e,n=t
R||(R=new THREE.LineDashedMaterial({color:13311,linewidth:1,dashSize:1,gapSize:.5,depthTest:!1,depthWrite:!1}),l.impl.createOverlayScene(f)),v?R.opacity=1:R.opacity=o
var r=this.setScale(i)
R.dashSize=4*r,R.gapSize=2*r
var a=new THREE.Geometry
a.vertices.push(i),a.vertices.push(n),a.computeLineDistances()
var s=new THREE.Line(a,R)
l.impl.addOverlay(f,s)},this.nearestPointsInSegmentToSegment=function(e,t,i,n){var o=.001,r=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3
r.subVectors(t,e),a.subVectors(n,i),s.subVectors(e,i)
var l,c,u,d,h=r.dot(r),p=r.dot(a),f=a.dot(a),m=r.dot(s),v=a.dot(s),g=h*f-p*p,E=g,y=g
return o>g?(c=0,E=1,d=v,y=f):(c=p*v-f*m,d=h*v-p*m,0>c?(c=0,d=v,y=f):c>E&&(c=E,d=v+p,y=f)),0>d?(d=0,0>-m?c=0:-m>h?c=E:(c=-m,E=h)):d>y&&(d=y,0>-m+p?c=0:-m+p>h?c=E:(c=-m+p,E=h)),l=Math.abs(c)<o?0:c/E,u=Math.abs(d)<o?0:d/y,r.multiplyScalar(l),a.multiplyScalar(u),s.add(r),s.sub(a),r.add(e),a.add(i),[r,a]},this.edgeToEdgeMeasure=function(e,t,i){var n=.01,o=S.getEndPointsInEdge(e),r=o[0].clone(),a=o[1].clone()
o=S.getEndPointsInEdge(t)
var s,l=o[0].clone(),c=o[1].clone(),u=this.nearestPointInPointToLine(r,l,c),d=this.nearestPointInPointToLine(a,l,c),h=new THREE.Vector3,p=new THREE.Vector3,f=this.nearestPointInPointToLine(i,r,a)
return r.distanceTo(l)<r.distanceTo(c)&&r.distanceTo(l)<a.distanceTo(l)&&r.distanceTo(l)<a.distanceTo(c)?(h.subVectors(r,a),p.subVectors(l,c),h.normalize(),p.normalize(),this.isEqualVectors(h,p,n)||this.isInverseVectors(h,p,n)?(this.drawLine(r,u),this.drawExtensionLine(r,l,c),[r,u]):(s=this.angleVectorToVector(h,p),this.drawAngleLineToLine(r,f,l,c,s),s)):r.distanceTo(c)<r.distanceTo(l)&&r.distanceTo(c)<a.distanceTo(l)&&r.distanceTo(c)<a.distanceTo(c)?(h.subVectors(r,a),p.subVectors(c,l),h.normalize(),p.normalize(),this.isEqualVectors(h,p,n)||this.isInverseVectors(h,p,n)?(this.drawLine(r,u),this.drawExtensionLine(r,l,c),[r,u]):(s=this.angleVectorToVector(h,p),this.drawAngleLineToLine(r,f,c,l,s),s)):a.distanceTo(l)<r.distanceTo(l)&&a.distanceTo(l)<r.distanceTo(c)&&a.distanceTo(l)<a.distanceTo(c)?(h.subVectors(a,r),p.subVectors(l,c),h.normalize(),p.normalize(),this.isEqualVectors(h,p,n)||this.isInverseVectors(h,p,n)?(this.drawLine(a,d),this.drawExtensionLine(a,l,c),[a,d]):(s=this.angleVectorToVector(h,p),this.drawAngleLineToLine(a,f,l,c,s),s)):(h.subVectors(a,r),p.subVectors(c,l),h.normalize(),p.normalize(),this.isEqualVectors(h,p,n)||this.isInverseVectors(h,p,n)?(this.drawLine(a,d),this.drawExtensionLine(a,l,c),[a,d]):(s=this.angleVectorToVector(h,p),this.drawAngleLineToLine(a,f,c,l,s),s))},this.nearestPointInPointToSegment=function(e,t,i){var n,o,r=new THREE.Vector3,a=new THREE.Vector3
return r.subVectors(t,e),a.subVectors(i,t),o=r.dot(a),r.subVectors(i,t),o=-o/r.dot(r),0>o?n=t:o>1?n=i:(r.subVectors(i,t),r.multiplyScalar(o),n=r.add(t)),n},this.nearestPointInPointToLine=function(e,t,i){var n,o,r=new THREE.Vector3,a=new THREE.Vector3
return r.subVectors(t,e),a.subVectors(i,t),o=r.dot(a),r.subVectors(i,t),o=-o/r.dot(r),r.subVectors(i,t),r.multiplyScalar(o),n=r.add(t)},this.pointToEdgeMeasure=function(e,t,i){var n=S.getEndPointsInEdge(t),o=n[0],r=n[1],a=this.nearestPointInPointToLine(e,o,r),s=this.nearestPointInPointToLine(i,o,r),l=new THREE.Vector3
return l.subVectors(s,a),l.add(e),this.drawLine(l,s),this.drawExtensionLinePointToPoint(e,l),[e,a]},this.edgeToPointMeasure=function(e,t){var i=S.getEndPointsInEdge(e),n=i[0],o=i[1],r=this.nearestPointInPointToLine(t,n,o)
return this.drawLine(t,r),this.drawExtensionLine(t,n,o),[t,r]},this.faceToFaceMeasure=function(e,t,i,n){var o=.01,r=t.clone(),a=n.clone(),s=this.angleVectorToVector(t,n)
if(r.x<=a.x+o&&r.x>=a.x-o&&r.y<=a.y+o&&r.y>=a.y-o&&r.z<=a.z+o&&r.z>=a.z-o||r.x<=-a.x+o&&r.x>=-a.x-o&&r.y<=-a.y+o&&r.y>=-a.y-o&&r.z<=-a.z+o&&r.z>=-a.z-o){var l=new THREE.Vector3
l.subVectors(e,i)
var c=r.dot(l)/r.dot(a)
l.addVectors(i,a.multiplyScalar(c))
var u=2*l.distanceTo(e),d=new THREE.PlaneBufferGeometry(u,u)
return this.drawExtensionFace(d,e,t),this.drawLine(i,l),[i,l,s]}return s=this.drawAngleFaceToFace(e,t,i,n)},this.angleVectorToVector=function(e,t){var i=180*e.angleTo(t)/Math.PI
return i},this.intersectPlaneToPlane=function(e,t,i,n){var o=new THREE.Vector3
o.crossVectors(t,n)
var r,a=o.x>=0?o.x:-o.x,s=o.y>=0?o.y:-o.y,l=o.z>=0?o.z:-o.z
r=a>s?a>l?1:3:s>l?2:3
var c,u,d=new THREE.Vector3
switch(c=-t.dot(e),u=-n.dot(i),r){case 1:d.x=0,0!==o.x?(d.y=(u*t.z-c*n.z)/o.x,d.z=(c*n.y-u*t.y)/o.x):(d.y=-(u*t.z)/(t.z*n.y),d.z=-(c*n.y)/(t.z*n.y))
break
case 2:d.y=0,0!==o.y?(d.x=(c*n.z-u*t.z)/o.y,d.z=(u*t.x-c*n.x)/o.y):(d.x=-(c*n.z)/(t.x*n.z),d.z=-(u*t.x)/(t.x*n.z))
break
case 3:d.z=0,0!==o.z?(d.x=(u*t.y-c*n.y)/o.z,d.y=(c*n.x-u*t.x)/o.z):(d.x=-(u*t.y)/(t.y*n.x),d.y=-(c*n.x)/(t.y*n.x))}var h=new THREE.Vector3
h.addVectors(d,o.multiplyScalar(100))
var p=this.nearestPointInPointToLine(e,d,h),f=this.nearestPointInPointToLine(i,d,h)
return[p,f]},this.drawAngle=function(e,t,i,n,o,r){var a=.001
x||(x=new THREE.MeshPhongMaterial({color:10066329,ambient:10066329,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),C=new THREE.MeshBasicMaterial({color:16750848,depthTest:!1,depthWrite:!1}),l.impl.createOverlayScene(u,x),l.impl.createOverlayScene(p,C)),l.impl.clearOverlay(u),l.impl.clearOverlay(p)
var s=e.distanceTo(t),c=100,d=new THREE.CircleGeometry(s,c,0,o*Math.PI/180),h=new THREE.Mesh(d,x),f=h.geometry.vertices[0].clone()
h.geometry.vertices.push(f),h.position.set(e.x,e.y,e.z)
var m=h.position.clone()
m.add(n),h.lookAt(m),h.updateMatrixWorld()
var v=h.geometry.vertices[1].clone(),g=h.geometry.vertices[h.geometry.vertices.length-2].clone()
v.applyMatrix4(h.matrixWorld),g.applyMatrix4(h.matrixWorld)
var E=new THREE.Vector3,y=new THREE.Vector3,A=new THREE.Vector3,T=new THREE.Vector3
E.subVectors(v,e),y.subVectors(g,e),A.subVectors(t,e),T.subVectors(i,e)
var b,w=E.angleTo(A),_=E.angleTo(T),S=y.angleTo(A),R=y.angleTo(T)
b=(a>=w&&w>=-a||a>=_&&_>=-a)&&(a>=S&&S>=-a||a>=R&&R>=-a)?0:(w<=Math.PI+a&&w>=Math.PI-a||_<=Math.PI+a&&_>=Math.PI-a)&&(S<=Math.PI+a&&S>=Math.PI-a||R<=Math.PI+a&&R>=Math.PI-a)?Math.PI:S+a>=w&&w>=S-a||R+a>=w&&w>=R-a?w:_
var M=new THREE.Matrix4
if(M.makeRotationAxis(n,b),M.multiply(h.matrix),h.matrix=M,h.rotation.setFromRotationMatrix(h.matrix),h.updateMatrixWorld(),v=h.geometry.vertices[1].clone(),g=h.geometry.vertices[h.geometry.vertices.length-2].clone(),v.applyMatrix4(h.matrixWorld),g.applyMatrix4(h.matrixWorld),E.subVectors(v,e),y.subVectors(g,e),w=E.angleTo(A),_=E.angleTo(T),S=y.angleTo(A),R=y.angleTo(T),w>=a&&_>=a){var M=new THREE.Matrix4
M.makeRotationAxis(n,2*-b),M.multiply(h.matrix),h.matrix=M,h.rotation.setFromRotationMatrix(h.matrix)}var P=new THREE.CircleGeometry(.9*s,c,0,o*Math.PI/180)
P.vertices.splice(0,1),h.updateMatrixWorld(),P.applyMatrix(h.matrixWorld)
var L=this.drawEdgeAsCylinder(P,C,2.5,0),I=new THREE.Geometry,k=new THREE.Geometry
I.vertices.push(h.geometry.vertices[0].clone(),h.geometry.vertices[1].clone()),k.vertices.push(h.geometry.vertices[0].clone(),h.geometry.vertices[h.geometry.vertices.length-2].clone()),I.applyMatrix(h.matrixWorld),k.applyMatrix(h.matrixWorld)
var V=this.drawLineAsCylinder(I,C,2.5),N=this.drawLineAsCylinder(k,C,2.5)
l.impl.addOverlay(u,h),l.impl.addMultipleOverlays(p,L),l.impl.addOverlay(p,V),l.impl.addOverlay(p,N),r.copy(h.geometry.vertices[Math.round(h.geometry.vertices.length/2)-1]),r.applyMatrix4(h.matrixWorld)},this.drawAngleFaceToFace=function(e,t,i,n){var o=this.intersectPlaneToPlane(e,t,i,n),r=new THREE.Vector3,a=new THREE.Vector3
r.subVectors(e,o[0]),a.subVectors(i,o[1])
var c=this.angleVectorToVector(r,a),u=o[0].clone(),d=new THREE.Vector3
d.crossVectors(t,n),d.normalize(),o=this.intersectPlaneToPlane(e,t,u,d)
var h=o[0].clone()
o=this.intersectPlaneToPlane(i,n,u,d)
var p=o[0].clone(),f=new THREE.Vector3
if(this.drawAngle(u,h,p,d,c,f),v){var m=V.label
if(!m){m=V.label=document.createElement("div"),m.className="measure-length",l.container.appendChild(m)
var g=document.createElement("div")
g.className="measure-length-text",m.appendChild(g)}m.children[0].textContent=s.getAngle(),m.classList.toggle("visible",!0),V.p1=f.clone(),V.p2=f.clone(),this.updateLabelPositions()}return c},this.drawAngleLineToLine=function(e,t,i,n,o){var r=e,a=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3
c.subVectors(e,t),u.subVectors(i,n),a.crossVectors(c,u),a.normalize()
var d=t,h=new THREE.Vector3
h.subVectors(r,i),h.add(n)
var p=new THREE.Vector3
if(this.drawAngle(r,d,h,a,o,p),v){var f=V.label
if(!f){f=V.label=document.createElement("div"),f.className="measure-length",l.container.appendChild(f)
var m=document.createElement("div")
m.className="measure-length-text",f.appendChild(m)}f.children[0].textContent=s.getAngle(),f.classList.toggle("visible",!0),V.p1=p.clone(),V.p2=p.clone(),this.updateLabelPositions()}},this.intersectLineToLine=function(e,t,i,n){var o=new THREE.Vector3,r=new THREE.Vector3
o.subVectors(i,e),o.cross(n),r.crossVectors(t,n)
var a=o.divide(r)
return r=t.clone(),r.multiplyScalar(a),o.addVectors(e,r),o},this.nearestPointInPointToPlane=function(e,t,i){var n=new THREE.Vector3,o=i.clone(),r=new THREE.Vector3
r.subVectors(e,t)
var a=-o.dot(r),s=o.dot(o),l=a/s
return n.addVectors(e,o.multiplyScalar(l)),n},this.faceToPointMeasure=function(e,t,i,n){var o=e.vertices[0],r=this.nearestPointInPointToPlane(n,o,t),a=i.clone(),s=new THREE.Vector3
s.subVectors(a,r),s.add(n)
var l=2*r.distanceTo(i),c=new THREE.PlaneBufferGeometry(l,l)
return this.drawExtensionFace(c,i,t),this.drawLine(n,r),[n,r]},this.nearestPointInPointToFace=function(e,t,i){for(var n,o=Number.MAX_VALUE,r=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Vector3,l=new THREE.Vector3,c=0;c<t.vertices.length;c+=3){r.subVectors(t.vertices[c+1],t.vertices[c]),a.subVectors(t.vertices[c+2],t.vertices[c]),l.crossVectors(r,a),s.subVectors(e,t.vertices[c]),r.cross(s)
var u=r.dot(l)/l.dot(l)
s.cross(a)
var d=s.dot(l)/l.dot(l),h=1-u-d
if(h>=0&&1>=h&&d>=0&&1>=d&&u>=0&&1>=u)return n=this.nearestPointInPointToPlane(e,t.vertices[0],i)}for(var c=0;c<t.vertices.length;c+=3){var p=this.nearestPointInPointToSegment(e,t.vertices[c],t.vertices[c+1])
e.distanceTo(p)<o&&(o=e.distanceTo(p),n=p.clone()),p=this.nearestPointInPointToSegment(e,t.vertices[c],t.vertices[c+2]),e.distanceTo(p)<o&&(o=e.distanceTo(p),n=p.clone()),p=this.nearestPointInPointToSegment(e,t.vertices[c+1],t.vertices[c+2]),e.distanceTo(p)<o&&(o=e.distanceTo(p),n=p.clone())}return n},this.pointToFaceMeasure=function(e,t,i,n){var o=t.vertices[0],r=this.nearestPointInPointToPlane(e,o,i),a=n.clone(),s=new THREE.Vector3
return s.subVectors(a,r),s.add(e),this.drawLine(a,s),this.drawExtensionLinePointToPoint(e,s),[e,r]},this.nearestPointsInEdgeToFace=function(e,t){for(var i,n,o=[],r=Number.MAX_VALUE,a=S.getEndPointsInEdge(e),s=a[0],l=a[1],c=0;c<t.vertices.length;c+=3){i=t.vertices[c],n=t.vertices[c+1]
var u=this.nearestPointsInSegmentToSegment(s,l,i,n)
u[0].distanceTo(u[1])<r&&(r=u[0].distanceTo(u[1]),o[0]=u[0].clone(),o[1]=u[1].clone()),i=t.vertices[c],n=t.vertices[c+2],u=this.nearestPointsInSegmentToSegment(s,l,i,n),u[0].distanceTo(u[1])<r&&(r=u[0].distanceTo(u[1]),o[0]=u[0].clone(),o[1]=u[1].clone()),i=t.vertices[c+1],n=t.vertices[c+2],u=this.nearestPointsInSegmentToSegment(s,l,i,n),u[0].distanceTo(u[1])<r&&(r=u[0].distanceTo(u[1]),o[0]=u[0].clone(),o[1]=u[1].clone())}return o},this.faceToEdgeMeasure=function(e,t,i,n,o){var r,a,s=.01,l=S.getEndPointsInEdge(n)
l[0].distanceTo(i)<l[1].distanceTo(i)?(r=l[0],a=l[1]):(r=l[1],a=l[0])
var c=new THREE.Vector3
c.subVectors(a,r)
var u=this.angleLineToPlane(c,t)
if(c.dot(t)<=s&&c.dot(t)>=-s){var d=e.vertices[0],h=this.nearestPointInPointToPlane(r,d,t),p=this.nearestPointInPointToLine(o,r,a)
return this.faceToPointMeasure(e,t,i,p),[r,h,u]}var f=this.nearestPointInPointToLine(o,r,a)
return this.drawAngleEdgeToFace(e.vertices[0],t,i,r,f,u),u},this.edgeToFaceMeasure=function(e,t,i,n,o){var r,a,s=.01,l=S.getEndPointsInEdge(e)
l[0].distanceTo(o)<l[1].distanceTo(o)?(r=l[0],a=l[1]):(r=l[1],a=l[0])
var c=new THREE.Vector3
c.subVectors(a,r)
var u=this.angleLineToPlane(c,n)
if(c.dot(n)<=s&&c.dot(n)>=-s){var d=i.vertices[0],h=this.nearestPointInPointToPlane(r,d,n),p=new THREE.Vector3
p.subVectors(o,h),p.add(r)
var f=new THREE.Vector3
return f.subVectors(o,h),f.add(a),this.drawLine(p,o),this.drawExtensionLinePointToPoint(p,f),[r,h,u]}var m=this.nearestPointInPointToLine(t,r,a)
return this.drawAngleEdgeToFace(i.vertices[0],n,o,r,m,u),u},this.angleLineToPlane=function(e,t){var i=this.angleVectorToVector(e,t)
return i>90?i-=90:i=90-i,i},this.drawAngleEdgeToFace=function(e,t,i,n,o,r){var a=this.intersectPointLineToPlane(e,t,n,o)
if(a){var c=o
if(90===r)var u=i.clone()
else var u=this.nearestPointInPointToPlane(o,e,t)
var d=new THREE.Vector3,h=new THREE.Vector3,p=new THREE.Vector3
h.subVectors(o,n),p.subVectors(u,a),d.crossVectors(h,p),d.normalize()
var f=new THREE.Vector3
if(this.drawAngle(a,c,u,d,r,f),v){var m=V.label
if(!m){m=V.label=document.createElement("div"),m.className="measure-length",l.container.appendChild(m)
var g=document.createElement("div")
g.className="measure-length-text",m.appendChild(g)}m.children[0].textContent=s.getAngle(),m.classList.toggle("visible",!0),V.p1=f.clone(),V.p2=f.clone(),this.updateLabelPositions()}}},this.intersectPointLineToPlane=function(e,t,i,n){var o=.001,r=new THREE.Vector3,a=new THREE.Vector3
r.subVectors(n,i),a.subVectors(i,e)
var s=t.dot(r),l=-t.dot(a)
return Math.abs(s)<o?null:(r.multiplyScalar(l/s),r.add(i),r)},this.nearestVertexInVertexToEdge=function(e,t){for(var i,n=Number.MAX_VALUE,o=0;o<t.vertices.length;o++){var r=e.distanceTo(t.vertices[o])
n>r&&(i=t.vertices[o],n=r)}return i},this.isEqualVectors=function(e,t,i){return Math.abs(e.x-t.x)<=i&&Math.abs(e.y-t.y)<=i&&Math.abs(e.z-t.z)<=i?!0:!1},this.isInverseVectors=function(e,t,i){return Math.abs(e.x+t.x)<=i&&Math.abs(e.y+t.y)<=i&&Math.abs(e.z+t.z)<=i?!0:!1},this.setSimple=function(e){if(i!=e){i=e
for(var t in k)if("xyz"!==t&&k.hasOwnProperty(t)){var n=k[t]
n.line&&(n.line.visible=!e,n.label&&n.label.classList.toggle("visible",!e))}l.impl.invalidate(!1,!1,!0)}},this.hide=function(){var e
for(e in P)if(P.hasOwnProperty(e)){var t=P[e]
t.mesh&&(t.mesh.visible=!1),t.label&&t.label.classList.remove("visible")}for(e in L)if(L.hasOwnProperty(e)){var i=L[e]
if(i.line)for(var n in i.line)i.line[n].visible=!1
i.label&&i.label.classList.remove("visible")}for(e in I)if(I.hasOwnProperty(e)){var o=I[e]
o.mesh&&(o.mesh.visible=!1),o.label&&o.label.classList.remove("visible")}for(e in k)if(k.hasOwnProperty(e)){var r=k[e]
r.line&&(r.line.visible=!1),r.label&&r.label.classList.remove("visible")}V.label&&V.label.classList.remove("visible"),x&&(l.impl.clearOverlay(u),l.impl.clearOverlay(p)),R&&l.impl.clearOverlay(f),M&&l.impl.clearOverlay(m),l.impl.invalidate(!1,!1,!0)},this.hideClick=function(e){if(P.hasOwnProperty(e)){var t=P[e]
t.mesh&&(t.mesh.visible=!1),t.label&&t.label.classList.remove("visible")}if(L.hasOwnProperty(e)){var i=L[e]
if(i.line)for(var n in i.line)i.line[n].visible=!1
i.label&&i.label.classList.remove("visible")}if(I.hasOwnProperty(e)){var o=I[e]
o.mesh&&(o.mesh.visible=!1),o.label&&o.label.classList.remove("visible")}for(var r in k)if(k.hasOwnProperty(r)){var a=k[r]
a.line&&(a.line.visible=!1),a.label&&a.label.classList.remove("visible")}V.label&&V.label.classList.remove("visible"),x&&(l.impl.clearOverlay(u),l.impl.clearOverlay(p)),R&&l.impl.clearOverlay(f),M&&l.impl.clearOverlay(m),l.impl.invalidate(!1,!1,!0)},this.destroy=function(){var e
for(e in P)if(P.hasOwnProperty(e)){var t=P[e]
t.mesh&&(l.impl.removeOverlay(r,t.mesh),t.mesh=t.geometry=null),t.label&&(t.label.parentNode.removeChild(t.label),t.label=null)}for(e in L)if(L.hasOwnProperty(e)){var i=L[e]
i.line&&(l.impl.removeMultipleOverlays(a,i.line),i.line=i.intersectPoint=null),i.label&&(i.label.parentNode.removeChild(i.label),i.label=null)}for(e in I)if(I.hasOwnProperty(e)){var n=I[e]
n.mesh&&(l.impl.removeOverlay(c,n.mesh),n.mesh=n.intersectPoint=null),n.label&&(n.label.parentNode.removeChild(n.label),n.label=null)}T&&(T=null,l.impl.removeOverlayScene(r)),_&&(_=null,l.impl.removeOverlayScene(c)),b&&(b=null,l.impl.removeOverlayScene(a)),R&&(R=null,l.impl.removeOverlayScene(f)),M&&(M=null,l.impl.removeOverlayScene(m))
for(e in k)if(k.hasOwnProperty(e)){var o=k[e]
o.line&&(l.impl.removeOverlay(o.overlayName,o.line),l.impl.removeOverlayScene(o.overlayName),o.material=o.line=o.geometry=null),o.label&&(o.label.parentNode.removeChild(o.label),o.label=null),o.material=o.line=o.geometry=o.label=o.p1=o.p2=null}V.label&&(V.label.parentNode.removeChild(V.label),V.label=null),V.label=V.p1=V.p2=null}}var s=this,l=e,c=["measure"],u=!1,d=null,h=null,p=!1,f=!1,m=0,v=!1,g=null,E=null,y="",A=3,T={},b=0,w=!1,_=null,x=null,C="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAKZJREFUeNrclLEKwzAQQ9+FgH/Nk7d8ViFT+6cG36IsNXgIdMg5kAoOIw8WSDoDvAEN04BdEhFjgCTR4e6klFxSIgDLSNydbdsAPgRCktRaUylFkfZ0Z2qtVTlnAfugGibwAur3JFrAxoBnYGEy1pGYmQCLLNB6Uqmw182M9eRS0yzqGo+y6D9rytSQR8vM7DKfbtHy4x+/xG8J+d4W9WAi8fxFOwYA8W0ypu2ZfcsAAAAASUVORK5CYII=), wait",S=null,R=null,M=null,P=null,L=null,I=null,k=null,V=null,N=null,D=null,H=null,O=Autodesk.Viewing.Private.GuiViewer3D&&e instanceof Autodesk.Viewing.Private.GuiViewer3D
this.register=function(){O&&!x&&(x=new Autodesk.Viewing.Extensions.Measure.MeasurePanel(s,l,"measure-panel","Measure",t),l.addPanel(x)),S||(S=new Autodesk.Viewing.Extensions.Measure.Snapper(e),l.toolController.registerTool(S))},this.deregister=function(){this.deactivate(),x&&(l.removePanel(x),x.uninitialize()),l.toolController.deregisterTool(S),S=null},this.isActive=function(){return u},this.getNames=function(){return c},this.getName=function(){return c[0]},this.getCursor=function(){return p&&!f?null:C},this.activate=function(){u=!0,m=0,p=!1,y||(y=l.model&&l.model.is2d()?l.model.getUnitString2d()||Autodesk.Viewing.ModelUnits.MILLIMETER:l.model.getUnitString()),A=l.model&&l.model.is2d()?3:1,o(),l.clearSelection(),l.toolController.activateTool("snapper"),l.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,i),l.addEventListener(Autodesk.Viewing.RESET_EVENT,n)},this.deactivate=function(){u=!1,d=h=null,T={},this.clearMeasurement(),r(),S&&S.isActive()&&l.toolController.deactivateTool("snapper"),l.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,i),l.removeEventListener(Autodesk.Viewing.RESET_EVENT,n)},this.update=function(){return!1},this.getUnits=function(){return y},this.setUnits=function(e){y!==e&&(y=e,_&&_.updateDistance())},this.getPrecision=function(){return A},this.setPrecision=function(e){A!==e&&(A=e,_&&_.updateDistance())},this.getDistance=function(e){if(l.model&&l.model.isLoadDone()){var t=Autodesk.Viewing.Private.convertUnits(l.model.getUnitString(),y,T[e]||0)
return Autodesk.Viewing.Private.formatValueWithUnits(t,y,3,A)}},this.getAngle=function(){return Autodesk.Viewing.Private.formatValueWithUnits(b,String.fromCharCode(176),3,A)},this.clearMeasurement=function(){d=h=null,g=E=null,V=N=null,D=H=null,m=1,T={},b=0,_&&_.hide(),x&&(x.updatePanel(),x.hideMeasureResult(),x.isolateMeasure&&this.clearIsolate())},this.clearRubberBand=function(){h=null,E=null,_.hideClick("second")},this.clearFirstPick=function(){h?(_.hide(),d=h.clone(),g=E,R=M,P=L,V=N,D=H,I=k,w=!0,g===SNAP_VERTEX?_.showFirstVertex(d):g===SNAP_EDGE?_.showFirstEdge(d,R):g===SNAP_FACE&&_.showFirstFace(d,R),w=!1,h=null,E=null,N=null,H=null,k=null,m=2,T={},b=0,x&&x.isolateMeasure&&this.clearIsolate()):this.clearMeasurement(),x&&x.showSelection1()},this.clearSecondPick=function(){h=null,E=null,N=null,H=null,m=2,T={},b=0,_.hideClick("second"),x&&x.isolateMeasure&&this.clearIsolate()},this.getIndicator=function(){return _},this.getFirstGeometry=function(){return{type:g,geometry:d}},this.getSecondGeometry=function(){return{type:E,geometry:h}},this.getEdgeLength=function(e){return _.getEdgeLength(e)},this.getFaceArea=function(e){return _.getFaceArea(e)},this.isolateMeasurement=function(){if(V&&N){var e=[V,N]
l.isolate(e)}},this.clearIsolate=function(){l.showAll()},this._handleMouseEvent=function(e){if(S.isSnapped()){if(0===m&&(this.clearMeasurement(),m=1),1===m)D=S.getViewportIndex(),g=S.getHighlightGeometry(),R=S.getIntersectPoint(),g===SNAP_VERTEX?(d=S.getVertex(),_.showFirstVertex(d)):g===SNAP_EDGE?(d=S.getEdge(),_.showFirstEdge(d,R)):g===SNAP_FACE?(d=S.getFace(),P=S.getFaceNormal(),_.showFirstFace(d,R)):g===SNAP_CIRCULARARC&&(d=S.getEdge(),I=S.getCircularArcCenter(),_.showFirstEdge(d,R)),V=S.getSnapNode(),x&&x.showSelection1()
else if(2===m){var t
if(E=S.getHighlightGeometry(),M=S.getIntersectPoint(),g===SNAP_VERTEX&&E===SNAP_VERTEX?(h=S.getVertex(),_.showSecondVertex(h),_.drawLine(d,h),t=[d,h]):g===SNAP_EDGE&&E===SNAP_EDGE?(h=S.getEdge(),_.showSecondEdge(h,M),t=_.edgeToEdgeMeasure(h,d,M)):g===SNAP_FACE&&E===SNAP_FACE?(h=S.getFace(),L=S.getFaceNormal(),_.showSecondFace(h,M),t=_.faceToFaceMeasure(R,P,M,L)):g===SNAP_VERTEX&&E===SNAP_EDGE?(h=S.getEdge(),_.showSecondEdge(h,M),t=_.pointToEdgeMeasure(d,h,M)):g===SNAP_EDGE&&E===SNAP_VERTEX?(h=S.getVertex(),_.showSecondVertex(h),t=_.edgeToPointMeasure(d,h)):g===SNAP_VERTEX&&E===SNAP_FACE?(h=S.getFace(),L=S.getFaceNormal(),_.showSecondFace(h,M),t=_.pointToFaceMeasure(d,h,L,M)):g===SNAP_FACE&&E===SNAP_VERTEX?(h=S.getVertex(),_.showSecondVertex(h),t=_.faceToPointMeasure(d,P,R,h)):g===SNAP_EDGE&&E===SNAP_FACE?(h=S.getFace(),L=S.getFaceNormal(),_.showSecondFace(h,M),t=_.edgeToFaceMeasure(d,R,h,L,M)):g===SNAP_FACE&&E===SNAP_EDGE?(h=S.getEdge(),_.showSecondEdge(h,M),t=_.faceToEdgeMeasure(d,P,R,h,M)):g===SNAP_CIRCULARARC&&E===SNAP_CIRCULARARC?(h=S.getEdge(),k=S.getCircularArcCenter(),I.equals(k)?(h=_.nearestVertexInVertexToEdge(M,h),E=SNAP_VERTEX,_.showSecondVertex(h),_.drawLine(I,h),t=[I,h]):(_.showSecondEdge(h,M),_.drawLine(I,k),t=[I,k])):g===SNAP_CIRCULARARC&&E===SNAP_VERTEX?(h=S.getVertex(),_.showSecondVertex(h),_.drawLine(I,h),t=[I,h]):g===SNAP_VERTEX&&E===SNAP_CIRCULARARC?(h=S.getEdge(),k=S.getCircularArcCenter(),_.showSecondEdge(h,M),_.drawLine(d,k),t=[d,k]):g===SNAP_CIRCULARARC&&E===SNAP_EDGE?(h=S.getEdge(),_.showSecondEdge(h,M),t=_.pointToEdgeMeasure(I,h,M)):g===SNAP_EDGE&&E===SNAP_CIRCULARARC&&(h=S.getEdge(),k=S.getCircularArcCenter(),_.showSecondEdge(h,M),t=_.edgeToPointMeasure(d,k)),v){if(void 0===t.length)b=t,x&&x.showAngleResult()
else{var i=t[0].clone(),n=t[1].clone()
l.model.is2d()&&l.model.pageToModel(i,n,D),T.xyz=i.distanceTo(n),T.x=Math.abs(i.x-n.x),T.y=Math.abs(i.y-n.y),T.z=Math.abs(i.z-n.z),x&&x.showDistanceResult()}x&&(x.showSelection2(),x.updatePanel()),_.updateDistance(),_.updateAngle(),N=S.getSnapNode(),H=S.getViewportIndex(),x&&x.isolateMeasure&&this.isolateMeasurement()}_.updateLabelPositions()}return!0}if(2===m){var o=this.inverseProject(e.canvasX,e.canvasY)
g===SNAP_VERTEX?_.drawLine(d,o):g===SNAP_EDGE?_.edgeToPointMeasure(d,o):g===SNAP_FACE?_.faceToPointMeasure(d,P,R,o):g===SNAP_CIRCULARARC&&_.drawLine(I,o)}return!1},this.inverseProject=function(e,t){var i=l.navigation.getCamera(),n=l.navigation.getScreenViewport(),o=new THREE.Vector3
return o.x=e/n.width*2-1,o.y=-(t/n.height*2-1),o.z=0,o=o.unproject(i)},this.handleButtonDown=function(e,t){return p=!0,0!==t||e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(v=!0),!1},this.handleMouseMove=function(e){return v=!1,2===m&&(this.clearRubberBand(),this._handleMouseEvent(e)),!1},this.handleButtonUp=function(e,t){return p=!1,!1},this.handleSingleClick=function(e,t){return v&&(this._handleMouseEvent(e)||(this.clearMeasurement(),m=0),(1===m||2===m)&&(m=1===m?2:0),v=!1),!0},this.handleDoubleClick=function(e,t){return!0},this.handleWheelInput=function(e){return _.updateScale(),!1}},function(){"use strict"
var e=AutodeskNamespace("Autodesk.Viewing.Extensions.Measure"),t=Autodesk.Viewing,i=Autodesk.Viewing.Extensions,n=Autodesk.Viewing.Private,o=Autodesk.Viewing.UI,r=function(e,i,r,a,s){o.DockingPanel.call(this,i.container,r,a,s),this.kPanelExpandedHeight=310,this.kPanelCollapsedHeight=35,this.isDeltaExpanded=!0,this.isSettingsExpanded=!1,this.isolateMeasure=!1,this.measureTool=e,this.viewer=i,this.parentContainer=i.container,this.container.classList.add("measurePanel"),this.container.dockRight=!0,this.container.style.minWidth="300px",this.container.style.width="300px",this.container.style.minHeight=this.kPanelCollapsedHeight+"px",this.container.style.height=this.kPanelExpandedHeight+"px",this.container.style.maxHeight=this.kPanelExpandedHeight+"px",this.container.style.top="200px",this.container.style.left="220px",this.container.style.position="absolute",this.addEventListener(this.closer,"click",function(e){s&&s.onCloseCallback&&s.onCloseCallback()})
var l=this.container.children[0]
l.classList.add("expanded"),s=s||{},s.heightAdjustment||(s.heightAdjustment=40),s.marginTop||(s.marginTop=0),s.left=!1,this.createScrollContainer(s),this.measureResults=document.createElement("div"),this.scrollContainer.appendChild(this.measureResults)
var c=this
this.selection1=document.createElement("div"),this.selection1.className="measure-result-container",this.measureResults.appendChild(this.selection1)
var u=document.createElement("div")
u.className="measure-selectionOne-label",this.selection1.appendChild(u)
var d=document.createElement("div")
d.className="adsk-icon-first measure-label-icon",u.appendChild(d),this.selection1Result=document.createElement("div"),this.selection1Result.className="measure-selection-result",this.selection1.appendChild(this.selection1Result)
var h=document.createElement("div")
h.className="adsk-icon-refresh measure-repick",h.addEventListener("click",function(e){c.firstSelectionRepick()},!0),this.selection1.appendChild(h),this.addDivider(this.selection1),this.results=document.createElement("div"),this.results.className="measure-result-container",this.measureResults.appendChild(this.results),this.distIcon=document.createElement("div"),this.distIcon.className="adsk-icon-measure-distance measure-distance-icon",this.results.appendChild(this.distIcon),this.angleIcon=document.createElement("div"),this.angleIcon.className="adsk-icon-measure-angle measure-angle-icon",this.results.appendChild(this.angleIcon),this.distanceDiv=document.createElement("div"),this.distanceDiv.className="measure-result",this.results.appendChild(this.distanceDiv),this.angleDiv=document.createElement("div"),this.angleDiv.className="measure-result",this.results.appendChild(this.angleDiv),this.initialDiv=document.createElement("div"),this.initialDiv.className="measure-initial",this.initialDiv.textContent="0.00",this.results.appendChild(this.initialDiv),this.settingsButton=document.createElement("div"),this.settingsButton.className="adsk-icon-settings measure-settings-button",this.settingsButton.addEventListener("click",function(e){c.showMeasureSettings()},!0),this.results.appendChild(this.settingsButton),this.deltaButton=document.createElement("div"),this.deltaButton.className="adsk-icon-arrow measure-delta-button",this.deltaButton.addEventListener("click",function(e){c.toggle()},!0),this.results.appendChild(this.deltaButton),this.deltaXDiv=document.createElement("div"),this.deltaXDiv.className="measure-delta-result",this.results.appendChild(this.deltaXDiv)
var p=document.createElement("span")
p.setAttribute("data-i18n","Delta"),p.textContent=t.i18n.translate("Delta"),this.deltaXDiv.appendChild(p)
var f=document.createElement("span")
f.className="measure-label-axis-x",f.textContent="X",this.deltaXDiv.appendChild(f)
var m=document.createElement("span")
this.deltaXDiv.appendChild(m),this.deltaYDiv=document.createElement("div"),this.deltaYDiv.className="measure-delta-result",this.results.appendChild(this.deltaYDiv)
var v=document.createElement("span")
v.setAttribute("data-i18n","Delta"),v.textContent=t.i18n.translate("Delta"),this.deltaYDiv.appendChild(v)
var g=document.createElement("span")
g.className="measure-label-axis-y",g.textContent="Y",this.deltaYDiv.appendChild(g)
var E=document.createElement("span")
this.deltaYDiv.appendChild(E),this.deltaZDiv=document.createElement("div"),this.deltaZDiv.className="measure-delta-result",this.results.appendChild(this.deltaZDiv)
var y=document.createElement("span")
y.setAttribute("data-i18n","Delta"),y.textContent=t.i18n.translate("Delta"),this.deltaZDiv.appendChild(y)
var A=document.createElement("span")
A.className="measure-label-axis-z",A.textContent="Z",this.deltaZDiv.appendChild(A)
var T=document.createElement("span")
this.deltaZDiv.appendChild(T),this.addDivider(this.results),this.selection2=document.createElement("div"),this.selection2.className="measure-result-container",this.measureResults.appendChild(this.selection2)
var b=document.createElement("div")
b.className="measure-selectionTwo-label",this.selection2.appendChild(b)
var w=document.createElement("div")
w.className="adsk-icon-second measure-label-icon",b.appendChild(w),this.selection2Result=document.createElement("div"),this.selection2Result.className="measure-selection-result",this.selection2.appendChild(this.selection2Result)
var _=document.createElement("div")
_.className="adsk-icon-refresh measure-repick",_.addEventListener("click",function(e){c.secondSelectionRepick()},!0),this.selection2.appendChild(_),this.addDivider(this.selection2),this.measureSettings=document.createElement("div"),this.measureSettings.className="measure-settings",this.measureSettings.style.display="none",this.measureResults.appendChild(this.measureSettings),this.table=document.createElement("table"),this.table.className="tftable measure-table",this.tbody=document.createElement("tbody"),this.table.appendChild(this.tbody),this.measureSettings.appendChild(this.table),this.units=[{name:"Unknown",units:"",matches:[""]},{name:"Decimal feet",units:"decimal-ft",matches:["decimal-ft"]},{name:"Feet and fractional inches",units:"ft",matches:["ft","in"]},{name:"Decimal inches",units:"decimal-in",matches:["decimal-in"]},{name:"Fractional inches",units:"fractional-in",matches:["fractional-in"]},{name:"Meters",units:"m",matches:["m"]},{name:"Centimeters",units:"cm",matches:["cm"]},{name:"Millimeters",units:"mm",matches:["mm"]},{name:"Meters and centimeters",units:"m-and-cm",matches:["m-and-cm"]}]
for(var x=this.findUnits(),C=[],S=0;S<this.units.length;++S)C.push(this.units[S].name)
this.unitList=new n.OptionDropDown("Unit type",this.tbody,C,x),this.addEventListener(this.unitList,"change",function(e){var t=c.unitList.selectedIndex,i=c.units[t].units
c.measureTool.setUnits(i),c.updatePanel(),c.setupPrecision()}),this.precisionList=new n.OptionDropDown("Precision",this.tbody,[],-1),this.addEventListener(this.precisionList,"change",function(e){var t=c.precisionList.selectedIndex
c.measureTool.setPrecision(t),c.updatePanel()}),this.setupPrecision(),this.isolate=new n.OptionCheckbox("Isolate measurement",this.tbody,!1),this.addEventListener(this.isolate,"change",function(e){var t=c.isolate.checked
c.isolateMeasure=t,c.isolateMeasure?c.measureTool.isolateMeasurement():c.measureTool.clearIsolate()}),this.addDivider(this.measureSettings)
var R=document.createElement("div")
R.className="measure-restart",R.setAttribute("data-i18n","Restart"),R.textContent=t.i18n.translate("Restart"),R.addEventListener("click",function(){c.measureTool.clearMeasurement()},!1),this.measureResults.appendChild(R),this.updatePanel(),this.addVisibilityListener(function(){c.resizeToContent({maxHeight:c.parentContainer.offsetHeight-75})}),this.hideMeasureResult()}
r.prototype=Object.create(o.DockingPanel.prototype),i.ViewerPanelMixin.call(r.prototype),r.prototype.addDropDownMenu=function(e,i,n,o,r){var a=function(e){var t=e.target.selectedIndex
r(t)},s=document.createElement("select")
s.className="optionDropDown"
for(var l=0;l<n.length;l++){var c=document.createElement("option")
c.value=l,c.setAttribute("data-i18n",n[l]),c.textContent=t.i18n.translate(n[l]),s.add(c)}var u=document.createElement("div")
u.className="measure-submenu-select"
var d=document.createElement("div")
return d.className="measure-submenu-selectlabel",d.setAttribute("for",i),d.setAttribute("data-i18n",i),d.textContent=t.i18n.translate(i),u.appendChild(d),u.appendChild(s),e.appendChild(u),s.selectedIndex=o,s.onchange=a,s},r.prototype.addDivider=function(e){var t=document.createElement("div")
return t.className="measure-horizontal-divider",e.appendChild(t),t},r.prototype.findUnits=function(){var e,t,i=this.measureTool.getUnits()
for(e=0;e<this.units.length;++e){var n=this.units[e].matches
if(n)for(t=0;t<n.length;++t)if(n[t]===i)return e}return 0},r.prototype.setupPrecision=function(){for(;this.precisionList.dropdownElement.lastChild;)this.precisionList.dropdownElement.removeChild(this.precisionList.dropdownElement.lastChild)
var e,t=this.measureTool.getUnits()
e="ft"===t||"in"===t||"fractional-in"===t?["1","1/2","1/4","1/8","1/16","1/32","1/64"]:["0","0.1","0.01","0.001","0.0001","0.00001"]
for(var i=0;i<e.length;++i){var n=document.createElement("option")
n.value=i,n.textContent=e[i],this.precisionList.dropdownElement.appendChild(n)}var o=this.measureTool.getPrecision()
e.length<=o&&(o=e.length-1,self.measureTool.setPrecision(o)),this.precisionList.dropdownElement.selectedIndex=o},r.prototype.uninitialize=function(){this.viewer=null,o.DockingPanel.prototype.uninitialize.call(this)},r.prototype.onTitleClick=function(e){},r.prototype.deltaCollapse=function(){this.deltaButton.classList.toggle("rotated"),this.measureTool.getIndicator().setSimple(this.isDeltaExpanded),this.isDeltaExpanded?(this.deltaXDiv.style.display="none",this.deltaYDiv.style.display="none",this.deltaZDiv.style.display="none",this.isDeltaExpanded=!1):(this.deltaXDiv.style.display="block",this.deltaYDiv.style.display="block",this.viewer.model&&!this.viewer.model.is2d()&&(this.deltaZDiv.style.display="block"),this.isDeltaExpanded=!0),this.resizeToContent()},r.prototype.toggle=function(){this.deltaCollapse()},r.prototype.isExpanded=function(){return this.container.children[0].classList.contains("expanded")},r.prototype.getContentSize=function(){return{height:this.isExpanded()?this.measureResults.clientHeight+46:0,width:this.measureResults.clientWidth}},r.prototype.updatePanel=function(){function e(e,i){"angle"===i?e.textContent="~ "+t.measureTool.getAngle():"xyz"===i?e.textContent="~ "+t.measureTool.getDistance(i):e.children[2].textContent=" = ~ "+t.measureTool.getDistance(i)}var t=this
e(this.distanceDiv,"xyz"),e(this.deltaXDiv,"x"),e(this.deltaYDiv,"y"),e(this.deltaZDiv,"z"),e(this.angleDiv,"angle"),this.unitList.dropdownElement.selectedIndex=this.findUnits(),this.precisionList.dropdownElement.selectedIndex=this.measureTool.getPrecision(),this.showSelection1(),this.showSelection2()},r.prototype.showDistanceResult=function(){this.results.style.display="block",this.initialDiv.style.display="none",this.angleDiv.style.display="none",this.angleIcon.style.display="none",this.distanceDiv.style.display="inline-block",this.distIcon.style.display="inline-block",this.deltaButton.style.display="inline-block",this.isDeltaExpanded&&(this.deltaXDiv.style.display="block",this.deltaYDiv.style.display="block",this.viewer.model&&!this.viewer.model.is2d()&&(this.deltaZDiv.style.display="block")),this.resizeToContent()},r.prototype.showAngleResult=function(){this.results.style.display="block",this.initialDiv.style.display="none",this.angleDiv.style.display="inline-block",this.angleIcon.style.display="inline-block",this.distanceDiv.style.display="none",this.distIcon.style.display="none",this.deltaButton.style.display="none",this.isDeltaExpanded&&(this.deltaXDiv.style.display="none",this.deltaYDiv.style.display="none",this.deltaZDiv.style.display="none"),this.resizeToContent()},r.prototype.showSelection1=function(){var e=this.measureTool.getFirstGeometry()
null!==e.type&&(e.type===SNAP_VERTEX?(this.selection1Result.setAttribute("data-i18n","Vertex"),this.selection1Result.textContent=t.i18n.translate("Vertex"),this.selection1Result.style.display="inline-block"):e.type===SNAP_EDGE?(this.selection1Result.setAttribute("data-i18n","Edge"),this.selection1Result.textContent=t.i18n.translate("Edge")+" - ~ "+this.measureTool.getEdgeLength(e.geometry),this.selection1Result.style.display="inline-block"):e.type===SNAP_FACE?(this.selection1Result.setAttribute("data-i18n","Face"),this.selection1Result.textContent=t.i18n.translate("Face")+" - ~ "+this.measureTool.getFaceArea(e.geometry),this.selection1Result.style.display="inline-block"):e.type===SNAP_CIRCULARARC&&(this.selection1Result.setAttribute("data-i18n","Edge"),this.selection1Result.textContent=t.i18n.translate("Edge")+" - ~ "+this.measureTool.getEdgeLength(e.geometry),this.selection1Result.style.display="inline-block"),this.selection1.style.display="block",this.resizeToContent())},r.prototype.showSelection2=function(){var e=this.measureTool.getSecondGeometry()
null!==e.type&&(e.type===SNAP_VERTEX?(this.selection2Result.setAttribute("data-i18n","Vertex"),this.selection2Result.textContent=t.i18n.translate("Vertex"),this.selection2Result.style.display="inline-block"):e.type===SNAP_EDGE?(this.selection2Result.setAttribute("data-i18n","Edge"),this.selection2Result.textContent=t.i18n.translate("Edge")+" - ~ "+this.measureTool.getEdgeLength(e.geometry),this.selection2Result.style.display="inline-block"):e.type===SNAP_FACE?(this.selection2Result.setAttribute("data-i18n","Face"),this.selection2Result.textContent=t.i18n.translate("Face")+" - ~ "+this.measureTool.getFaceArea(e.geometry),this.selection2Result.style.display="inline-block"):e.type===SNAP_CIRCULARARC&&(this.selection2Result.setAttribute("data-i18n","Edge"),this.selection2Result.textContent=t.i18n.translate("Edge")+" - ~ "+this.measureTool.getEdgeLength(e.geometry),this.selection2Result.style.display="inline-block"),this.selection2.style.display="block",this.resizeToContent())},r.prototype.firstSelectionRepick=function(){this.measureTool.clearFirstPick(),this.selection1Result.textContent=this.selection2Result.textContent,this.clearSelectionTwo(),this.clearResult(),this.resizeToContent()},r.prototype.secondSelectionRepick=function(){this.measureTool.clearSecondPick(),this.clearSelectionTwo(),this.clearResult(),this.resizeToContent()},r.prototype.hideMeasureResult=function(){this.clearSelectionOne(),this.clearSelectionTwo(),this.clearResult(),this.resizeToContent()},r.prototype.disableUnitOption=function(e){null!=e?this.unitList.dropdownElement.children[e].style.display="none":this.unitList.dropdownElement.disabled=!0},r.prototype.showMeasureSettings=function(){this.isSettingsExpanded?(this.measureSettings.style.display="none",this.isSettingsExpanded=!1):(this.measureSettings.style.display="block",this.isSettingsExpanded=!0),this.resizeToContent()},r.prototype.clearSelectionOne=function(){this.selection1Result.setAttribute("data-i18n","Select Object"),this.selection1Result.textContent=t.i18n.translate("Select Object")},r.prototype.clearSelectionTwo=function(){this.selection2Result.setAttribute("data-i18n","Select Object"),this.selection2Result.textContent=t.i18n.translate("Select Object")},r.prototype.clearResult=function(){this.distIcon.style.display="none",this.angleIcon.style.display="none",this.distanceDiv.style.display="none",this.angleDiv.style.display="none",this.initialDiv.style.display="inline-block",this.deltaButton.style.display="none",this.deltaXDiv.style.display="none",this.deltaYDiv.style.display="none",this.deltaZDiv.style.display="none"},e.MeasurePanel=r}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Measure")
var SNAP_VERTEX=0,SNAP_EDGE=1,SNAP_FACE=2,SNAP_CIRCULARARC=3,SNAP_PRECISION=.001
Autodesk.Viewing.Extensions.Measure.Snapper=function(e){function t(e,t){this.viewer=e,this.snapper=t,this.lineGeom=new THREE.Geometry,this.circularArc=null,this.circularArcCenter,this.ellipticalArc=null,this.ellipticalArcCenter,this.minDist=Number.MAX_VALUE,this.vpIdLine=null,this.vpIdCircular=null,this.vpIdElliptical=null,this.detectRadius=this.snapper.getDetectRadius()}var i=e,n=["snapper"],o=!1,r="MeasureTool-snapper-face",a="MeasureTool-snapper-vertex",s="MeasureTool-snapper-edge",l=null,c=Number.MAX_VALUE,u=null,d=null,h=null,p=null,f=null,m=null,v=null,g=null,E=!1,y=!1,A=null,T=null
this.isActive=function(){return o},this.getNames=function(){return n},this.getName=function(){return n[0]},this.activate=function(){o=!0},this.deactivate=function(){o=!1,this.destroy()},this.getFace=function(){return d},this.getEdge=function(){return h},this.getVertex=function(){return p},this.getSnapNode=function(){return f},this.getHighlightGeometry=function(){return m},this.getIntersectPoint=function(){return v},this.getFaceNormal=function(){return g},this.getEndPointsInEdge=function(e){for(var t=e.vertices,i=[],n=0;n<t.length;++n){for(var o=!1,r=0;r<t.length;++r)if(r!==n&&t[r].equals(t[n])){o=!0
break}o||i.push(t[n])}return i},this.getViewportIndex=function(){return A},this.getCircularArcCenter=function(){return T},this.getDetectRadius=function(){return l},this.isSnapped=function(){return y},this.isEqualWithPrecision=function(e,t){return Math.abs(e-t)<=SNAP_PRECISION?!0:!1},this.isEqualVectorsWithPrecision=function(e,t){return Math.abs(e.x-t.x)<=SNAP_PRECISION&&Math.abs(e.y-t.y)<=SNAP_PRECISION&&Math.abs(e.z-t.z)<=SNAP_PRECISION?!0:!1},this.isInverseVectorsWithPrecision=function(e,t){return Math.abs(e.x+t.x)<=SNAP_PRECISION&&Math.abs(e.y+t.y)<=SNAP_PRECISION&&Math.abs(e.z+t.z)<=SNAP_PRECISION?!0:!1},this.snapping3D=function(e){f=e.dbId
var t=e.face
v=e.intersectPoint
var n
if(n=void 0===e.fragId.length?[e.fragId]:e.fragId,i.model.hasTopology()){f&&(n=[],i.model.getData().instanceTree.enumNodeFragments(f,function(e){n.push(e)},!0)),d=h=p=null,c=Number.MAX_VALUE
for(var o=0;o<n.length;++o){var r=n[o],a=i.impl.getRenderProxy(i.model,r),s=a.geometry,E=i.model.getTopoIndex(r),A=i.model.getTopology(E),T=A.faces,b=A.edges
A.vertices
if(!d){d=this.faceSnappingWithTopology(t,s,T,a)
var w=(new THREE.Matrix3).getNormalMatrix(a.matrixWorld)
g=t.normal.applyMatrix3(w).normalize()}this.edgeSnappingWithTopology(v,s,b,a)}p=this.vertexSnappingWithTopology(h,v),d&&(l=this.setDetectRadius(v),l>u?(this.drawPoint(p),m=SNAP_VERTEX):l>c?(this.drawLine(h),m=SNAP_EDGE):(this.drawFace(d),m=SNAP_FACE),y=!1)}else for(var o=0;o<n.length;++o){var r=n[o],a=i.impl.getRenderProxy(i.model,r),s=a.geometry
if(d=this.faceSnapping(t,s)){d.applyMatrix(a.matrixWorld),h=this.edgeSnapping(d,v),p=this.vertexSnapping(h,v)
var w=(new THREE.Matrix3).getNormalMatrix(a.matrixWorld)
g=t.normal.applyMatrix3(w).normalize(),l=this.setDetectRadius(v),l>u?(this.drawPoint(p),m=SNAP_VERTEX):l>c?(this.drawLine(h),m=SNAP_EDGE):(this.drawFace(d),m=SNAP_FACE),y=!0
break}}},this.faceSnappingWithTopology=function(e,t,i,n){var o=new THREE.Vector3,r=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Geometry,l=t.attributes
if(void 0!==l.index){for(var c=t.vb?t.vb:l.position.array,u=t.vb?t.vbstride:3,d=0;d<i.length;d++){for(var h=i[d].indexList,p=0;p<h.length;p+=3)if(e.a===h[p]){if(e.b===h[p+1]&&e.c===h[p+2]||e.b===h[p+2]&&e.c===h[p+1])break}else if(e.a===h[p+1]){if(e.b===h[p]&&e.c===h[p+2]||e.b===h[p+2]&&e.c===h[p])break}else if(e.a===h[p+2]&&(e.b===h[p]&&e.c===h[p+1]||e.b===h[p+1]&&e.c===h[p]))break
if(p<h.length)break}if(d<i.length)for(var p=0;p<h.length;p+=3){o.set(c[h[p]*u],c[h[p]*u+1],c[h[p]*u+2]),r.set(c[h[p+1]*u],c[h[p+1]*u+1],c[h[p+1]*u+2]),a.set(c[h[p+2]*u],c[h[p+2]*u+1],c[h[p+2]*u+2])
var f=s.vertices.length
s.vertices.push(o.clone()),s.vertices.push(r.clone()),s.vertices.push(a.clone()),s.faces.push(new THREE.Face3(f,f+1,f+2))}}return s.vertices.length>0?(s.applyMatrix(n.matrixWorld),s):null},this.faceSnapping=function(e,t){var i=new THREE.Vector3,n=new THREE.Vector3,o=new THREE.Vector3,r=new THREE.Geometry,a=t.attributes
if(void 0!==a.index){var s=a.index.array||t.ib,l=t.vb?t.vb:a.position.array,c=t.vb?t.vbstride:3,u=t.offsets
u&&0!==u.length||(u=[{start:0,count:s.length,index:0}])
for(var d=0;d<u.length;++d)for(var h=u[d].start,p=u[d].count,f=u[d].index,m=h;h+p>m;m+=3){var v=f+s[m],g=f+s[m+1],E=f+s[m+2]
i.set(l[v*c],l[v*c+1],l[v*c+2]),n.set(l[g*c],l[g*c+1],l[g*c+2]),o.set(l[E*c],l[E*c+1],l[E*c+2])
var y=THREE.Triangle.normal(i,n,o),A=new THREE.Vector3
if(A.set(l[e.a*c],l[e.a*c+1],l[e.a*c+2]),this.isEqualVectorsWithPrecision(y,e.normal)&&this.isEqualWithPrecision(y.dot(i),e.normal.dot(A))){var T=r.vertices.length
r.vertices.push(i.clone()),r.vertices.push(n.clone()),r.vertices.push(o.clone()),r.faces.push(new THREE.Face3(T,T+1,T+2))}}}return r.vertices.length>0?this.getTrianglesOnSameFace(r,e,l,c):null},this.getTrianglesOnSameFace=function(e,t,i,n){var o=!1,r=e.vertices.slice(),a=new THREE.Vector3
a.set(i[t.a*n],i[t.a*n+1],i[t.a*n+2])
var s=new THREE.Vector3
s.set(i[t.b*n],i[t.b*n+1],i[t.b*n+2])
var l=new THREE.Vector3
l.set(i[t.c*n],i[t.c*n+1],i[t.c*n+2])
var c=new THREE.Geometry
c.vertices.push(a),c.vertices.push(s),c.vertices.push(l),c.faces.push(new THREE.Face3(0,1,2))
var u=[]
do{u=[]
for(var d=0;d<r.length;d+=3)if(r[d].equals(a)&&r[d+1].equals(s)&&r[d+2].equals(l))o=!0,u.push(d)
else for(var h=0;h<c.vertices.length;h+=3)if(this.trianglesSharedEdge(r[d],r[d+1],r[d+2],c.vertices[h],c.vertices[h+1],c.vertices[h+2])){var p=c.vertices.length
c.vertices.push(r[d].clone()),c.vertices.push(r[d+1].clone()),c.vertices.push(r[d+2].clone()),c.faces.push(new THREE.Face3(p,p+1,p+2)),u.push(d)
break}for(var f=u.length-1;f>=0;--f)r.splice(u[f],3)}while(u.length>0)
return o?c:null},this.trianglesSharedEdge=function(e,t,i,n,o,r){var a=!1,s=!1,l=!1
return(e.equals(n)||e.equals(o)||e.equals(r))&&(a=!0),(t.equals(n)||t.equals(o)||t.equals(r))&&(s=!0),(i.equals(n)||i.equals(o)||i.equals(r))&&(l=!0),a&s||a&l||s&l?!0:!1},this.edgeSnappingWithTopology=function(e,t,i,n){var o,r=new THREE.Geometry,a=Number.MAX_VALUE,s=new THREE.Vector3,l=new THREE.Vector3,u=t.attributes
if(void 0!==u.index&&void 0!=i){for(var d=t.vb?t.vb:u.position.array,p=t.vb?t.vbstride:3,f=0;f<i.length;f++)for(var m=i[f].indexList,v=0;v<m.length-1;v++){s.set(d[m[v]*p],d[m[v]*p+1],d[m[v]*p+2]),l.set(d[m[v+1]*p],d[m[v+1]*p+1],d[m[v+1]*p+2]),s.applyMatrix4(n.matrixWorld),l.applyMatrix4(n.matrixWorld)
var g=this.distancePointToLine(e,s,l)
a>g&&(a=g,o=f)}if(o){m=i[o].indexList
for(var E=0;E<m.length-1;E++)r.vertices.push(new THREE.Vector3(d[m[E]*p],d[m[E]*p+1],d[m[E]*p+2])),r.vertices.push(new THREE.Vector3(d[m[E+1]*p],d[m[E+1]*p+1],d[m[E+1]*p+2]))}}c>=a&&r.vertices.length>0&&(c=a,r.applyMatrix(n.matrixWorld),h=r)},this.edgeSnapping=function(e,t){for(var i=new THREE.Geometry,n=!0,o=!0,r=!0,a=0;a<e.vertices.length;a+=3){for(var s=0;s<e.vertices.length;s+=3)a!==s&&((e.vertices[a].equals(e.vertices[s])||e.vertices[a].equals(e.vertices[s+1])||e.vertices[a].equals(e.vertices[s+2]))&&(e.vertices[a+1].equals(e.vertices[s])||e.vertices[a+1].equals(e.vertices[s+1])||e.vertices[a+1].equals(e.vertices[s+2]))&&(n=!1),(e.vertices[a].equals(e.vertices[s])||e.vertices[a].equals(e.vertices[s+1])||e.vertices[a].equals(e.vertices[s+2]))&&(e.vertices[a+2].equals(e.vertices[s])||e.vertices[a+2].equals(e.vertices[s+1])||e.vertices[a+2].equals(e.vertices[s+2]))&&(o=!1),(e.vertices[a+1].equals(e.vertices[s])||e.vertices[a+1].equals(e.vertices[s+1])||e.vertices[a+1].equals(e.vertices[s+2]))&&(e.vertices[a+2].equals(e.vertices[s])||e.vertices[a+2].equals(e.vertices[s+1])||e.vertices[a+2].equals(e.vertices[s+2]))&&(r=!1))
n&&(i.vertices.push(e.vertices[a].clone()),i.vertices.push(e.vertices[a+1].clone())),o&&(i.vertices.push(e.vertices[a].clone()),i.vertices.push(e.vertices[a+2].clone())),r&&(i.vertices.push(e.vertices[a+1].clone()),i.vertices.push(e.vertices[a+2].clone())),n=!0,o=!0,r=!0}for(var l,u=new THREE.Geometry,d=Number.MAX_VALUE,h=0;h<i.vertices.length;h+=2){var p=this.distancePointToLine(t,i.vertices[h],i.vertices[h+1])
d>p&&(d=p,l=h)}return u.vertices.push(i.vertices[l].clone()),u.vertices.push(i.vertices[l+1].clone()),u.vertices=this.getConnectedLineSegmentsOnSameLine(i,u.vertices),c=d,u},this.distancePointToLine=function(e,t,i){var n,o,r=new THREE.Vector3,a=new THREE.Vector3
return r.subVectors(t,e),a.subVectors(i,t),o=r.dot(a),r.subVectors(i,t),o=-o/r.dot(r),0>o?n=e.distanceTo(t):o>1?n=e.distanceTo(i):(r.subVectors(e,t),a.subVectors(e,i),r.cross(a),a.subVectors(i,t),n=Math.sqrt(r.dot(r))/Math.sqrt(a.dot(a))),n},this.getConnectedLineSegmentsOnSameLine=function(e,t){var i=e.vertices.slice(),n=t[0],o=t[1],r=[]
do{r=[]
for(var a=0;a<i.length;a+=2)if(!i[a].equals(n)||!i[a+1].equals(o))for(var s=0;s<t.length;s+=2)if(i[a].equals(t[s])||i[a+1].equals(t[s])||i[a].equals(t[s+1])||i[a+1].equals(t[s+1])){var l=new THREE.Vector3,c=new THREE.Vector3
if(l.subVectors(t[s],t[s+1]),l.normalize(),c.subVectors(i[a],i[a+1]),c.normalize(),this.isEqualVectorsWithPrecision(l,c)||this.isInverseVectorsWithPrecision(l,c)){r.push(a)
break}}for(var u=r.length-1;u>=0;--u)t.push(i[r[u]]),t.push(i[r[u]+1]),i.splice(r[u],2)}while(r.length>0)
return t},this.vertexSnappingWithTopology=function(e,t){var i=Number.MAX_VALUE,n=new THREE.Vector3
if(e&&e.vertices.length>1){var o=t.distanceTo(e.vertices[0]),r=t.distanceTo(e.vertices[e.vertices.length-1])
r>=o?(i=o,n=e.vertices[0].clone()):(i=r,n=e.vertices[e.vertices.length-1].clone())}return u=i,n},this.vertexSnapping=function(e,t){for(var i=Number.MAX_VALUE,n=new THREE.Vector3,o=0;o<e.vertices.length;++o){var r=t.distanceTo(e.vertices[o])
i-SNAP_PRECISION>r&&(i=r,n=e.vertices[o].clone())}return u=i,n},this.angleVector2=function(e){return e.x>0&&e.y>=0?Math.atan(e.y/e.x):e.x>=0&&e.y<0?Math.atan(e.y/e.x)+2*Math.PI:e.x<0&&e.y<=0?Math.atan(e.y/e.x)+Math.PI:e.x<=0&&e.y>0?Math.atan(e.y/e.x)+Math.PI:null},t.prototype.onLineSegment=function(e,t,i,n,o){var r=this.snapper.getIntersectPoint(),a=this.lineGeom.vertices,s=new THREE.Vector3(e,t,r.z),l=new THREE.Vector3(i,n,r.z),c=this.snapper.distancePointToLine(r,s,l)
c<=this.detectRadius&&c<this.minDist&&(a.splice(0,2,s,l),this.minDist=c,this.vpIdLine=o)},t.prototype.onCircularArc=function(e,t,i,n,o,r){var a=this.snapper.getIntersectPoint(),s=new THREE.Vector2(a.x,a.y),l=new THREE.Vector2(e,t),c=s.distanceTo(l)
s.sub(l)
var u=this.snapper.angleVector2(s)
if(Math.abs(c-o)<=this.detectRadius){if(n>i&&u>=i&&n>=u)var d=new THREE.CircleGeometry(o,100,i,n-i)
else{if(!(i>n&&(u>=i||n>=u)))return
var d=new THREE.CircleGeometry(o,100,i,2*Math.PI-i+n)}d.vertices.splice(0,1),d.applyMatrix((new THREE.Matrix4).makeTranslation(e,t,a.z)),this.circularArc=d,this.circularArcCenter=new THREE.Vector3(e,t,a.z),this.vpIdCircular=r}},t.prototype.onEllipticalArc=function(e,t,i,n,o,r,a,s){var l=this.snapper.getIntersectPoint(),c=new THREE.Vector2(l.x,l.y),u=o-this.detectRadius,d=r-this.detectRadius,h=o+this.detectRadius,p=r+this.detectRadius,f=(c.x-e)*(c.x-e)/(u*u)+(c.y-t)*(c.y-t)/(d*d),m=(c.x-e)*(c.x-e)/(h*h)+(c.y-t)*(c.y-t)/(p*p),v=new THREE.Vector2(e,t)
c.sub(v),c.x*=r,c.y*=o
var g=this.snapper.angleVector2(c)
if(n>2*Math.PI&&(n=2*Math.PI),f>=1&&1>=m&&(n>i&&g>=i&&n>=g||i>n&&(g>=i||n>=g))){var E=new THREE.EllipseCurve(e,t,o,r,i,n,!1),y=new THREE.Path(E.getPoints(50)),A=y.createPointsGeometry(50)
this.snapper.isEqualWithPrecision(n-i,2*Math.PI)||A.vertices.pop(),A.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,l.z)),this.ellipticalArc=A,this.ellipticalArcCenter=new THREE.Vector3(e,t,l.z),this.vpIdElliptical=s}},this.snapping2D=function(e){if(e){var n=e.intersectPoint,o=e.fragId
if("undefined"!=typeof o){Array.isArray(o)||(o=[o]),v=n,l=this.setDetectRadius(n)
for(var r=new t(i,this),a=0;a<o.length;++a){var s=i.impl.getRenderProxy(i.model,o[a]),c=new Autodesk.Viewing.Private.VertexBufferReader(s.geometry)
c.enumGeomsForObject(e.dbId,r)}r.circularArc?(n.distanceTo(r.circularArc.vertices[0])<l?(p=r.circularArc.vertices[0],this.drawPoint(p),m=SNAP_VERTEX):n.distanceTo(r.circularArc.vertices[r.circularArc.vertices.length-1])<l?(p=r.circularArc.vertices[r.circularArc.vertices.length-1],this.drawPoint(p),m=SNAP_VERTEX):(this.lineStripToPieces(r.circularArc),h=r.circularArc,this.drawLine(h),T=r.circularArcCenter,m=SNAP_CIRCULARARC),A=r.vpIdCircular,y=!0):r.ellipticalArc?(n.distanceTo(r.ellipticalArc.vertices[0])<l?(p=r.ellipticalArc.vertices[0],this.drawPoint(p),m=SNAP_VERTEX):n.distanceTo(r.ellipticalArc.vertices[r.ellipticalArc.vertices.length-1])<l?(p=r.ellipticalArc.vertices[r.ellipticalArc.vertices.length-1],this.drawPoint(p),m=SNAP_VERTEX):(this.lineStripToPieces(r.ellipticalArc),h=r.ellipticalArc,this.drawLine(h),T=r.ellipticalArcCenter,m=SNAP_CIRCULARARC),A=r.vpIdElliptical,y=!0):r.lineGeom.vertices.length&&(n.distanceTo(r.lineGeom.vertices[0])<l?(p=r.lineGeom.vertices[0],this.drawPoint(p),m=SNAP_VERTEX):n.distanceTo(r.lineGeom.vertices[1])<l?(p=r.lineGeom.vertices[1],this.drawPoint(p),m=SNAP_VERTEX):(h=r.lineGeom,this.drawLine(h),m=SNAP_EDGE),A=r.vpIdLine,y=!0)}}},this.lineStripToPieces=function(e){for(var t=e.vertices,i=t.length-2;i>0;i--)t.splice(i,0,t[i])},this.createOverlay=function(e){i.impl.createOverlayScene(e)},this.addOverlay=function(e,t){i.impl.addOverlay(e,t)},this.clearOverlay=function(){i.impl.overlayScenes[r]&&i.impl.clearOverlay(r),i.impl.overlayScenes[a]&&i.impl.clearOverlay(a),i.impl.overlayScenes[s]&&i.impl.clearOverlay(s)},this.drawFace=function(e){this.createOverlay(r)
var t=52224,i=.5,n=new THREE.MeshPhongMaterial({color:t,ambient:t,opacity:i,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),o=new THREE.Mesh(e,n,!0)
this.addOverlay(r,o)},this.cylinderMesh=function(e,t,i){var n=(new THREE.Vector3).subVectors(t,e),o=new THREE.Matrix4
o.lookAt(e,t,(new THREE.Object3D).up),o.multiply((new THREE.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1))
var r=new THREE.CylinderGeometry(.5,.5,n.length(),8,1,!0),a=new THREE.Mesh(r,i)
return a.applyMatrix(o),a.position.x=(t.x+e.x)/2,a.position.y=(t.y+e.y)/2,a.position.z=(t.z+e.z)/2,a},this.drawLine=function(e){this.createOverlay(s)
for(var t=52224,i=.5,n=new THREE.MeshPhongMaterial({color:t,ambient:t,opacity:i,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),o=0;o<e.vertices.length;o+=2){var r=this.cylinderMesh(e.vertices[o],e.vertices[o+1],n)
this.setEdgeScale(r),this.addOverlay(s,r)}},this.drawArc=function(e){this.createOverlay(s)
for(var t=52224,i=.5,n=new THREE.MeshPhongMaterial({color:t,ambient:t,opacity:i,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),o=0;o<e.vertices.length-1;o++){var r=this.cylinderMesh(e.vertices[o],e.vertices[o+1],n)
this.setEdgeScale(r),this.addOverlay(s,r)}},this.drawPoint=function(e){this.createOverlay(a)
var t=52224,i=.5,n=new THREE.MeshPhongMaterial({color:t,ambient:t,opacity:i,transparent:!0,depthTest:!1,depthWrite:!1}),o=new THREE.Mesh(new THREE.SphereGeometry(1),n)
o.position.set(e.x,e.y,e.z),this.setPointScale(o),this.addOverlay(a,o)},this.setScale=function(e){var t=5,n=i.navigation,o=n.getCamera(),r=n.getEyeVector(),a=n.getPosition(),s=e.position.clone(),l=o.isPerspective?s.sub(a).dot(r.normalize()):n.getEyeVector().length(),c=n.getVerticalFov(),u=2*l*Math.tan(THREE.Math.degToRad(.5*c)),d=n.getScreenViewport(),h=window.devicePixelRatio||1,p=t*u/(d.height*h)
return p},this.setPointScale=function(e){var t=this.setScale(e)
e.scale.x=t,e.scale.y=t,e.scale.z=t},this.setEdgeScale=function(e){var t=this.setScale(e)
e.scale.x=t,e.scale.z=t},this.updatePointScale=function(){var e=i.impl.overlayScenes[a]
if(e)for(var t=e.scene,n=0;n<t.children.length;n++){var o=t.children[n]
o&&this.setPointScale(o)}},this.updateEdgeScale=function(){var e=i.impl.overlayScenes[s]
if(e)for(var t=e.scene,n=0;n<t.children.length;n++){var o=t.children[n]
o&&this.setEdgeScale(o)}},this.setDetectRadius=function(e){var t=10,n=i.navigation,o=n.getCamera(),r=n.getEyeVector(),a=n.getPosition(),s=e.clone(),l=o.isPerspective?s.sub(a).dot(r.normalize()):n.getEyeVector().length(),c=n.getVerticalFov(),u=2*l*Math.tan(THREE.Math.degToRad(.5*c)),d=n.getScreenViewport(),h=window.devicePixelRatio||1,p=t*u/(d.height*h)
return p},this.drawIntersectFace=function(e,t,i,n){this.createOverlay()
var o=new THREE.Vector3
o.set(t[e.a*i],t[e.a*i+1],t[e.a*i+2])
var r=new THREE.Vector3
r.set(t[e.b*i],t[e.b*i+1],t[e.b*i+2])
var a=new THREE.Vector3
a.set(t[e.c*i],t[e.c*i+1],t[e.c*i+2])
var s=new THREE.Geometry
s.vertices.push(o),s.vertices.push(r),s.vertices.push(a),s.faces.push(new THREE.Face3(0,1,2))
var l=new THREE.Mesh(s,n.material,!0)
l.matrixWorld=n.matrixWorld,this.addOverlay(l)},this.handleWheelInput=function(e){return this.updatePointScale(),this.updateEdgeScale(),!1},this.handleButtonDown=function(e,t){return E=!0,!1},this.handleButtonUp=function(e,t){return E=!1,!1},this.handleMouseMove=function(e){if(!E){this.clearOverlay(),d=null,h=null,p=null,y=!1
var t=i.impl.snappingHitTest(e.canvasX,e.canvasY,!1)
t&&t.intersectPoint&&(t.face?this.snapping3D(t):this.snapping2D(t))}return!1},this.destroy=function(){this.clearOverlay(),i.impl.removeOverlayScene(r),i.impl.removeOverlayScene(a),i.impl.removeOverlayScene(s)}},function(){AutodeskNamespace("Autodesk.Viewing.Extensions.FirstPerson"),Autodesk.Viewing.Extensions.FirstPerson.FirstPersonTool=function(e){function t(e){if(m)return!0
var t=e.ctrlKey||n&&e.metaKey,i=e.metaKey&&!n
return t||i||e.shiftKey||e.altKey}var i,n=-1!=navigator.userAgent.search("Mac OS"),o=e.navigation,r=e.container,a=o.getCamera(),s=["firstperson"],l={SHIFT:0,ALT:0,CONTROL:0},c=Autodesk.Viewing.theHotkeyManager.KEYCODES,u=!1,d=!1,h=!0,p=!1,f=0,m=null,v=new THREE.Clock(!0),g=-1,E=5e3,y=1,A=1,T=2,b=2,w=1,_=.5,x=.0035,C=0,S=0,R=0,M=-1e20,P=0,L=0,I=-1e20,k=0,V=0,N=!1,D=!1,H=!1,O=!1,B=!1,F=!1,U=a.fov,z=!1,G=a.isPerspective,W=!1,j=!1;(navigator.getGamepads||navigator.webkitGetGamepads||navigator.webkitGamepads)&&(i=new Autodesk.Viewing.Extensions.GamepadModule(e)),this.isActive=function(){return u},this.getNames=function(){return s},this.getName=function(){return s[0]},this.activate=function(t){v.start(),G=a.isPerspective,o.toPerspective(),U=a.fov,o.setVerticalFov(75,!0),y=e.model.getUnitScale()
var n=e.model.getBoundingBox().size()
A=Math.max(Math.min(Math.min(n.x,n.y),n.z)/10,1e-4),e.canvas.focus(),u=!0,j||K(),addCrosshair(),i.activate(this.getName())},this.deactivate=function(e){u=!1,v.stop(),Y(),removeCrosshair(),z&&o.setVerticalFov(U,!0),W&&(G||o.toOrthographic()),i&&i.deactivate()},this.getCursor=function(){return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3goOFQoQszohGAAAA9hJREFUSMedll1oHGUUhp8zuzP5291pEvNTomgVjFCCCa0NpAqJEJTUFVv8uWxQLwKCF6IUr7wJ6J30QvBCAlZssA0EkYJaAm1FwU3iakrbVNNuutlukk3dzWyT/ZnJ7ufFTtokbmvX72Y45+N73/Oe8858I+xYSikBJJFI7AmFQh9alvVWoVC47vP5ho4cOXJeRGwqWN4yOQ2oHh0dPROJRNo7OjqIRCKPRxeiP66srBxSSn0vIsX/RaCU0gDV399vNjQ0tB8/fpxAIEAsFuP06dPEYrFvgHqguEMxIqLKdUPbmnArU52dnb2maWJUGeRyOWzbpqGxgXg87gOMncDlwLe2Y5uCwcHBFp/P90k4PE349xkWolGi0SjhPy5hF+UmIEopz/1AtxRcqmJzDQ8P7750+Wq8e9+TPGLe4sSp39jz9LMsxm/izE6gOVnquoIcOHDgnddfe/VEU3PLWkUzSCQSesCzxNtvHKZu11O0137OuTMneYY1+l+px99sci5zgU+/Pv/Z5OTkWeCvigja2tqqri3/RPbiMfSWLvY+/wJ7XwxCOoyz+gPF5C0OzsFZv8NEOOxU7KL5+fkcooFUo9avYt+4htTU43noJVTmIPYvp8hnChSKCr/fr1VMkEqlCgEATUDTAIVykhSWRtj4M4/KKzZ9Z9u2ehCCbVUYhlEaurg7m09NB/GWYhe2r69vV8UEvb29DeIWL+6uIG6w6b1SGAqF0hUTZDKZ7GLKy1w0h+Z1keQuMEDOKbK+oZFIJOyKZqCUEsuy/k4mk6kr0ZH6/Z2CkrttEl1QjuJkKI3z6KGp6vTFpYoVmKaZ9Xg8lleDoq3IzOdBILuygbVgs2YVSNrgOM7o1NTURkUE7qufX15evo5A0VHcnrNRgFgFJF6gsVmntlaIxWKNIlK/s8D/VCAianZ29spmv0vfVoVuaNT6PYhWMpGIGIZhNAGtQC3bbXDfj51YlrWObHeOKu3didfX1x3btgGqgADgu5eafyXT6XT2zmDLnVDg9Xq9uq573fMeQAeqy+HtTAgguq7h0aUsgyZCJpPZcBxnE1xz3fhACqp7enoe+3ZimVg8j6ELiIACEUETWErnsCwrD2h1dXW6C+4A2a033T0VfPD+e8dePvoFb36sM/LzKomkQ1FgMW3z7neL3Gh6jtbW1rmamhrDNM0NYAVIAYWyl06ZPwoNeHh6evqJmZmZiV8vnCBw+yLRRCv7gkdpamr6aGho6KuBgQFnfHx88V7AZQlcEt01jgD+sbGx3V+OjPR07d8fDQaDl1OpVLK7u9swTXP1Qa7NfwCi46BIaoRmhAAAAABJRU5ErkJggg==), auto"},this.adjustSpeed=function(e){0===e?b=T:(b*=e>0?1.1:.9,.01>b&&(b=.01))},this.handleGesture=function(e){switch(e.type){case"dragstart":return m="drag",this.handleButtonDown(e,0)
case"dragmove":return"drag"===m?this.handleMouseMove(e):!1
case"dragend":return"drag"===m?(this.handleButtonUp(e,0),m=null,!0):!1}return!1},this.handleSingleClick=function(e,t){return!1},this.handleButtonDown=function(e,i){Y(),f+=1<<i
var n=t(e)
return 0!==i||n?!0:(S=e.pageX-window.innerWidth/2,P=e.pageY-window.innerHeight/2,k=V=0,R=L=0,p=!0,!0)},this.handleMouseMove=function(e){var t=-1e10>M?0:e.pageX-M,i=-1e10>I?0:e.pageY-I
return M=e.pageX,I=e.pageY,p!==h||d||(k+=t*x,V+=i*x),!0},this.handleButtonUp=function(e,t){return f-=1<<t,0===t&&p?(k=V=0,R=L=0,p=!1,!0):!0},this.handleKeyDown=function(e,t){if(d)return!1
Y()
var i=!1,n=!1
switch(t){case c.ESCAPE:break
case c.TAB:n=!1
break
case c.SHIFT:l.SHIFT=1,i=n=!0
break
case c.CONTROL:l.CONTROL=1,i=n=!0
break
case c.ALT:l.ALT=1,i=n=!0
break
case c.SPACE:l.SPACE=1,i=n=!0
break
case c.EQUALS:this.adjustSpeed(1),n=!0
break
case c.DASH:this.adjustSpeed(-1),n=!0
break
case c.ZERO:this.adjustSpeed(0),n=!0
break
case c.UP:case c.w:N=!0,n=!0
break
case c.LEFT:case c.a:H=!0,n=!0
break
case c.DOWN:case c.s:D=!0,n=!0
break
case c.RIGHT:case c.d:O=!0,n=!0
break
case c.q:B=!0,n=!0
break
case c.e:F=!0,n=!0
break
case c.g:n=!0
break
case c.F1:n=!0}return n},this.handleKeyUp=function(e,t){if(d)return!1
var i=!1,n=!1
switch(t){case c.TAB:n=!1
break
case c.SHIFT:l.SHIFT=0,i=n=!0
break
case c.CONTROL:l.CONTROL=0,i=n=!0
break
case c.ALT:l.ALT=0,i=n=!0
break
case c.SPACE:l.SPACE=0,i=n=!0
break
case c.UP:case c.w:N=!1,n=!0
break
case c.LEFT:case c.a:H=!1,n=!0
break
case c.DOWN:case c.s:D=!1,n=!0
break
case c.RIGHT:case c.d:O=!1,n=!0
break
case c.q:B=!1,n=!0
break
case c.e:F=!1,n=!0
break
case c.g:R=L=0,h=!h,q(h),n=!0
break
case c.F1:K(),n=!0}return n},this.handleWheelInput=function(e){return d?!1:(o.getReverseZoomDirection()&&(e*=-1),C+=e,!0)},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return this.handleSingleClick(e,0)},this.handleDoubleTap=function(e){return!1},this.handleBlur=function(e){return N=D=!1,H=O=!1,B=F=!1,!1},this.update=function(){if(!u)return!1
var e=v.getDelta()
if(g>-1){var t=(new Date).getTime()
t-g>E&&Y()}a.isPerspective||(console.log("Lost perspective mode: resetting view."),o.toPerspective())
var n=a.clone(),r=e*b*A*(1===l.SHIFT?4:1),s=e*_*A*(1===l.SHIFT?4:1)
if(0!=C){var c=C*w*A*(1===l.SHIFT?4:1)
n.translateZ(-c),C=0}N&&(console.log("PUSH"),console.log(n.position),n.translateZ(-r),console.log(n.position)),D&&n.translateZ(r),H&&n.translateX(-r),O&&n.translateX(r),B&&n.translateY(s),F&&n.translateY(-s)
var d=n.position,h=0!==d.distanceToSquared(a.position),p=n.target,f=a.target.clone().sub(a.position),m=f.clone().cross(a.up).normalize()
if(0!=V){var y=new THREE.Quaternion
y.setFromAxisAngle(m,-V)
var T=f.clone()
T.applyQuaternion(y)
var x=a.worldup.clone(),S=T.angleTo(x),R=THREE.Math.degToRad(5)
S>=R&&S<=Math.PI-R&&(f.applyQuaternion(y),n.up.applyQuaternion(y)),V=0}if(0!=k){var M=new THREE.Quaternion
M.setFromAxisAngle(a.worldup,-k),f.applyQuaternion(M),n.up.applyQuaternion(M),k=0}p=d.clone().add(f)
var P=0!==p.distanceToSquared(a.target)
return(h||P)&&(o.setView(d,p),o.orientCameraUp()),i&&(a=i.update(a)),a.dirty}
var X=function(e,t,i,n,o){Autodesk.Viewing.Private.HudMessage&&(Autodesk.Viewing.Private.HudMessage.displayMessage(r,e,i,n,o),t>0?(g=(new Date).getTime(),E=t):(g=-1,E=0))},Y=function(){Autodesk.Viewing.Private.HudMessage&&Autodesk.Viewing.Private.HudMessage.dismiss(),g=-1},q=function(e){Y()
var t={msgTitleKey:"View Orientation Drag Mode Toggled",messageKey:"View Orientation Drag Mode Toggled",messageDefaultValue:e?"Press the primary mouse button and drag to change the view orientation":"Move the cursor to change the view orientation"}
X(t,0)},K=function(){Y()
var e={msgTitleKey:"First Person Tool",messageKey:"First Person Tool",messageDefaultValue:"Use the WASD and QE keys to move",checkboxChecked:j}
X(e,0,null,null,function(e){j=e.target.checked})}
addCrosshair=function(){"function"==typeof stringToDOM&&(this.crosshair=stringToDOM('<div id="remote-crosshair"><div class="crosshair-v"></div><div class="crosshair-h"></div></div>f'),e.canvasWrap.appendChild(this.crosshair))},removeCrosshair=function(){this.crosshair&&this.crosshair.remove()}}}(),function(){"use strict"
AutodeskNamespace("Autodesk.Viewing.Extensions.FirstPerson"),Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension=function(e,t){Autodesk.Viewing.Extension.call(this,e,t)},Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype),Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.constructor=Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension,Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.load=function(){var e=this,t=this.viewer,i=t.getToolbar(!0),n=Autodesk.Viewing.UI
return this.tool=new Autodesk.Viewing.Extensions.FirstPerson.FirstPersonTool(t),t.toolController.registerTool(this.tool),this.createUI(i),this.onToolChanged=function(t){if(-1!==t.toolName.indexOf("firstperson")){var i=t.active?n.Button.State.ACTIVE:n.Button.State.INACTIVE
e.firstPersonToolButton.setState(i)}},t.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged),!0},Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.createUI=function(e){var t=this,i=this.viewer,n=Autodesk.Viewing.UI,o=e.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID)
this.firstPersonToolButton=new n.Button("toolbar-firstPersonTool"),this.firstPersonToolButton.setToolTip("First person"),this.firstPersonToolButton.onClick=function(e){var o=t.firstPersonToolButton.getState()
o===n.Button.State.INACTIVE?i.setActiveNavigationTool("firstperson"):o===n.Button.State.ACTIVE&&i.setActiveNavigationTool()},this.firstPersonToolButton.setIcon("adsk-icon-first-person")
var r=o.getControl("toolbar-cameraSubmenuTool")
r?o.addControl(this.firstPersonToolButton,{index:o.indexOf(r.getId())}):o.addControl(this.firstPersonToolButton)},Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.unload=function(){var e=this.viewer
e.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged),this.onToolChanged=void 0,Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID)
var t=e.getToolbar(!1)
return t&&t.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID).removeControl(this.firstPersonToolButton.getId()),this.firstPersonToolButton=null,e.getActiveNavigationTool()==this.tool.getName()&&e.setActiveNavigationTool(),e.toolController.deregisterTool(this.tool),this.tool=null,!0},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.FirstPerson",Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension)}(),AutodeskNamespace("Autodesk.Viewing.Extensions.VR"),Autodesk.Viewing.Extensions.VR.VRTool=function(e,t){var i=e.navigation,n=e.container,o=i.getCamera(),r=["vr"],a=!1,s=null,l=!1,c=!0,u=!1,d={SHIFT:0,ALT:0,CONTROL:0},h=Autodesk.Viewing.theHotkeyManager.KEYCODES,p=0,f=!1,m=!1,v=!1,g=!1,E=!1,y=!1,A=!1,T=new THREE.Clock(!0),b=-1,w=5e3,_=1,x=16,C=15,S=3,R=!1,M=1.75,P=16,L=15,I=(o.fov,o.isPerspective),k=null,V=null,N=null,D=!1,H=-1,O=!0,B=null,F=null,U=.15,z=!1,G=new THREE.Vector3(0,0,0),W=new THREE.Vector3(0,0,0),j=!1
Math.PI/2
this.isActive=function(){return a},this.getNames=function(){return r},this.getName=function(){return r[0]},this.activate=function(t){if(!a){l=o.worldup&&1===o.worldup.x,c=o.worldup&&1===o.worldup.y,u=o.worldup&&1===o.worldup.z,console.log("VRTool : camera world up = "+o.worldup.x+","+o.worldup.y+","+o.worldup.z),T.start(),K()?(X(!1),console.log("VR Supported (Web API): Oculus, etc.")):window.addEventListener("deviceorientation",$,!0)
var i=e.config&&e.config.useVR?e.config.useVR:""
j="wearality"===i.toLowerCase(),Y(!0)
var n=e.utilities.getBoundingBox(!0).size()
_=Math.max(Math.min(Math.min(n.x,n.y),n.z)/100,1),this.resetPointerTracking(),e.canvas.focus(),a=!0}},this.deactivate=function(e){a&&(a=!1,te(),k&&(N&&(N.stop(),N=null),k.disconnect(),k=null,V&&V.disable()),Y(!1),exitFullscreen(),T.stop(),X(!0))},this.getCursor=function(){return"url(data:image/gif;base64,R0lGODlhGAAYAMIDAAQEBH19feDg4P///////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAAQALAAAAAAYABgAAAMqSLrc/jDKSau9OOvN8fjDNghBIITZEABAgHpr+15jeYpgp+987//AICEBADs=), auto"}
var X=function(e){var t=document.getElementsByClassName("toolbar-menu")
t.length>0&&""!==t[0]&&(t[0].style.display=e?"block":"none")},Y=function(t){if(t!==!!s)if(console.log("Enable Render Context: "+t),t){e.displayViewCube(!1,!1),I=e.navigation.isPerspective,I||e.navigation.toPerspective()
var i=!!B,n=null
if(j){var o=.075
n={useWarp:i,HMD:{hResolution:1920,vResolution:1080,hScreenSize:.12576,vScreenSize:.07074,interpupillaryDistance:o,lensSeparationDistance:o,eyeToScreenDistance:.041,distortionK:[1,.22,.24,0],chromaAbParameter:[.996,-.004,1.014,0]}}}else n={useWarp:i}
s=new Autodesk.Viewing.Extensions.Oculus.StereoRenderContext(n),e.impl.setUserRenderContext(s),e.resize(e.canvas.clientWidth,e.canvas.clientHeight),B?launchFullscreen(e.impl.canvas,{vrDisplay:B}):launchFullscreen(e.impl.canvas)}else s=null,e.impl.setUserRenderContext(null),e.setScreenMode(Autodesk.Viewing.ScreenMode.kNormal),e.displayViewCube(e.prefs.get("viewCube"),!1)}
this.handleSingleTap=function(t){if(k&&t.pointers){if(1===t.pointers.length)return setTimeout(function(){e.setActiveNavigationTool(e.defaultNavigationToolName)},10),!0
if(2===t.pointers.length)return q(),!0}return!1},this.handleDoubleTap=function(e){return!1},this.handlePressHold=function(e){return!1},this.handleGesture=function(e){if(k)switch(e.type){case"dragstart":A=!0
break
case"dragmove":break
case"dragend":A=!1}return!1},this.handleKeyDown=function(e,t){var i=!1,n=!1
switch(t){case h.TAB:n=!0
break
case h.SHIFT:d.SHIFT=1,i=!0,n=!0
break
case h.CONTROL:d.CONTROL=1,i=!0,n=!0
break
case h.ALT:d.ALT=1,i=!0,n=!0
break
case h.SPACE:n=!0
break
case h.EQUALS:this.adjustSpeed(1),n=!0
break
case h.DASH:this.adjustSpeed(-1),n=!0
break
case h.ZERO:this.adjustSpeed(0),n=!0
break
case h.w:if(1===d.CONTROL&&1===d.SHIFT){n=!0
break}case h.UP:f=!0,n=!0
break
case h.LEFT:case h.a:v=!0,n=!0
break
case h.DOWN:case h.s:m=!0,n=!0
break
case h.RIGHT:case h.d:g=!0,n=!0
break
case h.q:y=!0,n=!0
break
case h.e:E=!0,n=!0
break
case h.h:n=!0}return n},this.handleKeyUp=function(e,t){var i=!1,n=!1
switch(t){case h.SHIFT:d.SHIFT=0,i=!0
break
case h.CONTROL:d.CONTROL=0,i=!0
break
case h.ALT:d.ALT=0,i=!0
break
case h.SPACE:B&&Q(),n=!0
break
case h.w:if(!f&&1===d.CONTROL&&1===d.SHIFT){setTimeout(function(){Y(!1),j=!j,Y(!0)},10),n=!0
break}case h.UP:f=!1,n=!0
break
case h.LEFT:case h.a:v=!1,n=!0
break
case h.DOWN:case h.s:m=!1,n=!0
break
case h.RIGHT:case h.d:g=!1,n=!0
break
case h.q:y=!1,n=!0
break
case h.e:E=!1,n=!0
break
case h.h:ie(),n=!0}return n},this.handleBlur=function(e){return f=!1,m=!1,v=!1,g=!1,!1},this.update=function(e){if(a){var t=T.getDelta()
if(b>-1){var n=(new Date).getTime()
n-b>w&&te()}var r=!1
B&&Z(t)?r=!0:k&&J(t)&&(r=!0)
var s=o.clone(),l=t*x*_*(1===d.SHIFT?4:1),c=t*C*_*(1===d.SHIFT?4:1)
if(0!=p){var u=p*S*_*(1===d.SHIFT?4:1)
s.translateZ(-u),p=0}var h=!1,A=!1,M=!1,P=!1
R&&(h=!0),(f||h)&&s.translateZ(-l),(m||A)&&s.translateZ(l),(v||M)&&s.translateX(-l),(g||P)&&s.translateX(l),E&&s.translateY(c),y&&s.translateY(-c)
var L=s.position,I=0!==L.distanceToSquared(o.position)
if(I){var V=s.target,N=L.clone().sub(o.position)
V.add(N),i.setView(L,V)}return o.dirty}},this.resetPointerTracking=function(){f=m=!1,v=g=!1,E=y=!1,_mouseDraggingLookMode=!1}
var q=function(){return R=!R,R?(P=x,x=M,H=(new Date).getTime()):x=P,ne(R),R},K=function(){function e(e){for(var i=0;i<e.length;++i)e[i]instanceof HMDVRDevice&&(B=e[i])
for(var i=0;i<e.length;++i)e[i]instanceof PositionSensorVRDevice&&(!B||e[i].hardwareUnitId==B.hardwareUnitId)&&(F=e[i],t=!0)}var t=!1
return navigator.getVRDevices?navigator.getVRDevices().then(e):navigator.mozGetVRDevices?navigator.mozGetVRDevices(e):t=!1,t},Z=function(e){if(!F)return!1
var t=F.getState()
if(o){if(u?(W.x=t.position.x,W.y=-t.position.z,W.z=t.position.y):(W.x=t.position.x,W.y=t.position.y,W.z=t.position.z),z){var i=G.distanceTo(W)
if(i>=U){var n=(i-U)/.0762,r=e*x*_*n,a=W.clone().sub(G).normalize().multiplyScalar(r)
o.position.add(a)}}u?(o.quaternion.x=t.orientation.x,o.quaternion.y=-t.orientation.z,o.quaternion.z=t.orientation.y,o.quaternion.w=t.orientation.w):(o.quaternion.x=t.orientation.x,o.quaternion.y=t.orientation.y,o.quaternion.z=t.orientation.z,o.quaternion.w=t.orientation.w)
var s=new THREE.Vector3(0,0,-1)
u&&(s=new THREE.Vector3(s.x,-s.z,s.y)),s.applyQuaternion(o.quaternion),o.target=o.position.clone().add(s.clone().multiplyScalar(10)),o.dirty=!0}return!0},Q=function(){B&&(z=!z,z&&G.copy(W),ne(z))},J=function(e){if(!k)return!1
var t=k.update()
if(!t)return!1
if(u){var n=t.z
t.z=t.y,t.y=-n}var r=u?new THREE.Vector3(0,1,0):new THREE.Vector3(0,0,-1),a=r.clone().applyQuaternion(t),s=o.target.clone().sub(o.position).length()
if(i.setTarget(o.position.clone().add(a.multiplyScalar(s))),N){if(N.isStarted())if(0>=H)N.checkVideoThreshold(L)&&q()
else{var l=N.checkVideoThreshold(L)
if(l){if(R){var c=(new Date).getTime(),d=c-H
d>250&&(H=c,x+=P,ne(!0))}}else H=-1}}else{var h=u?new THREE.Vector3(0,0,-1):new THREE.Vector3(0,-1,0),p=THREE.Math.radToDeg(a.angleTo(h))
if(30>p)if(D){if(R){var c=(new Date).getTime(),d=c-H,f=O?1500:1e3
d>=f&&(O=!1,H=c,x+=P,ne(!0))}}else q(),D=!0,R&&(O=!0)
else p>=30&&(D=!1,H=-1)}return o.dirty=!0,!0},$=function(e){return e.alpha?(window.removeEventListener("deviceorientation",$,!0),k=new THREE.DeviceOrientationControls,k.connect(),V||(V=new window.NoSleep,V.enable()),N=new VideoHelper("videoVR","videoVR-canvas",1),N.start()||(N=null,console.log("VideoHelper : Failed to start.")),X(!1),console.log("VR Supported (DeviceOrientation): Google Goggles, etc."),!0):!1},ee=function(e,t){Autodesk.Viewing.Private.HudMessage.dismiss(),Autodesk.Viewing.Private.HudMessage.displayMessage(n,e),b=(new Date).getTime(),(!t||0>=t)&&(t=5e3),w=t},te=function(){Autodesk.Viewing.Private.HudMessage.dismiss(),b=-1},ie=function(){var e={msgTitleKey:"Virtual Reality Tool",messageKey:"Virtual Reality Tool",messageDefaultValue:"This is the Virtual Reality tool"}
ee(e,3e3)},ne=function(e,t){(!t||0>=t)&&(t=250)
var i=Autodesk.Viewing.i18n.translate("START Auto Move"),n=Autodesk.Viewing.i18n.translate("STOP Auto Move"),o=e?i+" ("+Math.floor(x)+")":n,r={msgTitleKey:"VR Toggle Move",messageKey:"VR Toggle Move",messageDefaultValue:o}
ee(r,t)}},AutodeskNamespace("Autodesk.Viewing.Extensions.VR"),Autodesk.Viewing.Extensions.VR.VRExtension=function(e,t){Autodesk.Viewing.Extension.call(this,e,t)},Autodesk.Viewing.Extensions.VR.VRExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype),Autodesk.Viewing.Extensions.VR.VRExtension.prototype.constructor=Autodesk.Viewing.Extensions.VR.VRExtension,Autodesk.Viewing.Extensions.VR.VRExtension.prototype.load=function(){var e=this,t=this.viewer,i=t.getToolbar(!0),n=Autodesk.Viewing.UI
return this.tool=new Autodesk.Viewing.Extensions.VR.VRTool(t,this),t.toolController.registerTool(this.tool),this.createUI(i),this.onToolChanged=function(t){if(-1!==t.toolName.indexOf("vr")){var i=t.active?n.Button.State.ACTIVE:n.Button.State.INACTIVE
e.vrToolButton.setState(i)}},t.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged),!0},Autodesk.Viewing.Extensions.VR.VRExtension.prototype.createUI=function(e){var t=this,i=this.viewer,n=Autodesk.Viewing.UI,o=e.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID)
this.vrToolButton=new n.Button("toolbar-vrTool"),this.vrToolButton.setToolTip("Virtual Reality Tool"),this.vrToolButton.setIcon("toolbar-vrToolButton"),this.vrToolButton.onClick=function(e){var o=t.vrToolButton.getState()
o===n.Button.State.INACTIVE?i.setActiveNavigationTool("vr"):o===n.Button.State.ACTIVE&&i.setActiveNavigationTool()}
var r=o.getControl("toolbar-cameraSubmenuTool")
r?o.addControl(this.vrToolButton,{index:o.indexOf(r.getId())}):o.addControl(this.vrToolButton)},Autodesk.Viewing.Extensions.VR.VRExtension.prototype.unload=function(){var e=this.viewer
e.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged),this.onToolChanged=void 0,Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID)
var t=e.getToolbar(!1)
return t&&t.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID).removeControl(this.vrToolButton.getId()),this.vrToolButton=null,e.toolController.deregisterTool(this.tool),this.tool=null,!0},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.VR",Autodesk.Viewing.Extensions.VR.VRExtension),function(){"use strict"
AutodeskNamespace("Autodesk.Viewing.Extensions.FusionOrbit")
var e=Autodesk.Viewing,t=e.UI,i=e.Extensions.FusionOrbit,n=function(t,i){e.Extension.call(this,t,i)}
n.prototype=Object.create(e.Extension.prototype),n.prototype.constructor=n,n.prototype.load=function(){function t(){o.removeEventListener(e.TOOLBAR_CREATED_EVENT,t),n.createUI()}var n=this,o=this.viewer,r=o.getToolbar?o.getToolbar(!0):void 0
if(this.tool=new i.FusionOrbitTool,this.tool.setViewer(o),o.toolController.registerTool(this.tool),r){var a=r.getControl(e.TOOLBAR.MODELTOOLSID)
a&&a.getNumberOfControls()>0?t():o.addEventListener(e.TOOLBAR_CREATED_EVENT,t)}else o.addEventListener(e.TOOLBAR_CREATED_EVENT,t)
return!0},n.prototype.createUI=function(){var i=this.viewer,n=i.getToolbar(!1),o=n.getControl(e.TOOLBAR.NAVTOOLSID)
this.classicBehavior={},this.classicBehavior.orbitOnClick=o.orbitbutton.onClick,this.classicBehavior.freeorbitOnClick=o.freeorbitbutton.onClick,this.classicBehavior.returnToDefault=o.returnToDefault,o.freeorbitbutton.onClick=function(e){var n=o.freeorbitbutton.getState()
n===t.Button.State.INACTIVE?(i.setActiveNavigationTool("fusion orbit"),o.freeorbitbutton.setState(t.Button.State.ACTIVE)):n===t.Button.State.ACTIVE&&(i.setActiveNavigationTool(),o.freeorbitbutton.setState(t.Button.State.INACTIVE))},o.orbitbutton.onClick=function(e){var n=o.orbitbutton.getState()
n===t.Button.State.INACTIVE?(i.setActiveNavigationTool("fusion orbit constrained"),o.orbitbutton.setState(t.Button.State.ACTIVE)):n===t.Button.State.ACTIVE&&(i.setActiveNavigationTool(),o.orbitbutton.setState(t.Button.State.INACTIVE))},o.returnToDefault=function(){o.orbittoolsbutton.setState(t.Button.State.ACTIVE),o.orbittoolsbutton.setState(t.Button.State.INACTIVE)},o.orbittoolsbutton.setState(t.Button.State.INACTIVE),i.prefs.fusionOrbitConstrained?(o.orbittoolsbutton.onClick=o.orbitbutton.onClick,o.orbittoolsbutton.setIcon(o.orbitbutton.iconClass),i.setDefaultNavigationTool("orbit")):(o.orbittoolsbutton.onClick=o.freeorbitbutton.onClick,o.orbittoolsbutton.setIcon(o.freeorbitbutton.iconClass),i.setDefaultNavigationTool("freeorbit")),i.setActiveNavigationTool(),o.returnToDefault()},n.prototype.unload=function(){var i=this.viewer,n=i.getToolbar(!1),o=n.getControl(e.TOOLBAR.NAVTOOLSID)
return o&&(o.orbitbutton&&(o.orbitbutton.onClick=this.classicBehavior.orbitOnClick),o.freeorbitbutton&&(o.freeorbitbutton.onClick=this.classicBehavior.freeorbitOnClick),o.returnToDefault=this.classicBehavior.returnToDefault,o.orbittoolsbutton&&(o.orbittoolsbutton.onClick=o.orbitbutton.onClick,o.orbittoolsbutton.setIcon("adsk-icon-orbit-constrained"),o.orbittoolsbutton.setState(t.Button.State.ACTIVE))),i.setActiveNavigationTool("orbit"),i.setDefaultNavigationTool("orbit"),i.toolController.deregisterTool(this.tool),this.tool.setViewer(null),this.tool=null,!0},i.FusionOrbitExtension=n,e.theExtensionManager.registerExtension("Autodesk.Viewing.FusionOrbit",n)}(),Autodesk.Viewing.Extensions.FusionOrbit.html=['<div class="orbit-gizmo noselect">','<div class="outside"></div>','<div class="ring"></div>','<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="layout-mid">','<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>",'<div class="circle">','<div class="crosshair-area">','<div class="crosshair-v"></div>','<div class="crosshair-h"></div>',"</div>","</div>",'<div class="layout-ver">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>",'<div class="layout-hor">','<div class="edgemark-area"><div class="edgemark"></div></div>',"</div>","</div>"].join("\n"),Autodesk.Viewing.Extensions.FusionOrbit.FusionOrbitTool=function(){var e,t,i,n,o,r,a=["fusion orbit","fusion orbit constrained"],s=.8,l=1.2,c="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto",u={HORIZONTAL:0,VERTICAL:1,ROLL:2},d={HORIZONTAL:.005,VERTICAL:.005,ROLL:1},h=isTouchDevice(),p=!1,f={buttons:[],src:void 0,x:0,y:0,dx:0,dy:0,firstMove:!0,mode:void 0},m=this
this.setViewer=function(e){this.viewer=e,this.navapi=e?e.navigation:null}
var v=function(e){f.buttons[e.touches?0:e.button]=!0,f.src=e.target.className,f.x=0,f.y=0,f.dx=0,f.dy=0,f.firstMove=!0,f.mode=void 0,"ring"===f.src?f.mode=u.ROLL:"edgemark-area"===f.src&&("layout-ver"===e.target.parentNode.className?f.mode=u.HORIZONTAL:"layout-hor"===e.target.parentNode.className&&(f.mode=u.VERTICAL)),w(),e.stopPropagation()},g=function(e){f.buttons[e.touches?0:e.button]=!1,f.src=void 0},E=function(e){f.buttons[0]&&(y(e),A(),f.firstMove=!1)},y=function(e){var t=e.touches?e.touches[0].pageX:e.pageX,i=e.touches?e.touches[0].pageY:e.pageY
f.firstMove||(f.dx=t-f.x,f.dy=i-f.y),f.x=t,f.y=i},A=function(){var e=r.target.clone().sub(r.position).normalize(),i=e.clone().cross(r.up).normalize(),n=i.clone().cross(e).normalize()
if(r.up.copy(n),f.mode===u.ROLL){var a=new THREE.Vector3(f.x-t.center.x,f.y-t.center.y,0),s=new THREE.Vector3(f.dx,f.dy,0).add(a)
a.normalize(),s.normalize()
var l=a.clone().cross(s),c=Math.asin(l.z)
r.up.applyAxisAngle(e,-c*d.ROLL)}else{var h,p
f.mode===u.HORIZONTAL?(p=-f.dx*d.HORIZONTAL,o&&(r.up=Autodesk.Viewing.Navigation.snapToAxis(r.up.clone())),h=r.up):f.mode===u.VERTICAL&&(p=-f.dy*d.VERTICAL,o?(f.firstMove&&(r.up=Autodesk.Viewing.Navigation.snapToAxis(r.up.clone())),h=e.clone().cross(r.up).normalize()):h=i,r.up.applyAxisAngle(h,p))
var v=m.navapi.getPivotPoint(),g=r.position.clone().sub(v)
g.applyAxisAngle(h,p),r.position.addVectors(v,g)
var E=r.target.clone().sub(v)
E.applyAxisAngle(h,p),r.target.addVectors(v,E)}r.dirty=!0},T=function(){var e=r.target.clone().sub(r.position).normalize(),t=m.viewer.impl.rayIntersect(new THREE.Ray(r.position,e))
return t&&t.intersectPoint?t.intersectPoint:r.target},b=function(e,t){var i=t||e.clone().sub(r.position).normalize()
return new THREE.Plane(i,-i.x*e.x-i.y*e.y-i.z*e.z)},w=function(){var e=r.target.clone().sub(r.position).normalize(),t=b(r.position,e),i=t.distanceToPoint(r.pivot)
r.pivot.copy(e).multiplyScalar(i).add(r.position)},_=function(e){e.touches||0!==e.button||w()},x=function(e){p&&m.viewer.setActiveNavigationTool()},C=function(e,t){var i,n=m.viewer.impl.hitTest(e,t)
if(n&&n.intersectPoint)i=n.intersectPoint
else{var o=m.viewer.impl.viewportToRay(m.viewer.impl.clientToViewport(e,t))
i=o.intersectPlane(b(r.target))}var a=r.position.clone().sub(T()).add(i)
m.navapi.setRequestTransition(!0,a,i,r.fov)}
this.register=function(){e=stringToDOM(Autodesk.Viewing.Extensions.FusionOrbit.html),e.style.display="none",this.viewer.canvasWrap.insertBefore(e,this.viewer.canvasWrap.firstChild),i=e.querySelector(".ring"),i.addEventListener("mousedown",v),Array.prototype.forEach.call(e.querySelectorAll(".edgemark-area"),function(e,t){e.addEventListener("mousedown",v),h&&e.addEventListener("touchstart",v)}),window.addEventListener("mouseup",g),window.addEventListener("mousemove",E),n=e.querySelector(".outside"),n.addEventListener("mousedown",x)
var t=e.querySelector(".circle")
t.addEventListener("mousedown",_),h&&(i.addEventListener("touchstart",v),window.addEventListener("touchend",g),window.addEventListener("touchmove",E),n.addEventListener("touchstart",x),t.addEventListener("touchstart",_)),r=this.viewer.impl.camera},this.deregister=function(){window.removeEventListener("mouseup",g),window.removeEventListener("mousemove",E),n.removeEventListener("mousedown",x),h&&(window.removeEventListener("touchend",g),window.removeEventListener("touchmove",E),n.removeEventListener("touchstart",x)),this.viewer.canvasWrap.removeChild(e),e=void 0,i=void 0,n=void 0},this.activate=function(t){e.style.display="",this.handleResize(),o="fusion orbit constrained"===t,o?(this.viewer.setDefaultNavigationTool("orbit"),this.viewer.prefs.set("fusionOrbitConstrained",!0)):(this.viewer.setDefaultNavigationTool("freeorbit"),this.viewer.prefs.set("fusionOrbitConstrained",!1)),this.viewer.navigation.setZoomTowardsPivot(!0)},this.deactivate=function(t){e.style.display="none",this.viewer.navigation.setZoomTowardsPivot(this.viewer.prefs.zoomTowardsPivot)},this.getNames=function(){return a},this.getName=function(){return a[0]},this.update=function(){return!1},this.handleSingleClick=function(e,t){return C(e.canvasX,e.canvasY),!0},this.handleDoubleClick=function(e,t){return!0},this.handleSingleTap=function(e){return C(e.canvasX,e.canvasY),!0},this.handleDoubleTap=function(e){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){var t,i=this.viewer.impl.canvas.getBoundingClientRect()
t=i.width>i.height?new THREE.Vector2(((e.canvasX+.5)/i.width*2-1)*i.width/i.height,2*-((e.canvasY+.5)/i.height)+1):new THREE.Vector2((e.canvasX+.5)/i.width*2-1,(2*-((e.canvasY+.5)/i.height)+1)*i.height/i.width)
var o=t.length(),r=o>l
return p!==r&&(r?n.style.cursor="":n.style.cursor=c,p=r),!1},this.handleGesture=function(e){return w(),!1},this.handleBlur=function(e){return!1},this.handleResize=function(){t=e.getBoundingClientRect(),t.center={},t.center.x=t.left+t.width/2,t.center.y=t.top+t.height/2
var n=(window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth)*s
e.style.width=e.style.height=""+n+"px",e.style.top=e.style.left="calc(50% - "+n/2+"px)",i.style.borderWidth=""+.1*n+"px"}},AutodeskNamespace("Autodesk.Viewing.Private.Collaboration"),function(){function e(e,t,i){function o(t){var i=t.data.msg
if(s.x=i.x1,s.y=i.y1,l.x=i.x2,l.y=i.y2,c=i.explode,i.command)if("gohome"==i.command)s.x=s.y=0,l.x=l.y=0,e.navigation.setRequestHomeView(!0),e.showAll(),e.impl.selector.clearSelection(),e.explode(0),u=null
else if("select"==i.command){var n=e.impl.hitTestViewport(new THREE.Vector3(0,0,0))
n?e.impl.selector.toggleSelection(n.dbId,n.model):e.impl.selector.clearSelection()}else if("hide"==i.command){var n=e.impl.hitTestViewport(new THREE.Vector3(0,0,0))
n&&e.hide(n.dbId)}else if("fly"==i.command)u=u?null:r.target.clone().sub(r.position).normalize()
else if("savepoint"==i.command){var i=a.getState(y)
g.push(i),alertify.success("Savepoint created.")}else"nextsavepoint"==i.command&&g.length&&(E>=g.length&&(E=0),a.restoreState(g[E++]))}var r,a,s=new THREE.Vector2,l=new THREE.Vector2,c=0,u=null,d=e,h=.02,p=.002,f=.05,m=.01,v=1,g=[],E=0,y={seedURN:!1,objectSet:!0,viewport:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}},A=function(){if(!e.impl.model.is2d()){var t=e.impl.model.getData().bbox.size(),i=t.length()
h*=i,p*=i,e.removeEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,A)}}
e.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,A),this.getNames=function(){return["joystick"]},this.getName=function(){return"joystick"},this.activate=function(e){if(t.addEventListener("joystick",o),i.addEventListener("joystick",o),r=d.navigation.getCamera(),d.model){var s=d.model.getBoundingBox()
v=.001*s.size().length(),a=new n.ViewerState(d)}},this.deactivate=function(e){t.removeEventListener("joystick",o),i.removeEventListener("joystick",o),r=null,a=null,g.length=0},this.update=function(t){if(r.isPerspective||e.navigation.toPerspective(),u){var i=u.clone().multiplyScalar(p)
r.position.add(i),r.target.add(i)}if(0!=c){var n=e.getExplodeScale()+c*m
n>1&&(n=1),0>n&&(n=0),e.explode(n)}if(0==s.x&&0==s.y&&0==l.x&&0==l.y)return!(!u&&!c)
var o=r.target.clone().sub(r.position),a=o.length()
o.multiplyScalar(1/a)
var d=o.clone().cross(r.up).normalize(),v=o.clone().multiplyScalar(s.y*h)
r.position.add(v),r.target.add(v)
var g=d.clone().multiplyScalar(s.x*h)
r.position.add(g),r.target.add(g)
var E=new THREE.Quaternion
E.setFromAxisAngle(d,l.y*f)
var y=o.clone().applyQuaternion(E)
r.up.applyQuaternion(E)
var A=new THREE.Quaternion
return A.setFromAxisAngle(r.worldup,-l.x*f),y.applyQuaternion(A),r.up.applyQuaternion(A),y.multiplyScalar(a),r.target.copy(r.position).add(y),u&&u.copy(r.target).sub(r.position).normalize(),!0},this.handleSingleClick=function(e,t){return!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return!1},this.handleDoubleTap=function(e,t){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return!1},this.handleButtonUp=function(e,t){return!1},this.handleMouseMove=function(e){return!1},this.handleGesture=function(e,t){return!1},this.handleTouchChange=function(e,t){return!1},this.handleBlur=function(e){return!1},this.handleResize=function(){}}var t=Autodesk.Viewing,i=t.Extensions,n=t.Private,o=t.UI
n.Collaboration
i.RemoteControl=function(i,o){t.Extension.call(this,i,o),this.viewer=i,this.client=n.MessageClient.GetInstance(),this.p2p=new n.P2PClient(this.client),this.controllerTool=new e(i,this.client,this.p2p),i.toolController.registerTool(this.controllerTool)},i.RemoteControl.prototype=Object.create(t.Extension.prototype),i.RemoteControl.prototype.constructor=i.RemoteControl,i.RemoteControl.prototype.createUI=function(){var e=this,t=this.viewer
this.controlButton=new o.Button("toolbar-remoteControlTool"),this.controlButton.setToolTip("Pair with controller device"),this.controlButton.onClick=function(){this.getState()===o.Button.State.INACTIVE?(e.connect(),this.setState(o.Button.State.ACTIVE)):(e.disconnect(),this.setState(o.Button.State.INACTIVE))},this.controlButton.setIcon("adsk-icon-game-controller"),t.modelTools.addControl(this.controlButton),this.panel=new Autodesk.Viewing.UI.DockingPanel(t.container,"remote-panel","Remote Control"),this.panel.width=300,this.panel.height=375,this.panel.container.style.width=this.panel.width+"px",this.panel.container.style.height=this.panel.height+"px",this.panel.container.style.top=(window.innerHeight-this.panel.height)/2+"px",this.panel.container.style.left=(window.innerWidth-this.panel.width)/2+"px",this.panel.body=document.createElement("div"),this.panel.body.classList.add("body"),this.panel.container.appendChild(this.panel.body)
var i=Autodesk.Viewing.i18n.translate("Go to this link"),n=Autodesk.Viewing.i18n.translate("Scan the QR code with your device")
this.panel.body.innerHTML=["<p>"+i+"</p>",'<p><a class="url" target="_blank" href="#">Link</a></p>',"<p>or</p>","<p>"+n+"</p>",'<img class="qr-img" src="">'].join("\n"),this.panel.link=this.panel.container.querySelector(".url"),this.panel.code=this.panel.container.querySelector(".code"),this.panel.qrImg=this.panel.container.querySelector(".qr-img")},i.RemoteControl.prototype.load=function(){function e(n){t.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e),i.createUI()}var t=this.viewer,i=this
return t.modelTools&&t.modelTools.getNumberOfControls()>0?i.createUI():t.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e),!0},i.RemoteControl.prototype.unload=function(){var e=this.viewer
if(this.p2p.hangup(),this.client.disconnect(),e.toolController.deactivateTool(this.controllerTool.getName()),this.panel&&(this.panel.setVisible(!1),this.panel=null),this.controlButton)try{e.modelTools.removeControl(this.controlButton),this.controlButton=null}catch(t){stderr("RemoteControlReceiver - Failed to remove controlButton"),this.controlButton=null}return!0},i.RemoteControl.prototype.addCrosshair=function(){this.crosshair=stringToDOM('<div id="remote-crosshair"><div class="crosshair-v"></div><div class="crosshair-h"></div></div>'),this.viewer.canvasWrap.appendChild(this.crosshair)},i.RemoteControl.prototype.removeCrosshair=function(){this.crosshair&&this.crosshair.remove()},i.RemoteControl.prototype.connect=function(e){if(this.client.isConnected())return void console.log("RemoteControl already connected")
var t=this,i=this.viewer
t.client.addEventListener("connectSucceeded",function(i){function o(){l&&l.setVisible(!1),t.p2p.removeEventListener(o),t.addCrosshair()}stderr("connect succeeded")
var r=i.data.id+"rc"
t.client.join(r)
var a=(LMV_RESOURCE_ROOT.length?LMV_RESOURCE_ROOT:window.location.origin+"/")+"rc.html?sessionId="+r+"&env="+n.env,s="http://chart.googleapis.com/chart?cht=qr&chs=200x200&choe=UTF-8&chld=H|0&chl="+escape(a),l=t.panel
l&&(l.link.href=a,l.link.innerHTML=(LMV_RESOURCE_ROOT.length?LMV_RESOURCE_ROOT:window.location.origin+"/")+"rc.html",l.qrImg.src=s,l.setVisible(!0)),t.p2p.addEventListener("dataChannelAdded",o),e&&e instanceof Function&&e(a)}),i.navigation.toPerspective(),t.client.connect(),i.toolController.activateTool(t.controllerTool.getName())},i.RemoteControl.prototype.disconnect=function(){this.p2p.hangup(),this.client.disconnect(),this.viewer.toolController.deactivateTool(this.controllerTool.getName()),this.removeCrosshair()},t.theExtensionManager.registerExtension("Autodesk.Viewing.RemoteControl",i.RemoteControl)}(),function(){AutodeskNamespace("Autodesk.Viewing.Extensions.GamepadModule"),Autodesk.Viewing.Extensions.GamepadModule=function(e){function t(){for(var e in I)if(I.hasOwnProperty(e)&&o.buttons[e].pressed&&.5!=o.buttons[e].value)return w[e]=!0,!0
for(var e in w)if(w.hasOwnProperty(e)&&w[e])return!0
return!(Math.abs(o.axes[P.LEFT_STICK_X])<y&&Math.abs(o.axes[P.LEFT_STICK_Y])<y&&Math.abs(o.axes[P.RIGHT_STICK_X])<y&&Math.abs(o.axes[P.RIGHT_STICK_Y])<y)}function i(){for(var e in M)M.hasOwnProperty(e)&&n(M[e])}function n(e){if(o.buttons[e].value>y)switch(w[e]=!0,e){case M.LEFT_SHOULDER:I[e]()
break
case M.RIGHT_SHOULDER:I[e]()
break
case M.LEFT_TRIGGER:I[e](o.buttons[M.LEFT_TRIGGER].value)
break
case M.RIGHT_TRIGGER:I[e](o.buttons[M.RIGHT_TRIGGER].value)}else if(w[e])switch(w[e]=!1,e){case M.SOUTH_BTN:I[e]()
break
case M.EAST_BTN:I[e]()
break
case M.WEST_BTN:I[e]()
break
case M.NORTH_BTN:I[e]()
break
case M.NORTH_DPAD:I[e]()
break
case M.SOUTH_DPAD:I[e]()
break
case M.WEST_DPAD:I[e]()
break
case M.EAST_DPAD:I[e]()
break
case M.RIGHT_STICK_BUTTON:I[e]()
break
case M.LEFT_STICK_BUTTON:I[e]()
break
case M.LEFT_TRIGGER:I[e](o.buttons[M.LEFT_TRIGGER].value)
break
case M.RIGHT_TRIGGER:I[e](o.buttons[M.RIGHT_TRIGGER].value)}}var o,r,a,s,l,c,u,d,h,p,f=e.navigation,m=e.container,v=f.getCamera(),g=1,E=0,y=.1,A=5.5,T=6,b=T,w={},_=new THREE.Clock(!0),x={seedURN:!1,objectSet:!0,viewport:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}},C=2,S=75,R=-45,M={SOUTH_BTN:0,EAST_BTN:1,WEST_BTN:2,NORTH_BTN:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5,LEFT_TRIGGER:6,RIGHT_TRIGGER:7,SOUTH_DPAD:13,EAST_DPAD:15,WEST_DPAD:14,NORTH_DPAD:12,LEFT_STICK_BUTTON:10,RIGHT_STICK_BUTTON:11},P={LEFT_STICK_X:0,LEFT_STICK_Y:1,RIGHT_STICK_X:2,RIGHT_STICK_Y:3},L=function(){},I={}
for(var k in M)M.hasOwnProperty(k)&&(I[M[k]]=L)
var V=function(){}
this.activate=function(t){var i=e.model.getBoundingBox().size()
g=Math.max(Math.min(Math.min(i.x,i.y),i.z)/10,1e-4),o=navigator.getGamepads()[0],s=new Autodesk.Viewing.Private.ViewerState(e),l=[],c=0,p=t,O(t)},this.deactivate=function(){p=null,s=null},this.update=function(e,n){if(n&&(v=n),e=_.getDelta(),o=navigator.getGamepads()[0],r>-1){var s=(new Date).getTime()
s-r>a&&D()}if(o&&(d=e*C*g*b,v.isPerspective||f.toPerspective(),o&&t())){v.dirty=!0,u&&(h=v.position.z)
var l=v.target.clone().sub(v.position),c=l.length()
l.multiplyScalar(1/c)
var p=l.clone().cross(v.up).normalize()
if(Math.abs(o.axes[P.LEFT_STICK_Y])>y){var m=l.clone().multiplyScalar(-o.axes[P.LEFT_STICK_Y]*d)
v.position.add(m),v.target.add(m)}if(Math.abs(o.axes[P.LEFT_STICK_X])>y){var E=p.clone().multiplyScalar(o.axes[P.LEFT_STICK_X]*d)
v.position.add(E),v.target.add(E)}var A=new THREE.Quaternion,T=l
if(Math.abs(o.axes[P.RIGHT_STICK_Y])>y){var w=v.clone(),x=l.clone()
A.setFromAxisAngle(p,-o.axes[P.RIGHT_STICK_Y]*d/2),x.applyQuaternion(A),w.up.applyQuaternion(A)
var S=w.worldup.clone(),R=x.angleTo(S),M=THREE.Math.degToRad(5)
R>=M&&R<=Math.PI-M&&(T=l.clone().applyQuaternion(A),v.up.applyQuaternion(A))}var L=new THREE.Quaternion
Math.abs(o.axes[P.RIGHT_STICK_X])>y&&(L.setFromAxisAngle(v.worldup,-o.axes[P.RIGHT_STICK_X]*d/2),T.applyQuaternion(L),v.up.applyQuaternion(L)),i(),u&&(v.position.z=h),T.multiplyScalar(c),v.target.copy(v.position).add(T)}return v}
var N=function(e,t,i,n,o){Autodesk.Viewing.Private.HudMessage.displayMessage(m,e,i,n,o),t>0?(r=(new Date).getTime(),a=t):(r=-1,a=0)},D=function(){Autodesk.Viewing.Private.HudMessage.dismiss(),r=-1},H=function(e){D()
var t
switch(e){case"up":t=u?"Vertical Lock Mode":"Fly mode"
break
case"left":break
case"right":break
case"down":}var i={msgTitleKey:"View Orientation Drag Mode Toggled",messageKey:"View Orientation Drag Mode Toggled",messageDefaultValue:t}
N(i,2e3)},O=function(e){switch(e){case"headtracker":I[M.SOUTH_BTN]=q,I[M.SOUTH_DPAD]=B,I[M.NORTH_DPAD]=$,I[M.WEST_BTN]=Q,I[M.LEFT_SHOULDER]=F,I[M.RIGHT_SHOULDER]=U,I[M.LEFT_TRIGGER]=z,I[M.RIGHT_TRIGGER]=W,I[M.RIGHT_STICK_BUTTON]=K,I[M.LEFT_STICK_BUTTON]=Z
break
default:I[M.SOUTH_BTN]=q,I[M.EAST_BTN]=j,I[M.WEST_BTN]=Q,I[M.NORTH_BTN]=J,I[M.SOUTH_DPAD]=B,I[M.WEST_DPAD]=X,I[M.EAST_DPAD]=Y,I[M.NORTH_DPAD]=$,I[M.LEFT_SHOULDER]=F,I[M.RIGHT_SHOULDER]=U,I[M.LEFT_TRIGGER]=G,I[M.RIGHT_TRIGGER]=W,I[M.RIGHT_STICK_BUTTON]=K,I[M.LEFT_STICK_BUTTON]=Z}},B=function(){e.navigation.setRequestHomeView(!0),e.showAll(),e.impl.selector.clearSelection(),e.explode(0)},F=function(){u?h+=-o.buttons[M.LEFT_SHOULDER].pressed*d:v.translateY(-o.buttons[M.LEFT_SHOULDER].pressed*d)},U=function(){u?h+=o.buttons[M.RIGHT_SHOULDER].pressed*d:v.translateY(o.buttons[M.RIGHT_SHOULDER].pressed*d)},z=function(t){if(t>y){if(.5==t)return void e.explode(0)
E=t
var i=E
i>1&&(i=1),0>i&&(i=0),e.explode(i)}else e.explode(0)},G=function(e){if(e>y){if(.5==e)return v.fov=S,void(w[M.LEFT_TRIGGER]=!1)
v.fov=R*e+S}else v.fov=S},W=function(e){if(e>y){if(.5==e)return void(w[M.RIGHT_TRIGGER]=!1)
b=-(A*e)+T}else b=T},j=function(){var e=s.getState(x)
l.push(e),stderr("Savepoint created.")},X=function(){l.length&&(c--,0>c&&(c=l.length-1),s.restoreState(l[c]))},Y=function(){l.length&&(c++,c>=l.length&&(c=0),s.restoreState(l[c]))},q=function(){var t=e.impl.hitTestViewport(new THREE.Vector3(0,0,0))
"headtracker"==p&&v.updateMatrixWorld(),t?e.impl.selector.toggleSelection(t.dbId,t.model):e.impl.selector.clearSelection()},K=function(){e.impl.selector.clearSelection()},Z=function(){e.showAll(),e.impl.selector.clearSelection(),e.explode(0)},Q=function(){var t=e.impl.hitTestViewport(new THREE.Vector3(0,0,0),!1)
t&&(t.dbId in e.getHiddenNodes()?e.show(t.dbId):e.hide(t.dbId))},J=function(){e.getPropertyPanel(!0).setVisible(!e.getPropertyPanel(!0).isVisible())},$=function(){u=!u,u&&(h=v.position.z),H("up")}
V()}}(),AutodeskNamespace("Autodesk.Viewing.Extensions.Section"),Autodesk.Viewing.Extensions.Section.SectionExtension=function(e,t){Autodesk.Viewing.Extension.call(this,e,t),this.viewer=e},Autodesk.Viewing.Extensions.Section.SectionExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype),Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.constructor=Autodesk.Viewing.Extensions.Section.SectionExtension,Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.load=function(){function e(){i.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e),t.createUI()}var t=this,i=this.viewer
this.tool=new Autodesk.Viewing.Extensions.Section.SectionTool(i),i.toolController.registerTool(this.tool)
var n=i.getToolbar?i.getToolbar(!0):void 0
if(n){var o=n.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID)
o&&o.getNumberOfControls()>0?e():i.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e)}else i.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,e)
i.addEventListener(Autodesk.Viewing.RESET_EVENT,function(){t.tool&&t.tool.resetSection()}),this.HOTKEYS_ID="Autodesk.Section.Hotkeys"
var r=[{keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE],onRelease:function(){return t.enableSectionTool(!1)}}]
return Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.HOTKEYS_ID,r),!0},Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.enableSectionTool=function(e){if(this.tool){var t=this.viewer.toolController,i=this.tool.isActive()
if(e&&!i)return t.activateTool("section"),this.sectionToolButton.setState(Autodesk.Viewing.UI.Button.State.ACTIVE),!0
if(!e&&i)return t.deactivateTool("section"),this.sectionToolButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),!0}return!1},Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.createUI=function(){var e=this.viewer,t=Autodesk.Viewing.UI
this.sectionToolButton=new t.ComboButton("toolbar-sectionTool"),this.sectionToolButton.setToolTip("Section analysis"),this.sectionToolButton.setIcon("adsk-icon-section-analysis"),this.createSubmenu(this.sectionToolButton)
var i=e.getToolbar(!1),n=i.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID),o=n.getControl("toolbar-resetTool")
o?n.addControl(this.sectionToolButton,{index:n.indexOf(o.getId())}):n.addControl(this.sectionToolButton,{index:0})},Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.createSubmenu=function(e){function t(e,t){return function(){var i=e.getState()
i===r.Button.State.INACTIVE?(e.setState(r.Button.State.ACTIVE),n.enableSectionTool(!0),this instanceof r.ComboButton==!1?n.tool.setSection(t):n.tool.attachControl(!0)):i===r.Button.State.ACTIVE&&(e.setState(r.Button.State.INACTIVE),n.enableSectionTool(!1))}}function i(){var e=function(){var e=new THREE.Vector3
return function(t,i,n){return e.subVectors(t,i),e.lengthSq()<n}}(),t=new THREE.Vector3(1,0,0),r=new THREE.Vector3(0,1,0),a=new THREE.Vector3(0,0,1),s=o.autocam.getWorldRightVector(),l=o.autocam.getWorldUpVector(),c=o.autocam.getWorldFrontVector(),u=1e-4
e(l,t,u)?n.sectionYButton.setIcon("adsk-icon-plane-x"):e(l,a,u)?n.sectionYButton.setIcon("adsk-icon-plane-z"):n.sectionYButton.setIcon("adsk-icon-plane-y"),e(s,r,u)?n.sectionXButton.setIcon("adsk-icon-plane-y"):e(s,a,u)?n.sectionXButton.setIcon("adsk-icon-plane-z"):n.sectionXButton.setIcon("adsk-icon-plane-x"),e(c,t,u)?n.sectionZButton.setIcon("adsk-icon-plane-x"):e(c,r,u)?n.sectionZButton.setIcon("adsk-icon-plane-y"):n.sectionZButton.setIcon("adsk-icon-plane-z"),o.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i)}var n=this,o=this.viewer,r=Autodesk.Viewing.UI,a=this.sectionXButton=new r.Button("toolbar-sectionTool-x")
a.setToolTip("Add X plane"),a.setIcon("adsk-icon-plane-x"),a.onClick=t(a,"X"),e.addControl(a)
var s=this.sectionYButton=new r.Button("toolbar-sectionTool-y")
s.setToolTip("Add Y plane"),s.setIcon("adsk-icon-plane-y"),s.onClick=t(s,"Y"),e.addControl(s)
var l=this.sectionZButton=new r.Button("toolbar-sectionTool-z")
l.setToolTip("Add Z plane"),l.setIcon("adsk-icon-plane-z"),l.onClick=t(l,"Z"),e.addControl(l)
var c=this.sectionBoxButton=new r.Button("toolbar-sectionTool-box")
c.setToolTip("Add box"),c.setIcon("adsk-icon-box"),c.onClick=t(c,"BOX"),e.addControl(c),o.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i)},Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.destroyUI=function(){var e=this.viewer,t=e.getToolbar(!1)
if(t){var i=t.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID)
if(i&&this.sectionToolButton){var n=i.getControl("toolbar-inspectSubMenu")
n?n.removeControl(this.sectionToolButton.getId()):i.removeControl(this.sectionToolButton.getId()),this.sectionToolButton=null}}},Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.unload=function(){var e=this.viewer
return Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID),this.destroyUI(),e.toolController.deregisterTool(this.tool),this.tool=null,!0},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Section",Autodesk.Viewing.Extensions.Section.SectionExtension),AutodeskNamespace("Autodesk.Viewing.Extensions.Section"),Autodesk.Viewing.Extensions.Section.tintColor={r:1,g:1,b:0},Autodesk.Viewing.Extensions.Section.tintIntensity=.2,Autodesk.Viewing.Extensions.Section.SectionTool=function(e,t){function i(){L||(E=new THREE.TransformControls(A.camera,A.canvas,"transrotate"),E.addEventListener("change",o),E.setSnap(Math.PI/2,Math.PI/36),y=new THREE.TransformControls(A.camera,A.canvas,"translate"),y.addEventListener("change",o),void 0===A.overlayScenes[M]&&A.createOverlayScene(M),A.addOverlay(M,E),A.addOverlay(M,y),e.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,r),e.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,a),e.addEventListener(Autodesk.Viewing.HIDE_EVENT,a),e.addEventListener(Autodesk.Viewing.SHOW_EVENT,a),L=!0)}function n(){L&&(A.removeOverlay(M,E),E.removeEventListener("change",o),E=null,A.removeOverlay(M,y),y.removeEventListener("change",o),y=null,A.removeOverlayScene(M),e.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,r),e.removeEventListener(Autodesk.Viewing.ISOLATE_EVENT,a),e.removeEventListener(Autodesk.Viewing.HIDE_EVENT,a),e.removeEventListener(Autodesk.Viewing.SHOW_EVENT,a),L=!1)}function o(){A.invalidate(!1,!1,!0)}function r(){E&&E.update(),y&&y.update()}function a(){1===C.length&&l((new THREE.Plane).setComponents(C[0].x,C[0].y,C[0].z,C[0].w))}function s(e){return e.color||new THREE.Color(16777215)}function l(e){init_three_triangulator(),init_three_intersector()
var t=A.model.getData().instanceTree
if(t){var i=A.model.getFragmentList(),n=A.sceneAfter.getObjectByName("section")
n&&A.sceneAfter.remove(n)
var o=new THREE.Object3D
o.name="section",A.sceneAfter.add(o)
var r=new THREE.Object3D
o.add(r)
var a=new THREE.Object3D
o.add(a)
var l=Autodesk.Viewing.Private,c=l.Intersector.makePlaneBasis(e),u=(new THREE.Matrix4).getInverse(c),d=A.matman().create2DMaterial(null,{skipCircles:!0,skipEllipticals:!0},!1,!1),h=A.matman().findMaterial(null,d)
h.transparent=!0,h.depthTest=!0,h.polygonOffset=!0,h.polygonOffsetFactor=-1,h.polygonOffsetUnits=1
var p=new THREE.Box3,f=A.getVisibleBounds(!0)
25e-6*f.size().length()
t.enumNodeChildren(A.model.getRootId(),function(n){if(!t.isNodeHidden(n)&&!t.isNodeOff(n)){var o,d=[]
if(t.enumNodeFragments(n,function(t){i.getWorldBounds(t,p),l.Intersector.intersectBoxPlane(e,p)&&(o=i.getVizmesh(t),o.geometry&&(o.geometry.is2d||o.geometry.isLines||l.Intersector.intersectMeshPlane(e,o,d)))},!1),d.length){var f=new THREE.Box3
l.Intersector.convertToPlaneCoords(c,d,f)
var m=new l.VertexBufferBuilder(!1,8*d.length),v=s(o.material),g=0|.25*v.r*255.5,E=0|.25*v.g*255.5,y=0|.25*v.b*255.5,T=4278190080|y<<16|E<<8|g,b=new l.Triangulator.ContourSet(d,f)
b.snapEdges(),b.sanitizeEdges(),b.stitchContours()
for(var w=0;w<b.contours.length;w++)for(var _=b.contours[w],g=0|255.5*Math.random(),E=0|255.5*Math.random(),y=0|255.5*Math.random(),x=(_[0]===_[_.length-1],1);x<_.length;x++){var C=b.pts[_[x-1]],S=b.pts[_[x]]
m.addSegment(C.x,C.y,S.x,S.y,0,.01,T,n,0)}var R={mesh:m.toMesh()}
BufferGeometryUtils.meshToGeometry(R)
var M=R.geometry
M.streamingDraw=!0,M.streamingIndex=!0
var P=new THREE.Mesh(M,h)
P.matrix.copy(u),P.matrixAutoUpdate=!1,P.frustumCulled=!1,a.add(P)
var L=new l.Triangulator.TriangulatedSurface(b)
if(L.indices.length){for(var I=new THREE.BufferGeometry,k=new Float32Array(3*L.pts.length),w=0;w<L.pts.length;w++)k[3*w]=L.pts[w].x,k[3*w+1]=L.pts[w].y,k[3*w+2]=0
I.addAttribute("position",new THREE.BufferAttribute(k,3))
for(var V=o.material.packedNormals,N=V?new Uint16Array(2*L.pts.length):new Float32Array(3*L.pts.length),w=0;w<L.pts.length;w++)if(V){var D=.5*(0/Math.PI+1),H=1
N[2*w]=65535*D|0,N[2*w+1]=65535*H|0}else N[3*w]=0,N[3*w+1]=0,N[3*w+2]=1
I.addAttribute("normal",new THREE.BufferAttribute(N,V?2:3)),V&&(I.attributes.normal.bytesPerItem=2,I.attributes.normal.normalize=!0)
var O=new Uint16Array(L.indices.length)
O.set(L.indices),I.addAttribute("index",new THREE.BufferAttribute(O,1)),I.streamingDraw=!0,I.streamingIndex=!0
var B=A.matman().cloneMaterial(o.material)
B.packedNormals=V,B.cutplanes=null,B.side=THREE.FrontSide,B.depthTest=!0,B.map=null,B.bumpMap=null,B.normalMap=null,B.alphaMap=null,B.specularMap=null,B.transparent=!1,B.depthWrite=!0,B.hatchPattern=!0,B.needsUpdate=!0
var F=(o.material.id+2)*Math.PI*.125,U=Math.tan(F)
B.hatchParams=new THREE.Vector2(U,10),B.hatchTintColor=Autodesk.Viewing.Extensions.Section.tintColor,B.hatchTintIntensity=Autodesk.Viewing.Extensions.Section.tintIntensity,null!=B.prismType&&(B.defines={},B.defines[B.prismType.toUpperCase()]="")
var z=new THREE.Mesh(I,B)
z.matrix.copy(u),z.matrixAutoUpdate=!1,z.dbId=n,z.fragId=d.fragId,r.add(z)}}}},!0)}}function c(e,t,i){var t=t||A.getVisibleBounds(),i=i||0,n=new THREE.Vector3(0,0,1),o=(new THREE.Quaternion).setFromUnitVectors(n,e.normal),r=e.projectPoint(t.max),a=e.projectPoint(t.min),s=o.clone().inverse()
r.applyQuaternion(s),a.applyQuaternion(s)
var l=(new THREE.Vector3).subVectors(r,a),c=l.x*(1+i),u=l.y*(1+i),d=new THREE.PlaneBufferGeometry(c,u),h=new THREE.MeshBasicMaterial({opacity:0,color:16777215,side:THREE.DoubleSide,depthTest:!1,depthWrite:!1,transparent:!0}),p=new V.SectionMesh(d,h,e),f=e.projectPoint(t.center())
p.position.copy(f),p.quaternion.multiply(o)
for(var m=Autodesk.Viewing.Private.LightPresets[A.currentLightPreset()].bgColorGradient,v="rgb("+(255-m[0])+","+(255-m[1])+","+(255-m[2])+")",g=new THREE.LineBasicMaterial({color:v,linewidth:1,depthTest:!1}),E=p.geometry.getAttribute("position"),y=0;y<k.length;y++){var d=new THREE.Geometry
d.vertices.push((new THREE.Vector3).fromArray(E.array,k[y][0]*E.itemSize),(new THREE.Vector3).fromArray(E.array,k[y][1]*E.itemSize))
var T=new THREE.Line(d,g)
p.add(T),p.outlines.push(T)}return p}function u(){d(function(e){if(e instanceof V.SectionMesh&&e.connectivity.length>0){for(var t=(new THREE.Matrix4).getInverse(e.matrixWorld),i=new THREE.Vector3,n=e.geometry.getAttribute("position"),o=0;o<n.length/n.itemSize;o++){var r=e.connectivity[o]
null!==N(e.plane,r[0],r[1],i)&&(i.applyMatrix4(t),n.setXYZ(o,i.x,i.y,i.z))}n.needsUpdate=!0,e.geometry.computeBoundingBox(),e.geometry.computeBoundingSphere()
for(var o=0;o<e.outlines.length;o++){var a=e.outlines[o]
a.geometry.vertices[0].fromArray(n.array,k[o][0]*n.itemSize),a.geometry.vertices[1].fromArray(n.array,k[o][1]*n.itemSize),a.geometry.verticesNeedUpdate=!0}}})}function d(e){for(var t=0;t<x.length;t++)x[t].traverse(e)}function h(){d(function(e){e instanceof V.SectionMesh&&e.update()}),1===C.length&&l((new THREE.Plane).setComponents(C[0].x,C[0].y,C[0].z,C[0].w)),A.setCutPlanes(C)}function p(e){for(var t=0;t<x.length;t++)x[t].visible=e
_!==e&&o(),_=e}function f(t){t&&C.length>0&&(1===C.length&&l((new THREE.Plane).setComponents(C[0].x,C[0].y,C[0].z,C[0].w)),e.setCutPlanes(C)),p(t)}function m(e,t){e.attach(t),e.setPosition(t.position),e.visible=!0}function v(e){var t=A.api.navigation.getEyeVector()
t.dot(e)>0&&e.negate()
var i=new THREE.Group,n=new THREE.Plane(e,0),o=c(n,null,.05)
i.add(o),C.push(o.planeVec),x.push(i),A.addOverlay(M,i),m(E,o),E.showRotationGizmos(!0),S=E.getPicker(),h()}function g(){for(var e=[new THREE.Vector3(1,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(-1,0,0),new THREE.Vector3(0,-1,0),new THREE.Vector3(0,0,-1)],t=[[[1,2],[1,5],[2,4],[4,5]],[[3,5],[0,5],[2,3],[0,2]],[[1,3],[0,1],[3,4],[0,4]],[[1,5],[1,2],[4,5],[2,4]],[[2,3],[0,2],[3,5],[0,5]],[[0,1],[3,1],[0,4],[3,4]]],i=new THREE.Group,n=A.getVisibleBounds(),o=n.center(),r=new THREE.Box3(n.min,o),a=[],s=[],l=0;l<e.length;l++){var u=new THREE.Plane(e[l],-1*o.dot(e[l]))
if(a.push(u),l>2){var d=u.orthoPoint(r.max),p=u.orthoPoint(r.min),f=(new THREE.Vector3).subVectors(d,p)
u.constant-=f.length()}var v=c(u,r)
i.add(v),s.push(v),C.push(v.planeVec)}for(var l=0;l<s.length;l++)for(var v=s[l],g=t[l],T=0;T<g.length;T++){for(var b=[],w=g[T],_=0;_<w.length;_++)b.push(a[w[_]])
v.connectivity.push(b)}x.push(i),A.addOverlay(M,i),m(E,x[0].children[0]),m(y,x[0]),E.showRotationGizmos(!1),S=E.getPicker().concat(y.getPicker()),h()}var E,y,A=e.impl,T=["section"],b=!1,w=!1,_=!0,x=[],C=[],S=[],R="",M="gizmo",P=null,L=!1,I=!0,k=[[0,1],[1,3],[3,2],[2,0]],V=Autodesk.Viewing.Extensions.Section
init_TransformGizmos(),init_SectionMesh()
var N=function(){var e=new THREE.Matrix3,t=new THREE.Vector3,i=new THREE.Vector3,n=new THREE.Vector3
return function(o,r,a,s){e.set(o.normal.x,o.normal.y,o.normal.z,r.normal.x,r.normal.y,r.normal.z,a.normal.x,a.normal.y,a.normal.z)
var l=e.determinant()
if(0===l)return null
t.crossVectors(r.normal,a.normal).multiplyScalar(-o.constant),i.crossVectors(a.normal,o.normal).multiplyScalar(-r.constant),n.crossVectors(o.normal,r.normal).multiplyScalar(-a.constant)
var c=s||new THREE.Vector3
return c.copy(t).add(i).add(n).divideScalar(l)}}(),D=function(){var e=new THREE.Vector3,t=new THREE.Vector3,i=new THREE.Raycaster,n=A.camera
return function(o,r,a){var s=A.canvas.getBoundingClientRect(),l=(o.clientX-s.left)/s.width*2-1,c=2*-((o.clientY-s.top)/s.height)+1
n.isPerspective?(e.set(l,c,.5),e.unproject(n),i.set(n.position,e.sub(n.position).normalize())):(e.set(l,c,-1),e.unproject(n),t.set(0,0,-1),i.set(e,t.transformDirection(n.matrixWorld)))
var u=i.intersectObjects(r,a)
return u[0]?u[0]:null}}()
this.isActive=function(){return b},this.setSection=function(e){switch(this.clearSection(),e){case"X":var t=new THREE.Vector3(1,0,0)
v(t)
break
case"Y":var t=new THREE.Vector3(0,1,0)
v(t)
break
case"Z":var t=new THREE.Vector3(0,0,1)
v(t)
break
case"BOX":g()}R=e},this.clearSection=function(){for(E&&E.detach(),y&&y.detach();C.length>0;)C.pop()
for(;x.length>0;){var e=x.pop()
A.removeOverlay(M,e)}var t=A.sceneAfter.getObjectByName("section")
t&&A.sceneAfter.remove(t),A.setCutPlanes()},this.isPlaneOn=function(){return _},this.showPlane=function(e){p(e)},this.attachControl=function(e){e?(m(E,x[0].children[0]),E.highlight(),"BOX"===R&&m(y,x[0])):(E.detach(),y.detach())},this.setOutlineColor=function(e){A.setCutPlanesOutlineColor(e)},this.resetSection=function(){this.setSection(R)},this.getNames=function(){return T},this.getName=function(){return T[0]},this.register=function(){},this.deregister=function(){this.clearSection(),n()},this.activate=function(e){i(),b=!0,w=!1,I=!0,C=C||[],f(!0)},this.deactivate=function(e){b=!1,w=!1
var t=A.sceneAfter.getObjectByName("section")
t&&A.sceneAfter.remove(t),f(!1),A.setCutPlanes(),E.detach(),y.detach()},this.update=function(e){return!1},this.handleSingleClick=function(e,t){var i=e.pointers?e.pointers[0]:e,n=D(i,x[0].children)
return n&&(m(E,n.object),E.highlight(),o()),!1},this.handleDoubleClick=function(e,t){return!1},this.handleSingleTap=function(e){return this.handleSingleClick(e,0)},this.handleDoubleTap=function(e){return!1},this.handleKeyDown=function(e,t){return!1},this.handleKeyUp=function(e,t){return!1},this.handleWheelInput=function(e){return!1},this.handleButtonDown=function(e,t){return w=!0,y.onPointerDown(e)?!0:E.onPointerDown(e)},this.handleButtonUp=function(e,t){return w=!1,y.onPointerUp(e)?!0:E.onPointerUp(e)},this.handleMouseMove=function(e){if(w){if(y.onPointerMove(e))return h(),E.update(),!0
if(E.onPointerMove(e))return h(),u(),!0}if("touch"!==e.pointerType){var t=e.pointers?e.pointers[0]:e,i=D(t,x[0].children)
i&&(I=!1)
var n=I||i||D(t,S,!0)?!0:!1
E.visible=n,y.visible=void 0!==y.object&&n,p(n)}return y.onPointerHover(e)?!0:E.onPointerHover(e)},this.handleGesture=function(e){switch(e.type){case"dragstart":return P="drag",this.handleButtonDown(e,0)
case"dragmove":return"drag"===P?this.handleMouseMove(e):!1
case"dragend":return"drag"===P?(P=null,this.handleButtonUp(e,0)):!1}return!1},this.handleBlur=function(e){return!1},this.handleResize=function(){},this.handlePressHold=function(e){return!0}},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim"),Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef=function(){this.studyNode,this.constraintsNode=-1,this.constraintNodes=[],this.loadsNode=-1,this.loadNodes=[],this.resultsNode=-1,this.bodyNode=-1,this.resultTypes={},this.resultGroups={},this.simNodes=[],this.modelNodes=[],this.modalAnalysis=!1,this.modalResults={},this.modelStructurePanel=null,this.simExt=null},Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef.prototype.associateResult=function(e,t){this.resultTypes[t]=e},Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef.prototype.associateResultGroup=function(e,t){this.resultGroups[t]=e},Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef.prototype.associateModalResult=function(e,t){var i=[]
if(i=this.modalResults[e],null==i){var n=[]
n.push(t),i=n}else i.push(t)
this.modalResults[e]=i},Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef.prototype.reset=function(){this.studyNode=-1,this.constraintsNode=-1,this.constraintNodes=[],this.loadsNode=-1,this.loadNodes=[],this.resultsNode=-1,this.bodyNode=-1,this.resultTypes={},this.resultGroups={},this.simNodes=[],this.modelNodes=[],this.modalAnalysis=!1,this.modalResults={},this.modelStructurePanel=null},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim"),Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel=function(e){this.viewer=e,this.simDef=null,Autodesk.Viewing.UI.DockingPanel.call(this,e.container,"Simulation-Panel","Simulation Results")},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype),Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel,Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.initialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.initialize.call(this)
var e=this
this.kPanelExpandedHeight=420,this.kPanelCollapsedHeight=35,this.container.classList.add("measurePanel"),this.container.dockRight=!0,this.container.style.minWidth="380px",this.container.style.width="380px",this.container.style.minHeight=this.kPanelCollapsedHeight+"px",this.container.style.height=this.kPanelExpandedHeight+"px",this.container.style.maxHeight=this.kPanelExpandedHeight+"px",this.container.style.top="150px",this.container.style.left="220px",this.container.style.position="absolute",this.legend=document.createElement("div"),this.container.appendChild(this.legend),this.resultsGroup=document.createElement("select"),this.resultsGroup.classList.add("simulation-resultGroup"),this.resultsGroup.style.position="absolute",this.resultsGroup.style.top="42px",this.resultsGroup.style.width="180px",this.resultsGroup.style.left="5px",this.resultsGroup.style.color="black",this.resultsGroup.style.height="22px",this.resultsGroup.style.border="1px",this.resultsGroup.addEventListener("change",function(t){e.viewer.hide(e.simDef.resultsNode),0==e.simDef.modalAnalysis?e.fillResultTypes(e.resultsGroup.value):e.fillModalResultTypes(e.resultsGroup.value),setTimeout(function(){e.setSimObjectsVisibility()},100)}),this.legend.appendChild(this.resultsGroup),this.resultTypes=document.createElement("select"),this.resultTypes.classList.add("simulation-resultTypes"),this.resultTypes.style.position="absolute",this.resultTypes.style.top="42px",this.resultTypes.style.width="180px",this.resultTypes.style.left="190px",this.resultTypes.style.color="black",this.resultTypes.style.height="22px",this.resultTypes.style.border="1px",this.resultTypes.addEventListener("change",function(t){e.viewer.hide(e.simDef.resultsNode),e.setSimObjectsVisibility()}),this.legend.appendChild(this.resultTypes),this.colorScale=document.createElement("div"),this.colorScale.classList.add("simulation-colorscale"),this.colorScale.style.width="210px",this.colorScale.style.height="20px",this.colorScale.style.margin="5px",this.colorScale.style.position="absolute",this.colorScale.style.left="-70px",this.colorScale.style.top="170px",this.colorScale.style.backgroundRepeat="repeat",this.legend.appendChild(this.colorScale),this.colorScaleTopText=document.createElement("div"),this.colorScaleTopText.style.position="absolute",this.colorScaleTopText.style.left="52px",this.colorScaleTopText.style.top="73px",this.colorScaleTopText.innerHTML="- 3333",this.legend.appendChild(this.colorScaleTopText),this.colorScaleBottomText=document.createElement("div"),this.colorScaleBottomText.style.position="absolute",this.colorScaleBottomText.style.left="52px",this.colorScaleBottomText.style.top="281px",this.colorScaleBottomText.innerHTML="- 3333",this.legend.appendChild(this.colorScaleBottomText),this.line=document.createElement("hr"),this.line.style.position="absolute",this.line.style.top="300px",this.line.style.width="100%",this.line.style.borderTop="1px solid black",this.legend.appendChild(this.line),this.tbl=document.createElement("table"),this.tblBody=document.createElement("tbody"),this.tbl.appendChild(this.tblBody),this.legend.appendChild(this.tbl),this.tbl.style.position="absolute",this.tbl.style.top="310px",this.tbl.style.margin="5px"},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.setSimulationDef=function(e){function t(e,t){for(var i=0;i<e.length;++i){var n=e[i]
if(n.displayName===t)return n.displayValue}return null}function i(e){var i=t(e.properties,"Name")
r.setTitle(i)}function n(e,t,i){}function o(e){var i=t(e.properties,"Elements"),n=t(e.properties,"Nodes")
r.cellTextElements2.nodeValue=i,r.cellTextNodes2.nodeValue=n}this.simDef=e
var r=this,a=Number(this.simDef.studyNode)
this.viewer.getProperties(a,i,n)
var s
if(s=1==this.simDef.modalAnalysis?Autodesk.Viewing.i18n.translate("Modal Frequencies"):Autodesk.Viewing.i18n.translate("Static Stress"),this.rowType)this.cellTextType2.nodeValue=s
else{this.rowType=document.createElement("tr"),this.cellType1=document.createElement("td"),this.cellTextType1=document.createTextNode(Autodesk.Viewing.i18n.translate("Analysis Type")),this.cellType1.appendChild(this.cellTextType1),this.cellType1.style.width="180px",this.cellType2=document.createElement("td"),this.cellTextType2=document.createTextNode(s),this.cellType2.appendChild(this.cellTextType2),this.rowType.appendChild(this.cellType1),this.rowType.appendChild(this.cellType2),this.tblBody.appendChild(this.rowType),this.rowNodes=document.createElement("tr"),this.cellNodes1=document.createElement("td"),this.cellTextNodes1=document.createTextNode(Autodesk.Viewing.i18n.translate("Nodes")),this.cellNodes1.appendChild(this.cellTextNodes1),this.cellNodes2=document.createElement("td")
var l="1872"
this.cellTextNodes2=document.createTextNode(l),this.cellNodes2.appendChild(this.cellTextNodes2),this.rowNodes.appendChild(this.cellNodes1),this.rowNodes.appendChild(this.cellNodes2),this.tblBody.appendChild(this.rowNodes),this.rowElements=document.createElement("tr"),this.cellElements1=document.createElement("td"),this.cellTextElements1=document.createTextNode(Autodesk.Viewing.i18n.translate("Elements")),this.cellElements1.appendChild(this.cellTextElements1),this.cellElements2=document.createElement("td")
var c="1084"
this.cellTextElements2=document.createTextNode(c),this.cellElements2.appendChild(this.cellTextElements2),this.rowElements.appendChild(this.cellElements1),this.rowElements.appendChild(this.cellElements2),this.tblBody.appendChild(this.rowElements),this.rowMin=document.createElement("tr"),this.cellMin1=document.createElement("td"),this.cellTextMin1=document.createTextNode(Autodesk.Viewing.i18n.translate("Min")),this.cellMin1.appendChild(this.cellTextMin1),this.cellMin2=document.createElement("td")
var u="0.000E+02 MPa"
this.cellTextMin2=document.createTextNode(u),this.cellMin2.appendChild(this.cellTextMin2),this.rowMin.appendChild(this.cellMin1),this.rowMin.appendChild(this.cellMin2),this.tblBody.appendChild(this.rowMin),this.rowMax=document.createElement("tr"),this.cellMax1=document.createElement("td"),this.cellTextMax1=document.createTextNode(Autodesk.Viewing.i18n.translate("Max")),this.cellMax1.appendChild(this.cellTextMax1),this.cellMax2=document.createElement("td")
var d="5.117E+02 MPa"
this.cellTextMax2=document.createTextNode(d),this.cellMax2.appendChild(this.cellTextMax2),this.rowMax.appendChild(this.cellMax1),this.rowMax.appendChild(this.cellMax2),this.tblBody.appendChild(this.rowMax)}if(this.resultsGroup.options.length=0,0==this.simDef.modalAnalysis){var h=Object.keys(e.resultGroups)
if(!h||0==h.length)return void this.setSimObjectsVisibility()
for(var p=0;p<h.length;p++){var f=document.createElement("option")
f.value=h[p]
var m=e.resultGroups[h[p]]
f.setAttribute("data-i18n",m),f.textContent=Autodesk.Viewing.i18n.translate(m),this.resultsGroup.add(f)}}else{var h=Object.keys(e.modalResults)
if(!h||0==h.length)return void this.setSimObjectsVisibility()
for(var p=0;p<h.length;p++){var f=document.createElement("option")
f.value=h[p]
var m=h[p]
f.setAttribute("data-i18n",m),f.textContent=Autodesk.Viewing.i18n.translate(m),this.resultsGroup.add(f)}}this.resultsGroup.options.length<=1?(this.resultsGroup.disabled=!0,this.resultsGroup.style.webkitAppearance="none",this.resultsGroup.style.mozappearance="none",this.resultsGroup.style.MozAppearance="none",this.resultsGroup.style.appearance="none"):(this.resultsGroup.disabled=!1,this.resultsGroup.style.webkitAppearance="",this.resultsGroup.style.mozappearance="",this.resultsGroup.style.MozAppearance="",this.resultsGroup.style.appearance="")
var r=this,v=r.viewer.model
v.getObjectTree(function(t){r.instanceTree=t,0==r.simDef.modalAnalysis?r.fillResultTypes(r.resultsGroup.value):r.fillModalResultTypes(r.resultsGroup.value),setTimeout(function(){e.simExt.showResultsDlg(!0),e.simExt.applySettings(),r.setSimObjectsVisibility()},500)})
var g=Number(this.simDef.resultsNode)
this.viewer.getProperties(g,o,n)},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.processNodes=function(e,t){function i(e,t){for(var i=0;i<e.length;++i){var n=e[i]
if(n.displayName===t)return n.displayValue}return null}function n(e,t){function n(n){var o=n.properties,a=i(n.properties,"A1C6011B-E1A6-4ADF-975D-A0003C592F87")
if(a){var l=!0
if("SIM_CONSTRAINTS"==a)s.constraintsNode=e
else if("SIM_CONSTRAINT"==a)s.constraintNodes.push(e)
else if("SIM_LOADS"==a)s.loadsNode=e
else if("SIM_LOAD"==a)s.loadNodes.push(e)
else if("SIM_RESULTS_SCALAR_PLOT"==a)0==s.modalAnalysis?s.associateResult(i(o,"Name"),e):s.associateModalResult(i(o,"Name"),e)
else if("SIM_RESULTS_GROUP"==a)0==s.modalAnalysis&&s.associateResultGroup(i(o,"Name"),e)
else if("SIM_RESULTS"==a)s.resultsNode=e,r.viewer.hide(e)
else if("SIM_STUDY"==a){s.studyNode=e
var c=i(n.properties,"Study Type")
"SimCaseModalFrequencies"==c&&(s.modalAnalysis=!0)}1==l&&s.simNodes.push(e)}else s.modelNodes.push(e)
t()}function o(e,i,n){t()}e&&r.viewer&&r.viewer.getProperties(e,n,o)}function o(){a.length>0?n(a.shift(),o):(Autodesk.Viewing.Extensions.Fusion360Sim.$getObjectTree=function(){return s},t(s))}var r=this,a=[],s=this.simDef
s?s.reset():s=new Autodesk.Viewing.Extensions.Fusion360Sim.SimulationDef,e.enumNodeChildren(e.getRootId(),function(e){a.push(e)},!0),o()},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.initModel=function(e,t){if(this.viewer){var i=this
i.processNodes(e,function(e){e.simExt=t,i.setSimulationDef(e)}),i.addEventListener(i.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(e){if(-1!=i.simDef.loadsNode&&i.hightlightNode(i.simDef.loadsNode,!1),-1!=i.simDef.constraintsNode&&i.hightlightNode(i.simDef.constraintsNode,!1),i.simDef.modelNodes&&i.simDef.modelNodes.length>0)for(var t=0;t<i.simDef.modelNodes.length;++t)i.hightlightNode(i.simDef.modelNodes[t],!1)
var n=e.nodeIdArray
n&&(0==n.length?i.setSimObjectsVisibility():1==n.length&&i.isModelNode(n[0])&&(i.simDef.loadsNode&&i.viewer.hide(i.simDef.loadsNode),i.simDef.constraintsNode&&i.viewer.hide(i.simDef.constraintsNode),i.simDef.resultsNode&&i.viewer.hide(i.simDef.resultsNode)))})}},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.hightlightNode=function(e,t){var i=this.viewer.impl,n=this,o=!1,r=this.viewer.model.getData().instanceTree
if(r){var a=r.getRootId()
o="number"==typeof e&&e===a}o&&t||n.instanceTree.enumNodeFragments(e,function(e){i.highlightFragment(n.viewer.model,e,t,!0)},!0)},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.fillResultTypes=function(e){function t(e,t){for(var i=0;i<e.length;++i){var n=e[i]
if(n.displayName===t)return n.displayValue}return null}function i(e){function i(e){var i=t(e.properties,"Result group")
if(i===r){var n=document.createElement("option")
n.value=e.dbId
var a=o.simDef.resultTypes[e.dbId]
n.setAttribute("data-i18n",a),n.textContent=Autodesk.Viewing.i18n.translate(a),o.resultTypes.add(n),o.resultTypes.options.length<=1?(o.resultTypes.disabled=!0,o.resultTypes.style.webkitAppearance="none",o.resultTypes.style.mozappearance="none",o.resultTypes.style.MozAppearance="none",o.resultTypes.style.appearance="none"):(o.resultTypes.disabled=!1,o.resultTypes.style.webkitAppearance="",o.resultTypes.style.mozappearance="",o.resultTypes.style.MozAppearance="",o.resultTypes.style.appearance="")}}for(var r=t(e.properties,"Result group"),a=Object.keys(o.simDef.resultTypes),s=0;s<a.length;s++){var l=Number(a[s])
o.viewer.getProperties(l,i,n)}}function n(e,t,i){}var o=this
o.resultTypes.options.length=0
var r=Number(e)
o.viewer.getProperties(r,i,n)},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.fillModalResultTypes=function(e){function t(e,t){for(var i=0;i<e.length;++i){var n=e[i]
if(n.displayName===t)return n.displayValue}return null}function i(e){var i=t(e.properties,"Result type")
if(i===r){var n=document.createElement("option")
n.value=e.dbId
var a=t(e.properties,"Mode"),s=a
n.setAttribute("data-i18n",s),n.textContent=s,o.resultTypes.add(n),o.simDef.associateResult(s,e.dbId),o.resultTypes.options.length<=1?(o.resultTypes.disabled=!0,o.resultTypes.style.webkitAppearance="none",o.resultTypes.style.mozappearance="none",o.resultTypes.style.MozAppearance="none",o.resultTypes.style.appearance="none"):(o.resultTypes.disabled=!1,o.resultTypes.style.webkitAppearance="",o.resultTypes.style.mozappearance="",o.resultTypes.style.MozAppearance="",o.resultTypes.style.appearance="")}}function n(e,t,i){}var o=this
o.resultTypes.options.length=0
for(var r=e,a=o.simDef.modalResults[r],s=0;s<a.length;s++){var l=Number(a[s])
o.viewer.getProperties(l,i,n)}},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this),this.viewer=null},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.setTitle=function(e,t){e||(e="Simulations",t=t||{},t.localizeTitle=!0),Autodesk.Viewing.UI.DockingPanel.prototype.setTitle.call(this,e,t)},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.setModelNodesVisible=function(e){if(this.simDef.modelNodes&&this.simDef.modelNodes.length>0)for(var t=0;t<this.simDef.modelNodes.length;t++){var i=this.simDef.modelNodes[t],n=!1,o=this.viewer.model.getData().instanceTree
if(o){var r=o.getRootId()
n="number"==typeof i&&i===r}n||(e?this.viewer.show(i):this.viewer.hide(i))}},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isModelNode=function(e){return this.simDef.modelNodes&&0!=this.simDef.modelNodes.length?-1!==this.simDef.modelNodes.indexOf(e):!1},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.setNodeVisibility=function(e,t){t?this.viewer.show(e):this.viewer.hide(e)},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isSimLoadNode=function(e){return this.simDef.loadNodes?-1!==this.simDef.loadNodes.indexOf(e):!1},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isSimConstraintNode=function(e){return this.simDef.constraintNodes?-1!==this.simDef.constraintNodes.indexOf(e):!1},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isSimLoadsNode=function(e){return-1==this.simDef.loadsNode?!1:this.simDef.loadsNode==e},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isSimConstraintsNode=function(e){return-1==this.simDef.constraintsNode?!1:this.simDef.constraintsNode==e},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isSimStudyNode=function(e){return this.simDef.studyNode?this.simDef.studyNode==e:!1},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.isSimResultsNode=function(e){return this.simDef.resultsNode?this.simDef.resultsNode==e:!1},Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel.prototype.setSimObjectsVisibility=function(e){function t(e,t){for(var i=0;i<e.length;++i){var n=e[i]
if(n.displayName===t)return n.displayValue}return null}function i(e){var i=t(e.properties,"Minimal value"),n=t(e.properties,"Maximal value"),r=t(e.properties,"Scale reversed"),a=t(e.properties,"Unit")
o.cellTextMin2.nodeValue=i+" "+a,o.cellTextMax2.nodeValue=n+" "+a
var s=t(e.properties,"Lower referential value"),l=t(e.properties,"Upper referential value")
"True"==r?(o.colorScale.style.transform="rotate(90deg)",o.colorScale.style.moztransform="rotate(90deg)",o.colorScale.style.webkittransform="rotate(90deg)"):(o.colorScale.style.transform="rotate(-90deg)",o.colorScale.style.moztransform="rotate(-90deg)",o.colorScale.style.webkittransform="rotate(-90deg)"),o.colorScaleTopText.innerHTML="- "+l+" "+a,o.colorScaleBottomText.innerHTML="- "+s+" "+a}function n(e,t,i){}if(!this.resultTypes||0==this.resultTypes.options.length)return this.setModelNodesVisible(!0),void this.simDef.simExt.showResultsDlg(!1)
var o=this
this.viewer.hide(this.simDef.resultsNode)
var r=Number(this.resultTypes.value)
if(e){var a=!1,s=this.viewer.model.getData().instanceTree
if(s){var l=s.getRootId()
a="number"==typeof e&&e===l}this.setModelNodesVisible(!1)
var c=(this.isSimLoadNode(e),this.isSimLoadsNode(e),this.isSimConstraintNode(e),this.isSimConstraintsNode(e),this.isSimStudyNode(e))
this.viewer.hide(this.simDef.resultsNode),this.viewer.show(r),this.simDef.loadsNode&&this.viewer.show(this.simDef.loadsNode),this.simDef.constraintsNode&&this.viewer.show(this.simDef.constraintsNode),a||c||s.enumNodeFragments(e,function(e){o.viewer.impl.highlightFragment(o.viewer.model,e,!0,!0)},!0)}else this.setModelNodesVisible(!1),this.viewer.show(r),-1!=this.simDef.loadsNode&&this.viewer.show(this.simDef.loadsNode),-1!=this.simDef.constraintsNode&&this.viewer.show(this.simDef.constraintsNode)
var o=this
o.viewer.getProperties(r,i,n)},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim"),Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel=function(e,t,i){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.call(this,e.viewer,t,i),this.viewer=e.viewer,this.ext=e},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype=Object.create(Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype),Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel,Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.setGallery=function(e){this.simGalleryPanel=e},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.initialize=function(){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.initialize.call(this)},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.isSimResultsNode=function(e){return this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.resultsNode?this.simGalleryPanel.simDef.resultsNode==e:!1},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.isSimStudyNode=function(e){return this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.studyNode?this.simGalleryPanel.simDef.studyNode==e:!1},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.isModelNode=function(e){return this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.modelNodes&&0!=this.simGalleryPanel.simDef.modelNodes.length?-1!==this.simGalleryPanel.simDef.modelNodes.indexOf(e):!1},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.shouldInclude=function(e){return this.isSimStudyNode(e)?!1:!0},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.onClick=function(e,t){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick.call(this,e,t),this.simGalleryPanel.setModelNodesVisible(!0),this.simGalleryPanel.hightlightNode(e,!0),this.simGalleryPanel.simDef.loadsNode&&this.viewer.hide(this.simGalleryPanel.simDef.loadsNode),this.simGalleryPanel.simDef.constraintsNode&&this.viewer.hide(this.simGalleryPanel.simDef.constraintsNode),this.simGalleryPanel.simDef.resultsNode&&this.viewer.hide(this.simGalleryPanel.simDef.resultsNode)},Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel.prototype.expandStudyNode=function(){this.simGalleryPanel.simDef.studyNode&&this.tree.setCollapsed(this.simGalleryPanel.simDef.studyNode,!1)},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim"),Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel=function(e,t,i){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.call(this,e.viewer,t,i),this.viewer=e.viewer,this.ext=e,this.container.style.left="350px"},Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype=Object.create(Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype),Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel,Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.setGallery=function(e){this.simGalleryPanel=e},Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.isSimResultsNode=function(e){return this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.resultsNode?this.simGalleryPanel.simDef.resultsNode==e:!1},Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.isModelNode=function(e){return this.simGalleryPanel&&this.simGalleryPanel.simDef&&this.simGalleryPanel.simDef.modelNodes&&0!=this.simGalleryPanel.simDef.modelNodes.length?1==this.simGalleryPanel.simDef.modelNodes.indexOf(e):!1},Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.shouldInclude=function(e){return this.isSimResultsNode(e)||this.isModelNode(e)?!1:!0},Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.onClick=function(e,t){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick.call(this,e,t),this.simGalleryPanel.setSimObjectsVisibility(e)},Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel.prototype.expandStudyNode=function(){this.simGalleryPanel.simDef.studyNode&&this.tree.setCollapsed(this.simGalleryPanel.simDef.studyNode,!1)},AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360Sim"),Autodesk.Viewing.Extensions.Fusion360Sim.Simulation=function(e,t){Autodesk.Viewing.Extension.call(this,e,t),this.viewer=e,this.simButton=null,this.useSetupPanel=!0,this.useModelPanel=!0,t&&(void 0!==t.useSetupPanel&&(this.useSetupPanel=t.useSetupPanel),void 0!==t.useModelPanel&&(this.useModelPanel=t.useModelPanel))},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype=Object.create(Autodesk.Viewing.Extension.prototype),Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360Sim.Simulation,Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.load=function(){var e=this,t=this.viewer
e.galleryPanel=new Autodesk.Viewing.Extensions.Fusion360Sim.GalleryPanel(e.viewer),e.viewer.addPanel(e.galleryPanel),e.simButton=new Autodesk.Viewing.UI.Button("toolbar-simulation"),e.simButton.setToolTip("Simulation Results"),e.simButton.onClick=function(t){var i=e.galleryPanel.isVisible()
e.galleryPanel.setVisible(!i),e.simButton.setState(i?Autodesk.Viewing.UI.Button.State.INACTIVE:Autodesk.Viewing.UI.Button.State.ACTIVE)},e.simButton.setIcon("toolbar-simulationIcon"),t.settingsTools.addControl(e.simButton,{index:1}),this.hideLines=t.prefs.get("lineRendering"),this.ghosting=t.prefs.get("ghosting"),this.ambientShadow=t.prefs.get("ambientShadows"),this.antialiazing=t.prefs.get("antialiasing"),this.lightPreset=t.prefs.get("lightPreset")
var i=function(){t.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i)
var n=e.viewer.model
n.getObjectTree(function(t){e.galleryPanel.initModel(t,e),e.useModelPanel&&e.initModelBrowser(),e.useSetupPanel&&e.initSetupPanel()})}
this.initIfLoaded=function(){var t=e.viewer.model
t&&t.isLoadDone&&t.getObjectTree(function(t){setTimeout(function(){e.galleryPanel.initModel(t,e),e.useModelPanel&&e.initModelBrowser(),e.useSetupPanel&&e.initSetupPanel()},100)})}
var n=e.viewer.model
return n&&n.isLoadDone?(t.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.initIfLoaded),n.getObjectTree(function(t){setTimeout(function(){e.galleryPanel.initModel(t,e),e.useModelPanel&&e.initModelBrowser(),e.useSetupPanel&&e.initSetupPanel()},100)})):t.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,i),!0},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.unload=function(){return this.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT,this.initIfLoaded),this.showResultsDlg(!1),this.viewer.settingsTools.removeControl(this.simButton),this.viewer.removePanel(this.galleryPanel),this.galleryPanel.uninitialize(),this.viewer.hideLines(!this.hideLines),this.viewer.setGhosting(this.ghosting),this.viewer.setQualityLevel(this.ambientShadow,this.antialiazing),this.viewer.setLightPreset(this.lightPreset),this.modelStructurePanel&&this.viewer.setModelStructurePanel(null),this.simSetupPanel&&(this.simSetupPanel.setVisible(!1),this.viewer.removePanel(this.simSetupPanel),this.simSetupPanel.uninitialize()),!0},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.initSetupPanel=function(){var e=this
setTimeout(function(){e.simSetupButton=new Autodesk.Viewing.UI.Button("toolbar-simulation-setup"),e.simSetupButton.setToolTip("Simulation Setup"),e.simSetupButton.onClick=function(t){var i=e.simSetupPanel.isVisible()
e.simSetupPanel.setVisible(!i),e.simSetupButton.setState(i?Autodesk.Viewing.UI.Button.State.INACTIVE:Autodesk.Viewing.UI.Button.State.ACTIVE)},e.simSetupButton.setIcon("toolbar-simulationSetupIcon"),e.viewer.settingsTools.addControl(e.simSetupButton,{index:0}),e.simSetupPanel=new Autodesk.Viewing.Extensions.Fusion360Sim.SimSetupPanel(e,Autodesk.Viewing.i18n.translate("Simulation Setup Loading"),e.options),e.simSetupPanel.setGallery(e.galleryPanel),e.viewer.addPanel(e.simSetupPanel),e.viewer.model&&e.viewer.model.getObjectTree(function(t){e.simSetupPanel.setModel(t,Autodesk.Viewing.i18n.translate("Simulation Setup"))})},100)},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.initModelBrowser=function(){var e=this
setTimeout(function(){e.modelStructurePanel=new Autodesk.Viewing.Extensions.Fusion360Sim.SimModelStructurePanel(e,"Simulation Model Structure Loading",e.options),e.viewer.setModelStructurePanel(e.modelStructurePanel),e.modelStructurePanel.setGallery(e.galleryPanel)},100)},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.showResultsDlg=function(e){this.simButton.setState(e?Autodesk.Viewing.UI.Button.State.ACTIVE:Autodesk.Viewing.UI.Button.State.INACTIVE),this.simButton.setVisible(e),this.galleryPanel.setVisible(e)},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.applySettings=function(e){this.viewer.hideLines(!1),this.viewer.setGhosting(!1),this.viewer.setQualityLevel(!1,!0),this.viewer.setLightPreset(4)},Autodesk.Viewing.Extensions.Fusion360Sim.Simulation.prototype.simData=function(){return this.galleryPanel.simDef},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Fusion360.Simulation",Autodesk.Viewing.Extensions.Fusion360Sim.Simulation),function(e,t){"use strict"
var i,n=e.document
i=function(){var i,o,r,a,s,l,c,u,d,h,p,f,m,v={},g={},E=!1,y={ENTER:13,ESC:27,SPACE:32},A=[]
return g={buttons:{holder:'<nav class="alertify-buttons">{{buttons}}</nav>',submit:'<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',ok:'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',cancel:'<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>'},input:'<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>',message:'<p class="alertify-message">{{message}}</p>',log:'<article class="alertify-log{{class}}">{{message}}</article>'},m=function(){var e,i,o=!1,r=n.createElement("fakeelement"),a={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}
for(e in a)if(r.style[e]!==t){i=a[e],o=!0
break}return{type:i,supported:o}},i=function(e){return n.getElementById(e)},v={labels:{ok:"OK",cancel:"Cancel"},delay:5e3,buttonReverse:!1,buttonFocus:"ok",transition:t,addListeners:function(e){var t,i,l,c,u,d="undefined"!=typeof r,h="undefined"!=typeof o,p="undefined"!=typeof f,m="",v=this
t=function(t){return"undefined"!=typeof t.preventDefault&&t.preventDefault(),l(t),"undefined"!=typeof f&&(m=f.value),"function"==typeof e&&("undefined"!=typeof f?e(!0,m):e(!0)),!1},i=function(t){return"undefined"!=typeof t.preventDefault&&t.preventDefault(),l(t),"function"==typeof e&&e(!1),!1},l=function(e){v.hide(),v.unbind(n.body,"keyup",c),v.unbind(a,"focus",u),d&&v.unbind(r,"click",t),h&&v.unbind(o,"click",i)},c=function(e){var n=e.keyCode;(n===y.SPACE&&!p||p&&n===y.ENTER)&&t(e),n===y.ESC&&h&&i(e)},u=function(e){p?f.focus():!h||v.buttonReverse?r.focus():o.focus()},this.bind(a,"focus",u),this.bind(s,"focus",u),d&&this.bind(r,"click",t),h&&this.bind(o,"click",i),this.bind(n.body,"keyup",c),this.transition.supported||this.setFocus()},bind:function(e,t,i){"function"==typeof e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,i)},handleErrors:function(){if("undefined"!=typeof e.onerror){var t=this
return e.onerror=function(e,i,n){t.error("["+e+" on line "+n+" of "+i+"]",0)},!0}return!1},appendButtons:function(e,t){return this.buttonReverse?t+e:e+t},build:function(e){var t="",i=e.type,n=e.message,o=e.cssClass||""
switch(t+='<div class="alertify-dialog">',t+='<a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>',"none"===v.buttonFocus&&(t+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>'),"prompt"===i&&(t+='<div id="alertify-form">'),t+='<article class="alertify-inner">',t+=g.message.replace("{{message}}",n),"prompt"===i&&(t+=g.input),t+=g.buttons.holder,t+="</article>","prompt"===i&&(t+="</div>"),t+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>',t+="</div>",i){case"confirm":t=t.replace("{{buttons}}",this.appendButtons(g.buttons.cancel,g.buttons.ok)),t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel)
break
case"prompt":t=t.replace("{{buttons}}",this.appendButtons(g.buttons.cancel,g.buttons.submit)),t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel)
break
case"alert":t=t.replace("{{buttons}}",g.buttons.ok),t=t.replace("{{ok}}",this.labels.ok)}return d.className="alertify alertify-"+i+" "+o,u.className="alertify-cover",t},close:function(e,t){var i,n,o=t&&!isNaN(t)?+t:this.delay,r=this
this.bind(e,"click",function(){i(e)}),n=function(e){e.stopPropagation(),r.unbind(this,r.transition.type,n),h.removeChild(this),h.hasChildNodes()||(h.className+=" alertify-logs-hidden")},i=function(e){"undefined"!=typeof e&&e.parentNode===h&&(r.transition.supported?(r.bind(e,r.transition.type,n),e.className+=" alertify-log-hide"):(h.removeChild(e),h.hasChildNodes()||(h.className+=" alertify-logs-hidden")))},0!==t&&setTimeout(function(){i(e)},o)},dialog:function(e,t,i,o,r){c=n.activeElement
var a=function(){h&&null!==h.scrollTop&&u&&null!==u.scrollTop||a()}
if("string"!=typeof e)throw new Error("message must be a string")
if("string"!=typeof t)throw new Error("type must be a string")
if("undefined"!=typeof i&&"function"!=typeof i)throw new Error("fn must be a function")
return this.init(),a(),A.push({type:t,message:e,callback:i,placeholder:o,cssClass:r}),E||this.setup(),this},extend:function(e){if("string"!=typeof e)throw new Error("extend method must have exactly one paramter")
return function(t,i){return this.log(t,e,i),this}},hide:function(){var e,t=this
A.splice(0,1),A.length>0?this.setup(!0):(E=!1,e=function(i){i.stopPropagation(),t.unbind(d,t.transition.type,e)},this.transition.supported?(this.bind(d,this.transition.type,e),d.className="alertify alertify-hide alertify-hidden"):d.className="alertify alertify-hide alertify-hidden alertify-isHidden",u.className="alertify-cover alertify-cover-hidden",c.focus())},init:function(){n.createElement("nav"),n.createElement("article"),n.createElement("section"),null==i("alertify-cover")&&(u=n.createElement("div"),u.setAttribute("id","alertify-cover"),u.className="alertify-cover alertify-cover-hidden",n.body.appendChild(u)),null==i("alertify")&&(E=!1,A=[],d=n.createElement("section"),d.setAttribute("id","alertify"),d.setAttribute("style","z-index : 999999999"),d.className="alertify alertify-hidden",n.body.appendChild(d)),null==i("alertify-logs")&&(h=n.createElement("section"),h.setAttribute("id","alertify-logs"),h.className="alertify-logs alertify-logs-hidden",n.body.appendChild(h)),n.body.setAttribute("tabindex","0"),this.transition=m()},log:function(e,t,i){var n=function(){h&&null!==h.scrollTop||n()}
return this.init(),n(),h.className="alertify-logs",this.notify(e,t,i),this},notify:function(e,t,i){var o=n.createElement("article")
o.className="alertify-log"+("string"==typeof t&&""!==t?" alertify-log-"+t:""),o.innerHTML=e,h.appendChild(o),setTimeout(function(){o.className=o.className+" alertify-log-show"},50),this.close(o,i)},set:function(e){var t
if("object"!=typeof e&&e instanceof Array)throw new Error("args must be an object")
for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},setFocus:function(){f?(f.focus(),f.select()):l.focus()},setup:function(e){var n,c=A[0],u=this
E=!0,n=function(e){e.stopPropagation(),u.setFocus(),u.unbind(d,u.transition.type,n)},this.transition.supported&&!e&&this.bind(d,this.transition.type,n),d.innerHTML=this.build(c),a=i("alertify-resetFocus"),s=i("alertify-resetFocusBack"),r=i("alertify-ok")||t,o=i("alertify-cancel")||t,l="cancel"===v.buttonFocus?o:"none"===v.buttonFocus?i("alertify-noneFocus"):r,f=i("alertify-text")||t,p=i("alertify-form")||t,"string"==typeof c.placeholder&&""!==c.placeholder&&(f.value=c.placeholder),e&&this.setFocus(),this.addListeners(c.callback)},unbind:function(e,t,i){"function"==typeof e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)}},{alert:function(e,t,i){return v.dialog(e,"alert",t,"",i),this},confirm:function(e,t,i){return v.dialog(e,"confirm",t,"",i),this},extend:v.extend,init:v.init,log:function(e,t,i){return v.log(e,t,i),this},prompt:function(e,t,i,n){return v.dialog(e,"prompt",t,i,n),this},success:function(e,t){return v.log(e,"success",t),this},error:function(e,t){return v.log(e,"error",t),this},set:function(e){v.set(e)},hide:function(e){v.hide(e)},labels:v.labels,debug:v.handleErrors}},"undefined"==typeof e.alertify&&(e.alertify=new i)}(this),AutodeskNamespace("Autodesk.Viewing"),AutodeskNamespace("Autodesk.Viewing.Private")
var auth=null,VIEWING_URL,ACM_SESSION_URL,OSS_URL,PROTEIN_ROOT=null,PRISM_ROOT=null,LOCALIZATION_REL_PATH="",LMV_VIEWER_VERSION="1.2.21",LMV_RESOURCE_VERSION=null,LMV_RESOURCE_ROOT=""
!function(){var e=Autodesk.Viewing.Private
e.env=null,e.logger=null,e.refreshToken=null,e.docItemId=null,e.token={getAccessToken:null,tokenRefreshInterval:null},e.memoryOptimizedLoading=!0,e.GPU_MEMORY_LIMIT=268435456,e.GPU_OBJECT_LIMIT=1e4
var t=isAndroidDevice()||isIOSDevice()
t?(e.FRAGS_PERSISTENT_COUNT=2e3,e.FRAGS_PERSISTENT_MAX_COUNT=15e4,e.GEOMS_COUNT_LIMIT=8e3):(e.FRAGS_PERSISTENT_COUNT=1e4,e.FRAGS_PERSISTENT_MAX_COUNT=8e5,e.GEOMS_COUNT_LIMIT=3e5),e.onDemandLoading=!1,e.cullGeometryOnLoading=e.onDemandLoading,e.pageOutGeometryEnabled=e.onDemandLoading,e.PAGEOUT_SUCCESS=0,e.PAGEOUT_FAIL=1,e.PAGEOUT_NONE=2,e.PAGEOUT_PERCENTAGE=.35,e.GEOMS_PAGEOUT_COUNT=e.GEOMS_COUNT_LIMIT*e.PAGEOUT_PERCENTAGE,e.assets=[],e.offline=!1,e.offlineResourcePrefix=null
var i={local:{LOGGING:"rtc-dev.api.autodesk.com",RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},dev:{LOGGING:"rtc-dev.api.autodesk.com",RTC:["https://rtc-dev.api.autodesk.com:443","https://lmv.autodesk.com:443"]},stg:{LOGGING:"rtc-stg.api.autodesk.com",RTC:["https://rtc-stg.api.autodesk.com:443","https://lmv.autodesk.com:443"]},prod:{LOGGING:"rtc.api.autodesk.com",RTC:["https://rtc.api.autodesk.com:443","https://lmv.autodesk.com:443"]}},n={local:"",dev:"https://viewing-dev.api.autodesk.com",stg:"https://viewing-staging.api.autodesk.com",prod:"https://viewing.api.autodesk.com"},o={local:"",dev:"https://developer-dev.api.autodesk.com",stg:"https://developer-stg.api.autodesk.com",prod:"https://developer.api.autodesk.com"},r={ACM:"/oss-ext/v1/acmsessions",OSS:"/oss/v1",VIEWING:"/viewingservice/v1",VIEWING2:"/derivativeservice/v2"}
e.EnvironmentConfigurations={Local:{ROOT:"",VIEWING:"",ACM:"",OSS:"",LMV:i.local},Development:{ROOT:n.dev,VIEWING:n.dev+r.VIEWING,ACM:o.dev+r.ACM,OSS:o.dev+r.OSS,LMV:i.dev},Staging:{ROOT:n.stg,VIEWING:n.stg+r.VIEWING,ACM:o.stg+r.ACM,OSS:o.stg+r.OSS,LMV:i.stg},Production:{ROOT:n.prod,VIEWING:n.prod+r.VIEWING,ACM:o.prod+r.ACM,OSS:o.prod+r.OSS,LMV:i.prod},AutodeskDevelopment:{ROOT:o.dev,VIEWING:o.dev+r.VIEWING,ACM:o.dev+r.ACM,OSS:o.dev+r.OSS,LMV:i.dev},AutodeskStaging:{ROOT:o.stg,VIEWING:o.stg+r.VIEWING,ACM:o.stg+r.ACM,OSS:o.stg+r.OSS,LMV:i.stg},AutodeskProduction:{ROOT:o.prod,VIEWING:o.prod+r.VIEWING,ACM:o.prod+r.ACM,OSS:o.prod+r.OSS,LMV:i.prod},DevelopmentV2:{ROOT:n.dev,VIEWING:n.dev+r.VIEWING2,ACM:o.dev+r.ACM,OSS:o.dev+r.OSS,LMV:i.dev},StagingV2:{ROOT:n.stg,VIEWING:n.stg+r.VIEWING2,ACM:o.stg+r.ACM,OSS:o.stg+r.OSS,LMV:i.stg},ProductionV2:{ROOT:n.prod,VIEWING:n.prod+r.VIEWING2,ACM:o.prod+r.ACM,OSS:o.prod+r.OSS,LMV:i.prod},AutodeskDevelopmentV2:{ROOT:o.dev,VIEWING:o.dev+r.VIEWING2,ACM:o.dev+r.ACM,OSS:o.dev+r.OSS,LMV:i.dev},AutodeskStagingV2:{ROOT:o.stg,VIEWING:o.stg+r.VIEWING2,ACM:o.stg+r.ACM,OSS:o.stg+r.OSS,LMV:i.stg},AutodeskProductionV2:{ROOT:o.prod,VIEWING:o.prod+r.VIEWING2,ACM:o.prod+r.ACM,OSS:o.prod+r.OSS,LMV:i.prod}},e.initializeEnvironmentVariable=function(t){var i
if(t&&t.env&&(i=t.env),i||(i=e.getParameterByName("env")),t&&t.offlineResourcePrefix&&(e.offlineResourcePrefix=t.offlineResourcePrefix),t&&t.offline&&"true"===t.offline&&(e.offline=!0),!i)switch(window.location.hostname){case"viewing-dev.api.autodesk.com":i="Development"
break
case"viewing-staging.api.autodesk.com":i="Staging"
break
case"viewing.api.autodesk.com":i="Production"
break
case"developer-dev.api.autodesk.com":i="AutodeskDevelopment"
break
case"developer-stg.api.autodesk.com":i="AutodeskStaging"
break
case"developer.api.autodesk.com":i="AutodeskProduction"
break
case"localhost.autodesk.com":i="Local"
break
case"":i="Local"
break
case"127.0.0.1":i="Local"
break
default:i="AutodeskProduction"}console.log("Host name : "+window.location.hostname),console.log("Environment initialized as : "+i),e.env=i},e.initializeServiceEndPoints=function(t){var i=e.env,n=e.EnvironmentConfigurations[i]
VIEWING_URL=n.VIEWING,ACM_SESSION_URL=n.ACM,OSS_URL=n.OSS
var o=["viewer3D.js","viewer3D.min.js","firefly.js","firefly.min.js"]
t&&t.hasOwnProperty("libraryName")&&o.push(t.libraryName)
for(var r,a,s=0;s<o.length;s++){var l=e.getScript(o[s])
a=l?l.src:""
var c=a.indexOf(o[s])
if(c>=0){r=a.substr(0,c)
break}}LMV_RESOURCE_VERSION="v"+LMV_VIEWER_VERSION
var u=e.getParameterByNameFromPath("v",a)
u&&u.length&&u!=LMV_RESOURCE_VERSION?(console.warn("Version string mismatch between requested and actual version: "+u+" vs. "+LMV_RESOURCE_VERSION+". Using "+u),LMV_RESOURCE_VERSION=u):u&&u.length||(LMV_RESOURCE_VERSION=null,console.info("No viewer version specified, will implicitly use "+LMV_VIEWER_VERSION)),LMV_RESOURCE_ROOT=r||LMV_RESOURCE_ROOT},e.refreshCookie=function(t,i,n){var o=new XMLHttpRequest
if(o.onload=i,o.onerror=n,o.ontimeout=n,0===e.env.indexOf("Autodesk")){var r=e.EnvironmentConfigurations[e.env].ROOT
o.open("POST",r+"/utility/v1/settoken",!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.withCredentials=!0,o.send("access-token="+t),_isIE11&&(e.accessToken=t)}else{var t={oauth:{token:t}}
o.open("POST",VIEWING_URL+"/token",!0),o.setRequestHeader("Content-Type","application/json"),o.withCredentials=!0,o.send(JSON.stringify(t))}},e.initializeAuth=function(t,i){function n(o,r){a=o,e.refreshCookie(a,e.token.tokenRefreshInterval?null:t)
var s=r-60
0>=s&&(s=r),e.token.tokenRefreshInterval=1e3*s,setTimeout(function(){i.getAccessToken(n)},e.token.tokenRefreshInterval)}var o=i?i.shouldInitializeAuth:void 0
if(void 0===o){var r=e.getParameterByName("auth")
o="false"!==r.toLowerCase()}if("Local"==e.env||!o)return setTimeout(t,0),auth=!1
auth=!0
var a
return i&&i.accessToken?(a=i.accessToken,e.refreshCookie(a,t)):i&&i.getAccessToken?(e.token.getAccessToken=i.getAccessToken,a=i.getAccessToken(n),"string"==typeof a&&a&&e.refreshCookie(a,t)):(a=e.getParameterByName("accessToken"),a||(a="QYNrnn1T44Jy3wWMKJaT6RHmMgg=",console.log("Warning : no access token is provided. Use built in token : "+a)),e.refreshCookie(a,t)),auth},e.refreshTokenAndCookie=function(t,i){var n=null
e.refreshToken&&(n=e.refreshToken()),n?e.refreshCookie(n,t,i):i&&i(null)},e.initializeLogger=function(t){var i={endpoint:e.EnvironmentConfigurations[e.env].LMV.LOGGING,eventCallback:t?t.eventCallback:void 0}
e.logger=new e.Logger(i)},e.initializeProtein=function(){if((!ENABLE_DEBUG||"Local"!=e.env||auth)&&!e.offline){var t=new XMLHttpRequest
t.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=protein",!0),t.responseType="json",t.onload=function(e){var i=t.response.url
i&&i.length&&(i=i.replace("http://","https://"),PROTEIN_ROOT=i+"/",stderr("Protein root is: "+PROTEIN_ROOT))},t.send()
var i=new XMLHttpRequest
i.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=prism",!0),i.responseType="json",i.onload=function(e){var t=i.response.url
t&&t.length&&(t=t.replace("http://","https://"),PRISM_ROOT=t+"/",stderr("Prism root is: "+PRISM_ROOT))},i.send()}},e.getAuthObject=function(){return auth},e.getParameterByName=function(t){return e.getParameterByNameFromPath(t,window.location.href)},e.getParameterByNameFromPath=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")
var i="[\\?&]"+e+"=([^&#]*)",n=new RegExp(i),o=n.exec(t)
return null==o?"":decodeURIComponent(o[1].replace(/\+/g," "))},e.getDemoDocumentURN=function(){var t
switch(e.env){case"Development":t="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ=="
break
case"Staging":t="urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm"
break
case"Production":t="FIXME"
break
default:t="https://lmv.rocks/viewer/data/gears/output/bubble.json"}return t},e.setLanguage=function(e,t){var i={lng:e,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1}
LOCALIZATION_REL_PATH="res/locales/"+e+"/",Autodesk.Viewing.i18n.init(i,function(e){Autodesk.Viewing.i18n.localize(),t&&t()})},e.initializeLocalization=function(t){var i=t&&t.language||navigator.language,n=i.split("-")
i=n.length>1?n[0].toLowerCase()+"-"+n[1].toUpperCase():n[0].toLowerCase()
var o=["cs","de","en","es","fr","it","ja","ko","pl","pt-BR","ru","tr","zh-HANS","zh-HANT"];-1===o.indexOf(i)&&(i=i.indexOf("zh-CN")>-1?"zh-HANS":i.indexOf("zh-TW")>-1?"zh-HANT":n.length>1&&o.indexOf(n[0])>-1?n[0]:"en"),e.setLanguage(i)},e.initializeUserInfo=function(t){t&&t.userInfo&&(e.setUserName(t.userInfo.name),t.comment2Token&&(e.comment2Token=t.comment2Token))},e.getScript=function(e){e=e.toLowerCase()
var t=document.getElementsByTagName("SCRIPT")
if(t&&t.length>0)for(var i=0;i<t.length;++i)if(t[i].src&&-1!==t[i].src.toLowerCase().indexOf(e))return t[i]
return null},e.getResourceUrl=function(e){var t=LMV_RESOURCE_VERSION
return LMV_RESOURCE_ROOT+e+(t?"?v="+t:"")},e.loadDependency=function(t,i,n){if("undefined"==typeof window[t]){var o=document.createElement("SCRIPT")
o.src=e.getResourceUrl(i),document.head.appendChild(o),n&&(o.onload=n)}else n&&n()},Autodesk.Viewing.Initializer=function(t,i){function n(){THREE.warn=function(){stderr.apply(stderr,arguments)},init_three_dds_loader(),e.initializeLogger(t),e.initializeAuth(i,t),e.initializeLocalization(t),e.initializeUserInfo(t)}e.WEBGL_HELP_LINK=t?t.webGLHelpLink:null,e.initializeEnvironmentVariable(t),e.initializeServiceEndPoints(t),e.initializeProtein(),e.initWorkerScript(),e.loadDependency("THREE","three.min.js",n)}}()
